"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(t,o){return t(o={exports:{}},o.exports),o.exports}var o,s,check=function(t){return t&&t.Math===Math&&t},l=check("object"==typeof globalThis&&globalThis)||check("object"==typeof window&&window)||check("object"==typeof self&&self)||check("object"==typeof t&&t)||function(){return this}()||t||Function("return this")(),fails=function(t){try{return!!t()}catch(t){return!0}},h=!fails((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),m=!fails((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),_=Function.prototype.call,E=m?_.bind(_):function(){return _.apply(_,arguments)},$={}.propertyIsEnumerable,B=Object.getOwnPropertyDescriptor,q=B&&!$.call({1:2},1)?function propertyIsEnumerable(t){var o=B(this,t);return!!o&&o.enumerable}:$,j={f:q},createPropertyDescriptor=function(t,o){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:o}},K=Function.prototype,W=K.call,X=m&&K.bind.bind(W,W),re=m?X:function(t){return function(){return W.apply(t,arguments)}},oe=re({}.toString),ne=re("".slice),classofRaw=function(t){return ne(oe(t),8,-1)},ae=Object,le=re("".split),de=fails((function(){return!ae("z").propertyIsEnumerable(0)}))?function(t){return"String"===classofRaw(t)?le(t,""):ae(t)}:ae,isNullOrUndefined=function(t){return null==t},me=TypeError,requireObjectCoercible=function(t){if(isNullOrUndefined(t))throw new me("Can't call method on "+t);return t},toIndexedObject=function(t){return de(requireObjectCoercible(t))},we="object"==typeof document&&document.all,_e={all:we,IS_HTMLDDA:void 0===we&&void 0!==we},xe=_e.all,Te=_e.IS_HTMLDDA?function(t){return"function"==typeof t||t===xe}:function(t){return"function"==typeof t},Ee=_e.all,Ie=_e.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:Te(t)||t===Ee}:function(t){return"object"==typeof t?null!==t:Te(t)},getBuiltIn=function(t,o){return arguments.length<2?(s=l[t],Te(s)?s:void 0):l[t]&&l[t][o];var s},Fe=re({}.isPrototypeOf),He="undefined"!=typeof navigator&&String(navigator.userAgent)||"",qe=l.process,Ve=l.Deno,Ge=qe&&qe.versions||Ve&&Ve.version,We=Ge&&Ge.v8;We&&(s=(o=We.split("."))[0]>0&&o[0]<4?1:+(o[0]+o[1])),!s&&He&&(!(o=He.match(/Edge\/(\d+)/))||o[1]>=74)&&(o=He.match(/Chrome\/(\d+)/))&&(s=+o[1]);var et=s,tt=l.String,rt=!!Object.getOwnPropertySymbols&&!fails((function(){var t=Symbol("symbol detection");return!tt(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&et&&et<41})),ot=rt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,nt=Object,it=ot?function(t){return"symbol"==typeof t}:function(t){var o=getBuiltIn("Symbol");return Te(o)&&Fe(o.prototype,nt(t))},st=String,tryToString=function(t){try{return st(t)}catch(t){return"Object"}},lt=TypeError,aCallable=function(t){if(Te(t))return t;throw new lt(tryToString(t)+" is not a function")},getMethod$1=function(t,o){var s=t[o];return isNullOrUndefined(s)?void 0:aCallable(s)},ct=TypeError,ordinaryToPrimitive=function(t,o){var s,l;if("string"===o&&Te(s=t.toString)&&!Ie(l=E(s,t)))return l;if(Te(s=t.valueOf)&&!Ie(l=E(s,t)))return l;if("string"!==o&&Te(s=t.toString)&&!Ie(l=E(s,t)))return l;throw new ct("Can't convert object to primitive value")},dt=Object.defineProperty,defineGlobalProperty=function(t,o){try{dt(l,t,{value:o,configurable:!0,writable:!0})}catch(s){l[t]=o}return o},ut="__core-js_shared__",ht=l[ut]||defineGlobalProperty(ut,{}),pt=createCommonjsModule((function(t){(t.exports=function(t,o){return ht[t]||(ht[t]=void 0!==o?o:{})})("versions",[]).push({version:"3.33.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})})),ft=Object,toObject=function(t){return ft(requireObjectCoercible(t))},gt=re({}.hasOwnProperty),vt=Object.hasOwn||function hasOwn(t,o){return gt(toObject(t),o)},mt=0,yt=Math.random(),bt=re(1..toString),uid=function(t){return"Symbol("+(void 0===t?"":t)+")_"+bt(++mt+yt,36)},wt=l.Symbol,Ct=pt("wks"),_t=ot?wt.for||wt:wt&&wt.withoutSetter||uid,wellKnownSymbol=function(t){return vt(Ct,t)||(Ct[t]=rt&&vt(wt,t)?wt[t]:_t("Symbol."+t)),Ct[t]},kt=TypeError,xt=wellKnownSymbol("toPrimitive"),toPrimitive=function(t,o){if(!Ie(t)||it(t))return t;var s,l=getMethod$1(t,xt);if(l){if(void 0===o&&(o="default"),s=E(l,t,o),!Ie(s)||it(s))return s;throw new kt("Can't convert object to primitive value")}return void 0===o&&(o="number"),ordinaryToPrimitive(t,o)},toPropertyKey=function(t){var o=toPrimitive(t,"string");return it(o)?o:o+""},St=l.document,Tt=Ie(St)&&Ie(St.createElement),documentCreateElement=function(t){return Tt?St.createElement(t):{}},Et=!h&&!fails((function(){return 7!==Object.defineProperty(documentCreateElement("div"),"a",{get:function(){return 7}}).a})),At=Object.getOwnPropertyDescriptor,It=h?At:function getOwnPropertyDescriptor(t,o){if(t=toIndexedObject(t),o=toPropertyKey(o),Et)try{return At(t,o)}catch(t){}if(vt(t,o))return createPropertyDescriptor(!E(j.f,t,o),t[o])},Pt={f:It},Rt=h&&fails((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),$t=String,Mt=TypeError,anObject=function(t){if(Ie(t))return t;throw new Mt($t(t)+" is not an object")},Ot=TypeError,Nt=Object.defineProperty,Dt=Object.getOwnPropertyDescriptor,Lt="enumerable",Ft="configurable",Bt="writable",Ht=h?Rt?function defineProperty(t,o,s){if(anObject(t),o=toPropertyKey(o),anObject(s),"function"==typeof t&&"prototype"===o&&"value"in s&&Bt in s&&!s[Bt]){var l=Dt(t,o);l&&l[Bt]&&(t[o]=s.value,s={configurable:Ft in s?s[Ft]:l[Ft],enumerable:Lt in s?s[Lt]:l[Lt],writable:!1})}return Nt(t,o,s)}:Nt:function defineProperty(t,o,s){if(anObject(t),o=toPropertyKey(o),anObject(s),Et)try{return Nt(t,o,s)}catch(t){}if("get"in s||"set"in s)throw new Ot("Accessors not supported");return"value"in s&&(t[o]=s.value),t},Ut={f:Ht},qt=h?function(t,o,s){return Ut.f(t,o,createPropertyDescriptor(1,s))}:function(t,o,s){return t[o]=s,t},jt=Function.prototype,zt=h&&Object.getOwnPropertyDescriptor,Vt=vt(jt,"name"),Gt={EXISTS:Vt,PROPER:Vt&&"something"===function something(){}.name,CONFIGURABLE:Vt&&(!h||h&&zt(jt,"name").configurable)},Kt=re(Function.toString);Te(ht.inspectSource)||(ht.inspectSource=function(t){return Kt(t)});var Wt,Qt,Yt,Zt=ht.inspectSource,Jt=l.WeakMap,Xt=Te(Jt)&&/native code/.test(String(Jt)),er=pt("keys"),sharedKey=function(t){return er[t]||(er[t]=uid(t))},tr={},rr="Object already initialized",or=l.TypeError,nr=l.WeakMap;if(Xt||ht.state){var ir=ht.state||(ht.state=new nr);ir.get=ir.get,ir.has=ir.has,ir.set=ir.set,Wt=function(t,o){if(ir.has(t))throw new or(rr);return o.facade=t,ir.set(t,o),o},Qt=function(t){return ir.get(t)||{}},Yt=function(t){return ir.has(t)}}else{var sr=sharedKey("state");tr[sr]=!0,Wt=function(t,o){if(vt(t,sr))throw new or(rr);return o.facade=t,qt(t,sr,o),o},Qt=function(t){return vt(t,sr)?t[sr]:{}},Yt=function(t){return vt(t,sr)}}var ar={set:Wt,get:Qt,has:Yt,enforce:function(t){return Yt(t)?Qt(t):Wt(t,{})},getterFor:function(t){return function(o){var s;if(!Ie(o)||(s=Qt(o)).type!==t)throw new or("Incompatible receiver, "+t+" required");return s}}},lr=createCommonjsModule((function(t){var o=Gt.CONFIGURABLE,s=ar.enforce,l=ar.get,m=String,_=Object.defineProperty,E=re("".slice),$=re("".replace),B=re([].join),q=h&&!fails((function(){return 8!==_((function(){}),"length",{value:8}).length})),j=String(String).split("String"),K=t.exports=function(t,l,K){"Symbol("===E(m(l),0,7)&&(l="["+$(m(l),/^Symbol\(([^)]*)\)/,"$1")+"]"),K&&K.getter&&(l="get "+l),K&&K.setter&&(l="set "+l),(!vt(t,"name")||o&&t.name!==l)&&(h?_(t,"name",{value:l,configurable:!0}):t.name=l),q&&K&&vt(K,"arity")&&t.length!==K.arity&&_(t,"length",{value:K.arity});try{K&&vt(K,"constructor")&&K.constructor?h&&_(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var W=s(t);return vt(W,"source")||(W.source=B(j,"string"==typeof l?l:"")),t};Function.prototype.toString=K((function toString(){return Te(this)&&l(this).source||Zt(this)}),"toString")})),defineBuiltIn=function(t,o,s,l){l||(l={});var h=l.enumerable,m=void 0!==l.name?l.name:o;if(Te(s)&&lr(s,m,l),l.global)h?t[o]=s:defineGlobalProperty(o,s);else{try{l.unsafe?t[o]&&(h=!0):delete t[o]}catch(t){}h?t[o]=s:Ut.f(t,o,{value:s,enumerable:!1,configurable:!l.nonConfigurable,writable:!l.nonWritable})}return t},cr=Math.ceil,dr=Math.floor,ur=Math.trunc||function trunc(t){var o=+t;return(o>0?dr:cr)(o)},toIntegerOrInfinity=function(t){var o=+t;return o!=o||0===o?0:ur(o)},hr=Math.max,pr=Math.min,toAbsoluteIndex=function(t,o){var s=toIntegerOrInfinity(t);return s<0?hr(s+o,0):pr(s,o)},fr=Math.min,toLength=function(t){return t>0?fr(toIntegerOrInfinity(t),9007199254740991):0},lengthOfArrayLike=function(t){return toLength(t.length)},createMethod$7=function(t){return function(o,s,l){var h,m=toIndexedObject(o),_=lengthOfArrayLike(m),E=toAbsoluteIndex(l,_);if(t&&s!=s){for(;_>E;)if((h=m[E++])!=h)return!0}else for(;_>E;E++)if((t||E in m)&&m[E]===s)return t||E||0;return!t&&-1}},gr={includes:createMethod$7(!0),indexOf:createMethod$7(!1)},vr=gr.indexOf,mr=re([].push),objectKeysInternal=function(t,o){var s,l=toIndexedObject(t),h=0,m=[];for(s in l)!vt(tr,s)&&vt(l,s)&&mr(m,s);for(;o.length>h;)vt(l,s=o[h++])&&(~vr(m,s)||mr(m,s));return m},yr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],br=yr.concat("length","prototype"),wr={f:Object.getOwnPropertyNames||function getOwnPropertyNames(t){return objectKeysInternal(t,br)}},Cr={f:Object.getOwnPropertySymbols},_r=re([].concat),kr=getBuiltIn("Reflect","ownKeys")||function ownKeys(t){var o=wr.f(anObject(t)),s=Cr.f;return s?_r(o,s(t)):o},copyConstructorProperties$1=function(t,o,s){for(var l=kr(o),h=Ut.f,m=Pt.f,_=0;_<l.length;_++){var E=l[_];vt(t,E)||s&&vt(s,E)||h(t,E,m(o,E))}},xr=/#|\.prototype\./,isForced=function(t,o){var s=Tr[Sr(t)];return s===Ar||s!==Er&&(Te(o)?fails(o):!!o)},Sr=isForced.normalize=function(t){return String(t).replace(xr,".").toLowerCase()},Tr=isForced.data={},Er=isForced.NATIVE="N",Ar=isForced.POLYFILL="P",Ir=isForced,Pr=Pt.f,_export=function(t,o){var s,h,m,_,E,$=t.target,B=t.global,q=t.stat;if(s=B?l:q?l[$]||defineGlobalProperty($,{}):(l[$]||{}).prototype)for(h in o){if(_=o[h],m=t.dontCallGetSet?(E=Pr(s,h))&&E.value:s[h],!Ir(B?h:$+(q?".":"#")+h,t.forced)&&void 0!==m){if(typeof _==typeof m)continue;copyConstructorProperties$1(_,m)}(t.sham||m&&m.sham)&&qt(_,"sham",!0),defineBuiltIn(s,h,_,t)}},Rr={};Rr[wellKnownSymbol("toStringTag")]="z";var $r,Mr="[object z]"===String(Rr),Or=wellKnownSymbol("toStringTag"),Nr=Object,Dr="Arguments"===classofRaw(function(){return arguments}()),Lr=Mr?classofRaw:function(t){var o,s,l;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(s=function(t,o){try{return t[o]}catch(t){}}(o=Nr(t),Or))?s:Dr?classofRaw(o):"Object"===(l=classofRaw(o))&&Te(o.callee)?"Arguments":l},Fr=String,toString_1=function(t){if("Symbol"===Lr(t))throw new TypeError("Cannot convert a Symbol value to a string");return Fr(t)},Br=Object.keys||function keys(t){return objectKeysInternal(t,yr)},Hr=h&&!Rt?Object.defineProperties:function defineProperties(t,o){anObject(t);for(var s,l=toIndexedObject(o),h=Br(o),m=h.length,_=0;m>_;)Ut.f(t,s=h[_++],l[s]);return t},Ur={f:Hr},qr=getBuiltIn("document","documentElement"),jr="prototype",zr="script",Vr=sharedKey("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(t){return"<"+zr+">"+t+"</"+zr+">"},NullProtoObjectViaActiveX=function(t){t.write(scriptTag("")),t.close();var o=t.parentWindow.Object;return t=null,o},NullProtoObject=function(){try{$r=new ActiveXObject("htmlfile")}catch(t){}var t,o,s;NullProtoObject="undefined"!=typeof document?document.domain&&$r?NullProtoObjectViaActiveX($r):(o=documentCreateElement("iframe"),s="java"+zr+":",o.style.display="none",qr.appendChild(o),o.src=String(s),(t=o.contentWindow.document).open(),t.write(scriptTag("document.F=Object")),t.close(),t.F):NullProtoObjectViaActiveX($r);for(var l=yr.length;l--;)delete NullProtoObject[jr][yr[l]];return NullProtoObject()};tr[Vr]=!0;var Gr=Object.create||function create(t,o){var s;return null!==t?(EmptyConstructor[jr]=anObject(t),s=new EmptyConstructor,EmptyConstructor[jr]=null,s[Vr]=t):s=NullProtoObject(),void 0===o?s:Ur.f(s,o)},createProperty=function(t,o,s){var l=toPropertyKey(o);l in t?Ut.f(t,l,createPropertyDescriptor(0,s)):t[l]=s},Kr=Array,Wr=Math.max,arraySliceSimple=function(t,o,s){for(var l=lengthOfArrayLike(t),h=toAbsoluteIndex(o,l),m=toAbsoluteIndex(void 0===s?l:s,l),_=Kr(Wr(m-h,0)),E=0;h<m;h++,E++)createProperty(_,E,t[h]);return _.length=E,_},Qr=wr.f,Yr="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Zr={f:function getOwnPropertyNames(t){return Yr&&"Window"===classofRaw(t)?function(t){try{return Qr(t)}catch(t){return arraySliceSimple(Yr)}}(t):Qr(toIndexedObject(t))}},defineBuiltInAccessor=function(t,o,s){return s.get&&lr(s.get,o,{getter:!0}),s.set&&lr(s.set,o,{setter:!0}),Ut.f(t,o,s)},Jr={f:wellKnownSymbol},Xr=l,eo=Ut.f,wellKnownSymbolDefine=function(t){var o=Xr.Symbol||(Xr.Symbol={});vt(o,t)||eo(o,t,{value:Jr.f(t)})},symbolDefineToPrimitive=function(){var t=getBuiltIn("Symbol"),o=t&&t.prototype,s=o&&o.valueOf,l=wellKnownSymbol("toPrimitive");o&&!o[l]&&defineBuiltIn(o,l,(function(t){return E(s,this)}),{arity:1})},to=Ut.f,ro=wellKnownSymbol("toStringTag"),setToStringTag=function(t,o,s){t&&!s&&(t=t.prototype),t&&!vt(t,ro)&&to(t,ro,{configurable:!0,value:o})},functionUncurryThisClause=function(t){if("Function"===classofRaw(t))return re(t)},oo=functionUncurryThisClause(functionUncurryThisClause.bind),functionBindContext=function(t,o){return aCallable(t),void 0===o?t:m?oo(t,o):function(){return t.apply(o,arguments)}},no=Array.isArray||function isArray(t){return"Array"===classofRaw(t)},noop=function(){},io=[],so=getBuiltIn("Reflect","construct"),ao=/^\s*(?:class|function)\b/,lo=re(ao.exec),co=!ao.test(noop),uo=function isConstructor(t){if(!Te(t))return!1;try{return so(noop,io,t),!0}catch(t){return!1}},ho=function isConstructor(t){if(!Te(t))return!1;switch(Lr(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return co||!!lo(ao,Zt(t))}catch(t){return!0}};ho.sham=!0;var po=!so||fails((function(){var t;return uo(uo.call)||!uo(Object)||!uo((function(){t=!0}))||t}))?ho:uo,fo=wellKnownSymbol("species"),go=Array,arraySpeciesCreate=function(t,o){return new(function(t){var o;return no(t)&&(o=t.constructor,(po(o)&&(o===go||no(o.prototype))||Ie(o)&&null===(o=o[fo]))&&(o=void 0)),void 0===o?go:o}(t))(0===o?0:o)},vo=re([].push),createMethod$6=function(t){var o=1===t,s=2===t,l=3===t,h=4===t,m=6===t,_=7===t,E=5===t||m;return function($,B,q,j){for(var K,W,X=toObject($),re=de(X),oe=functionBindContext(B,q),ne=lengthOfArrayLike(re),ae=0,le=j||arraySpeciesCreate,me=o?le($,ne):s||_?le($,0):void 0;ne>ae;ae++)if((E||ae in re)&&(W=oe(K=re[ae],ae,X),t))if(o)me[ae]=W;else if(W)switch(t){case 3:return!0;case 5:return K;case 6:return ae;case 2:vo(me,K)}else switch(t){case 4:return!1;case 7:vo(me,K)}return m?-1:l||h?h:me}},mo={forEach:createMethod$6(0),map:createMethod$6(1),filter:createMethod$6(2),some:createMethod$6(3),every:createMethod$6(4),find:createMethod$6(5),findIndex:createMethod$6(6),filterReject:createMethod$6(7)},yo=mo.forEach,bo=sharedKey("hidden"),wo="Symbol",Co="prototype",_o=ar.set,ko=ar.getterFor(wo),xo=Object[Co],So=l.Symbol,To=So&&So[Co],Eo=l.RangeError,Ao=l.TypeError,Io=l.QObject,Po=Pt.f,Ro=Ut.f,$o=Zr.f,Mo=j.f,Oo=re([].push),No=pt("symbols"),Do=pt("op-symbols"),Lo=pt("wks"),Fo=!Io||!Io[Co]||!Io[Co].findChild,fallbackDefineProperty=function(t,o,s){var l=Po(xo,o);l&&delete xo[o],Ro(t,o,s),l&&t!==xo&&Ro(xo,o,l)},Bo=h&&fails((function(){return 7!==Gr(Ro({},"a",{get:function(){return Ro(this,"a",{value:7}).a}})).a}))?fallbackDefineProperty:Ro,wrap$1=function(t,o){var s=No[t]=Gr(To);return _o(s,{type:wo,tag:t,description:o}),h||(s.description=o),s},Ho=function defineProperty(t,o,s){t===xo&&Ho(Do,o,s),anObject(t);var l=toPropertyKey(o);return anObject(s),vt(No,l)?(s.enumerable?(vt(t,bo)&&t[bo][l]&&(t[bo][l]=!1),s=Gr(s,{enumerable:createPropertyDescriptor(0,!1)})):(vt(t,bo)||Ro(t,bo,createPropertyDescriptor(1,{})),t[bo][l]=!0),Bo(t,l,s)):Ro(t,l,s)},Uo=function defineProperties(t,o){anObject(t);var s=toIndexedObject(o),l=Br(s).concat($getOwnPropertySymbols(s));return yo(l,(function(o){h&&!E(qo,s,o)||Ho(t,o,s[o])})),t},qo=function propertyIsEnumerable(t){var o=toPropertyKey(t),s=E(Mo,this,o);return!(this===xo&&vt(No,o)&&!vt(Do,o))&&(!(s||!vt(this,o)||!vt(No,o)||vt(this,bo)&&this[bo][o])||s)},jo=function getOwnPropertyDescriptor(t,o){var s=toIndexedObject(t),l=toPropertyKey(o);if(s!==xo||!vt(No,l)||vt(Do,l)){var h=Po(s,l);return!h||!vt(No,l)||vt(s,bo)&&s[bo][l]||(h.enumerable=!0),h}},zo=function getOwnPropertyNames(t){var o=$o(toIndexedObject(t)),s=[];return yo(o,(function(t){vt(No,t)||vt(tr,t)||Oo(s,t)})),s},$getOwnPropertySymbols=function(t){var o=t===xo,s=$o(o?Do:toIndexedObject(t)),l=[];return yo(s,(function(t){!vt(No,t)||o&&!vt(xo,t)||Oo(l,No[t])})),l};rt||(So=function Symbol(){if(Fe(To,this))throw new Ao("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?toString_1(arguments[0]):void 0,o=uid(t),setter=function(t){this===xo&&E(setter,Do,t),vt(this,bo)&&vt(this[bo],o)&&(this[bo][o]=!1);var s=createPropertyDescriptor(1,t);try{Bo(this,o,s)}catch(t){if(!(t instanceof Eo))throw t;fallbackDefineProperty(this,o,s)}};return h&&Fo&&Bo(xo,o,{configurable:!0,set:setter}),wrap$1(o,t)},To=So[Co],defineBuiltIn(To,"toString",(function toString(){return ko(this).tag})),defineBuiltIn(So,"withoutSetter",(function(t){return wrap$1(uid(t),t)})),j.f=qo,Ut.f=Ho,Ur.f=Uo,Pt.f=jo,wr.f=Zr.f=zo,Cr.f=$getOwnPropertySymbols,Jr.f=function(t){return wrap$1(wellKnownSymbol(t),t)},h&&(defineBuiltInAccessor(To,"description",{configurable:!0,get:function description(){return ko(this).description}}),defineBuiltIn(xo,"propertyIsEnumerable",qo,{unsafe:!0}))),_export({global:!0,constructor:!0,wrap:!0,forced:!rt,sham:!rt},{Symbol:So}),yo(Br(Lo),(function(t){wellKnownSymbolDefine(t)})),_export({target:wo,stat:!0,forced:!rt},{useSetter:function(){Fo=!0},useSimple:function(){Fo=!1}}),_export({target:"Object",stat:!0,forced:!rt,sham:!h},{create:function create(t,o){return void 0===o?Gr(t):Uo(Gr(t),o)},defineProperty:Ho,defineProperties:Uo,getOwnPropertyDescriptor:jo}),_export({target:"Object",stat:!0,forced:!rt},{getOwnPropertyNames:zo}),symbolDefineToPrimitive(),setToStringTag(So,wo),tr[bo]=!0;var Vo=rt&&!!Symbol.for&&!!Symbol.keyFor,Go=pt("string-to-symbol-registry"),Ko=pt("symbol-to-string-registry");_export({target:"Symbol",stat:!0,forced:!Vo},{for:function(t){var o=toString_1(t);if(vt(Go,o))return Go[o];var s=getBuiltIn("Symbol")(o);return Go[o]=s,Ko[s]=o,s}});var Wo=pt("symbol-to-string-registry");_export({target:"Symbol",stat:!0,forced:!Vo},{keyFor:function keyFor(t){if(!it(t))throw new TypeError(tryToString(t)+" is not a symbol");if(vt(Wo,t))return Wo[t]}});var Qo=Function.prototype,Yo=Qo.apply,Zo=Qo.call,Jo="object"==typeof Reflect&&Reflect.apply||(m?Zo.bind(Yo):function(){return Zo.apply(Yo,arguments)}),Xo=re([].slice),en=re([].push),tn=String,rn=getBuiltIn("JSON","stringify"),on=re(/./.exec),nn=re("".charAt),sn=re("".charCodeAt),an=re("".replace),ln=re(1..toString),cn=/[\uD800-\uDFFF]/g,dn=/^[\uD800-\uDBFF]$/,un=/^[\uDC00-\uDFFF]$/,hn=!rt||fails((function(){var t=getBuiltIn("Symbol")("stringify detection");return"[null]"!==rn([t])||"{}"!==rn({a:t})||"{}"!==rn(Object(t))})),pn=fails((function(){return'"\\udf06\\ud834"'!==rn("\udf06\ud834")||'"\\udead"'!==rn("\udead")})),stringifyWithSymbolsFix=function(t,o){var s=Xo(arguments),l=function(t){if(Te(t))return t;if(no(t)){for(var o=t.length,s=[],l=0;l<o;l++){var h=t[l];"string"==typeof h?en(s,h):"number"!=typeof h&&"Number"!==classofRaw(h)&&"String"!==classofRaw(h)||en(s,toString_1(h))}var m=s.length,_=!0;return function(t,o){if(_)return _=!1,o;if(no(this))return o;for(var l=0;l<m;l++)if(s[l]===t)return o}}}(o);if(Te(l)||void 0!==t&&!it(t))return s[1]=function(t,o){if(Te(l)&&(o=E(l,this,tn(t),o)),!it(o))return o},Jo(rn,null,s)},fixIllFormed=function(t,o,s){var l=nn(s,o-1),h=nn(s,o+1);return on(dn,t)&&!on(un,h)||on(un,t)&&!on(dn,l)?"\\u"+ln(sn(t,0),16):t};rn&&_export({target:"JSON",stat:!0,arity:3,forced:hn||pn},{stringify:function stringify(t,o,s){var l=Xo(arguments),h=Jo(hn?stringifyWithSymbolsFix:rn,null,l);return pn&&"string"==typeof h?an(h,cn,fixIllFormed):h}});var fn=!rt||fails((function(){Cr.f(1)}));_export({target:"Object",stat:!0,forced:fn},{getOwnPropertySymbols:function getOwnPropertySymbols(t){var o=Cr.f;return o?o(toObject(t)):[]}});var gn=l.Symbol,vn=gn&&gn.prototype;if(h&&Te(gn)&&(!("description"in vn)||void 0!==gn().description)){var mn={},yn=function Symbol(){var t=arguments.length<1||void 0===arguments[0]?void 0:toString_1(arguments[0]),o=Fe(vn,this)?new gn(t):void 0===t?gn():gn(t);return""===t&&(mn[o]=!0),o};copyConstructorProperties$1(yn,gn),yn.prototype=vn,vn.constructor=yn;var bn="Symbol(description detection)"===String(gn("description detection")),wn=re(vn.valueOf),Cn=re(vn.toString),_n=/^Symbol\((.*)\)[^)]+$/,kn=re("".replace),xn=re("".slice);defineBuiltInAccessor(vn,"description",{configurable:!0,get:function description(){var t=wn(this);if(vt(mn,t))return"";var o=Cn(t),s=bn?xn(o,7,-1):kn(o,_n,"$1");return""===s?void 0:s}}),_export({global:!0,constructor:!0,forced:!0},{Symbol:yn})}wellKnownSymbolDefine("asyncIterator"),wellKnownSymbolDefine("hasInstance"),wellKnownSymbolDefine("isConcatSpreadable"),wellKnownSymbolDefine("iterator"),wellKnownSymbolDefine("match"),wellKnownSymbolDefine("matchAll"),wellKnownSymbolDefine("replace"),wellKnownSymbolDefine("search"),wellKnownSymbolDefine("species"),wellKnownSymbolDefine("split"),wellKnownSymbolDefine("toPrimitive"),symbolDefineToPrimitive(),wellKnownSymbolDefine("toStringTag"),setToStringTag(getBuiltIn("Symbol"),"Symbol"),wellKnownSymbolDefine("unscopables");var functionUncurryThisAccessor=function(t,o,s){try{return re(aCallable(Object.getOwnPropertyDescriptor(t,o)[s]))}catch(t){}},Sn=String,Tn=TypeError,aPossiblePrototype=function(t){if("object"==typeof t||Te(t))return t;throw new Tn("Can't set "+Sn(t)+" as a prototype")},En=Object.setPrototypeOf||("__proto__"in{}?function(){var t,o=!1,s={};try{(t=functionUncurryThisAccessor(Object.prototype,"__proto__","set"))(s,[]),o=s instanceof Array}catch(t){}return function setPrototypeOf(s,l){return anObject(s),aPossiblePrototype(l),o?t(s,l):s.__proto__=l,s}}():void 0),An=Ut.f,proxyAccessor=function(t,o,s){s in t||An(t,s,{configurable:!0,get:function(){return o[s]},set:function(t){o[s]=t}})},inheritIfRequired=function(t,o,s){var l,h;return En&&Te(l=o.constructor)&&l!==s&&Ie(h=l.prototype)&&h!==s.prototype&&En(t,h),t},normalizeStringArgument=function(t,o){return void 0===t?arguments.length<2?"":o:toString_1(t)},installErrorCause=function(t,o){Ie(o)&&"cause"in o&&qt(t,"cause",o.cause)},In=Error,Pn=re("".replace),Rn=String(new In("zxcasd").stack),$n=/\n\s*at [^:]*:[^\n]*/,Mn=$n.test(Rn),errorStackClear=function(t,o){if(Mn&&"string"==typeof t&&!In.prepareStackTrace)for(;o--;)t=Pn(t,$n,"");return t},On=!fails((function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",createPropertyDescriptor(1,7)),7!==t.stack)})),Nn=Error.captureStackTrace,errorStackInstall=function(t,o,s,l){On&&(Nn?Nn(t,o):qt(t,"stack",errorStackClear(s,l)))},wrapErrorConstructorWithCause=function(t,o,s,l){var m="stackTraceLimit",_=l?2:1,E=t.split("."),$=E[E.length-1],B=getBuiltIn.apply(null,E);if(B){var q=B.prototype;if(vt(q,"cause")&&delete q.cause,!s)return B;var j=getBuiltIn("Error"),K=o((function(t,o){var s=normalizeStringArgument(l?o:t,void 0),h=l?new B(t):new B;return void 0!==s&&qt(h,"message",s),errorStackInstall(h,K,h.stack,2),this&&Fe(q,this)&&inheritIfRequired(h,this,K),arguments.length>_&&installErrorCause(h,arguments[_]),h}));K.prototype=q,"Error"!==$?En?En(K,j):copyConstructorProperties$1(K,j,{name:!0}):h&&m in B&&(proxyAccessor(K,B,m),proxyAccessor(K,B,"prepareStackTrace")),copyConstructorProperties$1(K,B);try{q.name!==$&&qt(q,"name",$),q.constructor=K}catch(t){}return K}},Dn="WebAssembly",Ln=l[Dn],Fn=7!==new Error("e",{cause:7}).cause,exportGlobalErrorCauseWrapper=function(t,o){var s={};s[t]=wrapErrorConstructorWithCause(t,o,Fn),_export({global:!0,constructor:!0,arity:1,forced:Fn},s)},exportWebAssemblyErrorCauseWrapper=function(t,o){if(Ln&&Ln[t]){var s={};s[t]=wrapErrorConstructorWithCause(Dn+"."+t,o,Fn),_export({target:Dn,stat:!0,constructor:!0,arity:1,forced:Fn},s)}};exportGlobalErrorCauseWrapper("Error",(function(t){return function Error(o){return Jo(t,this,arguments)}})),exportGlobalErrorCauseWrapper("EvalError",(function(t){return function EvalError(o){return Jo(t,this,arguments)}})),exportGlobalErrorCauseWrapper("RangeError",(function(t){return function RangeError(o){return Jo(t,this,arguments)}})),exportGlobalErrorCauseWrapper("ReferenceError",(function(t){return function ReferenceError(o){return Jo(t,this,arguments)}})),exportGlobalErrorCauseWrapper("SyntaxError",(function(t){return function SyntaxError(o){return Jo(t,this,arguments)}})),exportGlobalErrorCauseWrapper("TypeError",(function(t){return function TypeError(o){return Jo(t,this,arguments)}})),exportGlobalErrorCauseWrapper("URIError",(function(t){return function URIError(o){return Jo(t,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("CompileError",(function(t){return function CompileError(o){return Jo(t,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("LinkError",(function(t){return function LinkError(o){return Jo(t,this,arguments)}})),exportWebAssemblyErrorCauseWrapper("RuntimeError",(function(t){return function RuntimeError(o){return Jo(t,this,arguments)}}));var Bn=Error.prototype.toString,Hn=fails((function(){if(h){var t=Gr(Object.defineProperty({},"name",{get:function(){return this===t}}));if("true"!==Bn.call(t))return!0}return"2: 1"!==Bn.call({message:1,name:2})||"Error"!==Bn.call({})}))?function toString(){var t=anObject(this),o=normalizeStringArgument(t.name,"Error"),s=normalizeStringArgument(t.message);return o?s?o+": "+s:o:s}:Bn,Un=Error.prototype;Un.toString!==Hn&&defineBuiltIn(Un,"toString",Hn);var qn=!fails((function(){function F(){}return F.prototype.constructor=null,Object.getPrototypeOf(new F)!==F.prototype})),jn=sharedKey("IE_PROTO"),zn=Object,Vn=zn.prototype,Gn=qn?zn.getPrototypeOf:function(t){var o=toObject(t);if(vt(o,jn))return o[jn];var s=o.constructor;return Te(s)&&o instanceof s?s.prototype:o instanceof zn?Vn:null},Kn={},Wn=wellKnownSymbol("iterator"),Qn=Array.prototype,isArrayIteratorMethod=function(t){return void 0!==t&&(Kn.Array===t||Qn[Wn]===t)},Yn=wellKnownSymbol("iterator"),getIteratorMethod=function(t){if(!isNullOrUndefined(t))return getMethod$1(t,Yn)||getMethod$1(t,"@@iterator")||Kn[Lr(t)]},Zn=TypeError,getIterator$1=function(t,o){var s=arguments.length<2?getIteratorMethod(t):o;if(aCallable(s))return anObject(E(s,t));throw new Zn(tryToString(t)+" is not iterable")},iteratorClose=function(t,o,s){var l,h;anObject(t);try{if(!(l=getMethod$1(t,"return"))){if("throw"===o)throw s;return s}l=E(l,t)}catch(t){h=!0,l=t}if("throw"===o)throw s;if(h)throw l;return anObject(l),s},Jn=TypeError,Result=function(t,o){this.stopped=t,this.result=o},Xn=Result.prototype,iterate=function(t,o,s){var l,h,m,_,$,B,q,j=s&&s.that,K=!(!s||!s.AS_ENTRIES),W=!(!s||!s.IS_RECORD),X=!(!s||!s.IS_ITERATOR),re=!(!s||!s.INTERRUPTED),oe=functionBindContext(o,j),stop=function(t){return l&&iteratorClose(l,"normal",t),new Result(!0,t)},callFn=function(t){return K?(anObject(t),re?oe(t[0],t[1],stop):oe(t[0],t[1])):re?oe(t,stop):oe(t)};if(W)l=t.iterator;else if(X)l=t;else{if(!(h=getIteratorMethod(t)))throw new Jn(tryToString(t)+" is not iterable");if(isArrayIteratorMethod(h)){for(m=0,_=lengthOfArrayLike(t);_>m;m++)if(($=callFn(t[m]))&&Fe(Xn,$))return $;return new Result(!1)}l=getIterator$1(t,h)}for(B=W?t.next:l.next;!(q=E(B,l)).done;){try{$=callFn(q.value)}catch(t){iteratorClose(l,"throw",t)}if("object"==typeof $&&$&&Fe(Xn,$))return $}return new Result(!1)},ci=wellKnownSymbol("toStringTag"),hi=Error,pi=[].push,yi=function AggregateError(t,o){var s,l=Fe(Ci,this);En?s=En(new hi,l?Gn(this):Ci):(s=l?this:Gr(Ci),qt(s,ci,"Error")),void 0!==o&&qt(s,"message",normalizeStringArgument(o)),errorStackInstall(s,yi,s.stack,1),arguments.length>2&&installErrorCause(s,arguments[2]);var h=[];return iterate(t,pi,{that:h}),qt(s,"errors",h),s};En?En(yi,hi):copyConstructorProperties$1(yi,hi,{name:!0});var Ci=yi.prototype=Gr(hi.prototype,{constructor:createPropertyDescriptor(1,yi),message:createPropertyDescriptor(1,""),name:createPropertyDescriptor(1,"AggregateError")});_export({global:!0,constructor:!0,arity:2},{AggregateError:yi});var _i="AggregateError",Ai=getBuiltIn(_i),Ii=!fails((function(){return 1!==Ai([1]).errors[0]}))&&fails((function(){return 7!==Ai([1],_i,{cause:7}).cause}));_export({global:!0,constructor:!0,arity:2,forced:Ii},{AggregateError:wrapErrorConstructorWithCause(_i,(function(t){return function AggregateError(o,s){return Jo(t,this,arguments)}}),Ii,!0)});var Ri=Ut.f,Di=wellKnownSymbol("unscopables"),Fi=Array.prototype;void 0===Fi[Di]&&Ri(Fi,Di,{configurable:!0,value:Gr(null)});var addToUnscopables=function(t){Fi[Di][t]=!0};_export({target:"Array",proto:!0},{at:function at(t){var o=toObject(this),s=lengthOfArrayLike(o),l=toIntegerOrInfinity(t),h=l>=0?l:s+l;return h<0||h>=s?void 0:o[h]}}),addToUnscopables("at");var Ki=TypeError,doesNotExceedSafeInteger=function(t){if(t>9007199254740991)throw Ki("Maximum allowed index exceeded");return t},Qi=wellKnownSymbol("species"),arrayMethodHasSpeciesSupport=function(t){return et>=51||!fails((function(){var o=[];return(o.constructor={})[Qi]=function(){return{foo:1}},1!==o[t](Boolean).foo}))},Ji=wellKnownSymbol("isConcatSpreadable"),es=et>=51||!fails((function(){var t=[];return t[Ji]=!1,t.concat()[0]!==t})),isConcatSpreadable=function(t){if(!Ie(t))return!1;var o=t[Ji];return void 0!==o?!!o:no(t)},ts=!es||!arrayMethodHasSpeciesSupport("concat");_export({target:"Array",proto:!0,arity:1,forced:ts},{concat:function concat(t){var o,s,l,h,m,_=toObject(this),E=arraySpeciesCreate(_,0),$=0;for(o=-1,l=arguments.length;o<l;o++)if(isConcatSpreadable(m=-1===o?_:arguments[o]))for(h=lengthOfArrayLike(m),doesNotExceedSafeInteger($+h),s=0;s<h;s++,$++)s in m&&createProperty(E,$,m[s]);else doesNotExceedSafeInteger($+1),createProperty(E,$++,m);return E.length=$,E}});var rs=TypeError,deletePropertyOrThrow=function(t,o){if(!delete t[o])throw new rs("Cannot delete property "+tryToString(o)+" of "+tryToString(t))},os=Math.min,ns=[].copyWithin||function copyWithin(t,o){var s=toObject(this),l=lengthOfArrayLike(s),h=toAbsoluteIndex(t,l),m=toAbsoluteIndex(o,l),_=arguments.length>2?arguments[2]:void 0,E=os((void 0===_?l:toAbsoluteIndex(_,l))-m,l-h),$=1;for(m<h&&h<m+E&&($=-1,m+=E-1,h+=E-1);E-- >0;)m in s?s[h]=s[m]:deletePropertyOrThrow(s,h),h+=$,m+=$;return s};_export({target:"Array",proto:!0},{copyWithin:ns}),addToUnscopables("copyWithin");var arrayMethodIsStrict=function(t,o){var s=[][t];return!!s&&fails((function(){s.call(null,o||function(){return 1},1)}))},ss=mo.every,as=arrayMethodIsStrict("every");_export({target:"Array",proto:!0,forced:!as},{every:function every(t){return ss(this,t,arguments.length>1?arguments[1]:void 0)}});var ls=function fill(t){for(var o=toObject(this),s=lengthOfArrayLike(o),l=arguments.length,h=toAbsoluteIndex(l>1?arguments[1]:void 0,s),m=l>2?arguments[2]:void 0,_=void 0===m?s:toAbsoluteIndex(m,s);_>h;)o[h++]=t;return o};_export({target:"Array",proto:!0},{fill:ls}),addToUnscopables("fill");var cs=mo.filter,ds=arrayMethodHasSpeciesSupport("filter");_export({target:"Array",proto:!0,forced:!ds},{filter:function filter(t){return cs(this,t,arguments.length>1?arguments[1]:void 0)}});var us=mo.find,hs="find",ps=!0;hs in[]&&Array(1)[hs]((function(){ps=!1})),_export({target:"Array",proto:!0,forced:ps},{find:function find(t){return us(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables(hs);var fs=mo.findIndex,gs="findIndex",vs=!0;gs in[]&&Array(1)[gs]((function(){vs=!1})),_export({target:"Array",proto:!0,forced:vs},{findIndex:function findIndex(t){return fs(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables(gs);var createMethod$5=function(t){var o=1===t;return function(s,l,h){for(var m,_=toObject(s),E=de(_),$=functionBindContext(l,h),B=lengthOfArrayLike(E);B-- >0;)if($(m=E[B],B,_))switch(t){case 0:return m;case 1:return B}return o?-1:void 0}},ms={findLast:createMethod$5(0),findLastIndex:createMethod$5(1)},ys=ms.findLast;_export({target:"Array",proto:!0},{findLast:function findLast(t){return ys(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables("findLast");var bs=ms.findLastIndex;_export({target:"Array",proto:!0},{findLastIndex:function findLastIndex(t){return bs(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables("findLastIndex");var flattenIntoArray=function(t,o,s,l,h,m,_,E){for(var $,B,q=h,j=0,K=!!_&&functionBindContext(_,E);j<l;)j in s&&($=K?K(s[j],j,o):s[j],m>0&&no($)?(B=lengthOfArrayLike($),q=flattenIntoArray(t,o,$,B,q,m-1)-1):(doesNotExceedSafeInteger(q+1),t[q]=$),q++),j++;return q},ws=flattenIntoArray;_export({target:"Array",proto:!0},{flat:function flat(){var t=arguments.length?arguments[0]:void 0,o=toObject(this),s=lengthOfArrayLike(o),l=arraySpeciesCreate(o,0);return l.length=ws(l,o,o,s,0,void 0===t?1:toIntegerOrInfinity(t)),l}}),_export({target:"Array",proto:!0},{flatMap:function flatMap(t){var o,s=toObject(this),l=lengthOfArrayLike(s);return aCallable(t),(o=arraySpeciesCreate(s,0)).length=ws(o,s,s,l,0,1,t,arguments.length>1?arguments[1]:void 0),o}});var Cs=mo.forEach,_s=arrayMethodIsStrict("forEach")?[].forEach:function forEach(t){return Cs(this,t,arguments.length>1?arguments[1]:void 0)};_export({target:"Array",proto:!0,forced:[].forEach!==_s},{forEach:_s});var callWithSafeIterationClosing=function(t,o,s,l){try{return l?o(anObject(s)[0],s[1]):o(s)}catch(o){iteratorClose(t,"throw",o)}},ks=Array,xs=function from(t){var o=toObject(t),s=po(this),l=arguments.length,h=l>1?arguments[1]:void 0,m=void 0!==h;m&&(h=functionBindContext(h,l>2?arguments[2]:void 0));var _,$,B,q,j,K,W=getIteratorMethod(o),X=0;if(!W||this===ks&&isArrayIteratorMethod(W))for(_=lengthOfArrayLike(o),$=s?new this(_):ks(_);_>X;X++)K=m?h(o[X],X):o[X],createProperty($,X,K);else for(j=(q=getIterator$1(o,W)).next,$=s?new this:[];!(B=E(j,q)).done;X++)K=m?callWithSafeIterationClosing(q,h,[B.value,X],!0):B.value,createProperty($,X,K);return $.length=X,$},Ss=wellKnownSymbol("iterator"),Ts=!1;try{var Es=0,As={next:function(){return{done:!!Es++}},return:function(){Ts=!0}};As[Ss]=function(){return this},Array.from(As,(function(){throw 2}))}catch(t){}var checkCorrectnessOfIteration=function(t,o){try{if(!o&&!Ts)return!1}catch(t){return!1}var s=!1;try{var l={};l[Ss]=function(){return{next:function(){return{done:s=!0}}}},t(l)}catch(t){}return s},Is=!checkCorrectnessOfIteration((function(t){Array.from(t)}));_export({target:"Array",stat:!0,forced:Is},{from:xs});var Ps=gr.includes,Rs=fails((function(){return!Array(1).includes()}));_export({target:"Array",proto:!0,forced:Rs},{includes:function includes(t){return Ps(this,t,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables("includes");var $s=gr.indexOf,Ms=functionUncurryThisClause([].indexOf),Os=!!Ms&&1/Ms([1],1,-0)<0,Ns=Os||!arrayMethodIsStrict("indexOf");_export({target:"Array",proto:!0,forced:Ns},{indexOf:function indexOf(t){var o=arguments.length>1?arguments[1]:void 0;return Os?Ms(this,t,o)||0:$s(this,t,o)}}),_export({target:"Array",stat:!0},{isArray:no});var Ds,Ls,Fs,Bs=wellKnownSymbol("iterator"),Hs=!1;[].keys&&("next"in(Fs=[].keys())?(Ls=Gn(Gn(Fs)))!==Object.prototype&&(Ds=Ls):Hs=!0);var Us=!Ie(Ds)||fails((function(){var t={};return Ds[Bs].call(t)!==t}));Us&&(Ds={}),Te(Ds[Bs])||defineBuiltIn(Ds,Bs,(function(){return this}));var qs={IteratorPrototype:Ds,BUGGY_SAFARI_ITERATORS:Hs},js=qs.IteratorPrototype,returnThis$1=function(){return this},iteratorCreateConstructor=function(t,o,s,l){var h=o+" Iterator";return t.prototype=Gr(js,{next:createPropertyDescriptor(+!l,s)}),setToStringTag(t,h,!1),Kn[h]=returnThis$1,t},zs=Gt.PROPER,Vs=Gt.CONFIGURABLE,Gs=qs.IteratorPrototype,Ks=qs.BUGGY_SAFARI_ITERATORS,Ws=wellKnownSymbol("iterator"),Qs="keys",Ys="values",Zs="entries",returnThis=function(){return this},iteratorDefine=function(t,o,s,l,h,m,_){iteratorCreateConstructor(s,o,l);var $,B,q,getIterationMethod=function(t){if(t===h&&re)return re;if(!Ks&&t&&t in W)return W[t];switch(t){case Qs:return function keys(){return new s(this,t)};case Ys:return function values(){return new s(this,t)};case Zs:return function entries(){return new s(this,t)}}return function(){return new s(this)}},j=o+" Iterator",K=!1,W=t.prototype,X=W[Ws]||W["@@iterator"]||h&&W[h],re=!Ks&&X||getIterationMethod(h),oe="Array"===o&&W.entries||X;if(oe&&($=Gn(oe.call(new t)))!==Object.prototype&&$.next&&(Gn($)!==Gs&&(En?En($,Gs):Te($[Ws])||defineBuiltIn($,Ws,returnThis)),setToStringTag($,j,!0)),zs&&h===Ys&&X&&X.name!==Ys&&(Vs?qt(W,"name",Ys):(K=!0,re=function values(){return E(X,this)})),h)if(B={values:getIterationMethod(Ys),keys:m?re:getIterationMethod(Qs),entries:getIterationMethod(Zs)},_)for(q in B)(Ks||K||!(q in W))&&defineBuiltIn(W,q,B[q]);else _export({target:o,proto:!0,forced:Ks||K},B);return W[Ws]!==re&&defineBuiltIn(W,Ws,re,{name:h}),Kn[o]=re,B},createIterResultObject=function(t,o){return{value:t,done:o}},Js=Ut.f,Xs="Array Iterator",ea=ar.set,oa=ar.getterFor(Xs),na=iteratorDefine(Array,"Array",(function(t,o){ea(this,{type:Xs,target:toIndexedObject(t),index:0,kind:o})}),(function(){var t=oa(this),o=t.target,s=t.kind,l=t.index++;if(!o||l>=o.length)return t.target=void 0,createIterResultObject(void 0,!0);switch(s){case"keys":return createIterResultObject(l,!1);case"values":return createIterResultObject(o[l],!1)}return createIterResultObject([l,o[l]],!1)}),"values"),aa=Kn.Arguments=Kn.Array;if(addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries"),h&&"values"!==aa.name)try{Js(aa,"name",{value:"values"})}catch(t){}var la=re([].join),ca=de!==Object||!arrayMethodIsStrict("join",",");_export({target:"Array",proto:!0,forced:ca},{join:function join(t){return la(toIndexedObject(this),void 0===t?",":t)}});var ha=Math.min,pa=[].lastIndexOf,ga=!!pa&&1/[1].lastIndexOf(1,-0)<0,va=arrayMethodIsStrict("lastIndexOf"),ma=ga||!va?function lastIndexOf(t){if(ga)return Jo(pa,this,arguments)||0;var o=toIndexedObject(this),s=lengthOfArrayLike(o),l=s-1;for(arguments.length>1&&(l=ha(l,toIntegerOrInfinity(arguments[1]))),l<0&&(l=s+l);l>=0;l--)if(l in o&&o[l]===t)return l||0;return-1}:pa;_export({target:"Array",proto:!0,forced:ma!==[].lastIndexOf},{lastIndexOf:ma});var _a=mo.map,Ta=arrayMethodHasSpeciesSupport("map");_export({target:"Array",proto:!0,forced:!Ta},{map:function map(t){return _a(this,t,arguments.length>1?arguments[1]:void 0)}});var $a=Array,Fa=fails((function(){function F(){}return!($a.of.call(F)instanceof F)}));_export({target:"Array",stat:!0,forced:Fa},{of:function of(){for(var t=0,o=arguments.length,s=new(po(this)?this:$a)(o);o>t;)createProperty(s,t,arguments[t++]);return s.length=o,s}});var Ua=TypeError,qa=Object.getOwnPropertyDescriptor,Ka=h&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,o){if(no(t)&&!qa(t,"length").writable)throw new Ua("Cannot set read only .length");return t.length=o}:function(t,o){return t.length=o},Wa=fails((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}();_export({target:"Array",proto:!0,arity:1,forced:Wa},{push:function push(t){var o=toObject(this),s=lengthOfArrayLike(o),l=arguments.length;doesNotExceedSafeInteger(s+l);for(var h=0;h<l;h++)o[s]=arguments[h],s++;return Ka(o,s),s}});var el=TypeError,createMethod$4=function(t){return function(o,s,l,h){aCallable(s);var m=toObject(o),_=de(m),E=lengthOfArrayLike(m),$=t?E-1:0,B=t?-1:1;if(l<2)for(;;){if($ in _){h=_[$],$+=B;break}if($+=B,t?$<0:E<=$)throw new el("Reduce of empty array with no initial value")}for(;t?$>=0:E>$;$+=B)$ in _&&(h=s(h,_[$],$,m));return h}},tl={left:createMethod$4(!1),right:createMethod$4(!0)},rl="process"===classofRaw(l.process),ol=tl.left,nl=!rl&&et>79&&et<83||!arrayMethodIsStrict("reduce");_export({target:"Array",proto:!0,forced:nl},{reduce:function reduce(t){var o=arguments.length;return ol(this,t,o,o>1?arguments[1]:void 0)}});var il=tl.right,sl=!rl&&et>79&&et<83||!arrayMethodIsStrict("reduceRight");_export({target:"Array",proto:!0,forced:sl},{reduceRight:function reduceRight(t){return il(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var al=re([].reverse),ll=[1,2];_export({target:"Array",proto:!0,forced:String(ll)===String(ll.reverse())},{reverse:function reverse(){return no(this)&&(this.length=this.length),al(this)}});var cl=arrayMethodHasSpeciesSupport("slice"),dl=wellKnownSymbol("species"),ul=Array,hl=Math.max;_export({target:"Array",proto:!0,forced:!cl},{slice:function slice(t,o){var s,l,h,m=toIndexedObject(this),_=lengthOfArrayLike(m),E=toAbsoluteIndex(t,_),$=toAbsoluteIndex(void 0===o?_:o,_);if(no(m)&&(s=m.constructor,(po(s)&&(s===ul||no(s.prototype))||Ie(s)&&null===(s=s[dl]))&&(s=void 0),s===ul||void 0===s))return Xo(m,E,$);for(l=new(void 0===s?ul:s)(hl($-E,0)),h=0;E<$;E++,h++)E in m&&createProperty(l,h,m[E]);return l.length=h,l}});var pl=mo.some,fl=arrayMethodIsStrict("some");_export({target:"Array",proto:!0,forced:!fl},{some:function some(t){return pl(this,t,arguments.length>1?arguments[1]:void 0)}});var gl=Math.floor,mergeSort=function(t,o){var s=t.length,l=gl(s/2);return s<8?insertionSort(t,o):merge(t,mergeSort(arraySliceSimple(t,0,l),o),mergeSort(arraySliceSimple(t,l),o),o)},insertionSort=function(t,o){for(var s,l,h=t.length,m=1;m<h;){for(l=m,s=t[m];l&&o(t[l-1],s)>0;)t[l]=t[--l];l!==m++&&(t[l]=s)}return t},merge=function(t,o,s,l){for(var h=o.length,m=s.length,_=0,E=0;_<h||E<m;)t[_+E]=_<h&&E<m?l(o[_],s[E])<=0?o[_++]:s[E++]:_<h?o[_++]:s[E++];return t},vl=mergeSort,ml=He.match(/firefox\/(\d+)/i),yl=!!ml&&+ml[1],bl=/MSIE|Trident/.test(He),wl=He.match(/AppleWebKit\/(\d+)\./),Cl=!!wl&&+wl[1],_l=[],kl=re(_l.sort),xl=re(_l.push),Sl=fails((function(){_l.sort(void 0)})),Tl=fails((function(){_l.sort(null)})),El=arrayMethodIsStrict("sort"),Al=!fails((function(){if(et)return et<70;if(!(yl&&yl>3)){if(bl)return!0;if(Cl)return Cl<603;var t,o,s,l,h="";for(t=65;t<76;t++){switch(o=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:s=3;break;case 68:case 71:s=4;break;default:s=2}for(l=0;l<47;l++)_l.push({k:o+l,v:s})}for(_l.sort((function(t,o){return o.v-t.v})),l=0;l<_l.length;l++)o=_l[l].k.charAt(0),h.charAt(h.length-1)!==o&&(h+=o);return"DGBEFHACIJK"!==h}}));_export({target:"Array",proto:!0,forced:Sl||!Tl||!El||!Al},{sort:function sort(t){void 0!==t&&aCallable(t);var o=toObject(this);if(Al)return void 0===t?kl(o):kl(o,t);var s,l,h=[],m=lengthOfArrayLike(o);for(l=0;l<m;l++)l in o&&xl(h,o[l]);for(vl(h,function(t){return function(o,s){return void 0===s?-1:void 0===o?1:void 0!==t?+t(o,s)||0:toString_1(o)>toString_1(s)?1:-1}}(t)),s=lengthOfArrayLike(h),l=0;l<s;)o[l]=h[l++];for(;l<m;)deletePropertyOrThrow(o,l++);return o}});var Il=wellKnownSymbol("species"),setSpecies=function(t){var o=getBuiltIn(t);h&&o&&!o[Il]&&defineBuiltInAccessor(o,Il,{configurable:!0,get:function(){return this}})};setSpecies("Array");var Pl=arrayMethodHasSpeciesSupport("splice"),Rl=Math.max,$l=Math.min;_export({target:"Array",proto:!0,forced:!Pl},{splice:function splice(t,o){var s,l,h,m,_,E,$=toObject(this),B=lengthOfArrayLike($),q=toAbsoluteIndex(t,B),j=arguments.length;for(0===j?s=l=0:1===j?(s=0,l=B-q):(s=j-2,l=$l(Rl(toIntegerOrInfinity(o),0),B-q)),doesNotExceedSafeInteger(B+s-l),h=arraySpeciesCreate($,l),m=0;m<l;m++)(_=q+m)in $&&createProperty(h,m,$[_]);if(h.length=l,s<l){for(m=q;m<B-l;m++)E=m+s,(_=m+l)in $?$[E]=$[_]:deletePropertyOrThrow($,E);for(m=B;m>B-l+s;m--)deletePropertyOrThrow($,m-1)}else if(s>l)for(m=B-l;m>q;m--)E=m+s-1,(_=m+l-1)in $?$[E]=$[_]:deletePropertyOrThrow($,E);for(m=0;m<s;m++)$[m+q]=arguments[m+2];return Ka($,B-l+s),h}});var arrayToReversed=function(t,o){for(var s=lengthOfArrayLike(t),l=new o(s),h=0;h<s;h++)l[h]=t[s-h-1];return l},Ml=Array;_export({target:"Array",proto:!0},{toReversed:function toReversed(){return arrayToReversed(toIndexedObject(this),Ml)}}),addToUnscopables("toReversed");var Ol,arrayFromConstructorAndList=function(t,o){for(var s=0,l=lengthOfArrayLike(o),h=new t(l);l>s;)h[s]=o[s++];return h},Nl=Array,Dl=re((Ol="Array",l[Ol].prototype).sort);_export({target:"Array",proto:!0},{toSorted:function toSorted(t){void 0!==t&&aCallable(t);var o=toIndexedObject(this),s=arrayFromConstructorAndList(Nl,o);return Dl(s,t)}}),addToUnscopables("toSorted");var Ll=Array,Fl=Math.max,Bl=Math.min;_export({target:"Array",proto:!0},{toSpliced:function toSpliced(t,o){var s,l,h,m,_=toIndexedObject(this),E=lengthOfArrayLike(_),$=toAbsoluteIndex(t,E),B=arguments.length,q=0;for(0===B?s=l=0:1===B?(s=0,l=E-$):(s=B-2,l=Bl(Fl(toIntegerOrInfinity(o),0),E-$)),h=doesNotExceedSafeInteger(E+s-l),m=Ll(h);q<$;q++)m[q]=_[q];for(;q<$+s;q++)m[q]=arguments[q-$+2];for(;q<h;q++)m[q]=_[q+l-s];return m}}),addToUnscopables("toSpliced"),addToUnscopables("flat"),addToUnscopables("flatMap");var Hl=1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}();_export({target:"Array",proto:!0,arity:1,forced:Hl},{unshift:function unshift(t){var o=toObject(this),s=lengthOfArrayLike(o),l=arguments.length;if(l){doesNotExceedSafeInteger(s+l);for(var h=s;h--;){var m=h+l;h in o?o[m]=o[h]:deletePropertyOrThrow(o,m)}for(var _=0;_<l;_++)o[_]=arguments[_]}return Ka(o,s+l)}});var Ul=RangeError,arrayWith=function(t,o,s,l){var h=lengthOfArrayLike(t),m=toIntegerOrInfinity(s),_=m<0?h+m:m;if(_>=h||_<0)throw new Ul("Incorrect index");for(var E=new o(h),$=0;$<h;$++)E[$]=$===_?l:t[$];return E},ql=Array;_export({target:"Array",proto:!0},{with:function(t,o){return arrayWith(toIndexedObject(this),ql,t,o)}});var jl="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,defineBuiltIns=function(t,o,s){for(var l in o)defineBuiltIn(t,l,o[l],s);return t},zl=TypeError,anInstance=function(t,o){if(Fe(o,t))return t;throw new zl("Incorrect invocation")},Vl=RangeError,toIndex=function(t){if(void 0===t)return 0;var o=toIntegerOrInfinity(t),s=toLength(o);if(o!==s)throw new Vl("Wrong length or index");return s},Gl=Math.sign||function sign(t){var o=+t;return 0===o||o!=o?o:o<0?-1:1},Kl=Math.abs,Wl=2220446049250313e-31,Ql=1/Wl,mathFloatRound=function(t,o,s,l){var h=+t,m=Kl(h),_=Gl(h);if(m<l)return _*function(t){return t+Ql-Ql}(m/l/o)*l*o;var E=(1+o/Wl)*m,$=E-(E-m);return $>s||$!=$?_*(1/0):_*$},Yl=Math.fround||function fround(t){return mathFloatRound(t,1.1920928955078125e-7,34028234663852886e22,11754943508222875e-54)},Zl=Array,Jl=Math.abs,Xl=Math.pow,tc=Math.floor,rc=Math.log,oc=Math.LN2,ieee754_pack=function(t,o,s){var l,h,m,_=Zl(s),E=8*s-o-1,$=(1<<E)-1,B=$>>1,q=23===o?Xl(2,-24)-Xl(2,-77):0,j=t<0||0===t&&1/t<0?1:0,K=0;for((t=Jl(t))!=t||t===1/0?(h=t!=t?1:0,l=$):(l=tc(rc(t)/oc),t*(m=Xl(2,-l))<1&&(l--,m*=2),(t+=l+B>=1?q/m:q*Xl(2,1-B))*m>=2&&(l++,m/=2),l+B>=$?(h=0,l=$):l+B>=1?(h=(t*m-1)*Xl(2,o),l+=B):(h=t*Xl(2,B-1)*Xl(2,o),l=0));o>=8;)_[K++]=255&h,h/=256,o-=8;for(l=l<<o|h,E+=o;E>0;)_[K++]=255&l,l/=256,E-=8;return _[--K]|=128*j,_},ieee754_unpack=function(t,o){var s,l=t.length,h=8*l-o-1,m=(1<<h)-1,_=m>>1,E=h-7,$=l-1,B=t[$--],q=127&B;for(B>>=7;E>0;)q=256*q+t[$--],E-=8;for(s=q&(1<<-E)-1,q>>=-E,E+=o;E>0;)s=256*s+t[$--],E-=8;if(0===q)q=1-_;else{if(q===m)return s?NaN:B?-1/0:1/0;s+=Xl(2,o),q-=_}return(B?-1:1)*s*Xl(2,q-o)},nc=wr.f,ic=Gt.PROPER,sc=Gt.CONFIGURABLE,ac="ArrayBuffer",cc="DataView",dc="prototype",uc="Wrong index",hc=ar.getterFor(ac),pc=ar.getterFor(cc),fc=ar.set,gc=l[ac],vc=gc,mc=vc&&vc[dc],yc=l[cc],bc=yc&&yc[dc],wc=Object.prototype,Cc=l.Array,_c=l.RangeError,kc=re(ls),xc=re([].reverse),Sc=ieee754_pack,Ec=ieee754_unpack,packInt8=function(t){return[255&t]},packInt16=function(t){return[255&t,t>>8&255]},packInt32=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},unpackInt32=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},packFloat32=function(t){return Sc(Yl(t),23,4)},packFloat64=function(t){return Sc(t,52,8)},addGetter=function(t,o,s){defineBuiltInAccessor(t[dc],o,{configurable:!0,get:function(){return s(this)[o]}})},get$1=function(t,o,s,l){var h=pc(t),m=toIndex(s),_=!!l;if(m+o>h.byteLength)throw new _c(uc);var E=h.bytes,$=m+h.byteOffset,B=arraySliceSimple(E,$,$+o);return _?B:xc(B)},set$2=function(t,o,s,l,h,m){var _=pc(t),E=toIndex(s),$=l(+h),B=!!m;if(E+o>_.byteLength)throw new _c(uc);for(var q=_.bytes,j=E+_.byteOffset,K=0;K<o;K++)q[j+K]=$[B?K:o-K-1]};if(jl){var Ac=ic&&gc.name!==ac;if(fails((function(){gc(1)}))&&fails((function(){new gc(-1)}))&&!fails((function(){return new gc,new gc(1.5),new gc(NaN),1!==gc.length||Ac&&!sc})))Ac&&sc&&qt(gc,"name",ac);else{(vc=function ArrayBuffer(t){return anInstance(this,mc),new gc(toIndex(t))})[dc]=mc;for(var Ic,Pc=nc(gc),Rc=0;Pc.length>Rc;)(Ic=Pc[Rc++])in vc||qt(vc,Ic,gc[Ic]);mc.constructor=vc}En&&Gn(bc)!==wc&&En(bc,wc);var Oc=new yc(new vc(2)),Dc=re(bc.setInt8);Oc.setInt8(0,2147483648),Oc.setInt8(1,2147483649),!Oc.getInt8(0)&&Oc.getInt8(1)||defineBuiltIns(bc,{setInt8:function setInt8(t,o){Dc(this,t,o<<24>>24)},setUint8:function setUint8(t,o){Dc(this,t,o<<24>>24)}},{unsafe:!0})}else mc=(vc=function ArrayBuffer(t){anInstance(this,mc);var o=toIndex(t);fc(this,{type:ac,bytes:kc(Cc(o),0),byteLength:o}),h||(this.byteLength=o,this.detached=!1)})[dc],yc=function DataView(t,o,s){anInstance(this,bc),anInstance(t,mc);var l=hc(t),m=l.byteLength,_=toIntegerOrInfinity(o);if(_<0||_>m)throw new _c("Wrong offset");if(_+(s=void 0===s?m-_:toLength(s))>m)throw new _c("Wrong length");fc(this,{type:cc,buffer:t,byteLength:s,byteOffset:_,bytes:l.bytes}),h||(this.buffer=t,this.byteLength=s,this.byteOffset=_)},bc=yc[dc],h&&(addGetter(vc,"byteLength",hc),addGetter(yc,"buffer",pc),addGetter(yc,"byteLength",pc),addGetter(yc,"byteOffset",pc)),defineBuiltIns(bc,{getInt8:function getInt8(t){return get$1(this,1,t)[0]<<24>>24},getUint8:function getUint8(t){return get$1(this,1,t)[0]},getInt16:function getInt16(t){var o=get$1(this,2,t,arguments.length>1&&arguments[1]);return(o[1]<<8|o[0])<<16>>16},getUint16:function getUint16(t){var o=get$1(this,2,t,arguments.length>1&&arguments[1]);return o[1]<<8|o[0]},getInt32:function getInt32(t){return unpackInt32(get$1(this,4,t,arguments.length>1&&arguments[1]))},getUint32:function getUint32(t){return unpackInt32(get$1(this,4,t,arguments.length>1&&arguments[1]))>>>0},getFloat32:function getFloat32(t){return Ec(get$1(this,4,t,arguments.length>1&&arguments[1]),23)},getFloat64:function getFloat64(t){return Ec(get$1(this,8,t,arguments.length>1&&arguments[1]),52)},setInt8:function setInt8(t,o){set$2(this,1,t,packInt8,o)},setUint8:function setUint8(t,o){set$2(this,1,t,packInt8,o)},setInt16:function setInt16(t,o){set$2(this,2,t,packInt16,o,arguments.length>2&&arguments[2])},setUint16:function setUint16(t,o){set$2(this,2,t,packInt16,o,arguments.length>2&&arguments[2])},setInt32:function setInt32(t,o){set$2(this,4,t,packInt32,o,arguments.length>2&&arguments[2])},setUint32:function setUint32(t,o){set$2(this,4,t,packInt32,o,arguments.length>2&&arguments[2])},setFloat32:function setFloat32(t,o){set$2(this,4,t,packFloat32,o,arguments.length>2&&arguments[2])},setFloat64:function setFloat64(t,o){set$2(this,8,t,packFloat64,o,arguments.length>2&&arguments[2])}});setToStringTag(vc,ac),setToStringTag(yc,cc);var Bc={ArrayBuffer:vc,DataView:yc},Hc="ArrayBuffer",Uc=Bc[Hc],qc=l[Hc];_export({global:!0,constructor:!0,forced:qc!==Uc},{ArrayBuffer:Uc}),setSpecies(Hc);var jc,zc,Gc,Kc=ar.enforce,Qc=ar.get,td=l.Int8Array,od=td&&td.prototype,sd=l.Uint8ClampedArray,pd=sd&&sd.prototype,fd=td&&Gn(td),gd=od&&Gn(od),vd=Object.prototype,wd=l.TypeError,Cd=wellKnownSymbol("toStringTag"),_d=uid("TYPED_ARRAY_TAG"),xd="TypedArrayConstructor",Sd=jl&&!!En&&"Opera"!==Lr(l.opera),Td=!1,Ed={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ad={BigInt64Array:8,BigUint64Array:8},getTypedArrayConstructor$4=function(t){var o=Gn(t);if(Ie(o)){var s=Qc(o);return s&&vt(s,xd)?s[xd]:getTypedArrayConstructor$4(o)}},isTypedArray=function(t){if(!Ie(t))return!1;var o=Lr(t);return vt(Ed,o)||vt(Ad,o)};for(jc in Ed)(Gc=(zc=l[jc])&&zc.prototype)?Kc(Gc)[xd]=zc:Sd=!1;for(jc in Ad)(Gc=(zc=l[jc])&&zc.prototype)&&(Kc(Gc)[xd]=zc);if((!Sd||!Te(fd)||fd===Function.prototype)&&(fd=function TypedArray(){throw new wd("Incorrect invocation")},Sd))for(jc in Ed)l[jc]&&En(l[jc],fd);if((!Sd||!gd||gd===vd)&&(gd=fd.prototype,Sd))for(jc in Ed)l[jc]&&En(l[jc].prototype,gd);if(Sd&&Gn(pd)!==gd&&En(pd,gd),h&&!vt(gd,Cd))for(jc in Td=!0,defineBuiltInAccessor(gd,Cd,{configurable:!0,get:function(){return Ie(this)?this[_d]:void 0}}),Ed)l[jc]&&qt(l[jc],_d,jc);var Id={NATIVE_ARRAY_BUFFER_VIEWS:Sd,TYPED_ARRAY_TAG:Td&&_d,aTypedArray:function(t){if(isTypedArray(t))return t;throw new wd("Target is not a typed array")},aTypedArrayConstructor:function(t){if(Te(t)&&(!En||Fe(fd,t)))return t;throw new wd(tryToString(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,o,s,m){if(h){if(s)for(var _ in Ed){var E=l[_];if(E&&vt(E.prototype,t))try{delete E.prototype[t]}catch(s){try{E.prototype[t]=o}catch(t){}}}gd[t]&&!s||defineBuiltIn(gd,t,s?o:Sd&&od[t]||o,m)}},exportTypedArrayStaticMethod:function(t,o,s){var m,_;if(h){if(En){if(s)for(m in Ed)if((_=l[m])&&vt(_,t))try{delete _[t]}catch(t){}if(fd[t]&&!s)return;try{return defineBuiltIn(fd,t,s?o:Sd&&fd[t]||o)}catch(t){}}for(m in Ed)!(_=l[m])||_[t]&&!s||defineBuiltIn(_,t,o)}},getTypedArrayConstructor:getTypedArrayConstructor$4,isView:function isView(t){if(!Ie(t))return!1;var o=Lr(t);return"DataView"===o||vt(Ed,o)||vt(Ad,o)},isTypedArray:isTypedArray,TypedArray:fd,TypedArrayPrototype:gd};_export({target:"ArrayBuffer",stat:!0,forced:!Id.NATIVE_ARRAY_BUFFER_VIEWS},{isView:Id.isView});var Pd=TypeError,aConstructor=function(t){if(po(t))return t;throw new Pd(tryToString(t)+" is not a constructor")},Md=wellKnownSymbol("species"),speciesConstructor=function(t,o){var s,l=anObject(t).constructor;return void 0===l||isNullOrUndefined(s=anObject(l)[Md])?o:aConstructor(s)},Od=Bc.ArrayBuffer,Nd=Bc.DataView,Ld=Nd.prototype,Fd=functionUncurryThisClause(Od.prototype.slice),Bd=functionUncurryThisClause(Ld.getUint8),Hd=functionUncurryThisClause(Ld.setUint8),Qd=fails((function(){return!new Od(2).slice(1,void 0).byteLength}));_export({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:Qd},{slice:function slice(t,o){if(Fd&&void 0===o)return Fd(anObject(this),t);for(var s=anObject(this).byteLength,l=toAbsoluteIndex(t,s),h=toAbsoluteIndex(void 0===o?s:o,s),m=new(speciesConstructor(this,Od))(toLength(h-l)),_=new Nd(this),E=new Nd(m),$=0;l<h;)Hd(E,$++,Bd(_,l++));return m}}),_export({global:!0,constructor:!0,forced:!jl},{DataView:Bc.DataView});var Yd=fails((function(){return 120!==new Date(16e11).getYear()})),Zd=re(Date.prototype.getFullYear);_export({target:"Date",proto:!0,forced:Yd},{getYear:function getYear(){return Zd(this)-1900}});var Jd=Date,eu=re(Jd.prototype.getTime);_export({target:"Date",stat:!0},{now:function now(){return eu(new Jd)}});var tu=Date.prototype,ru=re(tu.getTime),ou=re(tu.setFullYear);_export({target:"Date",proto:!0},{setYear:function setYear(t){ru(this);var o=toIntegerOrInfinity(t);return ou(this,o>=0&&o<=99?o+1900:o)}}),_export({target:"Date",proto:!0},{toGMTString:Date.prototype.toUTCString});var nu=RangeError,iu=function repeat(t){var o=toString_1(requireObjectCoercible(this)),s="",l=toIntegerOrInfinity(t);if(l<0||l===1/0)throw new nu("Wrong number of repetitions");for(;l>0;(l>>>=1)&&(o+=o))1&l&&(s+=o);return s},su=re(iu),au=re("".slice),lu=Math.ceil,createMethod$3=function(t){return function(o,s,l){var h,m,_=toString_1(requireObjectCoercible(o)),E=toLength(s),$=_.length,B=void 0===l?" ":toString_1(l);return E<=$||""===B?_:((m=su(B,lu((h=E-$)/B.length))).length>h&&(m=au(m,0,h)),t?_+m:m+_)}},cu={start:createMethod$3(!1),end:createMethod$3(!0)},du=cu.start,uu=RangeError,hu=isFinite,pu=Math.abs,fu=Date.prototype,gu=fu.toISOString,vu=re(fu.getTime),mu=re(fu.getUTCDate),yu=re(fu.getUTCFullYear),bu=re(fu.getUTCHours),wu=re(fu.getUTCMilliseconds),Cu=re(fu.getUTCMinutes),_u=re(fu.getUTCMonth),ku=re(fu.getUTCSeconds),xu=fails((function(){return"0385-07-25T07:06:39.999Z"!==gu.call(new Date(-50000000000001))}))||!fails((function(){gu.call(new Date(NaN))}))?function toISOString(){if(!hu(vu(this)))throw new uu("Invalid time value");var t=this,o=yu(t),s=wu(t),l=o<0?"-":o>9999?"+":"";return l+du(pu(o),l?6:4,0)+"-"+du(_u(t)+1,2,0)+"-"+du(mu(t),2,0)+"T"+du(bu(t),2,0)+":"+du(Cu(t),2,0)+":"+du(ku(t),2,0)+"."+du(s,3,0)+"Z"}:gu;_export({target:"Date",proto:!0,forced:Date.prototype.toISOString!==xu},{toISOString:xu});var Su=fails((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}));_export({target:"Date",proto:!0,arity:1,forced:Su},{toJSON:function toJSON(t){var o=toObject(this),s=toPrimitive(o,"number");return"number"!=typeof s||isFinite(s)?o.toISOString():null}});var Tu=TypeError,Eu=wellKnownSymbol("toPrimitive"),Au=Date.prototype;vt(Au,Eu)||defineBuiltIn(Au,Eu,(function(t){if(anObject(this),"string"===t||"default"===t)t="string";else if("number"!==t)throw new Tu("Incorrect hint");return ordinaryToPrimitive(this,t)}));var Iu=Date.prototype,Pu="Invalid Date",Ru="toString",$u=re(Iu[Ru]),Mu=re(Iu.getTime);String(new Date(NaN))!==Pu&&defineBuiltIn(Iu,Ru,(function toString(){var t=Mu(this);return t==t?$u(this):Pu}));var Ou=re("".charAt),Nu=re("".charCodeAt),Du=re(/./.exec),Lu=re(1..toString),Fu=re("".toUpperCase),Bu=/[\w*+\-./@]/,hex$1=function(t,o){for(var s=Lu(t,16);s.length<o;)s="0"+s;return s};_export({global:!0},{escape:function escape(t){for(var o,s,l=toString_1(t),h="",m=l.length,_=0;_<m;)o=Ou(l,_++),Du(Bu,o)?h+=o:h+=(s=Nu(o,0))<256?"%"+hex$1(s,2):"%u"+Fu(hex$1(s,4));return h}});var Hu=Function,Uu=re([].concat),qu=re([].join),ju={},zu=m?Hu.bind:function bind(t){var o=aCallable(this),s=o.prototype,l=Xo(arguments,1),h=function bound(){var s=Uu(l,Xo(arguments));return this instanceof h?function(t,o,s){if(!vt(ju,o)){for(var l=[],h=0;h<o;h++)l[h]="a["+h+"]";ju[o]=Hu("C,a","return new C("+qu(l,",")+")")}return ju[o](t,s)}(o,s.length,s):o.apply(t,s)};return Ie(s)&&(h.prototype=s),h};_export({target:"Function",proto:!0,forced:Function.bind!==zu},{bind:zu});var Vu=wellKnownSymbol("hasInstance"),Gu=Function.prototype;Vu in Gu||Ut.f(Gu,Vu,{value:lr((function(t){if(!Te(this)||!Ie(t))return!1;var o=this.prototype;if(!Ie(o))return t instanceof this;for(;t=Gn(t);)if(o===t)return!0;return!1}),Vu)});var Ku=Gt.EXISTS,Wu=Function.prototype,Qu=re(Wu.toString),Yu=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,Zu=re(Yu.exec);h&&!Ku&&defineBuiltInAccessor(Wu,"name",{configurable:!0,get:function(){try{return Zu(Yu,Qu(this))[1]}catch(t){return""}}}),_export({global:!0,forced:l.globalThis!==l},{globalThis:l}),setToStringTag(l.JSON,"JSON",!0);var Ju=fails((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),Xu=Object.isExtensible,wh=fails((function(){Xu(1)}))||Ju?function isExtensible(t){return!!Ie(t)&&((!Ju||"ArrayBuffer"!==classofRaw(t))&&(!Xu||Xu(t)))}:Xu,Ch=!fails((function(){return Object.isExtensible(Object.preventExtensions({}))})),_h=createCommonjsModule((function(t){var o=Ut.f,s=!1,l=uid("meta"),h=0,setMetadata=function(t){o(t,l,{value:{objectID:"O"+h++,weakData:{}}})},m=t.exports={enable:function(){m.enable=function(){},s=!0;var t=wr.f,o=re([].splice),h={};h[l]=1,t(h).length&&(wr.f=function(s){for(var h=t(s),m=0,_=h.length;m<_;m++)if(h[m]===l){o(h,m,1);break}return h},_export({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Zr.f}))},fastKey:function(t,o){if(!Ie(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!vt(t,l)){if(!wh(t))return"F";if(!o)return"E";setMetadata(t)}return t[l].objectID},getWeakData:function(t,o){if(!vt(t,l)){if(!wh(t))return!0;if(!o)return!1;setMetadata(t)}return t[l].weakData},onFreeze:function(t){return Ch&&s&&wh(t)&&!vt(t,l)&&setMetadata(t),t}};tr[l]=!0}));_h.enable,_h.fastKey,_h.getWeakData,_h.onFreeze;var collection=function(t,o,s){var h=-1!==t.indexOf("Map"),m=-1!==t.indexOf("Weak"),_=h?"set":"add",E=l[t],$=E&&E.prototype,B=E,q={},fixMethod=function(t){var o=re($[t]);defineBuiltIn($,t,"add"===t?function add(t){return o(this,0===t?0:t),this}:"delete"===t?function(t){return!(m&&!Ie(t))&&o(this,0===t?0:t)}:"get"===t?function get(t){return m&&!Ie(t)?void 0:o(this,0===t?0:t)}:"has"===t?function has(t){return!(m&&!Ie(t))&&o(this,0===t?0:t)}:function set(t,s){return o(this,0===t?0:t,s),this})};if(Ir(t,!Te(E)||!(m||$.forEach&&!fails((function(){(new E).entries().next()})))))B=s.getConstructor(o,t,h,_),_h.enable();else if(Ir(t,!0)){var j=new B,K=j[_](m?{}:-0,1)!==j,W=fails((function(){j.has(1)})),X=checkCorrectnessOfIteration((function(t){new E(t)})),oe=!m&&fails((function(){for(var t=new E,o=5;o--;)t[_](o,o);return!t.has(-0)}));X||((B=o((function(t,o){anInstance(t,$);var s=inheritIfRequired(new E,t,B);return isNullOrUndefined(o)||iterate(o,s[_],{that:s,AS_ENTRIES:h}),s}))).prototype=$,$.constructor=B),(W||oe)&&(fixMethod("delete"),fixMethod("has"),h&&fixMethod("get")),(oe||K)&&fixMethod(_),m&&$.clear&&delete $.clear}return q[t]=B,_export({global:!0,constructor:!0,forced:B!==E},q),setToStringTag(B,t),m||s.setStrong(B,t,h),B},xh=_h.fastKey,Sh=ar.set,Th=ar.getterFor,Eh={getConstructor:function(t,o,s,l){var m=t((function(t,m){anInstance(t,_),Sh(t,{type:o,index:Gr(null),first:void 0,last:void 0,size:0}),h||(t.size=0),isNullOrUndefined(m)||iterate(m,t[l],{that:t,AS_ENTRIES:s})})),_=m.prototype,E=Th(o),define=function(t,o,s){var l,m,_=E(t),$=getEntry(t,o);return $?$.value=s:(_.last=$={index:m=xh(o,!0),key:o,value:s,previous:l=_.last,next:void 0,removed:!1},_.first||(_.first=$),l&&(l.next=$),h?_.size++:t.size++,"F"!==m&&(_.index[m]=$)),t},getEntry=function(t,o){var s,l=E(t),h=xh(o);if("F"!==h)return l.index[h];for(s=l.first;s;s=s.next)if(s.key===o)return s};return defineBuiltIns(_,{clear:function clear(){for(var t=E(this),o=t.index,s=t.first;s;)s.removed=!0,s.previous&&(s.previous=s.previous.next=void 0),delete o[s.index],s=s.next;t.first=t.last=void 0,h?t.size=0:this.size=0},delete:function(t){var o=this,s=E(o),l=getEntry(o,t);if(l){var m=l.next,_=l.previous;delete s.index[l.index],l.removed=!0,_&&(_.next=m),m&&(m.previous=_),s.first===l&&(s.first=m),s.last===l&&(s.last=_),h?s.size--:o.size--}return!!l},forEach:function forEach(t){for(var o,s=E(this),l=functionBindContext(t,arguments.length>1?arguments[1]:void 0);o=o?o.next:s.first;)for(l(o.value,o.key,this);o&&o.removed;)o=o.previous},has:function has(t){return!!getEntry(this,t)}}),defineBuiltIns(_,s?{get:function get(t){var o=getEntry(this,t);return o&&o.value},set:function set(t,o){return define(this,0===t?0:t,o)}}:{add:function add(t){return define(this,t=0===t?0:t,t)}}),h&&defineBuiltInAccessor(_,"size",{configurable:!0,get:function(){return E(this).size}}),m},setStrong:function(t,o,s){var l=o+" Iterator",h=Th(o),m=Th(l);iteratorDefine(t,o,(function(t,o){Sh(this,{type:l,target:t,state:h(t),kind:o,last:void 0})}),(function(){for(var t=m(this),o=t.kind,s=t.last;s&&s.removed;)s=s.previous;return t.target&&(t.last=s=s?s.next:t.state.first)?createIterResultObject("keys"===o?s.key:"values"===o?s.value:[s.key,s.value],!1):(t.target=void 0,createIterResultObject(void 0,!0))}),s?"entries":"values",!s,!0),setSpecies(o)}};collection("Map",(function(t){return function Map(){return t(this,arguments.length?arguments[0]:void 0)}}),Eh);var Ah=Math.log,Ih=Math.log1p||function log1p(t){var o=+t;return o>-1e-8&&o<1e-8?o-o*o/2:Ah(1+o)},Ph=Math.acosh,Rh=Math.log,Oh=Math.sqrt,Nh=Math.LN2,Dh=!Ph||710!==Math.floor(Ph(Number.MAX_VALUE))||Ph(1/0)!==1/0;_export({target:"Math",stat:!0,forced:Dh},{acosh:function acosh(t){var o=+t;return o<1?NaN:o>94906265.62425156?Rh(o)+Nh:Ih(o-1+Oh(o-1)*Oh(o+1))}});var Lh=Math.asinh,Fh=Math.log,Bh=Math.sqrt;var Hh=!(Lh&&1/Lh(0)>0);_export({target:"Math",stat:!0,forced:Hh},{asinh:function asinh(t){var o=+t;return isFinite(o)&&0!==o?o<0?-asinh(-o):Fh(o+Bh(o*o+1)):o}});var Uh=Math.atanh,qh=Math.log,Vh=!(Uh&&1/Uh(-0)<0);_export({target:"Math",stat:!0,forced:Vh},{atanh:function atanh(t){var o=+t;return 0===o?o:qh((1+o)/(1-o))/2}});var Kh=Math.abs,Qh=Math.pow;_export({target:"Math",stat:!0},{cbrt:function cbrt(t){var o=+t;return Gl(o)*Qh(Kh(o),1/3)}});var Zh=Math.floor,Jh=Math.log,ep=Math.LOG2E;_export({target:"Math",stat:!0},{clz32:function clz32(t){var o=t>>>0;return o?31-Zh(Jh(o+.5)*ep):32}});var tp=Math.expm1,rp=Math.exp,op=!tp||tp(10)>22025.465794806718||tp(10)<22025.465794806718||-2e-17!==tp(-2e-17)?function expm1(t){var o=+t;return 0===o?o:o>-1e-6&&o<1e-6?o+o*o/2:rp(o)-1}:tp,np=Math.cosh,ip=Math.abs,sp=Math.E,ap=!np||np(710)===1/0;_export({target:"Math",stat:!0,forced:ap},{cosh:function cosh(t){var o=op(ip(t)-1)+1;return(o+1/(o*sp*sp))*(sp/2)}}),_export({target:"Math",stat:!0,forced:op!==Math.expm1},{expm1:op}),_export({target:"Math",stat:!0},{fround:Yl});var lp=Math.hypot,cp=Math.abs,dp=Math.sqrt,up=!!lp&&lp(1/0,NaN)!==1/0;_export({target:"Math",stat:!0,arity:2,forced:up},{hypot:function hypot(t,o){for(var s,l,h=0,m=0,_=arguments.length,E=0;m<_;)E<(s=cp(arguments[m++]))?(h=h*(l=E/s)*l+1,E=s):h+=s>0?(l=s/E)*l:s;return E===1/0?1/0:E*dp(h)}});var hp=Math.imul,pp=fails((function(){return-5!==hp(4294967295,5)||2!==hp.length}));_export({target:"Math",stat:!0,forced:pp},{imul:function imul(t,o){var s=65535,l=+t,h=+o,m=s&l,_=s&h;return 0|m*_+((s&l>>>16)*_+m*(s&h>>>16)<<16>>>0)}});var fp=Math.log,gp=Math.LOG10E,vp=Math.log10||function log10(t){return fp(t)*gp};_export({target:"Math",stat:!0},{log10:vp}),_export({target:"Math",stat:!0},{log1p:Ih});var mp=Math.log,yp=Math.LN2;_export({target:"Math",stat:!0},{log2:function log2(t){return mp(t)/yp}}),_export({target:"Math",stat:!0},{sign:Gl});var bp=Math.abs,wp=Math.exp,Cp=Math.E,_p=fails((function(){return-2e-17!==Math.sinh(-2e-17)}));_export({target:"Math",stat:!0,forced:_p},{sinh:function sinh(t){var o=+t;return bp(o)<1?(op(o)-op(-o))/2:(wp(o-1)-wp(-o-1))*(Cp/2)}});var kp=Math.exp;_export({target:"Math",stat:!0},{tanh:function tanh(t){var o=+t,s=op(o),l=op(-o);return s===1/0?1:l===1/0?-1:(s-l)/(kp(o)+kp(-o))}}),setToStringTag(Math,"Math",!0),_export({target:"Math",stat:!0},{trunc:ur});var xp=re(1..valueOf),Sp="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff",Tp=re("".replace),Ep=RegExp("^["+Sp+"]+"),Ap=RegExp("(^|[^"+Sp+"])["+Sp+"]+$"),createMethod$2=function(t){return function(o){var s=toString_1(requireObjectCoercible(o));return 1&t&&(s=Tp(s,Ep,"")),2&t&&(s=Tp(s,Ap,"$1")),s}},Ip={start:createMethod$2(1),end:createMethod$2(2),trim:createMethod$2(3)},Pp=wr.f,Rp=Pt.f,$p=Ut.f,Mp=Ip.trim,Op="Number",Np=l[Op];Xr[Op];var Dp=Np.prototype,Lp=l.TypeError,Fp=re("".slice),Bp=re("".charCodeAt),toNumber=function(t){var o,s,l,h,m,_,E,$,B=toPrimitive(t,"number");if(it(B))throw new Lp("Cannot convert a Symbol value to a number");if("string"==typeof B&&B.length>2)if(B=Mp(B),43===(o=Bp(B,0))||45===o){if(88===(s=Bp(B,2))||120===s)return NaN}else if(48===o){switch(Bp(B,1)){case 66:case 98:l=2,h=49;break;case 79:case 111:l=8,h=55;break;default:return+B}for(_=(m=Fp(B,2)).length,E=0;E<_;E++)if(($=Bp(m,E))<48||$>h)return NaN;return parseInt(m,l)}return+B},Hp=Ir(Op,!Np(" 0o1")||!Np("0b1")||Np("+0x1")),Up=function Number(t){var o,s=arguments.length<1?0:Np(function(t){var o=toPrimitive(t,"number");return"bigint"==typeof o?o:toNumber(o)}(t));return Fe(Dp,o=this)&&fails((function(){xp(o)}))?inheritIfRequired(Object(s),this,Up):s};Up.prototype=Dp,Hp&&(Dp.constructor=Up),_export({global:!0,constructor:!0,wrap:!0,forced:Hp},{Number:Up});Hp&&function(t,o){for(var s,l=h?Pp(o):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),m=0;l.length>m;m++)vt(o,s=l[m])&&!vt(t,s)&&$p(t,s,Rp(o,s))}(Xr[Op],Np),_export({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{EPSILON:Math.pow(2,-52)});var qp=l.isFinite,jp=Number.isFinite||function isFinite(t){return"number"==typeof t&&qp(t)};_export({target:"Number",stat:!0},{isFinite:jp});var zp=Math.floor,Vp=Number.isInteger||function isInteger(t){return!Ie(t)&&isFinite(t)&&zp(t)===t};_export({target:"Number",stat:!0},{isInteger:Vp}),_export({target:"Number",stat:!0},{isNaN:function isNaN(t){return t!=t}});var Gp=Math.abs;_export({target:"Number",stat:!0},{isSafeInteger:function isSafeInteger(t){return Vp(t)&&Gp(t)<=9007199254740991}}),_export({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991}),_export({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MIN_SAFE_INTEGER:-9007199254740991});var Kp=Ip.trim,Wp=re("".charAt),Qp=l.parseFloat,Yp=l.Symbol,Zp=Yp&&Yp.iterator,Jp=1/Qp(Sp+"-0")!=-1/0||Zp&&!fails((function(){Qp(Object(Zp))}))?function parseFloat(t){var o=Kp(toString_1(t)),s=Qp(o);return 0===s&&"-"===Wp(o,0)?-0:s}:Qp;_export({target:"Number",stat:!0,forced:Number.parseFloat!==Jp},{parseFloat:Jp});var Xp=Ip.trim,ef=l.parseInt,tf=l.Symbol,rf=tf&&tf.iterator,nf=/^[+-]?0x/i,sf=re(nf.exec),af=8!==ef(Sp+"08")||22!==ef(Sp+"0x16")||rf&&!fails((function(){ef(Object(rf))}))?function parseInt(t,o){var s=Xp(toString_1(t));return ef(s,o>>>0||(sf(nf,s)?16:10))}:ef;_export({target:"Number",stat:!0,forced:Number.parseInt!==af},{parseInt:af});var df=RangeError,uf=String,hf=isFinite,ff=Math.abs,gf=Math.floor,vf=Math.pow,bf=Math.round,wf=re(1..toExponential),Cf=re(iu),_f=re("".slice),xf="-6.9000e-11"===wf(-69e-12,4)&&"1.25e+0"===wf(1.255,2)&&"1.235e+4"===wf(12345,3)&&"3e+1"===wf(25,0),Sf=!xf||!(fails((function(){wf(1,1/0)}))&&fails((function(){wf(1,-1/0)})))||!!fails((function(){wf(1/0,1/0),wf(NaN,1/0)}));_export({target:"Number",proto:!0,forced:Sf},{toExponential:function toExponential(t){var o=xp(this);if(void 0===t)return wf(o);var s=toIntegerOrInfinity(t);if(!hf(o))return String(o);if(s<0||s>20)throw new df("Incorrect fraction digits");if(xf)return wf(o,s);var l="",h="",m=0,_="",E="";if(o<0&&(l="-",o=-o),0===o)m=0,h=Cf("0",s+1);else{var $=vp(o);m=gf($);var B=0,q=vf(10,m-s);2*o>=(2*(B=bf(o/q))+1)*q&&(B+=1),B>=vf(10,s+1)&&(B/=10,m+=1),h=uf(B)}return 0!==s&&(h=_f(h,0,1)+"."+_f(h,1)),0===m?(_="+",E="0"):(_=m>0?"+":"-",E=uf(ff(m))),l+(h+="e"+_+E)}});var Ef=RangeError,Af=String,Pf=Math.floor,Rf=re(iu),Mf=re("".slice),Df=re(1..toFixed),pow$1=function(t,o,s){return 0===o?s:o%2==1?pow$1(t,o-1,s*t):pow$1(t*t,o/2,s)},multiply=function(t,o,s){for(var l=-1,h=s;++l<6;)h+=o*t[l],t[l]=h%1e7,h=Pf(h/1e7)},divide=function(t,o){for(var s=6,l=0;--s>=0;)l+=t[s],t[s]=Pf(l/o),l=l%o*1e7},dataToString=function(t){for(var o=6,s="";--o>=0;)if(""!==s||0===o||0!==t[o]){var l=Af(t[o]);s=""===s?l:s+Rf("0",7-l.length)+l}return s},Lf=fails((function(){return"0.000"!==Df(8e-5,3)||"1"!==Df(.9,0)||"1.25"!==Df(1.255,2)||"1000000000000000128"!==Df(0xde0b6b3a7640080,0)}))||!fails((function(){Df({})}));_export({target:"Number",proto:!0,forced:Lf},{toFixed:function toFixed(t){var o,s,l,h,m=xp(this),_=toIntegerOrInfinity(t),E=[0,0,0,0,0,0],$="",B="0";if(_<0||_>20)throw new Ef("Incorrect fraction digits");if(m!=m)return"NaN";if(m<=-1e21||m>=1e21)return Af(m);if(m<0&&($="-",m=-m),m>1e-21)if(o=function(t){for(var o=0,s=t;s>=4096;)o+=12,s/=4096;for(;s>=2;)o+=1,s/=2;return o}(m*pow$1(2,69,1))-69,s=o<0?m*pow$1(2,-o,1):m/pow$1(2,o,1),s*=4503599627370496,(o=52-o)>0){for(multiply(E,0,s),l=_;l>=7;)multiply(E,1e7,0),l-=7;for(multiply(E,pow$1(10,l,1),0),l=o-1;l>=23;)divide(E,1<<23),l-=23;divide(E,1<<l),multiply(E,1,1),divide(E,2),B=dataToString(E)}else multiply(E,0,s),multiply(E,1<<-o,0),B=dataToString(E)+Rf("0",_);return B=_>0?$+((h=B.length)<=_?"0."+Rf("0",_-h)+B:Mf(B,0,h-_)+"."+Mf(B,h-_)):$+B}});var Ff=re(1..toPrecision),Bf=fails((function(){return"1"!==Ff(1,void 0)}))||!fails((function(){Ff({})}));_export({target:"Number",proto:!0,forced:Bf},{toPrecision:function toPrecision(t){return void 0===t?Ff(xp(this)):Ff(xp(this),t)}});var Hf=Object.assign,Gf=Object.defineProperty,Yf=re([].concat),Zf=!Hf||fails((function(){if(h&&1!==Hf({b:1},Hf(Gf({},"a",{enumerable:!0,get:function(){Gf(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},o={},s=Symbol("assign detection"),l="abcdefghijklmnopqrst";return t[s]=7,l.split("").forEach((function(t){o[t]=t})),7!==Hf({},t)[s]||Br(Hf({},o)).join("")!==l}))?function assign(t,o){for(var s=toObject(t),l=arguments.length,m=1,_=Cr.f,$=j.f;l>m;)for(var B,q=de(arguments[m++]),K=_?Yf(Br(q),_(q)):Br(q),W=K.length,X=0;W>X;)B=K[X++],h&&!E($,q,B)||(s[B]=q[B]);return s}:Hf;_export({target:"Object",stat:!0,arity:2,forced:Object.assign!==Zf},{assign:Zf}),_export({target:"Object",stat:!0,sham:!h},{create:Gr});var Xf=!fails((function(){if(!(Cl&&Cl<535)){var t=Math.random();__defineSetter__.call(null,t,(function(){})),delete l[t]}}));h&&_export({target:"Object",proto:!0,forced:Xf},{__defineGetter__:function __defineGetter__(t,o){Ut.f(toObject(this),t,{get:aCallable(o),enumerable:!0,configurable:!0})}});var eg=Ur.f;_export({target:"Object",stat:!0,forced:Object.defineProperties!==eg,sham:!h},{defineProperties:eg});var tg=Ut.f;_export({target:"Object",stat:!0,forced:Object.defineProperty!==tg,sham:!h},{defineProperty:tg}),h&&_export({target:"Object",proto:!0,forced:Xf},{__defineSetter__:function __defineSetter__(t,o){Ut.f(toObject(this),t,{set:aCallable(o),enumerable:!0,configurable:!0})}});var rg=j.f,og=re(rg),ng=re([].push),ig=h&&fails((function(){var t=Object.create(null);return t[2]=2,!og(t,2)})),createMethod$1=function(t){return function(o){for(var s,l=toIndexedObject(o),m=Br(l),_=ig&&null===Gn(l),E=m.length,$=0,B=[];E>$;)s=m[$++],h&&!(_?s in l:og(l,s))||ng(B,t?[s,l[s]]:l[s]);return B}},sg={entries:createMethod$1(!0),values:createMethod$1(!1)},lg=sg.entries;_export({target:"Object",stat:!0},{entries:function entries(t){return lg(t)}});var cg=_h.onFreeze,ug=Object.freeze,hg=fails((function(){ug(1)}));_export({target:"Object",stat:!0,forced:hg,sham:!Ch},{freeze:function freeze(t){return ug&&Ie(t)?ug(cg(t)):t}}),_export({target:"Object",stat:!0},{fromEntries:function fromEntries(t){var o={};return iterate(t,(function(t,s){createProperty(o,t,s)}),{AS_ENTRIES:!0}),o}});var pg=Pt.f,fg=!h||fails((function(){pg(1)}));_export({target:"Object",stat:!0,forced:fg,sham:!h},{getOwnPropertyDescriptor:function getOwnPropertyDescriptor(t,o){return pg(toIndexedObject(t),o)}}),_export({target:"Object",stat:!0,sham:!h},{getOwnPropertyDescriptors:function getOwnPropertyDescriptors(t){for(var o,s,l=toIndexedObject(t),h=Pt.f,m=kr(l),_={},E=0;m.length>E;)void 0!==(s=h(l,o=m[E++]))&&createProperty(_,o,s);return _}});var gg=Zr.f,vg=fails((function(){return!Object.getOwnPropertyNames(1)}));_export({target:"Object",stat:!0,forced:vg},{getOwnPropertyNames:gg});var mg=fails((function(){Gn(1)}));_export({target:"Object",stat:!0,forced:mg,sham:!qn},{getPrototypeOf:function getPrototypeOf(t){return Gn(toObject(t))}}),_export({target:"Object",stat:!0},{hasOwn:vt});var yg=Object.is||function is(t,o){return t===o?0!==t||1/t==1/o:t!=t&&o!=o};_export({target:"Object",stat:!0},{is:yg}),_export({target:"Object",stat:!0,forced:Object.isExtensible!==wh},{isExtensible:wh});var wg=Object.isFrozen,Cg=Ju||fails((function(){wg(1)}));_export({target:"Object",stat:!0,forced:Cg},{isFrozen:function isFrozen(t){return!Ie(t)||(!(!Ju||"ArrayBuffer"!==classofRaw(t))||!!wg&&wg(t))}});var _g=Object.isSealed,kg=Ju||fails((function(){_g(1)}));_export({target:"Object",stat:!0,forced:kg},{isSealed:function isSealed(t){return!Ie(t)||(!(!Ju||"ArrayBuffer"!==classofRaw(t))||!!_g&&_g(t))}});var xg=fails((function(){Br(1)}));_export({target:"Object",stat:!0,forced:xg},{keys:function keys(t){return Br(toObject(t))}});var Eg=Pt.f;h&&_export({target:"Object",proto:!0,forced:Xf},{__lookupGetter__:function __lookupGetter__(t){var o,s=toObject(this),l=toPropertyKey(t);do{if(o=Eg(s,l))return o.get}while(s=Gn(s))}});var Ag=Pt.f;h&&_export({target:"Object",proto:!0,forced:Xf},{__lookupSetter__:function __lookupSetter__(t){var o,s=toObject(this),l=toPropertyKey(t);do{if(o=Ag(s,l))return o.set}while(s=Gn(s))}});var Ig=_h.onFreeze,Pg=Object.preventExtensions,Mg=fails((function(){Pg(1)}));_export({target:"Object",stat:!0,forced:Mg,sham:!Ch},{preventExtensions:function preventExtensions(t){return Pg&&Ie(t)?Pg(Ig(t)):t}});var Ng=Object.getPrototypeOf,Dg=Object.setPrototypeOf,Lg=Object.prototype,Fg="__proto__";if(h&&Ng&&Dg&&!(Fg in Lg))try{defineBuiltInAccessor(Lg,Fg,{configurable:!0,get:function __proto__(){return Ng(toObject(this))},set:function __proto__(t){var o=requireObjectCoercible(this);(Ie(t)||null===t)&&Ie(o)&&Dg(o,t)}})}catch(t){}var Bg=_h.onFreeze,Hg=Object.seal,Ug=fails((function(){Hg(1)}));_export({target:"Object",stat:!0,forced:Ug,sham:!Ch},{seal:function seal(t){return Hg&&Ie(t)?Hg(Bg(t)):t}}),_export({target:"Object",stat:!0},{setPrototypeOf:En});var qg=Mr?{}.toString:function toString(){return"[object "+Lr(this)+"]"};Mr||defineBuiltIn(Object.prototype,"toString",qg,{unsafe:!0});var jg=sg.values;_export({target:"Object",stat:!0},{values:function values(t){return jg(t)}}),_export({global:!0,forced:parseFloat!==Jp},{parseFloat:Jp}),_export({global:!0,forced:parseInt!==af},{parseInt:af});var zg,Gg,Kg,Jg,ev=TypeError,validateArgumentsLength=function(t,o){if(t<o)throw new ev("Not enough arguments");return t},tv=/(?:ipad|iphone|ipod).*applewebkit/i.test(He),rv=l.setImmediate,ov=l.clearImmediate,nv=l.process,iv=l.Dispatch,sv=l.Function,av=l.MessageChannel,lv=l.String,cv=0,dv={},uv="onreadystatechange";fails((function(){zg=l.location}));var run=function(t){if(vt(dv,t)){var o=dv[t];delete dv[t],o()}},runner=function(t){return function(){run(t)}},eventListener=function(t){run(t.data)},globalPostMessageDefer=function(t){l.postMessage(lv(t),zg.protocol+"//"+zg.host)};rv&&ov||(rv=function setImmediate(t){validateArgumentsLength(arguments.length,1);var o=Te(t)?t:sv(t),s=Xo(arguments,1);return dv[++cv]=function(){Jo(o,void 0,s)},Gg(cv),cv},ov=function clearImmediate(t){delete dv[t]},rl?Gg=function(t){nv.nextTick(runner(t))}:iv&&iv.now?Gg=function(t){iv.now(runner(t))}:av&&!tv?(Jg=(Kg=new av).port2,Kg.port1.onmessage=eventListener,Gg=functionBindContext(Jg.postMessage,Jg)):l.addEventListener&&Te(l.postMessage)&&!l.importScripts&&zg&&"file:"!==zg.protocol&&!fails(globalPostMessageDefer)?(Gg=globalPostMessageDefer,l.addEventListener("message",eventListener,!1)):Gg=uv in documentCreateElement("script")?function(t){qr.appendChild(documentCreateElement("script"))[uv]=function(){qr.removeChild(this),run(t)}}:function(t){setTimeout(runner(t),0)});var hv={set:rv,clear:ov},Queue=function(){this.head=null,this.tail=null};Queue.prototype={add:function(t){var o={item:t,next:null},s=this.tail;s?s.next=o:this.head=o,this.tail=o},get:function(){var t=this.head;if(t)return null===(this.head=t.next)&&(this.tail=null),t.item}};var pv,fv,gv,vv,mv,yv=Queue,bv=/ipad|iphone|ipod/i.test(He)&&"undefined"!=typeof Pebble,wv=/web0s(?!.*chrome)/i.test(He),Cv=Pt.f,_v=hv.set,kv=l.MutationObserver||l.WebKitMutationObserver,xv=l.document,Sv=l.process,Tv=l.Promise,Ev=Cv(l,"queueMicrotask"),Av=Ev&&Ev.value;if(!Av){var Iv=new yv,flush=function(){var t,o;for(rl&&(t=Sv.domain)&&t.exit();o=Iv.get();)try{o()}catch(t){throw Iv.head&&pv(),t}t&&t.enter()};tv||rl||wv||!kv||!xv?!bv&&Tv&&Tv.resolve?((vv=Tv.resolve(void 0)).constructor=Tv,mv=functionBindContext(vv.then,vv),pv=function(){mv(flush)}):rl?pv=function(){Sv.nextTick(flush)}:(_v=functionBindContext(_v,l),pv=function(){_v(flush)}):(fv=!0,gv=xv.createTextNode(""),new kv(flush).observe(gv,{characterData:!0}),pv=function(){gv.data=fv=!fv}),Av=function(t){Iv.head||pv(),Iv.add(t)}}var Pv=Av,perform=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Rv=l.Promise,$v="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Mv=!$v&&!rl&&"object"==typeof window&&"object"==typeof document;Rv&&Rv.prototype;var Ov,Nv,Dv,Lv=wellKnownSymbol("species"),Fv=!1,Bv=Te(l.PromiseRejectionEvent),Hv=Ir("Promise",(function(){var t=Zt(Rv),o=t!==String(Rv);if(!o&&66===et)return!0;if(!et||et<51||!/native code/.test(t)){var s=new Rv((function(t){t(1)})),FakePromise=function(t){t((function(){}),(function(){}))};if((s.constructor={})[Lv]=FakePromise,!(Fv=s.then((function(){}))instanceof FakePromise))return!0}return!o&&(Mv||$v)&&!Bv})),Uv={CONSTRUCTOR:Hv,REJECTION_EVENT:Bv,SUBCLASSING:Fv},qv=TypeError,PromiseCapability=function(t){var o,s;this.promise=new t((function(t,l){if(void 0!==o||void 0!==s)throw new qv("Bad Promise constructor");o=t,s=l})),this.resolve=aCallable(o),this.reject=aCallable(s)},jv={f:function(t){return new PromiseCapability(t)}},zv=hv.set,Vv="Promise",Gv=Uv.CONSTRUCTOR,Kv=Uv.REJECTION_EVENT,Wv=Uv.SUBCLASSING,Qv=ar.getterFor(Vv),Yv=ar.set,Zv=Rv&&Rv.prototype,Jv=Rv,Xv=Zv,em=l.TypeError,tm=l.document,rm=l.process,om=jv.f,nm=om,im=!!(tm&&tm.createEvent&&l.dispatchEvent),sm="unhandledrejection",isThenable=function(t){var o;return!(!Ie(t)||!Te(o=t.then))&&o},callReaction=function(t,o){var s,l,h,m=o.value,_=1===o.state,$=_?t.ok:t.fail,B=t.resolve,q=t.reject,j=t.domain;try{$?(_||(2===o.rejection&&onHandleUnhandled(o),o.rejection=1),!0===$?s=m:(j&&j.enter(),s=$(m),j&&(j.exit(),h=!0)),s===t.promise?q(new em("Promise-chain cycle")):(l=isThenable(s))?E(l,s,B,q):B(s)):q(m)}catch(t){j&&!h&&j.exit(),q(t)}},notify=function(t,o){t.notified||(t.notified=!0,Pv((function(){for(var s,l=t.reactions;s=l.get();)callReaction(s,t);t.notified=!1,o&&!t.rejection&&onUnhandled(t)})))},dispatchEvent=function(t,o,s){var h,m;im?((h=tm.createEvent("Event")).promise=o,h.reason=s,h.initEvent(t,!1,!0),l.dispatchEvent(h)):h={promise:o,reason:s},!Kv&&(m=l["on"+t])?m(h):t===sm&&function(t,o){try{1===arguments.length?console.error(t):console.error(t,o)}catch(t){}}("Unhandled promise rejection",s)},onUnhandled=function(t){E(zv,l,(function(){var o,s=t.facade,l=t.value;if(isUnhandled(t)&&(o=perform((function(){rl?rm.emit("unhandledRejection",l,s):dispatchEvent(sm,s,l)})),t.rejection=rl||isUnhandled(t)?2:1,o.error))throw o.value}))},isUnhandled=function(t){return 1!==t.rejection&&!t.parent},onHandleUnhandled=function(t){E(zv,l,(function(){var o=t.facade;rl?rm.emit("rejectionHandled",o):dispatchEvent("rejectionhandled",o,t.value)}))},bind=function(t,o,s){return function(l){t(o,l,s)}},internalReject=function(t,o,s){t.done||(t.done=!0,s&&(t=s),t.value=o,t.state=2,notify(t,!0))},internalResolve=function(t,o,s){if(!t.done){t.done=!0,s&&(t=s);try{if(t.facade===o)throw new em("Promise can't be resolved itself");var l=isThenable(o);l?Pv((function(){var s={done:!1};try{E(l,o,bind(internalResolve,s,t),bind(internalReject,s,t))}catch(o){internalReject(s,o,t)}})):(t.value=o,t.state=1,notify(t,!1))}catch(o){internalReject({done:!1},o,t)}}};if(Gv&&(Xv=(Jv=function Promise(t){anInstance(this,Xv),aCallable(t),E(Ov,this);var o=Qv(this);try{t(bind(internalResolve,o),bind(internalReject,o))}catch(t){internalReject(o,t)}}).prototype,(Ov=function Promise(t){Yv(this,{type:Vv,done:!1,notified:!1,parent:!1,reactions:new yv,rejection:!1,state:0,value:void 0})}).prototype=defineBuiltIn(Xv,"then",(function then(t,o){var s=Qv(this),l=om(speciesConstructor(this,Jv));return s.parent=!0,l.ok=!Te(t)||t,l.fail=Te(o)&&o,l.domain=rl?rm.domain:void 0,0===s.state?s.reactions.add(l):Pv((function(){callReaction(l,s)})),l.promise})),Nv=function(){var t=new Ov,o=Qv(t);this.promise=t,this.resolve=bind(internalResolve,o),this.reject=bind(internalReject,o)},jv.f=om=function(t){return t===Jv||undefined===t?new Nv(t):nm(t)},Te(Rv)&&Zv!==Object.prototype)){Dv=Zv.then,Wv||defineBuiltIn(Zv,"then",(function then(t,o){var s=this;return new Jv((function(t,o){E(Dv,s,t,o)})).then(t,o)}),{unsafe:!0});try{delete Zv.constructor}catch(t){}En&&En(Zv,Xv)}_export({global:!0,constructor:!0,wrap:!0,forced:Gv},{Promise:Jv}),setToStringTag(Jv,Vv,!1),setSpecies(Vv);var am=Uv.CONSTRUCTOR||!checkCorrectnessOfIteration((function(t){Rv.all(t).then(void 0,(function(){}))}));_export({target:"Promise",stat:!0,forced:am},{all:function all(t){var o=this,s=jv.f(o),l=s.resolve,h=s.reject,m=perform((function(){var s=aCallable(o.resolve),m=[],_=0,$=1;iterate(t,(function(t){var B=_++,q=!1;$++,E(s,o,t).then((function(t){q||(q=!0,m[B]=t,--$||l(m))}),h)})),--$||l(m)}));return m.error&&h(m.value),s.promise}});var lm=Uv.CONSTRUCTOR,cm=Rv&&Rv.prototype;if(_export({target:"Promise",proto:!0,forced:lm,real:!0},{catch:function(t){return this.then(void 0,t)}}),Te(Rv)){var dm=getBuiltIn("Promise").prototype.catch;cm.catch!==dm&&defineBuiltIn(cm,"catch",dm,{unsafe:!0})}_export({target:"Promise",stat:!0,forced:am},{race:function race(t){var o=this,s=jv.f(o),l=s.reject,h=perform((function(){var h=aCallable(o.resolve);iterate(t,(function(t){E(h,o,t).then(s.resolve,l)}))}));return h.error&&l(h.value),s.promise}}),_export({target:"Promise",stat:!0,forced:Uv.CONSTRUCTOR},{reject:function reject(t){var o=jv.f(this);return E(o.reject,void 0,t),o.promise}});var promiseResolve=function(t,o){if(anObject(t),Ie(o)&&o.constructor===t)return o;var s=jv.f(t);return(0,s.resolve)(o),s.promise},um=Uv.CONSTRUCTOR;getBuiltIn("Promise"),_export({target:"Promise",stat:!0,forced:um},{resolve:function resolve(t){return promiseResolve(this,t)}}),_export({target:"Promise",stat:!0,forced:am},{allSettled:function allSettled(t){var o=this,s=jv.f(o),l=s.resolve,h=s.reject,m=perform((function(){var s=aCallable(o.resolve),h=[],m=0,_=1;iterate(t,(function(t){var $=m++,B=!1;_++,E(s,o,t).then((function(t){B||(B=!0,h[$]={status:"fulfilled",value:t},--_||l(h))}),(function(t){B||(B=!0,h[$]={status:"rejected",reason:t},--_||l(h))}))})),--_||l(h)}));return m.error&&h(m.value),s.promise}});var hm="No one promise resolved";_export({target:"Promise",stat:!0,forced:am},{any:function any(t){var o=this,s=getBuiltIn("AggregateError"),l=jv.f(o),h=l.resolve,m=l.reject,_=perform((function(){var l=aCallable(o.resolve),_=[],$=0,B=1,q=!1;iterate(t,(function(t){var j=$++,K=!1;B++,E(l,o,t).then((function(t){K||q||(q=!0,h(t))}),(function(t){K||q||(K=!0,_[j]=t,--B||m(new s(_,hm)))}))})),--B||m(new s(_,hm))}));return _.error&&m(_.value),l.promise}});var pm=Rv&&Rv.prototype,fm=!!Rv&&fails((function(){pm.finally.call({then:function(){}},(function(){}))}));if(_export({target:"Promise",proto:!0,real:!0,forced:fm},{finally:function(t){var o=speciesConstructor(this,getBuiltIn("Promise")),s=Te(t);return this.then(s?function(s){return promiseResolve(o,t()).then((function(){return s}))}:t,s?function(s){return promiseResolve(o,t()).then((function(){throw s}))}:t)}}),Te(Rv)){var gm=getBuiltIn("Promise").prototype.finally;pm.finally!==gm&&defineBuiltIn(pm,"finally",gm,{unsafe:!0})}var vm=!fails((function(){Reflect.apply((function(){}))}));_export({target:"Reflect",stat:!0,forced:vm},{apply:function apply(t,o,s){return Jo(aCallable(t),o,anObject(s))}});var mm=getBuiltIn("Reflect","construct"),ym=Object.prototype,bm=[].push,wm=fails((function(){function F(){}return!(mm((function(){}),[],F)instanceof F)})),Cm=!fails((function(){mm((function(){}))})),_m=wm||Cm;_export({target:"Reflect",stat:!0,forced:_m,sham:_m},{construct:function construct(t,o){aConstructor(t),anObject(o);var s=arguments.length<3?t:aConstructor(arguments[2]);if(Cm&&!wm)return mm(t,o,s);if(t===s){switch(o.length){case 0:return new t;case 1:return new t(o[0]);case 2:return new t(o[0],o[1]);case 3:return new t(o[0],o[1],o[2]);case 4:return new t(o[0],o[1],o[2],o[3])}var l=[null];return Jo(bm,l,o),new(Jo(zu,t,l))}var h=s.prototype,m=Gr(Ie(h)?h:ym),_=Jo(t,m,o);return Ie(_)?_:m}});var km=fails((function(){Reflect.defineProperty(Ut.f({},1,{value:1}),1,{value:2})}));_export({target:"Reflect",stat:!0,forced:km,sham:!h},{defineProperty:function defineProperty(t,o,s){anObject(t);var l=toPropertyKey(o);anObject(s);try{return Ut.f(t,l,s),!0}catch(t){return!1}}});var xm=Pt.f;_export({target:"Reflect",stat:!0},{deleteProperty:function deleteProperty(t,o){var s=xm(anObject(t),o);return!(s&&!s.configurable)&&delete t[o]}});var isDataDescriptor=function(t){return void 0!==t&&(vt(t,"value")||vt(t,"writable"))};_export({target:"Reflect",stat:!0},{get:function get(t,o){var s,l,h=arguments.length<3?t:arguments[2];return anObject(t)===h?t[o]:(s=Pt.f(t,o))?isDataDescriptor(s)?s.value:void 0===s.get?void 0:E(s.get,h):Ie(l=Gn(t))?get(l,o,h):void 0}}),_export({target:"Reflect",stat:!0,sham:!h},{getOwnPropertyDescriptor:function getOwnPropertyDescriptor(t,o){return Pt.f(anObject(t),o)}}),_export({target:"Reflect",stat:!0,sham:!qn},{getPrototypeOf:function getPrototypeOf(t){return Gn(anObject(t))}}),_export({target:"Reflect",stat:!0},{has:function has(t,o){return o in t}}),_export({target:"Reflect",stat:!0},{isExtensible:function isExtensible(t){return anObject(t),wh(t)}}),_export({target:"Reflect",stat:!0},{ownKeys:kr}),_export({target:"Reflect",stat:!0,sham:!Ch},{preventExtensions:function preventExtensions(t){anObject(t);try{var o=getBuiltIn("Object","preventExtensions");return o&&o(t),!0}catch(t){return!1}}});var Sm=fails((function(){var Constructor=function(){},t=Ut.f(new Constructor,"a",{configurable:!0});return!1!==Reflect.set(Constructor.prototype,"a",1,t)}));_export({target:"Reflect",stat:!0,forced:Sm},{set:function set(t,o,s){var l,h,m,_=arguments.length<4?t:arguments[3],$=Pt.f(anObject(t),o);if(!$){if(Ie(h=Gn(t)))return set(h,o,s,_);$=createPropertyDescriptor(0)}if(isDataDescriptor($)){if(!1===$.writable||!Ie(_))return!1;if(l=Pt.f(_,o)){if(l.get||l.set||!1===l.writable)return!1;l.value=s,Ut.f(_,o,l)}else Ut.f(_,o,createPropertyDescriptor(0,s))}else{if(void 0===(m=$.set))return!1;E(m,_,s)}return!0}}),En&&_export({target:"Reflect",stat:!0},{setPrototypeOf:function setPrototypeOf(t,o){anObject(t),aPossiblePrototype(o);try{return En(t,o),!0}catch(t){return!1}}}),_export({global:!0},{Reflect:{}}),setToStringTag(l.Reflect,"Reflect",!0);var Tm=wellKnownSymbol("match"),isRegexp=function(t){var o;return Ie(t)&&(void 0!==(o=t[Tm])?!!o:"RegExp"===classofRaw(t))},regexpFlags=function(){var t=anObject(this),o="";return t.hasIndices&&(o+="d"),t.global&&(o+="g"),t.ignoreCase&&(o+="i"),t.multiline&&(o+="m"),t.dotAll&&(o+="s"),t.unicode&&(o+="u"),t.unicodeSets&&(o+="v"),t.sticky&&(o+="y"),o},Em=RegExp.prototype,regexpGetFlags=function(t){var o=t.flags;return void 0!==o||"flags"in Em||vt(t,"flags")||!Fe(Em,t)?o:E(regexpFlags,t)},Am=l.RegExp,Im=fails((function(){var t=Am("a","y");return t.lastIndex=2,null!==t.exec("abcd")})),Pm=Im||fails((function(){return!Am("a","y").sticky})),Rm=Im||fails((function(){var t=Am("^r","gy");return t.lastIndex=2,null!==t.exec("str")})),$m={BROKEN_CARET:Rm,MISSED_STICKY:Pm,UNSUPPORTED_Y:Im},Mm=l.RegExp,Om=fails((function(){var t=Mm(".","s");return!(t.dotAll&&t.test("\n")&&"s"===t.flags)})),Nm=l.RegExp,Dm=fails((function(){var t=Nm("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})),Lm=wr.f,Fm=ar.enforce,Bm=wellKnownSymbol("match"),Hm=l.RegExp,Um=Hm.prototype,qm=l.SyntaxError,jm=re(Um.exec),zm=re("".charAt),Vm=re("".replace),Gm=re("".indexOf),Km=re("".slice),Wm=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Qm=/a/g,Ym=/a/g,Zm=new Hm(Qm)!==Qm,Jm=$m.MISSED_STICKY,Xm=$m.UNSUPPORTED_Y,ey=h&&(!Zm||Jm||Om||Dm||fails((function(){return Ym[Bm]=!1,Hm(Qm)!==Qm||Hm(Ym)===Ym||"/a/i"!==String(Hm(Qm,"i"))})));if(Ir("RegExp",ey)){for(var ty=function RegExp(t,o){var s,l,h,m,_,E,$=Fe(Um,this),B=isRegexp(t),q=void 0===o,j=[],K=t;if(!$&&B&&q&&t.constructor===ty)return t;if((B||Fe(Um,t))&&(t=t.source,q&&(o=regexpGetFlags(K))),t=void 0===t?"":toString_1(t),o=void 0===o?"":toString_1(o),K=t,Om&&"dotAll"in Qm&&(l=!!o&&Gm(o,"s")>-1)&&(o=Vm(o,/s/g,"")),s=o,Jm&&"sticky"in Qm&&(h=!!o&&Gm(o,"y")>-1)&&Xm&&(o=Vm(o,/y/g,"")),Dm&&(m=function(t){for(var o,s=t.length,l=0,h="",m=[],_={},E=!1,$=!1,B=0,q="";l<=s;l++){if("\\"===(o=zm(t,l)))o+=zm(t,++l);else if("]"===o)E=!1;else if(!E)switch(!0){case"["===o:E=!0;break;case"("===o:jm(Wm,Km(t,l+1))&&(l+=2,$=!0),h+=o,B++;continue;case">"===o&&$:if(""===q||vt(_,q))throw new qm("Invalid capture group name");_[q]=!0,m[m.length]=[q,B],$=!1,q="";continue}$?q+=o:h+=o}return[h,m]}(t),t=m[0],j=m[1]),_=inheritIfRequired(Hm(t,o),$?this:Um,ty),(l||h||j.length)&&(E=Fm(_),l&&(E.dotAll=!0,E.raw=ty(function(t){for(var o,s=t.length,l=0,h="",m=!1;l<=s;l++)"\\"!==(o=zm(t,l))?m||"."!==o?("["===o?m=!0:"]"===o&&(m=!1),h+=o):h+="[\\s\\S]":h+=o+zm(t,++l);return h}(t),s)),h&&(E.sticky=!0),j.length&&(E.groups=j)),t!==K)try{qt(_,"source",""===K?"(?:)":K)}catch(t){}return _},ry=Lm(Hm),oy=0;ry.length>oy;)proxyAccessor(ty,Hm,ry[oy++]);Um.constructor=ty,ty.prototype=Um,defineBuiltIn(l,"RegExp",ty,{constructor:!0})}setSpecies("RegExp");var ny=ar.get,iy=RegExp.prototype,sy=TypeError;h&&Om&&defineBuiltInAccessor(iy,"dotAll",{configurable:!0,get:function dotAll(){if(this!==iy){if("RegExp"===classofRaw(this))return!!ny(this).dotAll;throw new sy("Incompatible receiver, RegExp required")}}});var ay=ar.get,ly=pt("native-string-replace",String.prototype.replace),cy=RegExp.prototype.exec,dy=cy,uy=re("".charAt),hy=re("".indexOf),py=re("".replace),fy=re("".slice),gy=function(){var t=/a/,o=/b*/g;return E(cy,t,"a"),E(cy,o,"a"),0!==t.lastIndex||0!==o.lastIndex}(),vy=$m.BROKEN_CARET,my=void 0!==/()??/.exec("")[1];(gy||my||vy||Om||Dm)&&(dy=function exec(t){var o,s,l,h,m,_,$,B=this,q=ay(B),j=toString_1(t),K=q.raw;if(K)return K.lastIndex=B.lastIndex,o=E(dy,K,j),B.lastIndex=K.lastIndex,o;var W=q.groups,X=vy&&B.sticky,re=E(regexpFlags,B),oe=B.source,ne=0,ae=j;if(X&&(re=py(re,"y",""),-1===hy(re,"g")&&(re+="g"),ae=fy(j,B.lastIndex),B.lastIndex>0&&(!B.multiline||B.multiline&&"\n"!==uy(j,B.lastIndex-1))&&(oe="(?: "+oe+")",ae=" "+ae,ne++),s=new RegExp("^(?:"+oe+")",re)),my&&(s=new RegExp("^"+oe+"$(?!\\s)",re)),gy&&(l=B.lastIndex),h=E(cy,X?s:B,ae),X?h?(h.input=fy(h.input,ne),h[0]=fy(h[0],ne),h.index=B.lastIndex,B.lastIndex+=h[0].length):B.lastIndex=0:gy&&h&&(B.lastIndex=B.global?h.index+h[0].length:l),my&&h&&h.length>1&&E(ly,h[0],s,(function(){for(m=1;m<arguments.length-2;m++)void 0===arguments[m]&&(h[m]=void 0)})),h&&W)for(h.groups=_=Gr(null),m=0;m<W.length;m++)_[($=W[m])[0]]=h[$[1]];return h});var yy=dy;_export({target:"RegExp",proto:!0,forced:/./.exec!==yy},{exec:yy});var by=l.RegExp,wy=by.prototype,Cy=h&&fails((function(){var t=!0;try{by(".","d")}catch(o){t=!1}var o={},s="",l=t?"dgimsy":"gimsy",addGetter=function(t,l){Object.defineProperty(o,t,{get:function(){return s+=l,!0}})},h={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var m in t&&(h.hasIndices="d"),h)addGetter(m,h[m]);return Object.getOwnPropertyDescriptor(wy,"flags").get.call(o)!==l||s!==l}));Cy&&defineBuiltInAccessor(wy,"flags",{configurable:!0,get:regexpFlags});var _y=$m.MISSED_STICKY,ky=ar.get,xy=RegExp.prototype,Sy=TypeError;h&&_y&&defineBuiltInAccessor(xy,"sticky",{configurable:!0,get:function sticky(){if(this!==xy){if("RegExp"===classofRaw(this))return!!ky(this).sticky;throw new Sy("Incompatible receiver, RegExp required")}}});var Ty,Ey,Ay=(Ty=!1,(Ey=/[ac]/).exec=function(){return Ty=!0,/./.exec.apply(this,arguments)},!0===Ey.test("abc")&&Ty),Iy=/./.test;_export({target:"RegExp",proto:!0,forced:!Ay},{test:function(t){var o=anObject(this),s=toString_1(t),l=o.exec;if(!Te(l))return E(Iy,o,s);var h=E(l,o,s);return null!==h&&(anObject(h),!0)}});var Py=Gt.PROPER,Ry="toString",$y=RegExp.prototype[Ry],My=fails((function(){return"/a/b"!==$y.call({source:"a",flags:"b"})})),Oy=Py&&$y.name!==Ry;(My||Oy)&&defineBuiltIn(RegExp.prototype,Ry,(function toString(){var t=anObject(this);return"/"+toString_1(t.source)+"/"+toString_1(regexpGetFlags(t))}),{unsafe:!0}),collection("Set",(function(t){return function Set(){return t(this,arguments.length?arguments[0]:void 0)}}),Eh);var Ny=re("".charAt),Dy=fails((function(){return"\ud842"!=="ð ®·".at(-2)}));_export({target:"String",proto:!0,forced:Dy},{at:function at(t){var o=toString_1(requireObjectCoercible(this)),s=o.length,l=toIntegerOrInfinity(t),h=l>=0?l:s+l;return h<0||h>=s?void 0:Ny(o,h)}});var Ly=re("".charAt),Fy=re("".charCodeAt),By=re("".slice),createMethod=function(t){return function(o,s){var l,h,m=toString_1(requireObjectCoercible(o)),_=toIntegerOrInfinity(s),E=m.length;return _<0||_>=E?t?"":void 0:(l=Fy(m,_))<55296||l>56319||_+1===E||(h=Fy(m,_+1))<56320||h>57343?t?Ly(m,_):l:t?By(m,_,_+2):h-56320+(l-55296<<10)+65536}},Hy={codeAt:createMethod(!1),charAt:createMethod(!0)},Uy=Hy.codeAt;_export({target:"String",proto:!0},{codePointAt:function codePointAt(t){return Uy(this,t)}});var qy=TypeError,notARegexp=function(t){if(isRegexp(t))throw new qy("The method doesn't accept regular expressions");return t},jy=wellKnownSymbol("match"),correctIsRegexpLogic=function(t){var o=/./;try{"/./"[t](o)}catch(s){try{return o[jy]=!1,"/./"[t](o)}catch(t){}}return!1},zy=Pt.f,Vy=functionUncurryThisClause("".endsWith),Gy=functionUncurryThisClause("".slice),Ky=Math.min,Wy=correctIsRegexpLogic("endsWith"),Qy=!Wy&&!!function(){var t=zy(String.prototype,"endsWith");return t&&!t.writable}();_export({target:"String",proto:!0,forced:!Qy&&!Wy},{endsWith:function endsWith(t){var o=toString_1(requireObjectCoercible(this));notARegexp(t);var s=arguments.length>1?arguments[1]:void 0,l=o.length,h=void 0===s?l:Ky(toLength(s),l),m=toString_1(t);return Vy?Vy(o,m,h):Gy(o,h-m.length,h)===m}});var Yy=RangeError,Zy=String.fromCharCode,Jy=String.fromCodePoint,Xy=re([].join),eb=!!Jy&&1!==Jy.length;_export({target:"String",stat:!0,arity:1,forced:eb},{fromCodePoint:function fromCodePoint(t){for(var o,s=[],l=arguments.length,h=0;l>h;){if(o=+arguments[h++],toAbsoluteIndex(o,1114111)!==o)throw new Yy(o+" is not a valid code point");s[h]=o<65536?Zy(o):Zy(55296+((o-=65536)>>10),o%1024+56320)}return Xy(s,"")}});var tb=re("".indexOf);_export({target:"String",proto:!0,forced:!correctIsRegexpLogic("includes")},{includes:function includes(t){return!!~tb(toString_1(requireObjectCoercible(this)),toString_1(notARegexp(t)),arguments.length>1?arguments[1]:void 0)}});var rb=re("".charCodeAt);_export({target:"String",proto:!0},{isWellFormed:function isWellFormed(){for(var t=toString_1(requireObjectCoercible(this)),o=t.length,s=0;s<o;s++){var l=rb(t,s);if(55296==(63488&l)&&(l>=56320||++s>=o||56320!=(64512&rb(t,s))))return!1}return!0}});var ob=Hy.charAt,nb="String Iterator",ab=ar.set,cb=ar.getterFor(nb);iteratorDefine(String,"String",(function(t){ab(this,{type:nb,string:toString_1(t),index:0})}),(function next(){var t,o=cb(this),s=o.string,l=o.index;return l>=s.length?createIterResultObject(void 0,!0):(t=ob(s,l),o.index+=t.length,createIterResultObject(t,!1))}));var db=wellKnownSymbol("species"),ub=RegExp.prototype,fixRegexpWellKnownSymbolLogic=function(t,o,s,l){var h=wellKnownSymbol(t),m=!fails((function(){var o={};return o[h]=function(){return 7},7!==""[t](o)})),_=m&&!fails((function(){var o=!1,s=/a/;return"split"===t&&((s={}).constructor={},s.constructor[db]=function(){return s},s.flags="",s[h]=/./[h]),s.exec=function(){return o=!0,null},s[h](""),!o}));if(!m||!_||s){var E=functionUncurryThisClause(/./[h]),$=o(h,""[t],(function(t,o,s,l,h){var _=functionUncurryThisClause(t),$=o.exec;return $===yy||$===ub.exec?m&&!h?{done:!0,value:E(o,s,l)}:{done:!0,value:_(s,o,l)}:{done:!1}}));defineBuiltIn(String.prototype,t,$[0]),defineBuiltIn(ub,h,$[1])}l&&qt(ub[h],"sham",!0)},hb=Hy.charAt,advanceStringIndex=function(t,o,s){return o+(s?hb(t,o).length:1)},pb=TypeError,regexpExecAbstract=function(t,o){var s=t.exec;if(Te(s)){var l=E(s,t,o);return null!==l&&anObject(l),l}if("RegExp"===classofRaw(t))return E(yy,t,o);throw new pb("RegExp#exec called on incompatible receiver")};fixRegexpWellKnownSymbolLogic("match",(function(t,o,s){return[function match(o){var s=requireObjectCoercible(this),l=isNullOrUndefined(o)?void 0:getMethod$1(o,t);return l?E(l,o,s):new RegExp(o)[t](toString_1(s))},function(t){var l=anObject(this),h=toString_1(t),m=s(o,l,h);if(m.done)return m.value;if(!l.global)return regexpExecAbstract(l,h);var _=l.unicode;l.lastIndex=0;for(var E,$=[],B=0;null!==(E=regexpExecAbstract(l,h));){var q=toString_1(E[0]);$[B]=q,""===q&&(l.lastIndex=advanceStringIndex(h,toLength(l.lastIndex),_)),B++}return 0===B?null:$}]}));var fb=wellKnownSymbol("matchAll"),gb="RegExp String",vb=gb+" Iterator",mb=ar.set,yb=ar.getterFor(vb),bb=RegExp.prototype,wb=TypeError,_b=functionUncurryThisClause("".indexOf),kb=functionUncurryThisClause("".matchAll),xb=!!kb&&!fails((function(){kb("a",/./)})),Sb=iteratorCreateConstructor((function RegExpStringIterator(t,o,s,l){mb(this,{type:vb,regexp:t,string:o,global:s,unicode:l,done:!1})}),gb,(function next(){var t=yb(this);if(t.done)return createIterResultObject(void 0,!0);var o=t.regexp,s=t.string,l=regexpExecAbstract(o,s);return null===l?(t.done=!0,createIterResultObject(void 0,!0)):t.global?(""===toString_1(l[0])&&(o.lastIndex=advanceStringIndex(s,toLength(o.lastIndex),t.unicode)),createIterResultObject(l,!1)):(t.done=!0,createIterResultObject(l,!1))})),$matchAll=function(t){var o,s,l,h=anObject(this),m=toString_1(t),_=speciesConstructor(h,RegExp),E=toString_1(regexpGetFlags(h));return o=new _(_===RegExp?h.source:h,E),s=!!~_b(E,"g"),l=!!~_b(E,"u"),o.lastIndex=toLength(h.lastIndex),new Sb(o,m,s,l)};_export({target:"String",proto:!0,forced:xb},{matchAll:function matchAll(t){var o,s,l,h=requireObjectCoercible(this);if(isNullOrUndefined(t)){if(xb)return kb(h,t)}else{if(isRegexp(t)&&(o=toString_1(requireObjectCoercible(regexpGetFlags(t))),!~_b(o,"g")))throw new wb("`.matchAll` does not allow non-global regexes");if(xb)return kb(h,t);if(l=getMethod$1(t,fb))return E(l,t,h)}return s=toString_1(h),new RegExp(t,"g")[fb](s)}}),fb in bb||defineBuiltIn(bb,fb,$matchAll);var Tb=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(He),Eb=cu.end;_export({target:"String",proto:!0,forced:Tb},{padEnd:function padEnd(t){return Eb(this,t,arguments.length>1?arguments[1]:void 0)}});var Ab=cu.start;_export({target:"String",proto:!0,forced:Tb},{padStart:function padStart(t){return Ab(this,t,arguments.length>1?arguments[1]:void 0)}});var Ib=re([].push),Pb=re([].join);_export({target:"String",stat:!0},{raw:function raw(t){var o=toIndexedObject(toObject(t).raw),s=lengthOfArrayLike(o);if(!s)return"";for(var l=arguments.length,h=[],m=0;;){if(Ib(h,toString_1(o[m++])),m===s)return Pb(h,"");m<l&&Ib(h,toString_1(arguments[m]))}}}),_export({target:"String",proto:!0},{repeat:iu});var Rb=Math.floor,Mb=re("".charAt),Ob=re("".replace),Db=re("".slice),Lb=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Fb=/\$([$&'`]|\d{1,2})/g,getSubstitution=function(t,o,s,l,h,m){var _=s+t.length,E=l.length,$=Fb;return void 0!==h&&(h=toObject(h),$=Lb),Ob(m,$,(function(m,$){var B;switch(Mb($,0)){case"$":return"$";case"&":return t;case"`":return Db(o,0,s);case"'":return Db(o,_);case"<":B=h[Db($,1,-1)];break;default:var q=+$;if(0===q)return m;if(q>E){var j=Rb(q/10);return 0===j?m:j<=E?void 0===l[j-1]?Mb($,1):l[j-1]+Mb($,1):m}B=l[q-1]}return void 0===B?"":B}))},Bb=wellKnownSymbol("replace"),Ub=Math.max,qb=Math.min,zb=re([].concat),Gb=re([].push),Kb=re("".indexOf),Wb=re("".slice),Qb="$0"==="a".replace(/./,"$0"),Yb=!!/./[Bb]&&""===/./[Bb]("a","$0"),Zb=!fails((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}));fixRegexpWellKnownSymbolLogic("replace",(function(t,o,s){var l=Yb?"$":"$0";return[function replace(t,s){var l=requireObjectCoercible(this),h=isNullOrUndefined(t)?void 0:getMethod$1(t,Bb);return h?E(h,t,l,s):E(o,toString_1(l),t,s)},function(t,h){var m=anObject(this),_=toString_1(t);if("string"==typeof h&&-1===Kb(h,l)&&-1===Kb(h,"$<")){var E=s(o,m,_,h);if(E.done)return E.value}var $=Te(h);$||(h=toString_1(h));var B,q=m.global;q&&(B=m.unicode,m.lastIndex=0);for(var j,K=[];null!==(j=regexpExecAbstract(m,_))&&(Gb(K,j),q);){""===toString_1(j[0])&&(m.lastIndex=advanceStringIndex(_,toLength(m.lastIndex),B))}for(var W,X="",re=0,oe=0;oe<K.length;oe++){for(var ne,ae=toString_1((j=K[oe])[0]),le=Ub(qb(toIntegerOrInfinity(j.index),_.length),0),de=[],me=1;me<j.length;me++)Gb(de,void 0===(W=j[me])?W:String(W));var we=j.groups;if($){var _e=zb([ae],de,le,_);void 0!==we&&Gb(_e,we),ne=toString_1(Jo(h,void 0,_e))}else ne=getSubstitution(ae,_,le,de,we,h);le>=re&&(X+=Wb(_,re,le)+ne,re=le+ae.length)}return X+Wb(_,re)}]}),!Zb||!Qb||Yb);var Jb=wellKnownSymbol("replace"),Xb=TypeError,ew=re("".indexOf);re("".replace);var tw=re("".slice),rw=Math.max,stringIndexOf=function(t,o,s){return s>t.length?-1:""===o?s:ew(t,o,s)};_export({target:"String",proto:!0},{replaceAll:function replaceAll(t,o){var s,l,h,m,_,$,B,q,j=requireObjectCoercible(this),K=0,W=0,X="";if(!isNullOrUndefined(t)){if(isRegexp(t)&&(s=toString_1(requireObjectCoercible(regexpGetFlags(t))),!~ew(s,"g")))throw new Xb("`.replaceAll` does not allow non-global regexes");if(l=getMethod$1(t,Jb))return E(l,t,j,o)}for(h=toString_1(j),m=toString_1(t),(_=Te(o))||(o=toString_1(o)),$=m.length,B=rw(1,$),K=stringIndexOf(h,m,0);-1!==K;)q=_?toString_1(o(m,K,h)):getSubstitution(m,h,K,[],void 0,o),X+=tw(h,W,K)+q,W=K+$,K=stringIndexOf(h,m,K+B);return W<h.length&&(X+=tw(h,W)),X}}),fixRegexpWellKnownSymbolLogic("search",(function(t,o,s){return[function search(o){var s=requireObjectCoercible(this),l=isNullOrUndefined(o)?void 0:getMethod$1(o,t);return l?E(l,o,s):new RegExp(o)[t](toString_1(s))},function(t){var l=anObject(this),h=toString_1(t),m=s(o,l,h);if(m.done)return m.value;var _=l.lastIndex;yg(_,0)||(l.lastIndex=0);var E=regexpExecAbstract(l,h);return yg(l.lastIndex,_)||(l.lastIndex=_),null===E?-1:E.index}]}));var ow=$m.UNSUPPORTED_Y,nw=4294967295,iw=Math.min,sw=[].push,aw=re(/./.exec),lw=re(sw),cw=re("".slice),dw=!fails((function(){var t=/(?:)/,o=t.exec;t.exec=function(){return o.apply(this,arguments)};var s="ab".split(t);return 2!==s.length||"a"!==s[0]||"b"!==s[1]}));fixRegexpWellKnownSymbolLogic("split",(function(t,o,s){var l;return l="c"==="abbc".split(/(b)*/)[1]||4!=="test".split(/(?:)/,-1).length||2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,s){var l=toString_1(requireObjectCoercible(this)),h=void 0===s?nw:s>>>0;if(0===h)return[];if(void 0===t)return[l];if(!isRegexp(t))return E(o,l,t,h);for(var m,_,$,B=[],q=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),j=0,K=new RegExp(t.source,q+"g");(m=E(yy,K,l))&&!((_=K.lastIndex)>j&&(lw(B,cw(l,j,m.index)),m.length>1&&m.index<l.length&&Jo(sw,B,arraySliceSimple(m,1)),$=m[0].length,j=_,B.length>=h));)K.lastIndex===m.index&&K.lastIndex++;return j===l.length?!$&&aw(K,"")||lw(B,""):lw(B,cw(l,j)),B.length>h?arraySliceSimple(B,0,h):B}:"0".split(void 0,0).length?function(t,s){return void 0===t&&0===s?[]:E(o,this,t,s)}:o,[function split(o,s){var h=requireObjectCoercible(this),m=isNullOrUndefined(o)?void 0:getMethod$1(o,t);return m?E(m,o,h,s):E(l,toString_1(h),o,s)},function(t,h){var m=anObject(this),_=toString_1(t),E=s(l,m,_,h,l!==o);if(E.done)return E.value;var $=speciesConstructor(m,RegExp),B=m.unicode,q=(m.ignoreCase?"i":"")+(m.multiline?"m":"")+(m.unicode?"u":"")+(ow?"g":"y"),j=new $(ow?"^(?:"+m.source+")":m,q),K=void 0===h?nw:h>>>0;if(0===K)return[];if(0===_.length)return null===regexpExecAbstract(j,_)?[_]:[];for(var W=0,X=0,re=[];X<_.length;){j.lastIndex=ow?0:X;var oe,ne=regexpExecAbstract(j,ow?cw(_,X):_);if(null===ne||(oe=iw(toLength(j.lastIndex+(ow?X:0)),_.length))===W)X=advanceStringIndex(_,X,B);else{if(lw(re,cw(_,W,X)),re.length===K)return re;for(var ae=1;ae<=ne.length-1;ae++)if(lw(re,ne[ae]),re.length===K)return re;X=W=oe}}return lw(re,cw(_,W)),re}]}),!dw,ow);var uw=Pt.f,hw=functionUncurryThisClause("".startsWith),pw=functionUncurryThisClause("".slice),fw=Math.min,gw=correctIsRegexpLogic("startsWith"),vw=!gw&&!!function(){var t=uw(String.prototype,"startsWith");return t&&!t.writable}();_export({target:"String",proto:!0,forced:!vw&&!gw},{startsWith:function startsWith(t){var o=toString_1(requireObjectCoercible(this));notARegexp(t);var s=toLength(fw(arguments.length>1?arguments[1]:void 0,o.length)),l=toString_1(t);return hw?hw(o,l,s):pw(o,s,s+l.length)===l}});var mw=re("".slice),yw=Math.max,bw=Math.min,ww=!"".substr||"b"!=="ab".substr(-1);_export({target:"String",proto:!0,forced:ww},{substr:function substr(t,o){var s,l,h=toString_1(requireObjectCoercible(this)),m=h.length,_=toIntegerOrInfinity(t);return _===1/0&&(_=0),_<0&&(_=yw(m+_,0)),(s=void 0===o?m:toIntegerOrInfinity(o))<=0||s===1/0||_>=(l=bw(_+s,m))?"":mw(h,_,l)}});var Cw=Array,_w=re("".charAt),kw=re("".charCodeAt),xw=re([].join),Sw="".toWellFormed,Tw=Sw&&fails((function(){return"1"!==E(Sw,1)}));_export({target:"String",proto:!0,forced:Tw},{toWellFormed:function toWellFormed(){var t=toString_1(requireObjectCoercible(this));if(Tw)return E(Sw,t);for(var o=t.length,s=Cw(o),l=0;l<o;l++){var h=kw(t,l);55296!=(63488&h)?s[l]=_w(t,l):h>=56320||l+1>=o||56320!=(64512&kw(t,l+1))?s[l]="ï¿½":(s[l]=_w(t,l),s[++l]=_w(t,l))}return xw(s,"")}});var Ew=Gt.PROPER,stringTrimForced=function(t){return fails((function(){return!!Sp[t]()||"âÂá "!=="âÂá "[t]()||Ew&&Sp[t].name!==t}))},Aw=Ip.trim;_export({target:"String",proto:!0,forced:stringTrimForced("trim")},{trim:function trim(){return Aw(this)}});var Iw=Ip.end,Pw=stringTrimForced("trimEnd")?function trimEnd(){return Iw(this)}:"".trimEnd;_export({target:"String",proto:!0,name:"trimEnd",forced:"".trimRight!==Pw},{trimRight:Pw}),_export({target:"String",proto:!0,name:"trimEnd",forced:"".trimEnd!==Pw},{trimEnd:Pw});var Rw=Ip.start,$w=stringTrimForced("trimStart")?function trimStart(){return Rw(this)}:"".trimStart;_export({target:"String",proto:!0,name:"trimStart",forced:"".trimLeft!==$w},{trimLeft:$w}),_export({target:"String",proto:!0,name:"trimStart",forced:"".trimStart!==$w},{trimStart:$w});var Mw=/"/g,Ow=re("".replace),createHtml=function(t,o,s,l){var h=toString_1(requireObjectCoercible(t)),m="<"+o;return""!==s&&(m+=" "+s+'="'+Ow(toString_1(l),Mw,"&quot;")+'"'),m+">"+h+"</"+o+">"},stringHtmlForced=function(t){return fails((function(){var o=""[t]('"');return o!==o.toLowerCase()||o.split('"').length>3}))};_export({target:"String",proto:!0,forced:stringHtmlForced("anchor")},{anchor:function anchor(t){return createHtml(this,"a","name",t)}}),_export({target:"String",proto:!0,forced:stringHtmlForced("big")},{big:function big(){return createHtml(this,"big","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("blink")},{blink:function blink(){return createHtml(this,"blink","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("bold")},{bold:function bold(){return createHtml(this,"b","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("fixed")},{fixed:function fixed(){return createHtml(this,"tt","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("fontcolor")},{fontcolor:function fontcolor(t){return createHtml(this,"font","color",t)}}),_export({target:"String",proto:!0,forced:stringHtmlForced("fontsize")},{fontsize:function fontsize(t){return createHtml(this,"font","size",t)}}),_export({target:"String",proto:!0,forced:stringHtmlForced("italics")},{italics:function italics(){return createHtml(this,"i","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("link")},{link:function link(t){return createHtml(this,"a","href",t)}}),_export({target:"String",proto:!0,forced:stringHtmlForced("small")},{small:function small(){return createHtml(this,"small","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("strike")},{strike:function strike(){return createHtml(this,"strike","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("sub")},{sub:function sub(){return createHtml(this,"sub","","")}}),_export({target:"String",proto:!0,forced:stringHtmlForced("sup")},{sup:function sup(){return createHtml(this,"sup","","")}});var Nw=Id.NATIVE_ARRAY_BUFFER_VIEWS,Dw=l.ArrayBuffer,Lw=l.Int8Array,Fw=!Nw||!fails((function(){Lw(1)}))||!fails((function(){new Lw(-1)}))||!checkCorrectnessOfIteration((function(t){new Lw,new Lw(null),new Lw(1.5),new Lw(t)}),!0)||fails((function(){return 1!==new Lw(new Dw(2),1,void 0).length})),Bw=RangeError,Hw=RangeError,toOffset=function(t,o){var s=function(t){var o=toIntegerOrInfinity(t);if(o<0)throw new Bw("The argument can't be less than 0");return o}(t);if(s%o)throw new Hw("Wrong offset");return s},Uw=Math.round,isBigIntArray=function(t){var o=Lr(t);return"BigInt64Array"===o||"BigUint64Array"===o},qw=TypeError,toBigInt=function(t){var o=toPrimitive(t,"number");if("number"==typeof o)throw new qw("Can't convert number to bigint");return BigInt(o)},jw=Id.aTypedArrayConstructor,zw=function from(t){var o,s,l,h,m,_,$,B,q=aConstructor(this),j=toObject(t),K=arguments.length,W=K>1?arguments[1]:void 0,X=void 0!==W,re=getIteratorMethod(j);if(re&&!isArrayIteratorMethod(re))for(B=($=getIterator$1(j,re)).next,j=[];!(_=E(B,$)).done;)j.push(_.value);for(X&&K>2&&(W=functionBindContext(W,arguments[2])),s=lengthOfArrayLike(j),l=new(jw(q))(s),h=isBigIntArray(l),o=0;s>o;o++)m=X?W(j[o],o):j[o],l[o]=h?toBigInt(m):+m;return l},Vw=createCommonjsModule((function(t){var o=wr.f,s=mo.forEach,m=ar.get,_=ar.set,$=ar.enforce,B=Ut.f,q=Pt.f,j=l.RangeError,K=Bc.ArrayBuffer,W=K.prototype,X=Bc.DataView,re=Id.NATIVE_ARRAY_BUFFER_VIEWS,oe=Id.TYPED_ARRAY_TAG,ne=Id.TypedArray,ae=Id.TypedArrayPrototype,le=Id.aTypedArrayConstructor,de=Id.isTypedArray,me="BYTES_PER_ELEMENT",we="Wrong length",fromList=function(t,o){le(t);for(var s=0,l=o.length,h=new t(l);l>s;)h[s]=o[s++];return h},addGetter=function(t,o){defineBuiltInAccessor(t,o,{configurable:!0,get:function(){return m(this)[o]}})},isArrayBuffer=function(t){var o;return Fe(W,t)||"ArrayBuffer"===(o=Lr(t))||"SharedArrayBuffer"===o},isTypedArrayIndex=function(t,o){return de(t)&&!it(o)&&o in t&&Vp(+o)&&o>=0},_e=function getOwnPropertyDescriptor(t,o){return o=toPropertyKey(o),isTypedArrayIndex(t,o)?createPropertyDescriptor(2,t[o]):q(t,o)},xe=function defineProperty(t,o,s){return o=toPropertyKey(o),!(isTypedArrayIndex(t,o)&&Ie(s)&&vt(s,"value"))||vt(s,"get")||vt(s,"set")||s.configurable||vt(s,"writable")&&!s.writable||vt(s,"enumerable")&&!s.enumerable?B(t,o,s):(t[o]=s.value,t)};h?(re||(Pt.f=_e,Ut.f=xe,addGetter(ae,"buffer"),addGetter(ae,"byteOffset"),addGetter(ae,"byteLength"),addGetter(ae,"length")),_export({target:"Object",stat:!0,forced:!re},{getOwnPropertyDescriptor:_e,defineProperty:xe}),t.exports=function(t,h,q){var W=t.match(/\d+/)[0]/8,le=t+(q?"Clamped":"")+"Array",_e="get"+t,xe="set"+t,Te=l[le],Ee=Te,Fe=Ee&&Ee.prototype,He={},setter=function(t,o,s){var l=m(t);l.view[xe](o*W+l.byteOffset,q?function(t){var o=Uw(t);return o<0?0:o>255?255:255&o}(s):s,!0)},addElement=function(t,o){B(t,o,{get:function(){return function(t,o){var s=m(t);return s.view[_e](o*W+s.byteOffset,!0)}(this,o)},set:function(t){return setter(this,o,t)},enumerable:!0})};re?Fw&&(Ee=h((function(t,o,s,l){return anInstance(t,Fe),inheritIfRequired(Ie(o)?isArrayBuffer(o)?void 0!==l?new Te(o,toOffset(s,W),l):void 0!==s?new Te(o,toOffset(s,W)):new Te(o):de(o)?fromList(Ee,o):E(zw,Ee,o):new Te(toIndex(o)),t,Ee)})),En&&En(Ee,ne),s(o(Te),(function(t){t in Ee||qt(Ee,t,Te[t])})),Ee.prototype=Fe):(Ee=h((function(t,o,s,l){anInstance(t,Fe);var h,m,$,B=0,q=0;if(Ie(o)){if(!isArrayBuffer(o))return de(o)?fromList(Ee,o):E(zw,Ee,o);h=o,q=toOffset(s,W);var re=o.byteLength;if(void 0===l){if(re%W)throw new j(we);if((m=re-q)<0)throw new j(we)}else if((m=toLength(l)*W)+q>re)throw new j(we);$=m/W}else $=toIndex(o),h=new K(m=$*W);for(_(t,{buffer:h,byteOffset:q,byteLength:m,length:$,view:new X(h)});B<$;)addElement(t,B++)})),En&&En(Ee,ne),Fe=Ee.prototype=Gr(ae)),Fe.constructor!==Ee&&qt(Fe,"constructor",Ee),$(Fe).TypedArrayConstructor=Ee,oe&&qt(Fe,oe,le);var qe=Ee!==Te;He[le]=Ee,_export({global:!0,constructor:!0,forced:qe,sham:!re},He),me in Ee||qt(Ee,me,W),me in Fe||qt(Fe,me,W),setSpecies(le)}):t.exports=function(){}}));Vw("Float32",(function(t){return function Float32Array(o,s,l){return t(this,o,s,l)}})),Vw("Float64",(function(t){return function Float64Array(o,s,l){return t(this,o,s,l)}})),Vw("Int8",(function(t){return function Int8Array(o,s,l){return t(this,o,s,l)}})),Vw("Int16",(function(t){return function Int16Array(o,s,l){return t(this,o,s,l)}})),Vw("Int32",(function(t){return function Int32Array(o,s,l){return t(this,o,s,l)}})),Vw("Uint8",(function(t){return function Uint8Array(o,s,l){return t(this,o,s,l)}})),Vw("Uint8",(function(t){return function Uint8ClampedArray(o,s,l){return t(this,o,s,l)}}),!0),Vw("Uint16",(function(t){return function Uint16Array(o,s,l){return t(this,o,s,l)}})),Vw("Uint32",(function(t){return function Uint32Array(o,s,l){return t(this,o,s,l)}}));var Gw=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("at",(function at(t){var o=Gw(this),s=lengthOfArrayLike(o),l=toIntegerOrInfinity(t),h=l>=0?l:s+l;return h<0||h>=s?void 0:o[h]}));var Kw=re(ns),Ww=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("copyWithin",(function copyWithin(t,o){return Kw(Ww(this),t,o,arguments.length>2?arguments[2]:void 0)}));var Qw=mo.every,Yw=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("every",(function every(t){return Qw(Yw(this),t,arguments.length>1?arguments[1]:void 0)}));var Zw=Id.aTypedArray,Jw=Id.exportTypedArrayMethod,Xw=re("".slice);Jw("fill",(function fill(t){var o=arguments.length;Zw(this);var s="Big"===Xw(Lr(this),0,3)?toBigInt(t):+t;return E(ls,this,s,o>1?arguments[1]:void 0,o>2?arguments[2]:void 0)}),fails((function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t})));var eC=Id.aTypedArrayConstructor,tC=Id.getTypedArrayConstructor,typedArraySpeciesConstructor=function(t){return eC(speciesConstructor(t,tC(t)))},rC=mo.filter,oC=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("filter",(function filter(t){return function(t,o){return arrayFromConstructorAndList(typedArraySpeciesConstructor(t),o)}(this,rC(oC(this),t,arguments.length>1?arguments[1]:void 0))}));var nC=mo.find,iC=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("find",(function find(t){return nC(iC(this),t,arguments.length>1?arguments[1]:void 0)}));var sC=mo.findIndex,aC=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("findIndex",(function findIndex(t){return sC(aC(this),t,arguments.length>1?arguments[1]:void 0)}));var lC=ms.findLast,cC=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("findLast",(function findLast(t){return lC(cC(this),t,arguments.length>1?arguments[1]:void 0)}));var dC=ms.findLastIndex,uC=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("findLastIndex",(function findLastIndex(t){return dC(uC(this),t,arguments.length>1?arguments[1]:void 0)}));var hC=mo.forEach,pC=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("forEach",(function forEach(t){hC(pC(this),t,arguments.length>1?arguments[1]:void 0)})),(0,Id.exportTypedArrayStaticMethod)("from",zw,Fw);var fC=gr.includes,gC=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("includes",(function includes(t){return fC(gC(this),t,arguments.length>1?arguments[1]:void 0)}));var vC=gr.indexOf,mC=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("indexOf",(function indexOf(t){return vC(mC(this),t,arguments.length>1?arguments[1]:void 0)}));var yC=wellKnownSymbol("iterator"),bC=l.Uint8Array,wC=re(na.values),CC=re(na.keys),_C=re(na.entries),kC=Id.aTypedArray,xC=Id.exportTypedArrayMethod,SC=bC&&bC.prototype,TC=!fails((function(){SC[yC].call([1])})),EC=!!SC&&SC.values&&SC[yC]===SC.values&&"values"===SC.values.name,AC=function values(){return wC(kC(this))};xC("entries",(function entries(){return _C(kC(this))}),TC),xC("keys",(function keys(){return CC(kC(this))}),TC),xC("values",AC,TC||!EC,{name:"values"}),xC(yC,AC,TC||!EC,{name:"values"});var IC=Id.aTypedArray,PC=Id.exportTypedArrayMethod,RC=re([].join);PC("join",(function join(t){return RC(IC(this),t)}));var $C=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("lastIndexOf",(function lastIndexOf(t){var o=arguments.length;return Jo(ma,$C(this),o>1?[t,arguments[1]]:[t])}));var MC=mo.map,OC=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("map",(function map(t){return MC(OC(this),t,arguments.length>1?arguments[1]:void 0,(function(t,o){return new(typedArraySpeciesConstructor(t))(o)}))}));var NC=Id.aTypedArrayConstructor;(0,Id.exportTypedArrayStaticMethod)("of",(function of(){for(var t=0,o=arguments.length,s=new(NC(this))(o);o>t;)s[t]=arguments[t++];return s}),Fw);var DC=tl.left,LC=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("reduce",(function reduce(t){var o=arguments.length;return DC(LC(this),t,o,o>1?arguments[1]:void 0)}));var FC=tl.right,BC=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("reduceRight",(function reduceRight(t){var o=arguments.length;return FC(BC(this),t,o,o>1?arguments[1]:void 0)}));var HC=Id.aTypedArray,UC=Id.exportTypedArrayMethod,qC=Math.floor;UC("reverse",(function reverse(){for(var t,o=this,s=HC(o).length,l=qC(s/2),h=0;h<l;)t=o[h],o[h++]=o[--s],o[s]=t;return o}));var jC=l.RangeError,zC=l.Int8Array,VC=zC&&zC.prototype,GC=VC&&VC.set,KC=Id.aTypedArray,WC=Id.exportTypedArrayMethod,QC=!fails((function(){var t=new Uint8ClampedArray(2);return E(GC,t,{length:1,0:3},1),3!==t[1]})),YC=QC&&Id.NATIVE_ARRAY_BUFFER_VIEWS&&fails((function(){var t=new zC(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));WC("set",(function set(t){KC(this);var o=toOffset(arguments.length>1?arguments[1]:void 0,1),s=toObject(t);if(QC)return E(GC,this,s,o);var l=this.length,h=lengthOfArrayLike(s),m=0;if(h+o>l)throw new jC("Wrong length");for(;m<h;)this[o+m]=s[m++]}),!QC||YC);var ZC=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("slice",(function slice(t,o){for(var s=Xo(ZC(this),t,o),l=typedArraySpeciesConstructor(this),h=0,m=s.length,_=new l(m);m>h;)_[h]=s[h++];return _}),fails((function(){new Int8Array(1).slice()})));var JC=mo.some,XC=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("some",(function some(t){return JC(XC(this),t,arguments.length>1?arguments[1]:void 0)}));var e_=Id.aTypedArray,t_=Id.exportTypedArrayMethod,r_=l.Uint16Array,o_=r_&&functionUncurryThisClause(r_.prototype.sort),n_=!(!o_||fails((function(){o_(new r_(2),null)}))&&fails((function(){o_(new r_(2),{})}))),i_=!!o_&&!fails((function(){if(et)return et<74;if(yl)return yl<67;if(bl)return!0;if(Cl)return Cl<602;var t,o,s=new r_(516),l=Array(516);for(t=0;t<516;t++)o=t%4,s[t]=515-t,l[t]=t-2*o+3;for(o_(s,(function(t,o){return(t/4|0)-(o/4|0)})),t=0;t<516;t++)if(s[t]!==l[t])return!0}));t_("sort",(function sort(t){return void 0!==t&&aCallable(t),i_?o_(this,t):vl(e_(this),function(t){return function(o,s){return void 0!==t?+t(o,s)||0:s!=s?-1:o!=o?1:0===o&&0===s?1/o>0&&1/s<0?1:-1:o>s}}(t))}),!i_||n_);var s_=Id.aTypedArray;(0,Id.exportTypedArrayMethod)("subarray",(function subarray(t,o){var s=s_(this),l=s.length,h=toAbsoluteIndex(t,l);return new(typedArraySpeciesConstructor(s))(s.buffer,s.byteOffset+h*s.BYTES_PER_ELEMENT,toLength((void 0===o?l:toAbsoluteIndex(o,l))-h))}));var a_=l.Int8Array,l_=Id.aTypedArray,c_=Id.exportTypedArrayMethod,d_=[].toLocaleString,u_=!!a_&&fails((function(){d_.call(new a_(1))}));c_("toLocaleString",(function toLocaleString(){return Jo(d_,u_?Xo(l_(this)):l_(this),Xo(arguments))}),fails((function(){return[1,2].toLocaleString()!==new a_([1,2]).toLocaleString()}))||!fails((function(){a_.prototype.toLocaleString.call([1,2])})));var h_=Id.aTypedArray,p_=Id.getTypedArrayConstructor;(0,Id.exportTypedArrayMethod)("toReversed",(function toReversed(){return arrayToReversed(h_(this),p_(this))}));var f_=Id.aTypedArray,g_=Id.getTypedArrayConstructor,v_=Id.exportTypedArrayMethod,m_=re(Id.TypedArrayPrototype.sort);v_("toSorted",(function toSorted(t){void 0!==t&&aCallable(t);var o=f_(this),s=arrayFromConstructorAndList(g_(o),o);return m_(s,t)}));var y_=Id.exportTypedArrayMethod,b_=l.Uint8Array,w_=b_&&b_.prototype||{},C_=[].toString,k_=re([].join);fails((function(){C_.call({})}))&&(C_=function toString(){return k_(this)});var x_=w_.toString!==C_;y_("toString",C_,x_);var S_=Id.aTypedArray,T_=Id.getTypedArrayConstructor,E_=Id.exportTypedArrayMethod,A_=!!function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(t){return 8===t}}();E_("with",{with:function(t,o){var s=S_(this),l=toIntegerOrInfinity(t),h=isBigIntArray(s)?toBigInt(o):+o;return arrayWith(s,T_(s),l,h)}}.with,!A_);var I_=String.fromCharCode,P_=re("".charAt),R_=re(/./.exec),$_=re("".slice),M_=/^[\da-f]{2}$/i,O_=/^[\da-f]{4}$/i;_export({global:!0},{unescape:function unescape(t){for(var o,s,l=toString_1(t),h="",m=l.length,_=0;_<m;){if("%"===(o=P_(l,_++)))if("u"===P_(l,_)){if(s=$_(l,_+1,_+5),R_(O_,s)){h+=I_(parseInt(s,16)),_+=5;continue}}else if(s=$_(l,_,_+2),R_(M_,s)){h+=I_(parseInt(s,16)),_+=2;continue}h+=o}return h}});var N_=_h.getWeakData,D_=ar.set,L_=ar.getterFor,F_=mo.find,B_=mo.findIndex,H_=re([].splice),U_=0,uncaughtFrozenStore=function(t){return t.frozen||(t.frozen=new UncaughtFrozenStore)},UncaughtFrozenStore=function(){this.entries=[]},findUncaughtFrozen=function(t,o){return F_(t.entries,(function(t){return t[0]===o}))};UncaughtFrozenStore.prototype={get:function(t){var o=findUncaughtFrozen(this,t);if(o)return o[1]},has:function(t){return!!findUncaughtFrozen(this,t)},set:function(t,o){var s=findUncaughtFrozen(this,t);s?s[1]=o:this.entries.push([t,o])},delete:function(t){var o=B_(this.entries,(function(o){return o[0]===t}));return~o&&H_(this.entries,o,1),!!~o}};var q_,j_={getConstructor:function(t,o,s,l){var h=t((function(t,h){anInstance(t,m),D_(t,{type:o,id:U_++,frozen:void 0}),isNullOrUndefined(h)||iterate(h,t[l],{that:t,AS_ENTRIES:s})})),m=h.prototype,_=L_(o),define=function(t,o,s){var l=_(t),h=N_(anObject(o),!0);return!0===h?uncaughtFrozenStore(l).set(o,s):h[l.id]=s,t};return defineBuiltIns(m,{delete:function(t){var o=_(this);if(!Ie(t))return!1;var s=N_(t);return!0===s?uncaughtFrozenStore(o).delete(t):s&&vt(s,o.id)&&delete s[o.id]},has:function has(t){var o=_(this);if(!Ie(t))return!1;var s=N_(t);return!0===s?uncaughtFrozenStore(o).has(t):s&&vt(s,o.id)}}),defineBuiltIns(m,s?{get:function get(t){var o=_(this);if(Ie(t)){var s=N_(t);return!0===s?uncaughtFrozenStore(o).get(t):s?s[o.id]:void 0}},set:function set(t,o){return define(this,t,o)}}:{add:function add(t){return define(this,t,!0)}}),h}},z_=ar.enforce,V_=Object,G_=Array.isArray,K_=V_.isExtensible,W_=V_.isFrozen,Q_=V_.isSealed,Y_=V_.freeze,Z_=V_.seal,J_={},X_={},ek=!l.ActiveXObject&&"ActiveXObject"in l,wrapper=function(t){return function WeakMap(){return t(this,arguments.length?arguments[0]:void 0)}},tk=collection("WeakMap",wrapper,j_),rk=tk.prototype,ok=re(rk.set);if(Xt)if(ek){q_=j_.getConstructor(wrapper,"WeakMap",!0),_h.enable();var nk=re(rk.delete),ik=re(rk.has),sk=re(rk.get);defineBuiltIns(rk,{delete:function(t){if(Ie(t)&&!K_(t)){var o=z_(this);return o.frozen||(o.frozen=new q_),nk(this,t)||o.frozen.delete(t)}return nk(this,t)},has:function has(t){if(Ie(t)&&!K_(t)){var o=z_(this);return o.frozen||(o.frozen=new q_),ik(this,t)||o.frozen.has(t)}return ik(this,t)},get:function get(t){if(Ie(t)&&!K_(t)){var o=z_(this);return o.frozen||(o.frozen=new q_),ik(this,t)?sk(this,t):o.frozen.get(t)}return sk(this,t)},set:function set(t,o){if(Ie(t)&&!K_(t)){var s=z_(this);s.frozen||(s.frozen=new q_),ik(this,t)?ok(this,t,o):s.frozen.set(t,o)}else ok(this,t,o);return this}})}else Ch&&fails((function(){var t=Y_([]);return ok(new tk,t,1),!W_(t)}))&&defineBuiltIns(rk,{set:function set(t,o){var s;return G_(t)&&(W_(t)?s=J_:Q_(t)&&(s=X_)),ok(this,t,o),s===J_&&Y_(t),s===X_&&Z_(t),this}});collection("WeakSet",(function(t){return function WeakSet(){return t(this,arguments.length?arguments[0]:void 0)}}),j_);for(var ak="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",lk={},ck=0;ck<66;ck++)lk[ak.charAt(ck)]=ck;var dk={itoc:ak,ctoi:lk},uk=dk.ctoi,hk=/[^\d+/a-z]/i,pk=/[\t\n\f\r ]+/g,fk=/[=]{1,2}$/,gk=getBuiltIn("atob"),vk=String.fromCharCode,mk=re("".charAt),yk=re("".replace),bk=re(hk.exec),wk=fails((function(){return""!==gk(" ")})),Ck=!fails((function(){gk("a")})),_k=!wk&&!Ck&&!fails((function(){gk()})),kk=!wk&&!Ck&&1!==gk.length;_export({global:!0,bind:!0,enumerable:!0,forced:wk||Ck||_k||kk},{atob:function atob(t){if(validateArgumentsLength(arguments.length,1),_k||kk)return E(gk,l,t);var o,s,h=yk(toString_1(t),pk,""),m="",_=0,$=0;if(h.length%4==0&&(h=yk(h,fk,"")),h.length%4==1||bk(hk,h))throw new(getBuiltIn("DOMException"))("The string is not correctly encoded","InvalidCharacterError");for(;o=mk(h,_++);)vt(uk,o)&&(s=$%4?64*s+uk[o]:uk[o],$++%4&&(m+=vk(255&s>>(-2*$&6))));return m}});var xk=dk.itoc,Sk=getBuiltIn("btoa"),Tk=re("".charAt),Ek=re("".charCodeAt),Ak=!!Sk&&!fails((function(){Sk()})),Ik=!!Sk&&fails((function(){return"bnVsbA=="!==Sk(null)})),Pk=!!Sk&&1!==Sk.length;_export({global:!0,bind:!0,enumerable:!0,forced:Ak||Ik||Pk},{btoa:function btoa(t){if(validateArgumentsLength(arguments.length,1),Ak||Ik||Pk)return E(Sk,l,toString_1(t));for(var o,s,h=toString_1(t),m="",_=0,$=xk;Tk(h,_)||($="=",_%1);){if((s=Ek(h,_+=3/4))>255)throw new(getBuiltIn("DOMException"))("The string contains characters outside of the Latin1 range","InvalidCharacterError");m+=Tk($,63&(o=o<<8|s)>>8-_%1*8)}return m}});var Rk={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},$k=documentCreateElement("span").classList,Mk=$k&&$k.constructor&&$k.constructor.prototype,Ok=Mk===Object.prototype?void 0:Mk,handlePrototype$1=function(t){if(t&&t.forEach!==_s)try{qt(t,"forEach",_s)}catch(o){t.forEach=_s}};for(var Nk in Rk)Rk[Nk]&&handlePrototype$1(l[Nk]&&l[Nk].prototype);handlePrototype$1(Ok);var Dk=wellKnownSymbol("iterator"),Lk=wellKnownSymbol("toStringTag"),Fk=na.values,handlePrototype=function(t,o){if(t){if(t[Dk]!==Fk)try{qt(t,Dk,Fk)}catch(o){t[Dk]=Fk}if(t[Lk]||qt(t,Lk,o),Rk[o])for(var s in na)if(t[s]!==na[s])try{qt(t,s,na[s])}catch(o){t[s]=na[s]}}};for(var Bk in Rk)handlePrototype(l[Bk]&&l[Bk].prototype,Bk);handlePrototype(Ok,"DOMTokenList");var tryNodeRequire=function(t){try{if(rl)return Function('return require("'+t+'")')()}catch(t){}},Hk={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}},Uk=Ut.f,qk="DOMException",jk="DATA_CLONE_ERR",zk=getBuiltIn("Error"),Vk=getBuiltIn(qk)||function(){try{(new(getBuiltIn("MessageChannel")||tryNodeRequire("worker_threads").MessageChannel)).port1.postMessage(new WeakMap)}catch(t){if(t.name===jk&&25===t.code)return t.constructor}}(),Gk=Vk&&Vk.prototype,Kk=zk.prototype,Wk=ar.set,Qk=ar.getterFor(qk),Yk="stack"in new zk(qk),codeFor=function(t){return vt(Hk,t)&&Hk[t].m?Hk[t].c:0},Zk=function DOMException(){anInstance(this,Jk);var t=arguments.length,o=normalizeStringArgument(t<1?void 0:arguments[0]),s=normalizeStringArgument(t<2?void 0:arguments[1],"Error"),l=codeFor(s);if(Wk(this,{type:qk,name:s,message:o,code:l}),h||(this.name=s,this.message=o,this.code=l),Yk){var m=new zk(o);m.name=qk,Uk(this,"stack",createPropertyDescriptor(1,errorStackClear(m.stack,1)))}},Jk=Zk.prototype=Gr(Kk),createGetterDescriptor=function(t){return{enumerable:!0,configurable:!0,get:t}},getterFor=function(t){return createGetterDescriptor((function(){return Qk(this)[t]}))};h&&(defineBuiltInAccessor(Jk,"code",getterFor("code")),defineBuiltInAccessor(Jk,"message",getterFor("message")),defineBuiltInAccessor(Jk,"name",getterFor("name"))),Uk(Jk,"constructor",createPropertyDescriptor(1,Zk));var Xk=fails((function(){return!(new Vk instanceof zk)})),ex=Xk||fails((function(){return Kk.toString!==Hn||"2: 1"!==String(new Vk(1,2))})),tx=Xk||fails((function(){return 25!==new Vk(1,"DataCloneError").code}));Xk||25!==Vk[jk]||Gk[jk];_export({global:!0,constructor:!0,forced:Xk},{DOMException:Xk?Zk:Vk});var rx=getBuiltIn(qk),ox=rx.prototype;for(var nx in ex&&Vk===rx&&defineBuiltIn(ox,"toString",Hn),tx&&h&&Vk===rx&&defineBuiltInAccessor(ox,"code",createGetterDescriptor((function(){return codeFor(anObject(this).name)}))),Hk)if(vt(Hk,nx)){var ix=Hk[nx],sx=ix.s,ax=createPropertyDescriptor(6,ix.c);vt(rx,sx)||Uk(rx,sx,ax),vt(ox,sx)||Uk(ox,sx,ax)}var lx=Ut.f,cx="DOMException",dx=getBuiltIn("Error"),ux=getBuiltIn(cx),hx=function DOMException(){anInstance(this,px);var t=arguments.length,o=normalizeStringArgument(t<1?void 0:arguments[0]),s=normalizeStringArgument(t<2?void 0:arguments[1],"Error"),l=new ux(o,s),h=new dx(o);return h.name=cx,lx(l,"stack",createPropertyDescriptor(1,errorStackClear(h.stack,1))),inheritIfRequired(l,this,hx),l},px=hx.prototype=ux.prototype,fx="stack"in new dx(cx),gx="stack"in new ux(1,2),vx=ux&&h&&Object.getOwnPropertyDescriptor(l,cx),mx=!(!vx||vx.writable&&vx.configurable),yx=fx&&!mx&&!gx;_export({global:!0,constructor:!0,forced:yx},{DOMException:yx?hx:ux});var bx=getBuiltIn(cx),wx=bx.prototype;if(wx.constructor!==bx)for(var Cx in lx(wx,"constructor",createPropertyDescriptor(1,bx)),Hk)if(vt(Hk,Cx)){var _x=Hk[Cx],kx=_x.s;vt(bx,kx)||lx(bx,kx,createPropertyDescriptor(6,_x.c))}var xx="DOMException";setToStringTag(getBuiltIn(xx),xx);var Sx=hv.clear;_export({global:!0,bind:!0,enumerable:!0,forced:l.clearImmediate!==Sx},{clearImmediate:Sx});var Tx="function"==typeof Bun&&Bun&&"string"==typeof Bun.version,Ex=l.Function,Ax=/MSIE .\./.test(He)||Tx&&function(){var t=l.Bun.version.split(".");return t.length<3||"0"===t[0]&&(t[1]<3||"3"===t[1]&&"0"===t[2])}(),schedulersFix=function(t,o){var s=o?2:1;return Ax?function(l,h){var m=validateArgumentsLength(arguments.length,1)>s,_=Te(l)?l:Ex(l),E=m?Xo(arguments,s):[],$=m?function(){Jo(_,this,E)}:_;return o?t($,h):t($)}:t},Ix=hv.set,Px=l.setImmediate?schedulersFix(Ix,!1):Ix;_export({global:!0,bind:!0,enumerable:!0,forced:l.setImmediate!==Px},{setImmediate:Px});var Rx=l.process;_export({global:!0,enumerable:!0,dontCallGetSet:!0},{queueMicrotask:function queueMicrotask(t){validateArgumentsLength(arguments.length,1),aCallable(t);var o=rl&&Rx.domain;Pv(o?o.bind(t):t)}});var $x=TypeError,Mx=Object.defineProperty,Ox=l.self!==l;try{if(h){var Nx=Object.getOwnPropertyDescriptor(l,"self");!Ox&&Nx&&Nx.get&&Nx.enumerable||defineBuiltInAccessor(l,"self",{get:function self(){return l},set:function self(t){if(this!==l)throw new $x("Illegal invocation");Mx(l,"self",{value:t,writable:!0,configurable:!0,enumerable:!0})},configurable:!0,enumerable:!0})}else _export({global:!0,simple:!0,forced:Ox},{self:l})}catch(t){}var Dx,Lx,Fx,Bx,Hx=Map.prototype,Ux={Map:Map,set:re(Hx.set),get:re(Hx.get),has:re(Hx.has),remove:re(Hx.delete),proto:Hx},qx=Set.prototype,jx={Set:Set,add:re(qx.add),has:re(qx.has),remove:re(qx.delete),proto:qx},zx=TypeError,Vx=functionUncurryThisAccessor(ArrayBuffer.prototype,"byteLength","get")||function(t){if("ArrayBuffer"!==classofRaw(t))throw new zx("ArrayBuffer expected");return t.byteLength},Gx=re(ArrayBuffer.prototype.slice),Kx=l.structuredClone,Wx=!!Kx&&!fails((function(){if($v&&et>92||rl&&et>94||Mv&&et>97)return!1;var t=new ArrayBuffer(8),o=Kx(t,{transfer:[t]});return 0!==t.byteLength||8!==o.byteLength})),Qx=l.structuredClone,Yx=l.ArrayBuffer,Zx=l.MessageChannel,Jx=!1;if(Wx)Jx=function(t){Qx(t,{transfer:[t]})};else if(Yx)try{Zx||(Dx=tryNodeRequire("worker_threads"))&&(Zx=Dx.MessageChannel),Zx&&(Lx=new Zx,Fx=new Yx(2),Bx=function(t){Lx.port1.postMessage(null,[t])},2===Fx.byteLength&&(Bx(Fx),0===Fx.byteLength&&(Jx=Bx)))}catch(t){}var Xx,eS=Jx,tS=l.structuredClone,rS=l.ArrayBuffer,oS=l.DataView,nS=l.TypeError,iS=Math.min,sS=rS.prototype,aS=oS.prototype,lS=re(sS.slice),cS=functionUncurryThisAccessor(sS,"resizable","get"),dS=functionUncurryThisAccessor(sS,"maxByteLength","get"),uS=re(aS.getInt8),hS=re(aS.setInt8),pS=(Wx||eS)&&function(t,o,s){var l,h=Vx(t),m=void 0===o?h:toIndex(o),_=!cS||!cS(t);if(function(t){if(0!==Vx(t))return!1;try{return Gx(t,0,0),!1}catch(t){return!0}}(t))throw new nS("ArrayBuffer is detached");if(Wx&&(t=tS(t,{transfer:[t]}),h===m&&(s||_)))return t;if(h>=m&&(!s||_))l=lS(t,0,m);else{var E=s&&!_&&dS?{maxByteLength:dS(t)}:void 0;l=new rS(m,E);for(var $=new oS(t),B=new oS(l),q=iS(m,h),j=0;j<q;j++)hS(B,j,uS($,j))}return Wx||eS(t),l},fS=l.Object,gS=l.Array,vS=l.Date,mS=l.Error,yS=l.EvalError,bS=l.RangeError,wS=l.ReferenceError,CS=l.SyntaxError,_S=l.TypeError,kS=l.URIError,xS=l.PerformanceMark,SS=l.WebAssembly,TS=SS&&SS.CompileError||mS,ES=SS&&SS.LinkError||mS,AS=SS&&SS.RuntimeError||mS,IS=getBuiltIn("DOMException"),PS=Ux.Map,RS=Ux.has,$S=Ux.get,MS=Ux.set,OS=jx.Set,NS=jx.add,DS=getBuiltIn("Object","keys"),LS=re([].push),FS=re((!0).valueOf),BS=re(1..valueOf),HS=re("".valueOf),US=re(vS.prototype.getTime),qS=uid("structuredClone"),jS="DataCloneError",zS="Transferring",checkBasicSemantic=function(t){return!fails((function(){var o=new l.Set([7]),s=t(o),h=t(fS(7));return s===o||!s.has(7)||"object"!=typeof h||7!=+h}))&&t},checkErrorsCloning=function(t,o){return!fails((function(){var s=new o,l=t({a:s,b:s});return!(l&&l.a===l.b&&l.a instanceof o&&l.a.stack===s.stack)}))},VS=l.structuredClone,GS=!checkErrorsCloning(VS,mS)||!checkErrorsCloning(VS,IS)||(Xx=VS,!!fails((function(){var t=Xx(new l.AggregateError([1],qS,{cause:3}));return"AggregateError"!==t.name||1!==t.errors[0]||t.message!==qS||3!==t.cause}))),KS=!VS&&checkBasicSemantic((function(t){return new xS(qS,{detail:t}).detail})),WS=checkBasicSemantic(VS)||KS,throwUncloneable=function(t){throw new IS("Uncloneable type: "+t,jS)},throwUnpolyfillable=function(t,o){throw new IS((o||"Cloning")+" of "+t+" cannot be properly polyfilled in this engine",jS)},tryNativeRestrictedStructuredClone=function(t,o){return WS||throwUnpolyfillable(o),WS(t)},cloneBuffer=function(t,o,s){if(RS(o,t))return $S(o,t);var h,m,_,E,$,B;if("SharedArrayBuffer"===(s||Lr(t)))h=WS?WS(t):t;else{var q=l.DataView;q||"function"==typeof t.slice||throwUnpolyfillable("ArrayBuffer");try{if("function"!=typeof t.slice||t.resizable){m=t.byteLength,_="maxByteLength"in t?{maxByteLength:t.maxByteLength}:void 0,h=new ArrayBuffer(m,_),E=new q(t),$=new q(h);for(B=0;B<m;B++)$.setUint8(B,E.getUint8(B))}else h=t.slice(0)}catch(t){throw new IS("ArrayBuffer is detached",jS)}}return MS(o,t,h),h},cloneView=function(t,o,s,h,m){var _=l[o];return Ie(_)||throwUnpolyfillable(o),new _(cloneBuffer(t.buffer,m),s,h)},Placeholder=function(t,o,s){this.object=t,this.type=o,this.metadata=s},structuredCloneInternal=function(t,o,s){if(it(t)&&throwUncloneable("Symbol"),!Ie(t))return t;if(o){if(RS(o,t))return $S(o,t)}else o=new PS;var h,m,_,E,$,B,q,j,K=Lr(t);switch(K){case"Array":_=gS(lengthOfArrayLike(t));break;case"Object":_={};break;case"Map":_=new PS;break;case"Set":_=new OS;break;case"RegExp":_=new RegExp(t.source,regexpGetFlags(t));break;case"Error":switch(m=t.name){case"AggregateError":_=new(getBuiltIn("AggregateError"))([]);break;case"EvalError":_=new yS;break;case"RangeError":_=new bS;break;case"ReferenceError":_=new wS;break;case"SyntaxError":_=new CS;break;case"TypeError":_=new _S;break;case"URIError":_=new kS;break;case"CompileError":_=new TS;break;case"LinkError":_=new ES;break;case"RuntimeError":_=new AS;break;default:_=new mS}break;case"DOMException":_=new IS(t.message,t.name);break;case"ArrayBuffer":case"SharedArrayBuffer":_=s?new Placeholder(t,K):cloneBuffer(t,o,K);break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float16Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":B="DataView"===K?t.byteLength:t.length,_=s?new Placeholder(t,K,{offset:t.byteOffset,length:B}):cloneView(t,K,t.byteOffset,B,o);break;case"DOMQuad":try{_=new DOMQuad(structuredCloneInternal(t.p1,o,s),structuredCloneInternal(t.p2,o,s),structuredCloneInternal(t.p3,o,s),structuredCloneInternal(t.p4,o,s))}catch(o){_=tryNativeRestrictedStructuredClone(t,K)}break;case"File":if(WS)try{_=WS(t),Lr(_)!==K&&(_=void 0)}catch(t){}if(!_)try{_=new File([t],t.name,t)}catch(t){}_||throwUnpolyfillable(K);break;case"FileList":if(E=function(){var t;try{t=new l.DataTransfer}catch(o){try{t=new l.ClipboardEvent("").clipboardData}catch(t){}}return t&&t.items&&t.files?t:null}()){for($=0,B=lengthOfArrayLike(t);$<B;$++)E.items.add(structuredCloneInternal(t[$],o,s));_=E.files}else _=tryNativeRestrictedStructuredClone(t,K);break;case"ImageData":try{_=new ImageData(structuredCloneInternal(t.data,o,s),t.width,t.height,{colorSpace:t.colorSpace})}catch(o){_=tryNativeRestrictedStructuredClone(t,K)}break;default:if(WS)_=WS(t);else switch(K){case"BigInt":_=fS(t.valueOf());break;case"Boolean":_=fS(FS(t));break;case"Number":_=fS(BS(t));break;case"String":_=fS(HS(t));break;case"Date":_=new vS(US(t));break;case"Blob":try{_=t.slice(0,t.size,t.type)}catch(t){throwUnpolyfillable(K)}break;case"DOMPoint":case"DOMPointReadOnly":h=l[K];try{_=h.fromPoint?h.fromPoint(t):new h(t.x,t.y,t.z,t.w)}catch(t){throwUnpolyfillable(K)}break;case"DOMRect":case"DOMRectReadOnly":h=l[K];try{_=h.fromRect?h.fromRect(t):new h(t.x,t.y,t.width,t.height)}catch(t){throwUnpolyfillable(K)}break;case"DOMMatrix":case"DOMMatrixReadOnly":h=l[K];try{_=h.fromMatrix?h.fromMatrix(t):new h(t)}catch(t){throwUnpolyfillable(K)}break;case"AudioData":case"VideoFrame":Te(t.clone)||throwUnpolyfillable(K);try{_=t.clone()}catch(t){throwUncloneable(K)}break;case"CropTarget":case"CryptoKey":case"FileSystemDirectoryHandle":case"FileSystemFileHandle":case"FileSystemHandle":case"GPUCompilationInfo":case"GPUCompilationMessage":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":throwUnpolyfillable(K);default:throwUncloneable(K)}}switch(MS(o,t,_),K){case"Array":case"Object":for(q=DS(t),$=0,B=lengthOfArrayLike(q);$<B;$++)j=q[$],createProperty(_,j,structuredCloneInternal(t[j],o,s));break;case"Map":t.forEach((function(t,l){MS(_,structuredCloneInternal(l,o,s),structuredCloneInternal(t,o,s))}));break;case"Set":t.forEach((function(t){NS(_,structuredCloneInternal(t,o,s))}));break;case"Error":qt(_,"message",structuredCloneInternal(t.message,o,s)),vt(t,"cause")&&qt(_,"cause",structuredCloneInternal(t.cause,o,s)),"AggregateError"===m&&(_.errors=structuredCloneInternal(t.errors,o,s));case"DOMException":On&&qt(_,"stack",structuredCloneInternal(t.stack,o,s))}return _},replacePlaceholders=function(t,o){if(!Ie(t))return t;if(RS(o,t))return $S(o,t);var s,l,h,m,_,E,$,B;if(t instanceof Placeholder)switch(s=t.type,l=t.object,s){case"ArrayBuffer":case"SharedArrayBuffer":B=cloneBuffer(l,o,s);break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float16Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":h=t.metadata,B=cloneView(l,s,h.offset,h.length,o)}else switch(Lr(t)){case"Array":case"Object":for(E=DS(t),m=0,_=lengthOfArrayLike(E);m<_;m++)t[$=E[m]]=replacePlaceholders(t[$],o);break;case"Map":B=new PS,t.forEach((function(t,s){MS(B,replacePlaceholders(s,o),replacePlaceholders(t,o))}));break;case"Set":B=new OS,t.forEach((function(t){NS(B,replacePlaceholders(t,o))}));break;case"Error":t.message=replacePlaceholders(t.message,o),vt(t,"cause")&&(t.cause=replacePlaceholders(t.cause,o)),"AggregateError"===t.name&&(t.errors=replacePlaceholders(t.errors,o));case"DOMException":On&&(t.stack=replacePlaceholders(t.stack,o))}return MS(o,t,B||t),B||t};_export({global:!0,enumerable:!0,sham:!Wx,forced:GS},{structuredClone:function structuredClone(t){var o,s,h=validateArgumentsLength(arguments.length,1)>1&&!isNullOrUndefined(arguments[1])?anObject(arguments[1]):void 0,m=h?h.transfer:void 0,_=!1;void 0!==m&&(s=function(t,o){if(!Ie(t))throw new _S("Transfer option cannot be converted to a sequence");var s=[];iterate(t,(function(t){LS(s,anObject(t))}));for(var h,m,_,E,$,B=0,q=lengthOfArrayLike(s),j=[];B<q;)if(h=s[B++],"ArrayBuffer"!==(m=Lr(h))){if(RS(o,h))throw new IS("Duplicate transferable",jS);if(Wx)E=VS(h,{transfer:[h]});else switch(m){case"ImageBitmap":_=l.OffscreenCanvas,po(_)||throwUnpolyfillable(m,zS);try{($=new _(h.width,h.height)).getContext("bitmaprenderer").transferFromImageBitmap(h),E=$.transferToImageBitmap()}catch(t){}break;case"AudioData":case"VideoFrame":Te(h.clone)&&Te(h.close)||throwUnpolyfillable(m,zS);try{E=h.clone(),h.close()}catch(t){}break;case"MediaSourceHandle":case"MessagePort":case"OffscreenCanvas":case"ReadableStream":case"TransformStream":case"WritableStream":throwUnpolyfillable(m,zS)}if(void 0===E)throw new IS("This object cannot be transferred: "+m,jS);MS(o,h,E)}else LS(j,h);return j}(m,o=new PS),_=!!lengthOfArrayLike(s));var E=structuredCloneInternal(t,o,_);return _&&(function(t,o){for(var s,l,h=0,m=lengthOfArrayLike(t);h<m;){if(s=t[h++],RS(o,s))throw new IS("Duplicate transferable",jS);pS?l=pS(s,void 0,!0):(Te(s.transfer)||throwUnpolyfillable("ArrayBuffer",zS),l=s.transfer()),MS(o,s,l)}}(m,o=new PS),E=replacePlaceholders(E,o)),E}});var QS=schedulersFix(l.setInterval,!0);_export({global:!0,bind:!0,forced:l.setInterval!==QS},{setInterval:QS});var YS=schedulersFix(l.setTimeout,!0);_export({global:!0,bind:!0,forced:l.setTimeout!==YS},{setTimeout:YS});var ZS=wellKnownSymbol("iterator"),JS=!fails((function(){var t=new URL("b?a=1&b=2&c=3","http://a"),o=t.searchParams,s=new URLSearchParams("a=1&a=2&b=3"),l="";return t.pathname="c%20d",o.forEach((function(t,s){o.delete("b"),l+=s+t})),s.delete("a",2),s.delete("b",void 0),!o.size&&!h||!o.sort||"http://a/c%20d?a=1&c=3"!==t.href||"3"!==o.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!o[ZS]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://ÑÐµÑÑ").host||"#%D0%B1"!==new URL("http://a#Ð±").hash||"a1c3"!==l||"x"!==new URL("http://x",void 0).host})),XS=2147483647,eT=/[^\0-\u007E]/,tT=/[.\u3002\uFF0E\uFF61]/g,rT="Overflow: input needs wider integers to process",oT=RangeError,nT=re(tT.exec),iT=Math.floor,sT=String.fromCharCode,aT=re("".charCodeAt),lT=re([].join),cT=re([].push),dT=re("".replace),uT=re("".split),hT=re("".toLowerCase),digitToBasic=function(t){return t+22+75*(t<26)},adapt=function(t,o,s){var l=0;for(t=s?iT(t/700):t>>1,t+=iT(t/o);t>455;)t=iT(t/35),l+=36;return iT(l+36*t/(t+38))},encode=function(t){var o=[];t=function(t){for(var o=[],s=0,l=t.length;s<l;){var h=aT(t,s++);if(h>=55296&&h<=56319&&s<l){var m=aT(t,s++);56320==(64512&m)?cT(o,((1023&h)<<10)+(1023&m)+65536):(cT(o,h),s--)}else cT(o,h)}return o}(t);var s,l,h=t.length,m=128,_=0,E=72;for(s=0;s<t.length;s++)(l=t[s])<128&&cT(o,sT(l));var $=o.length,B=$;for($&&cT(o,"-");B<h;){var q=XS;for(s=0;s<t.length;s++)(l=t[s])>=m&&l<q&&(q=l);var j=B+1;if(q-m>iT((XS-_)/j))throw new oT(rT);for(_+=(q-m)*j,m=q,s=0;s<t.length;s++){if((l=t[s])<m&&++_>XS)throw new oT(rT);if(l===m){for(var K=_,W=36;;){var X=W<=E?1:W>=E+26?26:W-E;if(K<X)break;var re=K-X,oe=36-X;cT(o,sT(digitToBasic(X+re%oe))),K=iT(re/oe),W+=36}cT(o,sT(digitToBasic(K))),E=adapt(_,j,B===$),_=0,B++}}_++,m++}return lT(o,"")},pT=wellKnownSymbol("iterator"),fT="URLSearchParams",gT=fT+"Iterator",vT=ar.set,mT=ar.getterFor(fT),yT=ar.getterFor(gT),bT=Object.getOwnPropertyDescriptor,safeGetBuiltIn=function(t){if(!h)return l[t];var o=bT(l,t);return o&&o.value},wT=safeGetBuiltIn("fetch"),CT=safeGetBuiltIn("Request"),_T=safeGetBuiltIn("Headers"),kT=CT&&CT.prototype,xT=_T&&_T.prototype,ST=l.RegExp,TT=l.TypeError,ET=l.decodeURIComponent,AT=l.encodeURIComponent,IT=re("".charAt),PT=re([].join),RT=re([].push),$T=re("".replace),MT=re([].shift),OT=re([].splice),NT=re("".split),DT=re("".slice),LT=/\+/g,FT=Array(4),percentSequence=function(t){return FT[t-1]||(FT[t-1]=ST("((?:%[\\da-f]{2}){"+t+"})","gi"))},percentDecode=function(t){try{return ET(t)}catch(o){return t}},deserialize=function(t){var o=$T(t,LT," "),s=4;try{return ET(o)}catch(t){for(;s;)o=$T(o,percentSequence(s--),percentDecode);return o}},BT=/[!'()~]|%20/g,HT={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},replacer=function(t){return HT[t]},serialize=function(t){return $T(AT(t),BT,replacer)},UT=iteratorCreateConstructor((function Iterator(t,o){vT(this,{type:gT,iterator:getIterator$1(mT(t).entries),kind:o})}),"Iterator",(function next(){var t=yT(this),o=t.kind,s=t.iterator.next(),l=s.value;return s.done||(s.value="keys"===o?l.key:"values"===o?l.value:[l.key,l.value]),s}),!0),URLSearchParamsState=function(t){this.entries=[],this.url=null,void 0!==t&&(Ie(t)?this.parseObject(t):this.parseQuery("string"==typeof t?"?"===IT(t,0)?DT(t,1):t:toString_1(t)))};URLSearchParamsState.prototype={type:fT,bindURL:function(t){this.url=t,this.update()},parseObject:function(t){var o,s,l,h,m,_,$,B=getIteratorMethod(t);if(B)for(s=(o=getIterator$1(t,B)).next;!(l=E(s,o)).done;){if(m=(h=getIterator$1(anObject(l.value))).next,(_=E(m,h)).done||($=E(m,h)).done||!E(m,h).done)throw new TT("Expected sequence with length 2");RT(this.entries,{key:toString_1(_.value),value:toString_1($.value)})}else for(var q in t)vt(t,q)&&RT(this.entries,{key:q,value:toString_1(t[q])})},parseQuery:function(t){if(t)for(var o,s,l=NT(t,"&"),h=0;h<l.length;)(o=l[h++]).length&&(s=NT(o,"="),RT(this.entries,{key:deserialize(MT(s)),value:deserialize(PT(s,"="))}))},serialize:function(){for(var t,o=this.entries,s=[],l=0;l<o.length;)t=o[l++],RT(s,serialize(t.key)+"="+serialize(t.value));return PT(s,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var qT=function URLSearchParams(){anInstance(this,jT);var t=vT(this,new URLSearchParamsState(arguments.length>0?arguments[0]:void 0));h||(this.size=t.entries.length)},jT=qT.prototype;if(defineBuiltIns(jT,{append:function append(t,o){var s=mT(this);validateArgumentsLength(arguments.length,2),RT(s.entries,{key:toString_1(t),value:toString_1(o)}),h||this.length++,s.updateURL()},delete:function(t){for(var o=mT(this),s=validateArgumentsLength(arguments.length,1),l=o.entries,m=toString_1(t),_=s<2?void 0:arguments[1],E=void 0===_?_:toString_1(_),$=0;$<l.length;){var B=l[$];if(B.key!==m||void 0!==E&&B.value!==E)$++;else if(OT(l,$,1),void 0!==E)break}h||(this.size=l.length),o.updateURL()},get:function get(t){var o=mT(this).entries;validateArgumentsLength(arguments.length,1);for(var s=toString_1(t),l=0;l<o.length;l++)if(o[l].key===s)return o[l].value;return null},getAll:function getAll(t){var o=mT(this).entries;validateArgumentsLength(arguments.length,1);for(var s=toString_1(t),l=[],h=0;h<o.length;h++)o[h].key===s&&RT(l,o[h].value);return l},has:function has(t){for(var o=mT(this).entries,s=validateArgumentsLength(arguments.length,1),l=toString_1(t),h=s<2?void 0:arguments[1],m=void 0===h?h:toString_1(h),_=0;_<o.length;){var E=o[_++];if(E.key===l&&(void 0===m||E.value===m))return!0}return!1},set:function set(t,o){var s=mT(this);validateArgumentsLength(arguments.length,1);for(var l,m=s.entries,_=!1,E=toString_1(t),$=toString_1(o),B=0;B<m.length;B++)(l=m[B]).key===E&&(_?OT(m,B--,1):(_=!0,l.value=$));_||RT(m,{key:E,value:$}),h||(this.size=m.length),s.updateURL()},sort:function sort(){var t=mT(this);vl(t.entries,(function(t,o){return t.key>o.key?1:-1})),t.updateURL()},forEach:function forEach(t){for(var o,s=mT(this).entries,l=functionBindContext(t,arguments.length>1?arguments[1]:void 0),h=0;h<s.length;)l((o=s[h++]).value,o.key,this)},keys:function keys(){return new UT(this,"keys")},values:function values(){return new UT(this,"values")},entries:function entries(){return new UT(this,"entries")}},{enumerable:!0}),defineBuiltIn(jT,pT,jT.entries,{name:"entries"}),defineBuiltIn(jT,"toString",(function toString(){return mT(this).serialize()}),{enumerable:!0}),h&&defineBuiltInAccessor(jT,"size",{get:function size(){return mT(this).entries.length},configurable:!0,enumerable:!0}),setToStringTag(qT,fT),_export({global:!0,constructor:!0,forced:!JS},{URLSearchParams:qT}),!JS&&Te(_T)){var zT=re(xT.has),VT=re(xT.set),wrapRequestOptions=function(t){if(Ie(t)){var o,s=t.body;if(Lr(s)===fT)return o=t.headers?new _T(t.headers):new _T,zT(o,"content-type")||VT(o,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Gr(t,{body:createPropertyDescriptor(0,toString_1(s)),headers:createPropertyDescriptor(0,o)})}return t};if(Te(wT)&&_export({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function fetch(t){return wT(t,arguments.length>1?wrapRequestOptions(arguments[1]):{})}}),Te(CT)){var GT=function Request(t){return anInstance(this,kT),new CT(t,arguments.length>1?wrapRequestOptions(arguments[1]):{})};kT.constructor=GT,GT.prototype=kT,_export({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:GT})}}var KT,WT={URLSearchParams:qT,getState:mT},QT=Hy.codeAt,YT=ar.set,ZT=ar.getterFor("URL"),JT=WT.URLSearchParams,XT=WT.getState,eE=l.URL,tE=l.TypeError,rE=l.parseInt,oE=Math.floor,nE=Math.pow,iE=re("".charAt),sE=re(/./.exec),aE=re([].join),lE=re(1..toString),cE=re([].pop),dE=re([].push),uE=re("".replace),hE=re([].shift),pE=re("".split),fE=re("".slice),gE=re("".toLowerCase),vE=re([].unshift),mE="Invalid scheme",yE="Invalid host",bE="Invalid port",wE=/[a-z]/i,CE=/[\d+-.a-z]/i,_E=/\d/,kE=/^0x/i,xE=/^[0-7]+$/,SE=/^\d+$/,TE=/^[\da-f]+$/i,EE=/[\0\t\n\r #%/:<>?@[\\\]^|]/,AE=/[\0\t\n\r #/:<>?@[\\\]^|]/,IE=/^[\u0000-\u0020]+/,PE=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,RE=/[\t\n\r]/g,serializeHost=function(t){var o,s,l,h;if("number"==typeof t){for(o=[],s=0;s<4;s++)vE(o,t%256),t=oE(t/256);return aE(o,".")}if("object"==typeof t){for(o="",l=function(t){for(var o=null,s=1,l=null,h=0,m=0;m<8;m++)0!==t[m]?(h>s&&(o=l,s=h),l=null,h=0):(null===l&&(l=m),++h);return h>s&&(o=l,s=h),o}(t),s=0;s<8;s++)h&&0===t[s]||(h&&(h=!1),l===s?(o+=s?":":"::",h=!0):(o+=lE(t[s],16),s<7&&(o+=":")));return"["+o+"]"}return t},$E={},ME=Zf({},$E,{" ":1,'"':1,"<":1,">":1,"`":1}),OE=Zf({},ME,{"#":1,"?":1,"{":1,"}":1}),NE=Zf({},OE,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),percentEncode=function(t,o){var s=QT(t,0);return s>32&&s<127&&!vt(o,t)?t:encodeURIComponent(t)},DE={ftp:21,file:null,http:80,https:443,ws:80,wss:443},isWindowsDriveLetter=function(t,o){var s;return 2===t.length&&sE(wE,iE(t,0))&&(":"===(s=iE(t,1))||!o&&"|"===s)},startsWithWindowsDriveLetter=function(t){var o;return t.length>1&&isWindowsDriveLetter(fE(t,0,2))&&(2===t.length||"/"===(o=iE(t,2))||"\\"===o||"?"===o||"#"===o)},isSingleDot=function(t){return"."===t||"%2e"===gE(t)},LE={},FE={},BE={},HE={},UE={},qE={},jE={},zE={},VE={},GE={},KE={},WE={},QE={},YE={},ZE={},JE={},XE={},eA={},tA={},rA={},oA={},URLState=function(t,o,s){var l,h,m,_=toString_1(t);if(o){if(h=this.parse(_))throw new tE(h);this.searchParams=null}else{if(void 0!==s&&(l=new URLState(s,!0)),h=this.parse(_,null,l))throw new tE(h);(m=XT(new JT)).bindURL(this),this.searchParams=m}};URLState.prototype={type:"URL",parse:function(t,o,s){var l,h,m,_,E,$=this,B=o||LE,q=0,j="",K=!1,W=!1,X=!1;for(t=toString_1(t),o||($.scheme="",$.username="",$.password="",$.host=null,$.port=null,$.path=[],$.query=null,$.fragment=null,$.cannotBeABaseURL=!1,t=uE(t,IE,""),t=uE(t,PE,"$1")),t=uE(t,RE,""),l=xs(t);q<=l.length;){switch(h=l[q],B){case LE:if(!h||!sE(wE,h)){if(o)return mE;B=BE;continue}j+=gE(h),B=FE;break;case FE:if(h&&(sE(CE,h)||"+"===h||"-"===h||"."===h))j+=gE(h);else{if(":"!==h){if(o)return mE;j="",B=BE,q=0;continue}if(o&&($.isSpecial()!==vt(DE,j)||"file"===j&&($.includesCredentials()||null!==$.port)||"file"===$.scheme&&!$.host))return;if($.scheme=j,o)return void($.isSpecial()&&DE[$.scheme]===$.port&&($.port=null));j="","file"===$.scheme?B=YE:$.isSpecial()&&s&&s.scheme===$.scheme?B=HE:$.isSpecial()?B=zE:"/"===l[q+1]?(B=UE,q++):($.cannotBeABaseURL=!0,dE($.path,""),B=tA)}break;case BE:if(!s||s.cannotBeABaseURL&&"#"!==h)return mE;if(s.cannotBeABaseURL&&"#"===h){$.scheme=s.scheme,$.path=arraySliceSimple(s.path),$.query=s.query,$.fragment="",$.cannotBeABaseURL=!0,B=oA;break}B="file"===s.scheme?YE:qE;continue;case HE:if("/"!==h||"/"!==l[q+1]){B=qE;continue}B=VE,q++;break;case UE:if("/"===h){B=GE;break}B=eA;continue;case qE:if($.scheme=s.scheme,h===KT)$.username=s.username,$.password=s.password,$.host=s.host,$.port=s.port,$.path=arraySliceSimple(s.path),$.query=s.query;else if("/"===h||"\\"===h&&$.isSpecial())B=jE;else if("?"===h)$.username=s.username,$.password=s.password,$.host=s.host,$.port=s.port,$.path=arraySliceSimple(s.path),$.query="",B=rA;else{if("#"!==h){$.username=s.username,$.password=s.password,$.host=s.host,$.port=s.port,$.path=arraySliceSimple(s.path),$.path.length--,B=eA;continue}$.username=s.username,$.password=s.password,$.host=s.host,$.port=s.port,$.path=arraySliceSimple(s.path),$.query=s.query,$.fragment="",B=oA}break;case jE:if(!$.isSpecial()||"/"!==h&&"\\"!==h){if("/"!==h){$.username=s.username,$.password=s.password,$.host=s.host,$.port=s.port,B=eA;continue}B=GE}else B=VE;break;case zE:if(B=VE,"/"!==h||"/"!==iE(j,q+1))continue;q++;break;case VE:if("/"!==h&&"\\"!==h){B=GE;continue}break;case GE:if("@"===h){K&&(j="%40"+j),K=!0,m=xs(j);for(var re=0;re<m.length;re++){var oe=m[re];if(":"!==oe||X){var ne=percentEncode(oe,NE);X?$.password+=ne:$.username+=ne}else X=!0}j=""}else if(h===KT||"/"===h||"?"===h||"#"===h||"\\"===h&&$.isSpecial()){if(K&&""===j)return"Invalid authority";q-=xs(j).length+1,j="",B=KE}else j+=h;break;case KE:case WE:if(o&&"file"===$.scheme){B=JE;continue}if(":"!==h||W){if(h===KT||"/"===h||"?"===h||"#"===h||"\\"===h&&$.isSpecial()){if($.isSpecial()&&""===j)return yE;if(o&&""===j&&($.includesCredentials()||null!==$.port))return;if(_=$.parseHost(j))return _;if(j="",B=XE,o)return;continue}"["===h?W=!0:"]"===h&&(W=!1),j+=h}else{if(""===j)return yE;if(_=$.parseHost(j))return _;if(j="",B=QE,o===WE)return}break;case QE:if(!sE(_E,h)){if(h===KT||"/"===h||"?"===h||"#"===h||"\\"===h&&$.isSpecial()||o){if(""!==j){var ae=rE(j,10);if(ae>65535)return bE;$.port=$.isSpecial()&&ae===DE[$.scheme]?null:ae,j=""}if(o)return;B=XE;continue}return bE}j+=h;break;case YE:if($.scheme="file","/"===h||"\\"===h)B=ZE;else{if(!s||"file"!==s.scheme){B=eA;continue}switch(h){case KT:$.host=s.host,$.path=arraySliceSimple(s.path),$.query=s.query;break;case"?":$.host=s.host,$.path=arraySliceSimple(s.path),$.query="",B=rA;break;case"#":$.host=s.host,$.path=arraySliceSimple(s.path),$.query=s.query,$.fragment="",B=oA;break;default:startsWithWindowsDriveLetter(aE(arraySliceSimple(l,q),""))||($.host=s.host,$.path=arraySliceSimple(s.path),$.shortenPath()),B=eA;continue}}break;case ZE:if("/"===h||"\\"===h){B=JE;break}s&&"file"===s.scheme&&!startsWithWindowsDriveLetter(aE(arraySliceSimple(l,q),""))&&(isWindowsDriveLetter(s.path[0],!0)?dE($.path,s.path[0]):$.host=s.host),B=eA;continue;case JE:if(h===KT||"/"===h||"\\"===h||"?"===h||"#"===h){if(!o&&isWindowsDriveLetter(j))B=eA;else if(""===j){if($.host="",o)return;B=XE}else{if(_=$.parseHost(j))return _;if("localhost"===$.host&&($.host=""),o)return;j="",B=XE}continue}j+=h;break;case XE:if($.isSpecial()){if(B=eA,"/"!==h&&"\\"!==h)continue}else if(o||"?"!==h)if(o||"#"!==h){if(h!==KT&&(B=eA,"/"!==h))continue}else $.fragment="",B=oA;else $.query="",B=rA;break;case eA:if(h===KT||"/"===h||"\\"===h&&$.isSpecial()||!o&&("?"===h||"#"===h)){if(".."===(E=gE(E=j))||"%2e."===E||".%2e"===E||"%2e%2e"===E?($.shortenPath(),"/"===h||"\\"===h&&$.isSpecial()||dE($.path,"")):isSingleDot(j)?"/"===h||"\\"===h&&$.isSpecial()||dE($.path,""):("file"===$.scheme&&!$.path.length&&isWindowsDriveLetter(j)&&($.host&&($.host=""),j=iE(j,0)+":"),dE($.path,j)),j="","file"===$.scheme&&(h===KT||"?"===h||"#"===h))for(;$.path.length>1&&""===$.path[0];)hE($.path);"?"===h?($.query="",B=rA):"#"===h&&($.fragment="",B=oA)}else j+=percentEncode(h,OE);break;case tA:"?"===h?($.query="",B=rA):"#"===h?($.fragment="",B=oA):h!==KT&&($.path[0]+=percentEncode(h,$E));break;case rA:o||"#"!==h?h!==KT&&("'"===h&&$.isSpecial()?$.query+="%27":$.query+="#"===h?"%23":percentEncode(h,$E)):($.fragment="",B=oA);break;case oA:h!==KT&&($.fragment+=percentEncode(h,ME))}q++}},parseHost:function(t){var o,s,l;if("["===iE(t,0)){if("]"!==iE(t,t.length-1))return yE;if(o=function(t){var o,s,l,h,m,_,E,$=[0,0,0,0,0,0,0,0],B=0,q=null,j=0,chr=function(){return iE(t,j)};if(":"===chr()){if(":"!==iE(t,1))return;j+=2,q=++B}for(;chr();){if(8===B)return;if(":"!==chr()){for(o=s=0;s<4&&sE(TE,chr());)o=16*o+rE(chr(),16),j++,s++;if("."===chr()){if(0===s)return;if(j-=s,B>6)return;for(l=0;chr();){if(h=null,l>0){if(!("."===chr()&&l<4))return;j++}if(!sE(_E,chr()))return;for(;sE(_E,chr());){if(m=rE(chr(),10),null===h)h=m;else{if(0===h)return;h=10*h+m}if(h>255)return;j++}$[B]=256*$[B]+h,2!=++l&&4!==l||B++}if(4!==l)return;break}if(":"===chr()){if(j++,!chr())return}else if(chr())return;$[B++]=o}else{if(null!==q)return;j++,q=++B}}if(null!==q)for(_=B-q,B=7;0!==B&&_>0;)E=$[B],$[B--]=$[q+_-1],$[q+--_]=E;else if(8!==B)return;return $}(fE(t,1,-1)),!o)return yE;this.host=o}else if(this.isSpecial()){if(t=function(t){var o,s,l=[],h=uT(dT(hT(t),tT,"."),".");for(o=0;o<h.length;o++)s=h[o],cT(l,nT(eT,s)?"xn--"+encode(s):s);return lT(l,".")}(t),sE(EE,t))return yE;if(o=function(t){var o,s,l,h,m,_,E,$=pE(t,".");if($.length&&""===$[$.length-1]&&$.length--,(o=$.length)>4)return t;for(s=[],l=0;l<o;l++){if(""===(h=$[l]))return t;if(m=10,h.length>1&&"0"===iE(h,0)&&(m=sE(kE,h)?16:8,h=fE(h,8===m?1:2)),""===h)_=0;else{if(!sE(10===m?SE:8===m?xE:TE,h))return t;_=rE(h,m)}dE(s,_)}for(l=0;l<o;l++)if(_=s[l],l===o-1){if(_>=nE(256,5-o))return null}else if(_>255)return null;for(E=cE(s),l=0;l<s.length;l++)E+=s[l]*nE(256,3-l);return E}(t),null===o)return yE;this.host=o}else{if(sE(AE,t))return yE;for(o="",s=xs(t),l=0;l<s.length;l++)o+=percentEncode(s[l],$E);this.host=o}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return vt(DE,this.scheme)},shortenPath:function(){var t=this.path,o=t.length;!o||"file"===this.scheme&&1===o&&isWindowsDriveLetter(t[0],!0)||t.length--},serialize:function(){var t=this,o=t.scheme,s=t.username,l=t.password,h=t.host,m=t.port,_=t.path,E=t.query,$=t.fragment,B=o+":";return null!==h?(B+="//",t.includesCredentials()&&(B+=s+(l?":"+l:"")+"@"),B+=serializeHost(h),null!==m&&(B+=":"+m)):"file"===o&&(B+="//"),B+=t.cannotBeABaseURL?_[0]:_.length?"/"+aE(_,"/"):"",null!==E&&(B+="?"+E),null!==$&&(B+="#"+$),B},setHref:function(t){var o=this.parse(t);if(o)throw new tE(o);this.searchParams.update()},getOrigin:function(){var t=this.scheme,o=this.port;if("blob"===t)try{return new nA(t.path[0]).origin}catch(t){return"null"}return"file"!==t&&this.isSpecial()?t+"://"+serializeHost(this.host)+(null!==o?":"+o:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(t){this.parse(toString_1(t)+":",LE)},getUsername:function(){return this.username},setUsername:function(t){var o=xs(toString_1(t));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var s=0;s<o.length;s++)this.username+=percentEncode(o[s],NE)}},getPassword:function(){return this.password},setPassword:function(t){var o=xs(toString_1(t));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var s=0;s<o.length;s++)this.password+=percentEncode(o[s],NE)}},getHost:function(){var t=this.host,o=this.port;return null===t?"":null===o?serializeHost(t):serializeHost(t)+":"+o},setHost:function(t){this.cannotBeABaseURL||this.parse(t,KE)},getHostname:function(){var t=this.host;return null===t?"":serializeHost(t)},setHostname:function(t){this.cannotBeABaseURL||this.parse(t,WE)},getPort:function(){var t=this.port;return null===t?"":toString_1(t)},setPort:function(t){this.cannotHaveUsernamePasswordPort()||(""===(t=toString_1(t))?this.port=null:this.parse(t,QE))},getPathname:function(){var t=this.path;return this.cannotBeABaseURL?t[0]:t.length?"/"+aE(t,"/"):""},setPathname:function(t){this.cannotBeABaseURL||(this.path=[],this.parse(t,XE))},getSearch:function(){var t=this.query;return t?"?"+t:""},setSearch:function(t){""===(t=toString_1(t))?this.query=null:("?"===iE(t,0)&&(t=fE(t,1)),this.query="",this.parse(t,rA)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var t=this.fragment;return t?"#"+t:""},setHash:function(t){""!==(t=toString_1(t))?("#"===iE(t,0)&&(t=fE(t,1)),this.fragment="",this.parse(t,oA)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var nA=function URL(t){var o=anInstance(this,iA),s=validateArgumentsLength(arguments.length,1)>1?arguments[1]:void 0,l=YT(o,new URLState(t,!1,s));h||(o.href=l.serialize(),o.origin=l.getOrigin(),o.protocol=l.getProtocol(),o.username=l.getUsername(),o.password=l.getPassword(),o.host=l.getHost(),o.hostname=l.getHostname(),o.port=l.getPort(),o.pathname=l.getPathname(),o.search=l.getSearch(),o.searchParams=l.getSearchParams(),o.hash=l.getHash())},iA=nA.prototype,accessorDescriptor=function(t,o){return{get:function(){return ZT(this)[t]()},set:o&&function(t){return ZT(this)[o](t)},configurable:!0,enumerable:!0}};if(h&&(defineBuiltInAccessor(iA,"href",accessorDescriptor("serialize","setHref")),defineBuiltInAccessor(iA,"origin",accessorDescriptor("getOrigin")),defineBuiltInAccessor(iA,"protocol",accessorDescriptor("getProtocol","setProtocol")),defineBuiltInAccessor(iA,"username",accessorDescriptor("getUsername","setUsername")),defineBuiltInAccessor(iA,"password",accessorDescriptor("getPassword","setPassword")),defineBuiltInAccessor(iA,"host",accessorDescriptor("getHost","setHost")),defineBuiltInAccessor(iA,"hostname",accessorDescriptor("getHostname","setHostname")),defineBuiltInAccessor(iA,"port",accessorDescriptor("getPort","setPort")),defineBuiltInAccessor(iA,"pathname",accessorDescriptor("getPathname","setPathname")),defineBuiltInAccessor(iA,"search",accessorDescriptor("getSearch","setSearch")),defineBuiltInAccessor(iA,"searchParams",accessorDescriptor("getSearchParams")),defineBuiltInAccessor(iA,"hash",accessorDescriptor("getHash","setHash"))),defineBuiltIn(iA,"toJSON",(function toJSON(){return ZT(this).serialize()}),{enumerable:!0}),defineBuiltIn(iA,"toString",(function toString(){return ZT(this).serialize()}),{enumerable:!0}),eE){var sA=eE.createObjectURL,aA=eE.revokeObjectURL;sA&&defineBuiltIn(nA,"createObjectURL",functionBindContext(sA,eE)),aA&&defineBuiltIn(nA,"revokeObjectURL",functionBindContext(aA,eE))}setToStringTag(nA,"URL"),_export({global:!0,constructor:!0,forced:!JS,sham:!h},{URL:nA});var lA=getBuiltIn("URL"),cA=JS&&fails((function(){lA.canParse()}));_export({target:"URL",stat:!0,forced:!cA},{canParse:function canParse(t){var o=validateArgumentsLength(arguments.length,1),s=toString_1(t),l=o<2||void 0===arguments[1]?void 0:toString_1(arguments[1]);try{return!!new lA(s,l)}catch(t){return!1}}}),_export({target:"URL",proto:!0,enumerable:!0},{toJSON:function toJSON(){return E(URL.prototype.toString,this)}});var dA=URLSearchParams,uA=dA.prototype,hA=re(uA.append),pA=re(uA.delete),fA=re(uA.forEach),gA=re([].push),vA=new dA("a=1&a=2&b=3");vA.delete("a",1),vA.delete("b",void 0),vA+""!="a=2"&&defineBuiltIn(uA,"delete",(function(t){var o=arguments.length,s=o<2?void 0:arguments[1];if(o&&void 0===s)return pA(this,t);var l=[];fA(this,(function(t,o){gA(l,{key:o,value:t})})),validateArgumentsLength(o,1);for(var h,m=toString_1(t),_=toString_1(s),E=0,$=0,B=!1,q=l.length;E<q;)h=l[E++],B||h.key===m?(B=!0,pA(this,h.key)):$++;for(;$<q;)(h=l[$++]).key===m&&h.value===_||hA(this,h.key,h.value)}),{enumerable:!0,unsafe:!0});var mA=URLSearchParams,yA=mA.prototype,bA=re(yA.getAll),wA=re(yA.has),CA=new mA("a=1");!CA.has("a",2)&&CA.has("a",void 0)||defineBuiltIn(yA,"has",(function has(t){var o=arguments.length,s=o<2?void 0:arguments[1];if(o&&void 0===s)return wA(this,t);var l=bA(this,t);validateArgumentsLength(o,1);for(var h=toString_1(s),m=0;m<l.length;)if(l[m++]===h)return!0;return!1}),{enumerable:!0,unsafe:!0});var _A=URLSearchParams.prototype,kA=re(_A.forEach);h&&!("size"in _A)&&defineBuiltInAccessor(_A,"size",{get:function size(){var t=0;return kA(this,(function(){t++})),t},configurable:!0,enumerable:!0}),createCommonjsModule((function(t){var o=function(t){var o,s=Object.prototype,l=s.hasOwnProperty,h=Object.defineProperty||function(t,o,s){t[o]=s.value},m="function"==typeof Symbol?Symbol:{},_=m.iterator||"@@iterator",E=m.asyncIterator||"@@asyncIterator",$=m.toStringTag||"@@toStringTag";function define(t,o,s){return Object.defineProperty(t,o,{value:s,enumerable:!0,configurable:!0,writable:!0}),t[o]}try{define({},"")}catch(t){define=function(t,o,s){return t[o]=s}}function wrap(t,o,s,l){var m=o&&o.prototype instanceof Generator?o:Generator,_=Object.create(m.prototype),E=new Context(l||[]);return h(_,"_invoke",{value:makeInvokeMethod(t,s,E)}),_}function tryCatch(t,o,s){try{return{type:"normal",arg:t.call(o,s)}}catch(t){return{type:"throw",arg:t}}}t.wrap=wrap;var B="suspendedStart",q="suspendedYield",j="executing",K="completed",W={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var X={};define(X,_,(function(){return this}));var re=Object.getPrototypeOf,oe=re&&re(re(values([])));oe&&oe!==s&&l.call(oe,_)&&(X=oe);var ne=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(X);function defineIteratorMethods(t){["next","throw","return"].forEach((function(o){define(t,o,(function(t){return this._invoke(o,t)}))}))}function AsyncIterator(t,o){function invoke(s,h,m,_){var E=tryCatch(t[s],t,h);if("throw"!==E.type){var $=E.arg,B=$.value;return B&&"object"==typeof B&&l.call(B,"__await")?o.resolve(B.__await).then((function(t){invoke("next",t,m,_)}),(function(t){invoke("throw",t,m,_)})):o.resolve(B).then((function(t){$.value=t,m($)}),(function(t){return invoke("throw",t,m,_)}))}_(E.arg)}var s;h(this,"_invoke",{value:function enqueue(t,l){function callInvokeWithMethodAndArg(){return new o((function(o,s){invoke(t,l,o,s)}))}return s=s?s.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,o,s){var l=B;return function invoke(h,m){if(l===j)throw new Error("Generator is already running");if(l===K){if("throw"===h)throw m;return doneResult()}for(s.method=h,s.arg=m;;){var _=s.delegate;if(_){var E=maybeInvokeDelegate(_,s);if(E){if(E===W)continue;return E}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(l===B)throw l=K,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);l=j;var $=tryCatch(t,o,s);if("normal"===$.type){if(l=s.done?K:q,$.arg===W)continue;return{value:$.arg,done:s.done}}"throw"===$.type&&(l=K,s.method="throw",s.arg=$.arg)}}}function maybeInvokeDelegate(t,s){var l=s.method,h=t.iterator[l];if(h===o)return s.delegate=null,"throw"===l&&t.iterator.return&&(s.method="return",s.arg=o,maybeInvokeDelegate(t,s),"throw"===s.method)||"return"!==l&&(s.method="throw",s.arg=new TypeError("The iterator does not provide a '"+l+"' method")),W;var m=tryCatch(h,t.iterator,s.arg);if("throw"===m.type)return s.method="throw",s.arg=m.arg,s.delegate=null,W;var _=m.arg;return _?_.done?(s[t.resultName]=_.value,s.next=t.nextLoc,"return"!==s.method&&(s.method="next",s.arg=o),s.delegate=null,W):_:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,W)}function pushTryEntry(t){var o={tryLoc:t[0]};1 in t&&(o.catchLoc=t[1]),2 in t&&(o.finallyLoc=t[2],o.afterLoc=t[3]),this.tryEntries.push(o)}function resetTryEntry(t){var o=t.completion||{};o.type="normal",delete o.arg,t.completion=o}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var s=t[_];if(s)return s.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var h=-1,m=function next(){for(;++h<t.length;)if(l.call(t,h))return next.value=t[h],next.done=!1,next;return next.value=o,next.done=!0,next};return m.next=m}}return{next:doneResult}}function doneResult(){return{value:o,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,h(ne,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),h(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,$,"GeneratorFunction"),t.isGeneratorFunction=function(t){var o="function"==typeof t&&t.constructor;return!!o&&(o===GeneratorFunction||"GeneratorFunction"===(o.displayName||o.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,$,"GeneratorFunction")),t.prototype=Object.create(ne),t},t.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,E,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(o,s,l,h,m){void 0===m&&(m=Promise);var _=new AsyncIterator(wrap(o,s,l,h),m);return t.isGeneratorFunction(s)?_:_.next().then((function(t){return t.done?t.value:_.next()}))},defineIteratorMethods(ne),define(ne,$,"Generator"),define(ne,_,(function(){return this})),define(ne,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var o=Object(t),s=[];for(var l in o)s.push(l);return s.reverse(),function next(){for(;s.length;){var t=s.pop();if(t in o)return next.value=t,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(resetTryEntry),!t)for(var s in this)"t"===s.charAt(0)&&l.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=o)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var s=this;function handle(l,h){return _.type="throw",_.arg=t,s.next=l,h&&(s.method="next",s.arg=o),!!h}for(var h=this.tryEntries.length-1;h>=0;--h){var m=this.tryEntries[h],_=m.completion;if("root"===m.tryLoc)return handle("end");if(m.tryLoc<=this.prev){var E=l.call(m,"catchLoc"),$=l.call(m,"finallyLoc");if(E&&$){if(this.prev<m.catchLoc)return handle(m.catchLoc,!0);if(this.prev<m.finallyLoc)return handle(m.finallyLoc)}else if(E){if(this.prev<m.catchLoc)return handle(m.catchLoc,!0)}else{if(!$)throw new Error("try statement without catch or finally");if(this.prev<m.finallyLoc)return handle(m.finallyLoc)}}}},abrupt:function(t,o){for(var s=this.tryEntries.length-1;s>=0;--s){var h=this.tryEntries[s];if(h.tryLoc<=this.prev&&l.call(h,"finallyLoc")&&this.prev<h.finallyLoc){var m=h;break}}m&&("break"===t||"continue"===t)&&m.tryLoc<=o&&o<=m.finallyLoc&&(m=null);var _=m?m.completion:{};return _.type=t,_.arg=o,m?(this.method="next",this.next=m.finallyLoc,W):this.complete(_)},complete:function(t,o){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&o&&(this.next=o),W},finish:function(t){for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o];if(s.finallyLoc===t)return this.complete(s.completion,s.afterLoc),resetTryEntry(s),W}},catch:function(t){for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o];if(s.tryLoc===t){var l=s.completion;if("throw"===l.type){var h=l.arg;resetTryEntry(s)}return h}}throw new Error("illegal catch attempt")},delegateYield:function(t,s,l){return this.delegate={iterator:values(t),resultName:s,nextLoc:l},"next"===this.method&&(this.arg=o),W}},t}(t.exports);try{regeneratorRuntime=o}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}}));var xA="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||{},SA="URLSearchParams"in xA,TA="Symbol"in xA&&"iterator"in Symbol,EA="FileReader"in xA&&"Blob"in xA&&function(){try{return new Blob,!0}catch(t){return!1}}(),AA="FormData"in xA,IA="ArrayBuffer"in xA;if(IA)var PA=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],RA=ArrayBuffer.isView||function(t){return t&&PA.indexOf(Object.prototype.toString.call(t))>-1};function normalizeName(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function normalizeValue(t){return"string"!=typeof t&&(t=String(t)),t}function iteratorFor(t){var o={next:function(){var o=t.shift();return{done:void 0===o,value:o}}};return TA&&(o[Symbol.iterator]=function(){return o}),o}function Headers$1(t){this.map={},t instanceof Headers$1?t.forEach((function(t,o){this.append(o,t)}),this):Array.isArray(t)?t.forEach((function(t){if(2!=t.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+t.length);this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(o){this.append(o,t[o])}),this)}function consumed(t){if(!t._noBody)return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function fileReaderReady(t){return new Promise((function(o,s){t.onload=function(){o(t.result)},t.onerror=function(){s(t.error)}}))}function readBlobAsArrayBuffer(t){var o=new FileReader,s=fileReaderReady(o);return o.readAsArrayBuffer(t),s}function bufferClone(t){if(t.slice)return t.slice(0);var o=new Uint8Array(t.byteLength);return o.set(new Uint8Array(t)),o.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(t){this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:EA&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:AA&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:SA&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():IA&&EA&&function isDataView(t){return t&&DataView.prototype.isPrototypeOf(t)}(t)?(this._bodyArrayBuffer=bufferClone(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):IA&&(ArrayBuffer.prototype.isPrototypeOf(t)||RA(t))?this._bodyArrayBuffer=bufferClone(t):this._bodyText=t=Object.prototype.toString.call(t):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):SA&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},EA&&(this.blob=function(){var t=consumed(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=consumed(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}if(EA)return this.blob().then(readBlobAsArrayBuffer);throw new Error("could not read as ArrayBuffer")},this.text=function(){var t=consumed(this);if(t)return t;if(this._bodyBlob)return function readBlobAsText(t){var o=new FileReader,s=fileReaderReady(o),l=/charset=([A-Za-z0-9_-]+)/.exec(t.type),h=l?l[1]:"utf-8";return o.readAsText(t,h),s}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function readArrayBufferAsText(t){for(var o=new Uint8Array(t),s=new Array(o.length),l=0;l<o.length;l++)s[l]=String.fromCharCode(o[l]);return s.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},AA&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}Headers$1.prototype.append=function(t,o){t=normalizeName(t),o=normalizeValue(o);var s=this.map[t];this.map[t]=s?s+", "+o:o},Headers$1.prototype.delete=function(t){delete this.map[normalizeName(t)]},Headers$1.prototype.get=function(t){return t=normalizeName(t),this.has(t)?this.map[t]:null},Headers$1.prototype.has=function(t){return this.map.hasOwnProperty(normalizeName(t))},Headers$1.prototype.set=function(t,o){this.map[normalizeName(t)]=normalizeValue(o)},Headers$1.prototype.forEach=function(t,o){for(var s in this.map)this.map.hasOwnProperty(s)&&t.call(o,this.map[s],s,this)},Headers$1.prototype.keys=function(){var t=[];return this.forEach((function(o,s){t.push(s)})),iteratorFor(t)},Headers$1.prototype.values=function(){var t=[];return this.forEach((function(o){t.push(o)})),iteratorFor(t)},Headers$1.prototype.entries=function(){var t=[];return this.forEach((function(o,s){t.push([s,o])})),iteratorFor(t)},TA&&(Headers$1.prototype[Symbol.iterator]=Headers$1.prototype.entries);var $A=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function Request$1(t,o){if(!(this instanceof Request$1))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var s=(o=o||{}).body;if(t instanceof Request$1){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,o.headers||(this.headers=new Headers$1(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,s||null==t._bodyInit||(s=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=o.credentials||this.credentials||"same-origin",!o.headers&&this.headers||(this.headers=new Headers$1(o.headers)),this.method=function normalizeMethod(t){var o=t.toUpperCase();return $A.indexOf(o)>-1?o:t}(o.method||this.method||"GET"),this.mode=o.mode||this.mode||null,this.signal=o.signal||this.signal||function(){if("AbortController"in xA)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&s)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(s),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==o.cache&&"no-cache"!==o.cache)){var l=/([?&])_=[^&]*/;if(l.test(this.url))this.url=this.url.replace(l,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function decode(t){var o=new FormData;return t.trim().split("&").forEach((function(t){if(t){var s=t.split("="),l=s.shift().replace(/\+/g," "),h=s.join("=").replace(/\+/g," ");o.append(decodeURIComponent(l),decodeURIComponent(h))}})),o}function Response(t,o){if(!(this instanceof Response))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(o||(o={}),this.type="default",this.status=void 0===o.status?200:o.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===o.statusText?"":""+o.statusText,this.headers=new Headers$1(o.headers),this.url=o.url||"",this._initBody(t)}Request$1.prototype.clone=function(){return new Request$1(this,{body:this._bodyInit})},Body.call(Request$1.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers$1(this.headers),url:this.url})},Response.error=function(){var t=new Response(null,{status:200,statusText:""});return t.status=0,t.type="error",t};var MA=[301,302,303,307,308];Response.redirect=function(t,o){if(-1===MA.indexOf(o))throw new RangeError("Invalid status code");return new Response(null,{status:o,headers:{location:t}})};var OA=xA.DOMException;try{new OA}catch(t){OA=function(t,o){this.message=t,this.name=o;var s=Error(t);this.stack=s.stack},OA.prototype=Object.create(Error.prototype),OA.prototype.constructor=OA}function fetch$1(t,o){return new Promise((function(s,l){var h=new Request$1(t,o);if(h.signal&&h.signal.aborted)return l(new OA("Aborted","AbortError"));var m=new XMLHttpRequest;function abortXhr(){m.abort()}if(m.onload=function(){var t,o,l={statusText:m.statusText,headers:(t=m.getAllResponseHeaders()||"",o=new Headers$1,t.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t})).forEach((function(t){var s=t.split(":"),l=s.shift().trim();if(l){var h=s.join(":").trim();try{o.append(l,h)}catch(t){console.warn("Response "+t.message)}}})),o)};h.url.startsWith("file://")&&(m.status<200||m.status>599)?l.status=200:l.status=m.status,l.url="responseURL"in m?m.responseURL:l.headers.get("X-Request-URL");var _="response"in m?m.response:m.responseText;setTimeout((function(){s(new Response(_,l))}),0)},m.onerror=function(){setTimeout((function(){l(new TypeError("Network request failed"))}),0)},m.ontimeout=function(){setTimeout((function(){l(new TypeError("Network request timed out"))}),0)},m.onabort=function(){setTimeout((function(){l(new OA("Aborted","AbortError"))}),0)},m.open(h.method,function fixUrl(t){try{return""===t&&xA.location.href?xA.location.href:t}catch(o){return t}}(h.url),!0),"include"===h.credentials?m.withCredentials=!0:"omit"===h.credentials&&(m.withCredentials=!1),"responseType"in m&&(EA?m.responseType="blob":IA&&(m.responseType="arraybuffer")),o&&"object"==typeof o.headers&&!(o.headers instanceof Headers$1||xA.Headers&&o.headers instanceof xA.Headers)){var _=[];Object.getOwnPropertyNames(o.headers).forEach((function(t){_.push(normalizeName(t)),m.setRequestHeader(t,normalizeValue(o.headers[t]))})),h.headers.forEach((function(t,o){-1===_.indexOf(o)&&m.setRequestHeader(o,t)}))}else h.headers.forEach((function(t,o){m.setRequestHeader(o,t)}));h.signal&&(h.signal.addEventListener("abort",abortXhr),m.onreadystatechange=function(){4===m.readyState&&h.signal.removeEventListener("abort",abortXhr)}),m.send(void 0===h._bodyInit?null:h._bodyInit)}))}fetch$1.polyfill=!0,xA.fetch||(xA.fetch=fetch$1,xA.Headers=Headers$1,xA.Request=Request$1,xA.Response=Response)
/**
@license @nocompile
Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/,function(){var o;function ba(t){var o=0;return function(){return o<t.length?{done:!1,value:t[o++]}:{done:!0}}}var s="function"==typeof Object.defineProperties?Object.defineProperty:function(t,o,s){return t==Array.prototype||t==Object.prototype||(t[o]=s.value),t};var l,h=function da(o){o=["object"==typeof globalThis&&globalThis,o,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof t&&t];for(var s=0;s<o.length;++s){var l=o[s];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}(this);function fa(t,o){if(o)e:{var l=h;t=t.split(".");for(var m=0;m<t.length-1;m++){var _=t[m];if(!(_ in l))break e;l=l[_]}(o=o(m=l[t=t[t.length-1]]))!=m&&null!=o&&s(l,t,{configurable:!0,writable:!0,value:o})}}function ja(t){return(t={next:t})[Symbol.iterator]=function(){return this},t}function ka(t){var o="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return o?o.call(t):{next:ba(t)}}function w(t){if(!(t instanceof Array)){t=ka(t);for(var o,s=[];!(o=t.next()).done;)s.push(o.value);t=s}return t}if(fa("Symbol",(function(t){function c(t,o){this.g=t,s(this,"description",{configurable:!0,writable:!0,value:o})}if(t)return t;c.prototype.toString=function(){return this.g};var o=0;return function b(t){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c("jscomp_symbol_"+(t||"")+"_"+o++,t)}})),fa("Symbol.iterator",(function(t){if(t)return t;t=Symbol("Symbol.iterator");for(var o="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),l=0;l<o.length;l++){var m=h[o[l]];"function"==typeof m&&"function"!=typeof m.prototype[t]&&s(m.prototype,t,{configurable:!0,writable:!0,value:function(){return ja(ba(this))}})}return t})),"function"==typeof Object.setPrototypeOf)l=Object.setPrototypeOf;else{var m;e:{var _={};try{_.__proto__={a:!0},m=_.a;break e}catch(t){}m=!1}l=m?function(t,o){if(t.__proto__=o,t.__proto__!==o)throw new TypeError(t+" is not extensible");return t}:null}var E=l;function ra(){this.u=!1,this.h=null,this.Oa=void 0,this.g=1,this.ea=0,this.i=null}function ua(t){if(t.u)throw new TypeError("Generator is already running");t.u=!0}function wa(t,o){t.i={ab:o,fb:!0},t.g=t.ea}function ya(t,o){return t.g=3,{value:o}}function za(t){this.g=new ra,this.h=t}function Ba(t,o,s,l){try{var h=o.call(t.g.h,s);if(!(h instanceof Object))throw new TypeError("Iterator result "+h+" is not an object");if(!h.done)return t.g.u=!1,h;var m=h.value}catch(o){return t.g.h=null,wa(t.g,o),Ca(t)}return t.g.h=null,l.call(t.g,m),Ca(t)}function Ca(t){for(;t.g.g;)try{var o=t.h(t.g);if(o)return t.g.u=!1,{value:o.value,done:!1}}catch(o){t.g.Oa=void 0,wa(t.g,o)}if(t.g.u=!1,t.g.i){if(o=t.g.i,t.g.i=null,o.fb)throw o.ab;return{value:o.return,done:!0}}return{value:void 0,done:!0}}function Da(t){this.next=function(o){return ua(t.g),t.g.h?o=Ba(t,t.g.h.next,o,t.g.O):(t.g.O(o),o=Ca(t)),o},this.throw=function(o){return ua(t.g),t.g.h?o=Ba(t,t.g.h.throw,o,t.g.O):(wa(t.g,o),o=Ca(t)),o},this.return=function(o){return function Aa(t,o){ua(t.g);var s=t.g.h;return s?Ba(t,"return"in s?s.return:function(t){return{value:t,done:!0}},o,t.g.return):(t.g.return(o),Ca(t))}(t,o)},this[Symbol.iterator]=function(){return this}}function Ea(t,o){return o=new Da(new za(o)),E&&t.prototype&&E(o,t.prototype),o}ra.prototype.O=function(t){this.Oa=t},ra.prototype.return=function(t){this.i={return:t},this.g=this.ea},Array.from||(Array.from=function(t){return[].slice.call(t)}),Object.assign||(Object.assign=function(t){for(var o,s=[].slice.call(arguments,1),l=0;l<s.length;l++)if(o=s[l])for(var h=t,m=Object.keys(o),_=0;_<m.length;_++){var E=m[_];h[E]=o[E]}return t});var $=setTimeout;function Ga(){}function A(t){if(!(this instanceof A))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this.N=0,this.Ha=!1,this.I=void 0,this.ba=[],Ia(t,this)}function Ja(t,o){for(;3===t.N;)t=t.I;0===t.N?t.ba.push(o):(t.Ha=!0,B((function(){var s=1===t.N?o.hb:o.ib;if(null===s)(1===t.N?La:Ma)(o.promise,t.I);else{try{var l=s(t.I)}catch(t){return void Ma(o.promise,t)}La(o.promise,l)}})))}function La(t,o){try{if(o===t)throw new TypeError("A promise cannot be resolved with itself.");if(o&&("object"==typeof o||"function"==typeof o)){var s=o.then;if(o instanceof A)return t.N=3,t.I=o,void Na(t);if("function"==typeof s)return void Ia(function Ha(t,o){return function(){t.apply(o,arguments)}}(s,o),t)}t.N=1,t.I=o,Na(t)}catch(o){Ma(t,o)}}function Ma(t,o){t.N=2,t.I=o,Na(t)}function Na(t){2===t.N&&0===t.ba.length&&B((function(){t.Ha||"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t.I)}));for(var o=0,s=t.ba.length;o<s;o++)Ja(t,t.ba[o]);t.ba=null}function Oa(t,o,s){this.hb="function"==typeof t?t:null,this.ib="function"==typeof o?o:null,this.promise=s}function Ia(t,o){var s=!1;try{t((function(t){s||(s=!0,La(o,t))}),(function(t){s||(s=!0,Ma(o,t))}))}catch(t){s||(s=!0,Ma(o,t))}}function Qa(t){return t&&"object"==typeof t&&t.constructor===A?t:new A((function(o){o(t)}))}A.prototype.catch=function(t){return this.then(null,t)},A.prototype.then=function(t,o){var s=new this.constructor(Ga);return Ja(this,new Oa(t,o,s)),s},A.prototype.finally=function(t){var o=this.constructor;return this.then((function(s){return o.resolve(t()).then((function(){return s}))}),(function(s){return o.resolve(t()).then((function(){return o.reject(s)}))}))};var B="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){$(t,0)};if(!window.Promise){window.Promise=A,A.prototype.then=A.prototype.then,A.all=function Pa(t){return new A((function(o,s){function d(t,m){try{if(m&&("object"==typeof m||"function"==typeof m)){var _=m.then;if("function"==typeof _)return void _.call(m,(function(o){d(t,o)}),s)}l[t]=m,0==--h&&o(l)}catch(t){s(t)}}if(!t||void 0===t.length)return s(new TypeError("Promise.all accepts an array"));var l=Array.prototype.slice.call(t);if(0===l.length)return o([]);for(var h=l.length,m=0;m<l.length;m++)d(m,l[m])}))},A.race=function Sa(t){return new A((function(o,s){if(!t||void 0===t.length)return s(new TypeError("Promise.race accepts an array"));for(var l=0,h=t.length;l<h;l++)Qa(t[l]).then(o,s)}))},A.resolve=Qa,A.reject=function Ra(t){return new A((function(o,s){s(t)}))};var q=document.createTextNode(""),j=[];new MutationObserver((function(){for(var t=j.length,o=0;o<t;o++)j[o]();j.splice(0,t)})).observe(q,{characterData:!0}),B=function(t){j.push(t),q.textContent=0<q.textContent.length?"":"a"}}!function(o,s){if(!(s in o)){var l=typeof t==typeof l?window:t,h=0,m=String(Math.random()),_="__symbol@@"+m,E=o.getOwnPropertyNames,$=o.getOwnPropertyDescriptor,B=o.create,q=o.keys,j=o.freeze||o,K=o.defineProperty,W=o.defineProperties,X=$(o,"getOwnPropertyNames"),re=o.prototype,oe=re.hasOwnProperty,ne=re.propertyIsEnumerable,ae=re.toString,y=function(t,o,s){oe.call(t,_)||K(t,_,{enumerable:!1,configurable:!1,writable:!1,value:{}}),t[_]["@@"+o]=s},x=function(){},ta=function(t){return t!=_&&!oe.call(de,t)},ia=function(t){return t!=_&&oe.call(de,t)},sa=function(t){var o=String(t);return ia(o)?oe.call(this,o)&&!!this[_]&&this[_]["@@"+o]:ne.call(this,t)},n=function(t){return K(re,t,{enumerable:!1,configurable:!0,get:x,set:function(o){we(this,t,{enumerable:!1,configurable:!0,writable:!0,value:o}),y(this,t,!0)}}),de[t]=K(o(t),"constructor",me),j(de[t])},le=function G(t){if(this instanceof G)throw new TypeError("Symbol is not a constructor");return n("__symbol:".concat(t||"",m,++h))},de=B(null),me={value:le},ib=function(t){return de[t]},Va=function(t,o,s){var l=String(o);if(ia(l)){if(o=we,s.enumerable){var h=B(s);h.enumerable=!1}else h=s;o(t,l,h),y(t,l,!!s.enumerable)}else K(t,o,s);return t},jb=function(t){return E(t).filter(ia).map(ib)};X.value=Va,K(o,"defineProperty",X),X.value=jb,K(o,s,X),X.value=function(t){return E(t).filter(ta)},K(o,"getOwnPropertyNames",X),X.value=function(t,o){var s=jb(o);return s.length?q(o).concat(s).forEach((function(s){sa.call(o,s)&&Va(t,s,o[s])})):W(t,o),t},K(o,"defineProperties",X),X.value=sa,K(re,"propertyIsEnumerable",X),X.value=le,K(l,"Symbol",X),X.value=function(t){return(t="__symbol:".concat("__symbol:",t,m))in re?de[t]:n(t)},K(le,"for",X),X.value=function(t){if(ta(t))throw new TypeError(t+" is not a symbol");if(oe.call(de,t)&&("__symbol:"===(t=t.slice(10)).slice(0,10)&&(t=t.slice(10))!==m))return 0<(t=t.slice(0,t.length-m.length)).length?t:void 0},K(le,"keyFor",X),X.value=function(t,o){var s=$(t,o);return s&&ia(o)&&(s.enumerable=sa.call(t,o)),s},K(o,"getOwnPropertyDescriptor",X),X.value=function(t,o){return 1===arguments.length||void 0===o?B(t):function(t,o){var s=B(t);return E(o).forEach((function(t){sa.call(o,t)&&Va(s,t,o[t])})),s}(t,o)},K(o,"create",X),X.value=function(){var t=ae.call(this);return"[object String]"===t&&ia(this)?"[object Symbol]":t},K(re,"toString",X);try{if(!0!==B(K({},"__symbol:",{get:function(){return K(this,"__symbol:",{value:!0})["__symbol:"]}}))["__symbol:"])throw"IE11";var we=K}catch(t){we=function(t,o,s){var l=$(re,o);delete re[o],K(t,o,s),K(re,o,l)}}}}(Object,"getOwnPropertySymbols"),function(t,o){var s,l=t.defineProperty,h=t.prototype,m=h.toString;"iterator match replace search split hasInstance isConcatSpreadable unscopables species toPrimitive toStringTag".split(" ").forEach((function(_){_ in o||(l(o,_,{value:o(_)}),"toStringTag"===_&&((s=t.getOwnPropertyDescriptor(h,"toString")).value=function(){var t=m.call(this),s=null==this?this:this[o.toStringTag];return null==s?t:"[object "+s+"]"},l(h,"toString",s)))}))}(Object,Symbol),function(t,o,s){function d(){return this}o[t]||(o[t]=function(){var o=0,s=this,l={next:function(){var t=s.length<=o;return t?{done:t}:{done:t,value:s[o++]}}};return l[t]=d,l}),s[t]||(s[t]=function(){var o=String.fromCodePoint,s=this,l=0,h=s.length,m={next:function(){var t=h<=l,m=t?"":o(s.codePointAt(l));return l+=m.length,t?{done:t}:{done:t,value:m}}};return m[t]=d,m})}(Symbol.iterator,Array.prototype,String.prototype);var K=Object.prototype.toString;Object.prototype.toString=function(){return void 0===this?"[object Undefined]":null===this?"[object Null]":K.call(this)},Object.keys=function(t){return Object.getOwnPropertyNames(t).filter((function(o){return(o=Object.getOwnPropertyDescriptor(t,o))&&o.enumerable}))},String.prototype[Symbol.iterator]&&String.prototype.codePointAt||(String.prototype[Symbol.iterator]=function Xa(){var t,o=this;return Ea(Xa,(function(s){if(1==s.g&&(t=0),3!=s.g)return t<o.length?s=ya(s,o[t]):(s.g=0,s=void 0),s;t++,s.g=2}))}),Set.prototype[Symbol.iterator]||(Set.prototype[Symbol.iterator]=function Ya(){var t,o,s=this;return Ea(Ya,(function(l){if(1==l.g&&(t=[],s.forEach((function(o){t.push(o)})),o=0),3!=l.g)return o<t.length?l=ya(l,t[o]):(l.g=0,l=void 0),l;o++,l.g=2}))}),Map.prototype[Symbol.iterator]||(Map.prototype[Symbol.iterator]=function Za(){var t,o,s=this;return Ea(Za,(function(l){if(1==l.g&&(t=[],s.forEach((function(o,s){t.push([s,o])})),o=0),3!=l.g)return o<t.length?l=ya(l,t[o]):(l.g=0,l=void 0),l;o++,l.g=2}))});var W=document.createEvent("Event");if(W.initEvent("foo",!0,!0),W.preventDefault(),!W.defaultPrevented){var X=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){this.cancelable&&(X.call(this),Object.defineProperty(this,"defaultPrevented",{get:function(){return!0},configurable:!0}))}}var re=/Trident/.test(navigator.userAgent);if(!window.Event||re&&"function"!=typeof window.Event){var oe=window.Event;if(window.Event=function(t,o){o=o||{};var s=document.createEvent("Event");return s.initEvent(t,!!o.bubbles,!!o.cancelable),s},oe){for(var ne in oe)window.Event[ne]=oe[ne];window.Event.prototype=oe.prototype}}if((!window.CustomEvent||re&&"function"!=typeof window.CustomEvent)&&(window.CustomEvent=function(t,o){o=o||{};var s=document.createEvent("CustomEvent");return s.initCustomEvent(t,!!o.bubbles,!!o.cancelable,o.detail),s},window.CustomEvent.prototype=window.Event.prototype),!window.MouseEvent||re&&"function"!=typeof window.MouseEvent){var ae=window.MouseEvent;if(window.MouseEvent=function(t,o){o=o||{};var s=document.createEvent("MouseEvent");return s.initMouseEvent(t,!!o.bubbles,!!o.cancelable,o.view||window,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget),s},ae)for(var le in ae)window.MouseEvent[le]=ae[le];window.MouseEvent.prototype=ae.prototype}var de,me=function(){function a(){l++}var t=!1,o=!1,s={get capture(){return t=!0},get once(){return o=!0}},l=0,h=document.createElement("div");h.addEventListener("click",a,s);var m=t&&o;return m&&(h.dispatchEvent(new Event("click")),h.dispatchEvent(new Event("click")),m=1==l),h.removeEventListener("click",a,s),m}(),we=null!==(de=window.EventTarget)&&void 0!==de?de:window.Node;if(!me&&"addEventListener"in we.prototype){var lb=function(t){if(!t||"object"!=typeof t&&"function"!=typeof t){var o=!!t;t=!1}else o=!!t.capture,t=!!t.once;return{capture:o,once:t}},_e=we.prototype.addEventListener,xe=we.prototype.removeEventListener,Te=new WeakMap,Ee=new WeakMap,sb=function(t,o,s){var l=s?Te:Ee;return void 0===(s=l.get(t))&&l.set(t,s=new Map),void 0===(t=s.get(o))&&s.set(o,t=new WeakMap),t};we.prototype.addEventListener=function(t,o,s){var l=this;if(null!=o){var h=(s=lb(s)).capture;s=s.once;var m=sb(this,t,h);if(!m.has(o)){var _=s?function(s){return m.delete(o),xe.call(l,t,_,h),"function"==typeof o?o.call(l,s):"function"==typeof(null==o?void 0:o.handleEvent)?o.handleEvent(s):void 0}:null;m.set(o,_),_e.call(this,t,null!=_?_:o,h)}}},we.prototype.removeEventListener=function(t,o,s){if(null!=o){s=lb(s).capture;var l=sb(this,t,s),h=l.get(o);void 0!==h&&(l.delete(o),xe.call(this,t,null!=h?h:o,s))}}}Object.getOwnPropertyDescriptor(Node.prototype,"baseURI")||Object.defineProperty(Node.prototype,"baseURI",{get:function(){var t=(this.ownerDocument||this).querySelector("base[href]");return t&&t.href||window.location.href},configurable:!0,enumerable:!0});var Ie,Fe,He=Element.prototype,qe=null!==(Ie=Object.getOwnPropertyDescriptor(He,"attributes"))&&void 0!==Ie?Ie:Object.getOwnPropertyDescriptor(Node.prototype,"attributes"),Ve=null!==(Fe=null==qe?void 0:qe.get)&&void 0!==Fe?Fe:function(){return this.attributes},Ge=Array.prototype.map;He.hasOwnProperty("getAttributeNames")||(He.getAttributeNames=function(){return Ge.call(Ve.call(this),(function(t){return t.name}))});var We,et=Element.prototype;et.hasOwnProperty("matches")||(et.matches=null!==(We=et.webkitMatchesSelector)&&void 0!==We?We:et.msMatchesSelector);var tt=Node.prototype.appendChild;function Cb(t){(t=t.prototype).hasOwnProperty("append")||Object.defineProperty(t,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];for(s=(o=ka(o)).next();!s.done;s=o.next())s=s.value,tt.call(this,"string"==typeof s?document.createTextNode(s):s)}})}Cb(Document),Cb(DocumentFragment),Cb(Element);var rt,ot,nt=Node.prototype.insertBefore,it=null!==(ot=null===(rt=Object.getOwnPropertyDescriptor(Node.prototype,"firstChild"))||void 0===rt?void 0:rt.get)&&void 0!==ot?ot:function(){return this.firstChild};function Hb(t){(t=t.prototype).hasOwnProperty("prepend")||Object.defineProperty(t,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];s=it.call(this);for(var l=(o=ka(o)).next();!l.done;l=o.next())l=l.value,nt.call(this,"string"==typeof l?document.createTextNode(l):l,s)}})}Hb(Document),Hb(DocumentFragment),Hb(Element);var st,lt,ct=Node.prototype.appendChild,dt=Node.prototype.removeChild,ut=null!==(lt=null===(st=Object.getOwnPropertyDescriptor(Node.prototype,"firstChild"))||void 0===st?void 0:st.get)&&void 0!==lt?lt:function(){return this.firstChild};function Nb(t){(t=t.prototype).hasOwnProperty("replaceChildren")||Object.defineProperty(t,"replaceChildren",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];for(;null!==(s=ut.call(this));)dt.call(this,s);for(s=(o=ka(o)).next();!s.done;s=o.next())s=s.value,ct.call(this,"string"==typeof s?document.createTextNode(s):s)}})}Nb(Document),Nb(DocumentFragment),Nb(Element);var ht,pt,ft,gt,vt=Node.prototype.insertBefore,mt=null!==(pt=null===(ht=Object.getOwnPropertyDescriptor(Node.prototype,"parentNode"))||void 0===ht?void 0:ht.get)&&void 0!==pt?pt:function(){return this.parentNode},yt=null!==(gt=null===(ft=Object.getOwnPropertyDescriptor(Node.prototype,"nextSibling"))||void 0===ft?void 0:ft.get)&&void 0!==gt?gt:function(){return this.nextSibling};function Vb(t){(t=t.prototype).hasOwnProperty("after")||Object.defineProperty(t,"after",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];if(null!==(s=mt.call(this)))for(var l=yt.call(this),h=(o=ka(o)).next();!h.done;h=o.next())h=h.value,vt.call(s,"string"==typeof h?document.createTextNode(h):h,l)}})}Vb(CharacterData),Vb(Element);var bt,wt,Ct=Node.prototype.insertBefore,_t=null!==(wt=null===(bt=Object.getOwnPropertyDescriptor(Node.prototype,"parentNode"))||void 0===bt?void 0:bt.get)&&void 0!==wt?wt:function(){return this.parentNode};function $b(t){(t=t.prototype).hasOwnProperty("before")||Object.defineProperty(t,"before",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];if(null!==(s=_t.call(this)))for(var l=(o=ka(o)).next();!l.done;l=o.next())l=l.value,Ct.call(s,"string"==typeof l?document.createTextNode(l):l,this)}})}$b(CharacterData),$b(Element);var kt,xt,St=Node.prototype.removeChild,Tt=null!==(xt=null===(kt=Object.getOwnPropertyDescriptor(Node.prototype,"parentNode"))||void 0===kt?void 0:kt.get)&&void 0!==xt?xt:function(){return this.parentNode};function ec(t){(t=t.prototype).hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=Tt.call(this);t&&St.call(t,this)}})}ec(CharacterData),ec(Element);var Et,At,It=Node.prototype.insertBefore,Pt=Node.prototype.removeChild,Rt=null!==(At=null===(Et=Object.getOwnPropertyDescriptor(Node.prototype,"parentNode"))||void 0===Et?void 0:Et.get)&&void 0!==At?At:function(){return this.parentNode};function lc(t){(t=t.prototype).hasOwnProperty("replaceWith")||Object.defineProperty(t,"replaceWith",{configurable:!0,enumerable:!0,writable:!0,value:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];if(null!==(s=Rt.call(this))){for(var l=(o=ka(o)).next();!l.done;l=o.next())l=l.value,It.call(s,"string"==typeof l?document.createTextNode(l):l,this);Pt.call(s,this)}}})}lc(CharacterData),lc(Element);var $t=window.Element.prototype,Mt=window.HTMLElement.prototype,Ot=window.SVGElement.prototype;!Mt.hasOwnProperty("classList")||$t.hasOwnProperty("classList")||Ot.hasOwnProperty("classList")||Object.defineProperty($t,"classList",Object.getOwnPropertyDescriptor(Mt,"classList"));var Nt=Element.prototype,Dt=Element.prototype.hasAttribute,Lt=Element.prototype.setAttribute,Ft=Element.prototype.removeAttribute;Nt.hasOwnProperty("toggleAttribute")||(Nt.toggleAttribute=function(t,o){return void 0===o?Dt.call(this,t)?(Ft.call(this,t),!1):(Lt.call(this,t,""),!0):o?(Dt.call(this,t)||Lt.call(this,t,""),!0):(Ft.call(this,t),!1)});var Bt=document.createElement("style");Bt.textContent="body {transition: opacity ease-in 0.2s; } \nbody[unresolved] {opacity: 0; display: block; overflow: hidden; position: relative; } \n";var Ht=document.querySelector("head");Ht.insertBefore(Bt,Ht.firstChild);var Ut=window;Ut.WebComponents=Ut.WebComponents||{flags:{}};var qt=document.querySelector('script[src*="webcomponents-bundle"]'),jt=/wc-(.+)/,zt={};if(!zt.noOpts){if(location.search.slice(1).split("&").forEach((function(t){var o;(t=t.split("="))[0]&&(o=t[0].match(jt))&&(zt[o[1]]=t[1]||!0)})),qt)for(var Vt=0,Gt=void 0;Gt=qt.attributes[Vt];Vt++)"src"!==Gt.name&&(zt[Gt.name]=Gt.value||!0);var Kt={};zt.log&&zt.log.split&&zt.log.split(",").forEach((function(t){Kt[t]=!0})),zt.log=Kt}Ut.WebComponents.flags=zt;var Wt=zt.shadydom;if(Wt){Ut.ShadyDOM=Ut.ShadyDOM||{},Ut.ShadyDOM.force=Wt;var Qt=zt.noPatch;Ut.ShadyDOM.noPatch="true"===Qt||Qt}var Yt=zt.register||zt.ce;function Fc(){}function D(t){return t.__shady||(t.__shady=new Fc),t.__shady}function L(t){return t&&t.__shady}Yt&&window.customElements&&(Ut.customElements.forcePolyfill=Yt),function(){function a(){}function b(t,o){if(!t.childNodes.length)return[];switch(t.nodeType){case Node.DOCUMENT_NODE:return W.call(t,o);case Node.DOCUMENT_FRAGMENT_NODE:return X.call(t,o);default:return K.call(t,o)}}var t="undefined"==typeof HTMLTemplateElement,o=!(document.createDocumentFragment().cloneNode()instanceof DocumentFragment),s=!1;/Trident/.test(navigator.userAgent)&&function(){function p(t,s){if(t instanceof DocumentFragment)for(var l;l=t.firstChild;)o.call(this,l,s);else o.call(this,t,s);return t}s=!0;var t=Node.prototype.cloneNode;Node.prototype.cloneNode=function(o){return o=t.call(this,o),this instanceof DocumentFragment&&(o.__proto__=DocumentFragment.prototype),o},DocumentFragment.prototype.querySelectorAll=HTMLElement.prototype.querySelectorAll,DocumentFragment.prototype.querySelector=HTMLElement.prototype.querySelector,Object.defineProperties(DocumentFragment.prototype,{nodeType:{get:function(){return Node.DOCUMENT_FRAGMENT_NODE},configurable:!0},localName:{get:function(){},configurable:!0},nodeName:{get:function(){return"#document-fragment"},configurable:!0}});var o=Node.prototype.insertBefore;Node.prototype.insertBefore=p;var l=Node.prototype.appendChild;Node.prototype.appendChild=function(t){return t instanceof DocumentFragment?p.call(this,t,null):l.call(this,t),t};var h=Node.prototype.removeChild,m=Node.prototype.replaceChild;Node.prototype.replaceChild=function(t,o){return t instanceof DocumentFragment?(p.call(this,t,o),h.call(this,o)):m.call(this,t,o),o},Document.prototype.createDocumentFragment=function(){var t=this.createElement("df");return t.__proto__=DocumentFragment.prototype,t};var _=Document.prototype.importNode;Document.prototype.importNode=function(t,o){return o=_.call(this,t,o||!1),t instanceof DocumentFragment&&(o.__proto__=DocumentFragment.prototype),o}}();var l=Node.prototype.cloneNode,h=Document.prototype.createElement,m=Document.prototype.importNode,_=Node.prototype.removeChild,E=Node.prototype.appendChild,$=Node.prototype.replaceChild,B=DOMParser.prototype.parseFromString,q=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML")||{get:function(){return this.innerHTML},set:function(t){this.innerHTML=t}},j=Object.getOwnPropertyDescriptor(window.Node.prototype,"childNodes")||{get:function(){return this.childNodes}},K=Element.prototype.querySelectorAll,W=Document.prototype.querySelectorAll,X=DocumentFragment.prototype.querySelectorAll,re=function(){if(!t){var s=document.createElement("template"),l=document.createElement("template");return l.content.appendChild(document.createElement("div")),s.content.appendChild(l),0===(s=s.cloneNode(!0)).content.childNodes.length||0===s.content.firstChild.content.childNodes.length||o}}();if(t){var oe=document.implementation.createHTMLDocument("template"),ne=!0,ae=document.createElement("style");ae.textContent="template{display:none;}";var le=document.head;le.insertBefore(ae,le.firstElementChild),a.prototype=Object.create(HTMLElement.prototype);var de=!document.createElement("div").hasOwnProperty("innerHTML");a.Z=function(t){if(!t.content&&t.namespaceURI===document.documentElement.namespaceURI){t.content=oe.createDocumentFragment();for(var o;o=t.firstChild;)E.call(t.content,o);if(de)t.__proto__=a.prototype;else if(t.cloneNode=function(t){return a.va(this,t)},ne)try{n(t),J(t)}catch(t){ne=!1}a.bootstrap(t.content)}};var me={option:["select"],thead:["table"],col:["colgroup","table"],tr:["tbody","table"],th:["tr","tbody","table"],td:["tr","tbody","table"]},n=function(t){Object.defineProperty(t,"innerHTML",{get:function(){return xa(this)},set:function(t){var o=me[(/<([a-z][^/\0>\x20\t\r\n\f]+)/i.exec(t)||["",""])[1].toLowerCase()];if(o)for(var s=0;s<o.length;s++)t="<"+o[s]+">"+t+"</"+o[s]+">";for(oe.body.innerHTML=t,a.bootstrap(oe);this.content.firstChild;)_.call(this.content,this.content.firstChild);if(t=oe.body,o)for(s=0;s<o.length;s++)t=t.lastChild;for(;t.firstChild;)E.call(this.content,t.firstChild)},configurable:!0})},J=function(t){Object.defineProperty(t,"outerHTML",{get:function(){return"<template>"+this.innerHTML+"</template>"},set:function(t){if(!this.parentNode)throw Error("Failed to set the 'outerHTML' property on 'Element': This element has no parent node.");for(oe.body.innerHTML=t,t=this.ownerDocument.createDocumentFragment();oe.body.firstChild;)E.call(t,oe.body.firstChild);$.call(this.parentNode,t,this)},configurable:!0})};n(a.prototype),J(a.prototype),a.bootstrap=function(t){for(var o,s=0,l=(t=b(t,"template")).length;s<l&&(o=t[s]);s++)a.Z(o)},document.addEventListener("DOMContentLoaded",(function(){a.bootstrap(document)})),Document.prototype.createElement=function(){var t=h.apply(this,arguments);return"template"===t.localName&&a.Z(t),t},DOMParser.prototype.parseFromString=function(){var t=B.apply(this,arguments);return a.bootstrap(t),t},Object.defineProperty(HTMLElement.prototype,"innerHTML",{get:function(){return xa(this)},set:function(t){q.set.call(this,t),a.bootstrap(this)},configurable:!0,enumerable:!0});var we=/[&\u00A0"]/g,_e=/[&\u00A0<>]/g,ib=function(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"Â ":return"&nbsp;"}};ae=function(t){for(var o={},s=0;s<t.length;s++)o[t[s]]=!0;return o};var xe=ae("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),Te=ae("style script xmp iframe noembed noframes plaintext noscript".split(" ")),xa=function(t,o){"template"===t.localName&&(t=t.content);for(var s,l="",h=o?o(t):j.get.call(t),m=0,_=h.length;m<_&&(s=h[m]);m++){e:{var E=s,$=t,B=o;switch(E.nodeType){case Node.ELEMENT_NODE:for(var q=E.localName,K="<"+q,W=E.attributes,X=0;$=W[X];X++)K+=" "+$.name+'="'+$.value.replace(we,ib)+'"';K+=">",E=xe[q]?K:K+xa(E,B)+"</"+q+">";break e;case Node.TEXT_NODE:E=E.data,E=$&&Te[$.localName]?E:E.replace(_e,ib);break e;case Node.COMMENT_NODE:E="\x3c!--"+E.data+"--\x3e";break e;default:throw window.console.error(E),Error("not implemented")}}l+=E}return l}}if(t||re){a.va=function(t,o){var s=l.call(t,!1);return this.Z&&this.Z(s),o&&(E.call(s.content,l.call(t.content,!0)),I(s.content,t.content)),s};var I=function(t,o){if(o.querySelectorAll&&0!==(o=b(o,"template")).length)for(var s,l,h=0,m=(t=b(t,"template")).length;h<m;h++)l=o[h],s=t[h],a&&a.Z&&a.Z(l),$.call(s.parentNode,Ee.call(l,!0),s)},Ee=Node.prototype.cloneNode=function(t){if(!s&&o&&this instanceof DocumentFragment){if(!t)return this.ownerDocument.createDocumentFragment();var h=Ie.call(this.ownerDocument,this,!0)}else h=this.nodeType===Node.ELEMENT_NODE&&"template"===this.localName&&this.namespaceURI==document.documentElement.namespaceURI?a.va(this,t):l.call(this,t);return t&&I(h,this),h},Ie=Document.prototype.importNode=function(t,o){if(o=o||!1,"template"===t.localName)return a.va(t,o);var s=m.call(this,t,o);if(o){I(s,t),t=b(s,'script:not([type]),script[type="application/javascript"],script[type="text/javascript"]');for(var l,_=0;_<t.length;_++){l=t[_],(o=h.call(document,"script")).textContent=l.textContent;for(var E,B=l.attributes,q=0;q<B.length;q++)E=B[q],o.setAttribute(E.name,E.value);$.call(l.parentNode,o,l)}}return s}}t&&(window.HTMLTemplateElement=a)}(),Fc.prototype.toJSON=function(){return{}};var Zt=window.ShadyDOM||{};Zt.cb=!(!Element.prototype.attachShadow||!Node.prototype.getRootNode);var Jt,Xt=Object.getOwnPropertyDescriptor(Node.prototype,"firstChild");Zt.D=!!(Xt&&Xt.configurable&&Xt.get),Zt.Ba=Zt.force||!Zt.cb,Zt.J=Zt.noPatch||!1,Zt.ha=Zt.preferPerformance,Zt.Da="on-demand"===Zt.J;var er=Zt.querySelectorImplementation;function Jc(){return Document.prototype.msElementsFromPoint?"msElementsFromPoint":"elementsFromPoint"}function Lc(t){return(t=L(t))&&void 0!==t.firstChild}function O(t){return t instanceof ShadowRoot}function Mc(t){return(t=(t=L(t))&&t.root)&&Nc(t)}Jt=-1<["native","selectorEngine"].indexOf(er)?er:void 0,Zt.wb=Jt,Zt.Ra=navigator.userAgent.match("Trident");var tr=Element.prototype,rr=tr.matches||tr.matchesSelector||tr.mozMatchesSelector||tr.msMatchesSelector||tr.oMatchesSelector||tr.webkitMatchesSelector,or=document.createTextNode(""),nr=0,ir=[];function Tc(t){ir.push(t),or.textContent=nr++}new MutationObserver((function(){for(;ir.length;)try{ir.shift()()}catch(t){throw or.textContent=nr++,t}})).observe(or,{characterData:!0});var sr=document.contains?function(t,o){return t.__shady_native_contains(o)}:function(t,o){return t===o||t.documentElement&&t.documentElement.__shady_native_contains(o)};function Vc(t,o){for(;o;){if(o==t)return!0;o=o.__shady_parentNode}return!1}function Wc(t){for(var o=t.length-1;0<=o;o--){var s=t[o],l=s.getAttribute("id")||s.getAttribute("name");l&&"length"!==l&&isNaN(l)&&(t[l]=s)}return t.item=function(o){return t[o]},t.namedItem=function(o){if("length"!==o&&isNaN(o)&&t[o])return t[o];for(var s=ka(t),l=s.next();!l.done;l=s.next())if(((l=l.value).getAttribute("id")||l.getAttribute("name"))==o)return l;return null},t}function Xc(t){var o=[];for(t=t.__shady_native_firstChild;t;t=t.__shady_native_nextSibling)o.push(t);return o}function Yc(t){var o=[];for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling)o.push(t);return o}function Zc(t,o,s){if(s.configurable=!0,s.value)t[o]=s.value;else try{Object.defineProperty(t,o,s)}catch(t){}}function P(t,o,s,l){for(var h in s=void 0===s?"":s,o)l&&0<=l.indexOf(h)||Zc(t,s+h,o[h])}function $c(t,o){for(var s in o)s in t&&Zc(t,s,o[s])}function Q(t){var o={};return Object.getOwnPropertyNames(t).forEach((function(s){o[s]=Object.getOwnPropertyDescriptor(t,s)})),o}function ad(t,o){for(var s,l=Object.getOwnPropertyNames(o),h=0;h<l.length;h++)t[s=l[h]]=o[s]}function bd(t){return t instanceof Node?t:document.createTextNode(""+t)}function cd(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];if(1===o.length)return bd(o[0]);s=document.createDocumentFragment();for(var l=(o=ka(o)).next();!l.done;l=o.next())s.appendChild(bd(l.value));return s}function dd(t){var o;for(o=void 0===o?1:o;0<o;o--)t=t.reduce((function(t,o){return Array.isArray(o)?t.push.apply(t,w(o)):t.push(o),t}),[]);return t}var ar,lr=[];function hd(t){ar||(ar=!0,Tc(id)),lr.push(t)}function id(){ar=!1;for(var t=!!lr.length;lr.length;)lr.shift()();return t}function jd(){this.g=!1,this.addedNodes=[],this.removedNodes=[],this.qa=new Set}id.list=lr,jd.prototype.flush=function(){if(this.g){this.g=!1;var t=this.takeRecords();t.length&&this.qa.forEach((function(o){o(t)}))}},jd.prototype.takeRecords=function(){if(this.addedNodes.length||this.removedNodes.length){var t=[{addedNodes:this.addedNodes,removedNodes:this.removedNodes}];return this.addedNodes=[],this.removedNodes=[],t}return[]};var cr=/[&\u00A0"]/g,dr=/[&\u00A0<>]/g;function qd(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"Â ":return"&nbsp;"}}function rd(t){for(var o={},s=0;s<t.length;s++)o[t[s]]=!0;return o}var ur=rd("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),hr=rd("style script xmp iframe noembed noframes plaintext noscript".split(" "));function ud(t,o){"template"===t.localName&&(t=t.content);for(var s="",l=o?o(t):t.childNodes,h=0,m=l.length,_=void 0;h<m&&(_=l[h]);h++){e:{var E=_,$=t,B=o;switch(E.nodeType){case Node.ELEMENT_NODE:for(var q,j="<"+($=E.localName),K=E.attributes,W=0;q=K[W];W++)j+=" "+q.name+'="'+q.value.replace(cr,qd)+'"';j+=">",E=ur[$]?j:j+ud(E,B)+"</"+$+">";break e;case Node.TEXT_NODE:E=E.data,E=$&&hr[$.localName]?E:E.replace(dr,qd);break e;case Node.COMMENT_NODE:E="\x3c!--"+E.data+"--\x3e";break e;default:throw window.console.error(E),Error("not implemented")}}s+=E}return s}var pr=Zt.D,fr={querySelector:function(t){return this.__shady_native_querySelector(t)},querySelectorAll:function(t){return this.__shady_native_querySelectorAll(t)}},gr={};function yd(t){gr[t]=function(o){return o["__shady_native_"+t]}}function zd(t,o){for(var s in P(t,o,"__shady_native_"),o)yd(s)}function S(t,o){o=void 0===o?[]:o;for(var s=0;s<o.length;s++){var l=o[s],h=Object.getOwnPropertyDescriptor(t,l);h&&(Object.defineProperty(t,"__shady_native_"+l,h),h.value?fr[l]||(fr[l]=h.value):yd(l))}}var vr=document.createTreeWalker(document,NodeFilter.SHOW_ALL,null,!1),mr=document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT,null,!1),yr=document.implementation.createHTMLDocument("inert");function Dd(t){for(var o;o=t.__shady_native_firstChild;)t.__shady_native_removeChild(o)}var br=["firstElementChild","lastElementChild","children","childElementCount"],wr=["querySelector","querySelectorAll","append","prepend","replaceChildren"];var Cr=Q({get childNodes(){return this.__shady_childNodes},get firstChild(){return this.__shady_firstChild},get lastChild(){return this.__shady_lastChild},get childElementCount(){return this.__shady_childElementCount},get children(){return this.__shady_children},get firstElementChild(){return this.__shady_firstElementChild},get lastElementChild(){return this.__shady_lastElementChild},get shadowRoot(){return this.__shady_shadowRoot}}),_r=Q({get textContent(){return this.__shady_textContent},set textContent(t){this.__shady_textContent=t},get innerHTML(){return this.__shady_innerHTML},set innerHTML(t){this.__shady_innerHTML=t}}),kr=Q({get parentElement(){return this.__shady_parentElement},get parentNode(){return this.__shady_parentNode},get nextSibling(){return this.__shady_nextSibling},get previousSibling(){return this.__shady_previousSibling},get nextElementSibling(){return this.__shady_nextElementSibling},get previousElementSibling(){return this.__shady_previousElementSibling},get className(){return this.__shady_className},set className(t){this.__shady_className=t}});function Kd(t){for(var o in t){var s=t[o];s&&(s.enumerable=!1)}}Kd(Cr),Kd(_r),Kd(kr);var xr=Zt.D||!0===Zt.J,Sr=xr?function(){}:function(t){var o=D(t);o.Ta||(o.Ta=!0,$c(t,kr))},Tr=xr?function(){}:function(t){var o=D(t);o.Sa||(o.Sa=!0,$c(t,Cr),window.customElements&&window.customElements.polyfillWrapFlushCallback&&!Zt.J||$c(t,_r))},Er="__eventWrappers"+Date.now(),Ar=function(){var t=Object.getOwnPropertyDescriptor(Event.prototype,"composed");return t?function(o){return t.get.call(o)}:null}(),Ir=function(){function a(){}var t=!1,o={get capture(){return t=!0,!1}};return window.addEventListener("test",a,o),window.removeEventListener("test",a,o),t}();function Rd(t){if(null===t||"object"!=typeof t&&"function"!=typeof t)var o=!!t,s=!1;else{o=!!t.capture,s=!!t.once;var l=t.U}return{Pa:l,capture:o,once:s,Na:Ir?t:o}}var Pr={blur:!0,focus:!0,focusin:!0,focusout:!0,click:!0,dblclick:!0,mousedown:!0,mouseenter:!0,mouseleave:!0,mousemove:!0,mouseout:!0,mouseover:!0,mouseup:!0,wheel:!0,beforeinput:!0,input:!0,keydown:!0,keyup:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,touchstart:!0,touchend:!0,touchmove:!0,touchcancel:!0,pointerover:!0,pointerenter:!0,pointerdown:!0,pointermove:!0,pointerup:!0,pointercancel:!0,pointerout:!0,pointerleave:!0,gotpointercapture:!0,lostpointercapture:!0,dragstart:!0,drag:!0,dragenter:!0,dragleave:!0,dragover:!0,drop:!0,dragend:!0,DOMActivate:!0,DOMFocusIn:!0,DOMFocusOut:!0,keypress:!0},Rr={DOMAttrModified:!0,DOMAttributeNameChanged:!0,DOMCharacterDataModified:!0,DOMElementNameChanged:!0,DOMNodeInserted:!0,DOMNodeInsertedIntoDocument:!0,DOMNodeRemoved:!0,DOMNodeRemovedFromDocument:!0,DOMSubtreeModified:!0};function Ud(t){return t instanceof Node?t.__shady_getRootNode():t}function Vd(t,o){var s=[],l=t;for(t=Ud(t);l;)s.push(l),l=l.__shady_assignedSlot?l.__shady_assignedSlot:l.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&l.host&&(o||l!==t)?l.host:l.__shady_parentNode;return s[s.length-1]===document&&s.push(window),s}function Xd(t,o){if(!O)return t;t=Vd(t,!0);for(var s,l,h=0,m=void 0,_=void 0;h<o.length;h++)if((l=Ud(s=o[h]))!==m&&(_=t.indexOf(l),m=l),!O(l)||-1<_)return s}var $r={get composed(){return void 0===this.__composed&&(Ar?this.__composed="focusin"===this.type||"focusout"===this.type||Ar(this):!1!==this.isTrusted&&(this.__composed=Pr[this.type])),this.__composed||!1},composedPath:function(){return this.__composedPath||(this.__composedPath=Vd(this.__target,this.composed)),this.__composedPath},get target(){return Xd(this.currentTarget||this.__previousCurrentTarget,this.composedPath())},get relatedTarget(){return this.__relatedTarget?(this.__relatedTargetComposedPath||(this.__relatedTargetComposedPath=Vd(this.__relatedTarget,!0)),Xd(this.currentTarget||this.__previousCurrentTarget,this.__relatedTargetComposedPath)):null},stopPropagation:function(){Event.prototype.stopPropagation.call(this),this.ua=!0},stopImmediatePropagation:function(){Event.prototype.stopImmediatePropagation.call(this),this.ua=this.__immediatePropagationStopped=!0}},Mr=Zt.D&&Object.getOwnPropertyDescriptor(Event.prototype,"eventPhase");function $d(t){function b(o,s){return(o=new t(o,s)).__composed=s&&!!s.composed,o}return b.__proto__=t,b.prototype=t.prototype,b}Mr&&(Object.defineProperty($r,"eventPhase",{get:function(){return this.currentTarget===this.target?Event.AT_TARGET:this.__shady_native_eventPhase},enumerable:!0,configurable:!0}),Object.defineProperty($r,"__shady_native_eventPhase",Mr));var Or={focus:!0,blur:!0};function be(t){return t.__target!==t.target||t.__relatedTarget!==t.relatedTarget}function ce(t,o,s){if(s=o.__handlers&&o.__handlers[t.type]&&o.__handlers[t.type][s])for(var l,h=0;(l=s[h])&&(!be(t)||t.target!==t.relatedTarget)&&(l.call(o,t),!t.__immediatePropagationStopped);h++);}var Nr=new Event("e").hasOwnProperty("currentTarget");function ee(t){var o=(t=Nr?Object.create(t):t).composedPath(),s=o.map((function(t){return Xd(t,o)})),l=t.bubbles,h=Object.getOwnPropertyDescriptor(t,"currentTarget");Object.defineProperty(t,"currentTarget",{configurable:!0,enumerable:!0,get:function(){return $}});var m=Event.CAPTURING_PHASE,_=Object.getOwnPropertyDescriptor(t,"eventPhase");Object.defineProperty(t,"eventPhase",{configurable:!0,enumerable:!0,get:function(){return m}});try{for(var E=o.length-1;0<=E;E--){var $=o[E];if(m=$===s[E]?Event.AT_TARGET:Event.CAPTURING_PHASE,ce(t,$,"capture"),t.ua)return}for(E=0;E<o.length;E++){var B=($=o[E])===s[E];if((B||l)&&(m=B?Event.AT_TARGET:Event.BUBBLING_PHASE,ce(t,$,"bubble"),t.ua))break}}finally{Nr||(h?Object.defineProperty(t,"currentTarget",h):delete t.currentTarget,_?Object.defineProperty(t,"eventPhase",_):delete t.eventPhase)}}function fe(t,o,s,l){for(var h=0;h<t.length;h++){var m=t[h],_=m.type,E=m.capture;if(o===m.node&&s===_&&l===E)return h}return-1}function ge(t){return id(),!Zt.ha&&this instanceof Node&&!sr(document,this)?(t.__target||he(t,this),ee(t)):this.__shady_native_dispatchEvent(t)}function ie(t,o,s){var l=this,h=Rd(s),m=h.capture,_=h.once,E=h.Pa;if(h=h.Na,o){var $=typeof o;if(("function"===$||"object"===$)&&("object"!==$||o.handleEvent&&"function"==typeof o.handleEvent)){if(Rr[t])return this.__shady_native_addEventListener(t,o,h);var B=E||this;if(E=o[Er]){if(-1<fe(E,B,t,m))return}else o[Er]=[];E=function(h){if(_&&l.__shady_removeEventListener(t,o,s),h.__target||he(h),B!==l){var E=Object.getOwnPropertyDescriptor(h,"currentTarget");Object.defineProperty(h,"currentTarget",{get:function(){return B},configurable:!0});var q=Object.getOwnPropertyDescriptor(h,"eventPhase");Object.defineProperty(h,"eventPhase",{configurable:!0,enumerable:!0,get:function(){return m?Event.CAPTURING_PHASE:Event.BUBBLING_PHASE}})}if(h.__previousCurrentTarget=h.currentTarget,(!O(B)&&"slot"!==B.localName||-1!=h.composedPath().indexOf(B))&&(h.composed||-1<h.composedPath().indexOf(B)))if(be(h)&&h.target===h.relatedTarget)h.eventPhase===Event.BUBBLING_PHASE&&h.stopImmediatePropagation();else if(h.eventPhase===Event.CAPTURING_PHASE||h.bubbles||h.target===B||B instanceof Window){var j="function"===$?o.call(B,h):o.handleEvent&&o.handleEvent(h);return B!==l&&(E?(Object.defineProperty(h,"currentTarget",E),E=null):delete h.currentTarget,q?(Object.defineProperty(h,"eventPhase",q),q=null):delete h.eventPhase),j}},o[Er].push({node:B,type:t,capture:m,ub:E}),this.__handlers=this.__handlers||{},this.__handlers[t]=this.__handlers[t]||{capture:[],bubble:[]},this.__handlers[t][m?"capture":"bubble"].push(E),Or[t]||this.__shady_native_addEventListener(t,E,h)}}}function je(t,o,s){if(o){var l=Rd(s);s=l.capture;var h=l.Pa;if(l=l.Na,Rr[t])return this.__shady_native_removeEventListener(t,o,l);var m=h||this;h=void 0;var _=null;try{_=o[Er]}catch(t){}_&&(-1<(m=fe(_,m,t,s))&&(h=_.splice(m,1)[0].ub,_.length||(o[Er]=void 0))),this.__shady_native_removeEventListener(t,h||o,l),h&&this.__handlers&&this.__handlers[t]&&(-1<(o=(t=this.__handlers[t][s?"capture":"bubble"]).indexOf(h))&&t.splice(o,1))}}var Dr=Q($r);function he(t,o){if(o=void 0===o?t.target:o,t.__target=o,t.__relatedTarget=t.relatedTarget,Zt.D){if(!(o=Object.getPrototypeOf(t)).hasOwnProperty("__shady_patchedProto")){var s=Object.create(o);s.__shady_sourceProto=o,P(s,Dr),o.__shady_patchedProto=s}t.__proto__=o.__shady_patchedProto}else P(t,Dr)}var Lr=$d(Event),Fr=$d(CustomEvent),Br=$d(MouseEvent);var Hr=Object.getOwnPropertyNames(Element.prototype).filter((function(t){return"on"===t.substring(0,2)})),Ur=Object.getOwnPropertyNames(HTMLElement.prototype).filter((function(t){return"on"===t.substring(0,2)}));function se(t){return{set:function(o){var s=D(this),l=t.substring(2);s.T||(s.T={}),s.T[t]&&this.removeEventListener(l,s.T[t]),this.__shady_addEventListener(l,o),s.T[t]=o},get:function(){var o=L(this);return o&&o.T&&o.T[t]},configurable:!0}}function te(t,o){return{index:t,ia:[],pa:o}}function ue(t,o,s,l){var h=0,m=0,_=0,E=0,$=Math.min(o-h,l-m);if(0==h&&0==m)e:{for(_=0;_<$;_++)if(t[_]!==s[_])break e;_=$}if(o==t.length&&l==s.length){E=t.length;for(var B=s.length,q=0;q<$-_&&ve(t[--E],s[--B]);)q++;E=q}if(m+=_,l-=E,0==(o-=E)-(h+=_)&&0==l-m)return[];if(h==o){for(o=te(h,0);m<l;)o.ia.push(s[m++]);return[o]}if(m==l)return[te(h,o-h)];for(l=l-(_=m)+1,E=o-($=h)+1,o=Array(l),B=0;B<l;B++)o[B]=Array(E),o[B][0]=B;for(B=0;B<E;B++)o[0][B]=B;for(B=1;B<l;B++)for(q=1;q<E;q++)if(t[$+q-1]===s[_+B-1])o[B][q]=o[B-1][q-1];else{var j=o[B-1][q]+1,K=o[B][q-1]+1;o[B][q]=j<K?j:K}for($=o.length-1,_=o[0].length-1,l=o[$][_],t=[];0<$||0<_;)0==$?(t.push(2),_--):0==_?(t.push(3),$--):(E=o[$-1][_-1],(j=(B=o[$-1][_])<(q=o[$][_-1])?B<E?B:E:q<E?q:E)==E?(E==l?t.push(0):(t.push(1),l=E),$--,_--):j==B?(t.push(3),$--,l=B):(t.push(2),_--,l=q));for(t.reverse(),o=void 0,$=[],_=0;_<t.length;_++)switch(t[_]){case 0:o&&($.push(o),o=void 0),h++,m++;break;case 1:o||(o=te(h,0)),o.pa++,h++,o.ia.push(s[m]),m++;break;case 2:o||(o=te(h,0)),o.pa++,h++;break;case 3:o||(o=te(h,0)),o.ia.push(s[m]),m++}return o&&$.push(o),$}function ve(t,o){return t===o}var qr=Q({dispatchEvent:ge,addEventListener:ie,removeEventListener:je}),jr=null;function ye(){return jr||(jr=window.ShadyCSS&&window.ShadyCSS.ScopingShim),jr||null}function ze(t,o,s){var l=ye();return!(!l||"class"!==o)&&(l.setElementClass(t,s),!0)}function Ae(t,o){var s=ye();s&&s.unscopeNode(t,o)}function Be(t,o){var s=ye();if(!s)return!0;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){for(s=!0,t=t.__shady_firstChild;t;t=t.__shady_nextSibling)s=s&&Be(t,o);return s}return t.nodeType!==Node.ELEMENT_NODE||s.currentScopeForNode(t)===o}function Ce(t){if(t.nodeType!==Node.ELEMENT_NODE)return"";var o=ye();return o?o.currentScopeForNode(t):""}function De(t,o){if(t)for(t.nodeType===Node.ELEMENT_NODE&&o(t),t=t.__shady_firstChild;t;t=t.__shady_nextSibling)t.nodeType===Node.ELEMENT_NODE&&De(t,o)}var zr=window.document,Vr=Zt.ha,Gr=Object.getOwnPropertyDescriptor(Node.prototype,"isConnected"),Kr=Gr&&Gr.get;function Je(t){for(var o;o=t.__shady_firstChild;)t.__shady_removeChild(o)}function Ke(t){var o=L(t);if(o&&void 0!==o.ta)for(o=t.__shady_firstChild;o;o=o.__shady_nextSibling)Ke(o);(t=L(t))&&(t.ta=void 0)}function Le(t){var o=t;if(t&&"slot"===t.localName){var s=L(t);(s=s&&s.aa)&&(o=s.length?s[0]:Le(t.__shady_nextSibling))}return o}function Me(t,o,s){if(t=(t=L(t))&&t.ga){if(o)if(o.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(var l=0,h=o.childNodes.length;l<h;l++)t.addedNodes.push(o.childNodes[l]);else t.addedNodes.push(o);s&&t.removedNodes.push(s),function kd(t){t.g||(t.g=!0,Tc((function(){t.flush()})))}(t)}}var Wr=Q({get parentNode(){var t=L(this);return void 0!==(t=t&&t.parentNode)?t:this.__shady_native_parentNode},get firstChild(){var t=L(this);return void 0!==(t=t&&t.firstChild)?t:this.__shady_native_firstChild},get lastChild(){var t=L(this);return void 0!==(t=t&&t.lastChild)?t:this.__shady_native_lastChild},get nextSibling(){var t=L(this);return void 0!==(t=t&&t.nextSibling)?t:this.__shady_native_nextSibling},get previousSibling(){var t=L(this);return void 0!==(t=t&&t.previousSibling)?t:this.__shady_native_previousSibling},get childNodes(){if(Lc(this)){var t=L(this);if(!t.childNodes){t.childNodes=[];for(var o=this.__shady_firstChild;o;o=o.__shady_nextSibling)t.childNodes.push(o)}var s=t.childNodes}else s=this.__shady_native_childNodes;return s.item=function(t){return s[t]},s},get parentElement(){var t=L(this);return(t=t&&t.parentNode)&&t.nodeType!==Node.ELEMENT_NODE&&(t=null),void 0!==t?t:this.__shady_native_parentElement},get isConnected(){if(Kr&&Kr.call(this))return!0;if(this.nodeType==Node.DOCUMENT_FRAGMENT_NODE)return!1;var t=this.ownerDocument;if(null===t||sr(t,this))return!0;for(t=this;t&&!(t instanceof Document);)t=t.__shady_parentNode||(O(t)?t.host:void 0);return!!(t&&t instanceof Document)},get textContent(){if(Lc(this)){for(var t=[],o=this.__shady_firstChild;o;o=o.__shady_nextSibling)o.nodeType!==Node.COMMENT_NODE&&t.push(o.__shady_textContent);return t.join("")}return this.__shady_native_textContent},set textContent(t){switch(null==t&&(t=""),this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:if(!Lc(this)&&Zt.D){var o=this.__shady_firstChild;(o!=this.__shady_lastChild||o&&o.nodeType!=Node.TEXT_NODE)&&Je(this),this.__shady_native_textContent=t}else Je(this),(0<t.length||this.nodeType===Node.ELEMENT_NODE)&&this.__shady_insertBefore(document.createTextNode(t));break;default:this.nodeValue=t}},insertBefore:function(t,o){if(this.ownerDocument!==zr&&t.ownerDocument!==zr)return this.__shady_native_insertBefore(t,o),t;if(t===this)throw Error("Failed to execute 'appendChild' on 'Node': The new child element contains the parent.");if(o){var s=L(o);if(void 0!==(s=s&&s.parentNode)&&s!==this||void 0===s&&o.__shady_native_parentNode!==this)throw Error("Failed to execute 'insertBefore' on 'Node': The node before which the new node is to be inserted is not a child of this node.")}if(o===t)return t;Me(this,t);var l=[],h=(s=Ne(this))?s.host.localName:Ce(this),m=t.__shady_parentNode;if(m){var _=Ce(t),E=!!s||!Ne(t)||Vr&&void 0!==this.__noInsertionPoint;m.__shady_removeChild(t,E)}m=!0;var $=(!Vr||void 0===t.__noInsertionPoint&&void 0===this.__noInsertionPoint)&&!Be(t,h),B=s&&!t.__noInsertionPoint&&(!Vr||t.nodeType===Node.DOCUMENT_FRAGMENT_NODE);return(B||$)&&($&&(_=_||Ce(t)),De(t,(function(t){if(B&&"slot"===t.localName&&l.push(t),$){var o=_;ye()&&(o&&Ae(t,o),(o=ye())&&o.scopeNode(t,h))}}))),l.length&&(Oe(s),s.i.push.apply(s.i,w(l)),Pe(s)),Lc(this)&&(function Qe(t,o,s){Nf(o,2);var l=D(o);if(void 0!==l.firstChild&&(l.childNodes=null),t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(t=t.__shady_native_firstChild;t;t=t.__shady_native_nextSibling)Of(t,o,l,s);else Of(t,o,l,s)}(t,this,o),(E=L(this)).root?(m=!1,Mc(this)&&Pe(E.root)):s&&"slot"===this.localName&&(m=!1,Pe(s))),m?(s=O(this)?this.host:this,o?(o=Le(o),s.__shady_native_insertBefore(t,o)):s.__shady_native_appendChild(t)):t.ownerDocument!==this.ownerDocument&&this.ownerDocument.adoptNode(t),t},appendChild:function(t){if(this!=t||!O(t))return this.__shady_insertBefore(t)},removeChild:function(t,o){if(o=void 0!==o&&o,this.ownerDocument!==zr)return this.__shady_native_removeChild(t);if(t.__shady_parentNode!==this)throw Error("The node to be removed is not a child of this node: "+t);Me(this,null,t);var s=Ne(t),l=s&&function Re(t,o){if(t.g){kf(t);var s,l=t.h;for(s in l)for(var h=l[s],m=0;m<h.length;m++){var _=h[m];if(Vc(o,_)){h.splice(m,1);var E=t.g.indexOf(_);if(0<=E&&(t.g.splice(E,1),(E=L(_.__shady_parentNode))&&E.ka&&E.ka--),m--,E=(_=L(_)).aa)for(var $=0;$<E.length;$++){var B=E[$],q=B.__shady_native_parentNode;q&&q.__shady_native_removeChild(B)}_.aa=[],_.assignedNodes=[],E=!0}}return E}}(s,t),h=L(this);if(Lc(this)&&(function Se(t,o){var s=D(t);o=D(o),t===o.firstChild&&(o.firstChild=s.nextSibling),t===o.lastChild&&(o.lastChild=s.previousSibling),t=s.previousSibling;var l=s.nextSibling;t&&(D(t).nextSibling=l),l&&(D(l).previousSibling=t),s.parentNode=s.previousSibling=s.nextSibling=void 0,void 0!==o.childNodes&&(o.childNodes=null)}(t,this),Mc(this))){Pe(h.root);var m=!0}if(ye()&&!o&&s&&t.nodeType!==Node.TEXT_NODE){var _=Ce(t);De(t,(function(t){Ae(t,_)}))}return Ke(t),s&&((o="slot"===this.localName)&&(m=!0),(l||o)&&Pe(s)),m||(m=O(this)?this.host:this,(!h.root&&"slot"!==t.localName||m===t.__shady_native_parentNode)&&m.__shady_native_removeChild(t)),t},replaceChild:function(t,o){return this.__shady_insertBefore(t,o),this.__shady_removeChild(o),t},cloneNode:function(t){if("template"==this.localName)return this.__shady_native_cloneNode(t);var o=this.__shady_native_cloneNode(!1);if(t&&o.nodeType!==Node.ATTRIBUTE_NODE){t=this.__shady_firstChild;for(var s;t;t=t.__shady_nextSibling)s=t.__shady_cloneNode(!0),o.__shady_appendChild(s)}return o},getRootNode:function(t){if(this&&this.nodeType){var o=D(this),s=o.ta;return void 0===s&&(O(this)?(s=this,o.ta=s):(s=(s=this.__shady_parentNode)?s.__shady_getRootNode(t):this,document.documentElement.__shady_native_contains(this)&&(o.ta=s))),s}},contains:function(t){return Vc(this,t)}}),Qr=Q({get assignedSlot(){var t=this.__shady_parentNode;return(t=t&&t.__shady_shadowRoot)&&Ue(t),(t=L(this))&&t.assignedSlot||null}}),Yr=new Map;function Xe(t,o,s,l){for(l=void 0===l||l;o<t.length;o++)if("\\"===t[o]&&o<t.length-1&&"\n"!==t[o+1])o++;else{if(-1!==s.indexOf(t[o]))return o;if(l&&Yr.has(t[o])){var h=Yr.get(t[o]);o=Xe(t,o+1,[h.end],h.sa)}}return t.length}function Ze(t,o,s){var l=[];return $e(t,o,s,l),l}function $e(t,o,s,l){for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling){var h;if(h=t.nodeType===Node.ELEMENT_NODE){var m=o,_=s,E=l,$=m(h=t);$&&E.push(h),_&&_($)?h=$:($e(h,m,_,E),h=void 0)}if(h)break}}[["(",{end:")",sa:!0}],["[",{end:"]",sa:!0}],['"',{end:'"',sa:!1}],["'",{end:"'",sa:!1}]].forEach((function(t){var o=ka(t);t=o.next().value,o=o.next().value,Yr.set(t,o)}));var Zr={get firstElementChild(){var t=L(this);if(t&&void 0!==t.firstChild){for(t=this.__shady_firstChild;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_nextSibling;return t}return this.__shady_native_firstElementChild},get lastElementChild(){var t=L(this);if(t&&void 0!==t.lastChild){for(t=this.__shady_lastChild;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_previousSibling;return t}return this.__shady_native_lastElementChild},get children(){return Lc(this)?Wc(Array.prototype.filter.call(Yc(this),(function(t){return t.nodeType===Node.ELEMENT_NODE}))):this.__shady_native_children},get childElementCount(){var t=this.__shady_children;return t?t.length:0}},Jr=Q((Zr.append=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];this.__shady_insertBefore(cd.apply(null,w(o)),null)},Zr.prepend=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];this.__shady_insertBefore(cd.apply(null,w(o)),this.__shady_firstChild)},Zr.replaceChildren=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];for(;null!==(s=this.__shady_firstChild);)this.__shady_removeChild(s);this.__shady_insertBefore(cd.apply(null,w(o)),null)},Zr));function cf(t,o){function c(o,s){return(o===t||-1===s.indexOf(":scope"))&&rr.call(o,s)}var s=function Ye(t){function b(){if(0<s.length){for(;" "===s[s.length-1];)s.pop();o.push({La:s.filter((function(t,o){return 0==o%2})),Za:s.filter((function(t,o){return 1==o%2}))}),s.length=0}}for(var o=[],s=[],l=0;l<t.length;){var h=s[s.length-1],m=Xe(t,l,[","," ",">","+","~"]),_=m===l?t[l]:t.substring(l,m);","===_?b():-1!==[void 0," ",">","+","~"].indexOf(h)&&" "===_||(" "===h&&-1!==[">","+","~"].indexOf(_)?s[s.length-1]=_:s.push(_)),l=m+(m===l?1:0)}return b(),o}(o);if(1>s.length)return[];for(o=dd(Ze(t,(function(){return!0})).map((function(t){return dd(s.map((function(o){var s=o.La,l=s.length-1;return c(t,s[l])?{target:t,da:o,fa:t,index:l}:[]})))})));o.some((function(t){return 0<t.index}));)o=dd(o.map((function(t){if(0>=t.index)return t;var o=t.target,s=t.fa,l=t.da;t=t.index-1;var h=l.Za[t],m=l.La[t];if(" "===h){for(h=[],s=s.__shady_parentElement;s;s=s.__shady_parentElement)c(s,m)&&h.push({target:o,da:l,fa:s,index:t});return h}if(">"===h)return c(s=s.__shady_parentElement,m)?{target:o,da:l,fa:s,index:t}:[];if("+"===h)return(s=s.__shady_previousElementSibling)&&c(s,m)?{target:o,da:l,fa:s,index:t}:[];if("~"===h){for(h=[],s=s.__shady_previousElementSibling;s;s=s.__shady_previousElementSibling)c(s,m)&&h.push({target:o,da:l,fa:s,index:t});return h}throw Error("Unrecognized combinator: '"+h+"'.")})));return function ed(t){for(var o=[],s=new Set,l=(t=ka(t)).next();!l.done;l=t.next())l=l.value,s.has(l)||(o.push(l),s.add(l));return o}(o.map((function(t){return t.target})))}var Xr=Zt.querySelectorImplementation,eo=Q({querySelector:function(t){if("native"===Xr){for(var o=Array.prototype.slice.call((this instanceof ShadowRoot?this.host:this).__shady_native_querySelectorAll(t)),s=this.__shady_getRootNode(),l=(o=ka(o)).next();!l.done;l=o.next())if((l=l.value).__shady_getRootNode()==s)return l;return null}if("selectorEngine"===Xr)return cf(this,t)[0]||null;if(void 0===Xr)return Ze(this,(function(o){return rr.call(o,t)}),(function(t){return!!t}))[0]||null;throw Error("Unrecognized value of ShadyDOM.querySelectorImplementation: '"+Xr+"'")},querySelectorAll:function(t,o){if(o||"native"===Xr){o=Array.prototype.slice.call((this instanceof ShadowRoot?this.host:this).__shady_native_querySelectorAll(t));var s=this.__shady_getRootNode();return Wc(o.filter((function(t){return t.__shady_getRootNode()==s})))}if("selectorEngine"===Xr)return Wc(cf(this,t));if(void 0===Xr)return Wc(Ze(this,(function(o){return rr.call(o,t)})));throw Error("Unrecognized value of ShadyDOM.querySelectorImplementation: '"+Xr+"'")}}),to=Zt.ha&&!Zt.J?ad({},Jr):Jr;ad(Jr,eo);var ro=Q({after:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];if(null!==(s=this.__shady_parentNode)){var l=this.__shady_nextSibling;s.__shady_insertBefore(cd.apply(null,w(o)),l)}},before:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];null!==(s=this.__shady_parentNode)&&s.__shady_insertBefore(cd.apply(null,w(o)),this)},remove:function(){var t=this.__shady_parentNode;null!==t&&t.__shady_removeChild(this)},replaceWith:function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];if(null!==(s=this.__shady_parentNode)){var l=this.__shady_nextSibling;s.__shady_removeChild(this),s.__shady_insertBefore(cd.apply(null,w(o)),l)}}}),oo=window.document;function jf(t,o){if("slot"===o)Mc(t=t.__shady_parentNode)&&Pe(L(t).root);else if("slot"===t.localName&&"name"===o&&(o=Ne(t))){if(o.g){kf(o);var s=t.Ua,l=lf(t);if(l!==s){var h=(s=o.h[s]).indexOf(t);0<=h&&s.splice(h,1),(s=o.h[l]||(o.h[l]=[])).push(t),1<s.length&&(o.h[l]=mf(s))}}Pe(o)}}var no=Q({get previousElementSibling(){var t=L(this);if(t&&void 0!==t.previousSibling){for(t=this.__shady_previousSibling;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_previousSibling;return t}return this.__shady_native_previousElementSibling},get nextElementSibling(){var t=L(this);if(t&&void 0!==t.nextSibling){for(t=this.__shady_nextSibling;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.__shady_nextSibling;return t}return this.__shady_native_nextElementSibling},get slot(){return this.getAttribute("slot")},set slot(t){this.__shady_setAttribute("slot",t)},get className(){return this.getAttribute("class")||""},set className(t){this.__shady_setAttribute("class",t)},setAttribute:function(t,o){this.ownerDocument!==oo?this.__shady_native_setAttribute(t,o):ze(this,t,o)||(this.__shady_native_setAttribute(t,o),jf(this,t))},removeAttribute:function(t){this.ownerDocument!==oo?this.__shady_native_removeAttribute(t):ze(this,t,"")?""===this.getAttribute(t)&&this.__shady_native_removeAttribute(t):(this.__shady_native_removeAttribute(t),jf(this,t))},toggleAttribute:function(t,o){return this.ownerDocument!==oo?this.__shady_native_toggleAttribute(t,o):ze(this,t,"")?""!==this.getAttribute(t)||o?void 0:this.__shady_native_toggleAttribute(t,o):(o=this.__shady_native_toggleAttribute(t,o),jf(this,t),o)}});Zt.ha||Hr.forEach((function(t){no[t]=se(t)}));var io=Q({attachShadow:function(t){if(!this)throw Error("Must provide a host.");if(!t)throw Error("Not enough arguments.");if(t.shadyUpgradeFragment&&!Zt.Ra){var o=t.shadyUpgradeFragment;if(o.__proto__=ShadowRoot.prototype,of(o,this,t),pf(o,o),t=o.__noInsertionPoint?null:o.querySelectorAll("slot"),o.__noInsertionPoint=void 0,t&&t.length){var s=o;Oe(s),s.i.push.apply(s.i,w(t)),Pe(o)}o.host.__shady_native_appendChild(o)}else o=new qf(xo,this,t);return this.__CE_shadowRoot=o},get shadowRoot(){var t=L(this);return t&&t.lb||null}});ad(no,io);var so=document.implementation.createHTMLDocument("inert"),ao=Q({get innerHTML(){return Lc(this)?ud("template"===this.localName?this.content:this,Yc):this.__shady_native_innerHTML},set innerHTML(t){if("template"===this.localName)this.__shady_native_innerHTML=t;else{Je(this);var o=this.localName||"div";for(o=this.namespaceURI&&this.namespaceURI!==so.namespaceURI?so.createElementNS(this.namespaceURI,o):so.createElement(o),Zt.D?o.__shady_native_innerHTML=t:o.innerHTML=t;t=o.__shady_firstChild;)this.__shady_insertBefore(t)}}}),lo=Q({blur:function(){var t=L(this);(t=(t=t&&t.root)&&t.activeElement)?t.__shady_blur():this.__shady_native_blur()}});Zt.ha||Ur.forEach((function(t){lo[t]=se(t)}));var co=Q({assignedNodes:function(t){if("slot"===this.localName){var o=this.__shady_getRootNode();return o&&O(o)&&Ue(o),(o=L(this))&&(t&&t.flatten?o.aa:o.assignedNodes)||[]}},addEventListener:function(t,o,s){if("slot"!==this.localName||"slotchange"===t)ie.call(this,t,o,s);else{"object"!=typeof s&&(s={capture:!!s});var l=this.__shady_parentNode;if(!l)throw Error("ShadyDOM cannot attach event to slot unless it has a `parentNode`");s.U=this,l.__shady_addEventListener(t,o,s)}},removeEventListener:function(t,o,s){if("slot"!==this.localName||"slotchange"===t)je.call(this,t,o,s);else{"object"!=typeof s&&(s={capture:!!s});var l=this.__shady_parentNode;if(!l)throw Error("ShadyDOM cannot attach event to slot unless it has a `parentNode`");s.U=this,l.__shady_removeEventListener(t,o,s)}}}),uo=Q({getElementById:function(t){return""===t?null:Ze(this,(function(o){return o.id==t}),(function(t){return!!t}))[0]||null}});function yf(t,o){for(var s;o&&!t.has(s=o.__shady_getRootNode());)o=s.host;return o}var ho="__shady_native_"+Jc(),po=Q({get activeElement(){var t=Zt.D?document.__shady_native_activeElement:document.activeElement;if(!t||!t.nodeType)return null;var o=!!O(this);if(!(this===document||o&&this.host!==t&&this.host.__shady_native_contains(t)))return null;for(o=Ne(t);o&&o!==this;)o=Ne(t=o.host);return this===document?o?null:t:o===this?t:null},elementsFromPoint:function(t,o){if(t=document[ho](t,o),this===document&&Zt.useNativeDocumentEFP)return t;t=[].slice.call(t),o=function zf(t){var o=new Set;for(o.add(t);O(t)&&t.host;)t=t.host.__shady_getRootNode(),o.add(t);return o}(this);for(var s=new Set,l=0;l<t.length;l++)s.add(yf(o,t[l]));var h=[];return s.forEach((function(t){return h.push(t)})),h},elementFromPoint:function(t,o){return this===document&&Zt.useNativeDocumentEFP?this.__shady_native_elementFromPoint(t,o):this.__shady_elementsFromPoint(t,o)[0]||null}}),fo=window.document,go=Q({importNode:function(t,o){if(t.ownerDocument!==fo||"template"===t.localName)return this.__shady_native_importNode(t,o);var s=this.__shady_native_importNode(t,!1);if(o)for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling)o=this.__shady_importNode(t,!0),s.__shady_appendChild(o);return s}}),vo=Q({dispatchEvent:ge,addEventListener:ie.bind(window),removeEventListener:je.bind(window)}),mo={};Object.getOwnPropertyDescriptor(HTMLElement.prototype,"parentElement")&&(mo.parentElement=Wr.parentElement),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"contains")&&(mo.contains=Wr.contains),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"children")&&(mo.children=Jr.children),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"innerHTML")&&(mo.innerHTML=ao.innerHTML),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"className")&&(mo.className=no.className);var yo={EventTarget:[qr],Node:[Wr,window.EventTarget?null:qr],Text:[Qr],Comment:[Qr],CDATASection:[Qr],ProcessingInstruction:[Qr],Element:[no,Jr,ro,Qr,!Zt.D||"innerHTML"in Element.prototype?ao:null,window.HTMLSlotElement?null:co],HTMLElement:[lo,mo],HTMLSlotElement:[co],DocumentFragment:[to,uo],Document:[go,to,uo,po],Window:[vo],CharacterData:[ro],XMLHttpRequest:[window.EventTarget?null:qr]},bo=Zt.D?null:["innerHTML","textContent"];function If(t,o,s,l){o.forEach((function(o){return t&&o&&P(t,o,s,l)}))}function Jf(t){var o,s=t?null:bo;for(o in yo)If(window[o]&&window[o].prototype,yo[o],t,s)}function Kf(t){return t.__shady_protoIsPatched=!0,If(t,yo.EventTarget),If(t,yo.Node),If(t,yo.Element),If(t,yo.HTMLElement),If(t,yo.HTMLSlotElement),t}["Text","Comment","CDATASection","ProcessingInstruction"].forEach((function(t){var o=window[t],s=Object.create(o.prototype);s.__shady_protoIsPatched=!0,If(s,yo.EventTarget),If(s,yo.Node),yo[t]&&If(s,yo[t]),o.prototype.__shady_patchedProto=s}));var wo=Zt.Da,Co=Zt.D;function Nf(t,o){if(wo&&!t.__shady_protoIsPatched&&!O(t)){var s=Object.getPrototypeOf(t),l=s.hasOwnProperty("__shady_patchedProto")&&s.__shady_patchedProto;l||(Kf(l=Object.create(s)),s.__shady_patchedProto=l),Object.setPrototypeOf(t,l)}Co||(1===o?Sr(t):2===o&&Tr(t))}function Of(t,o,s,l){Nf(t,1),l=l||null;var h=D(t),m=l?D(l):null;h.previousSibling=l?m.previousSibling:o.__shady_lastChild,(m=L(h.previousSibling))&&(m.nextSibling=t),(m=L(h.nextSibling=l))&&(m.previousSibling=t),h.parentNode=o,l?l===s.firstChild&&(s.firstChild=t):(s.lastChild=t,s.firstChild||(s.firstChild=t)),s.childNodes=null}function pf(t,o){var s=D(t);if(o||void 0===s.firstChild){s.childNodes=null;var l=s.firstChild=t.__shady_native_firstChild;for(s.lastChild=t.__shady_native_lastChild,Nf(t,2),s=l,l=void 0;s;s=s.__shady_native_nextSibling){var h=D(s);h.parentNode=o||t,h.nextSibling=s.__shady_native_nextSibling,h.previousSibling=l||null,l=s,Nf(s,1)}}}var _o=Q({addEventListener:function(t,o,s){"object"!=typeof s&&(s={capture:!!s}),s.U=s.U||this,this.host.__shady_addEventListener(t,o,s)},removeEventListener:function(t,o,s){"object"!=typeof s&&(s={capture:!!s}),s.U=s.U||this,this.host.__shady_removeEventListener(t,o,s)}});function Qf(t,o){P(t,_o,o),P(t,po,o),P(t,ao,o),P(t,Jr,o),Zt.J&&!o?(P(t,Wr,o),P(t,uo,o)):Zt.D||(P(t,kr),P(t,Cr),P(t,_r))}var ko,xo={},So=Zt.deferConnectionCallbacks&&"loading"===document.readyState;function Tf(t){var o=[];do{o.unshift(t)}while(t=t.__shady_parentNode);return o}function qf(t,o,s){if(t!==xo)throw new TypeError("Illegal constructor");this.g=null,of(this,o,s)}function of(t,o,s){if(t.host=o,t.mode=s&&s.mode,pf(t.host),(o=D(t.host)).root=t,o.lb="closed"!==t.mode?t:null,(o=D(t)).firstChild=o.lastChild=o.parentNode=o.nextSibling=o.previousSibling=null,Zt.preferPerformance)for(;o=t.host.__shady_native_firstChild;)t.host.__shady_native_removeChild(o);else Pe(t)}function Pe(t){t.Y||(t.Y=!0,hd((function(){return Ue(t)})))}function Ue(t){var o;if(o=t.Y){for(var s;t;)t.Y&&(s=t),O(t=(o=t).host.__shady_getRootNode())&&(o=L(o.host))&&0<o.ka||(t=void 0);o=s}(s=o)&&s._renderSelf()}function Uf(t,o,s){var l=D(o),h=l.xa;l.xa=null,s||(s=(t=t.h[o.__shady_slot||"__catchall"])&&t[0]),s?(D(s).assignedNodes.push(o),l.assignedSlot=s):l.assignedSlot=void 0,h!==l.assignedSlot&&l.assignedSlot&&(D(l.assignedSlot).Aa=!0)}function Vf(t,o,s){for(var l=0,h=void 0;l<s.length&&(h=s[l]);l++)if("slot"==h.localName){var m=L(h).assignedNodes;m&&m.length&&Vf(t,o,m)}else o.push(s[l])}function Wf(t,o){o.__shady_native_dispatchEvent(new Event("slotchange")),(o=L(o)).assignedSlot&&Wf(t,o.assignedSlot)}function Oe(t){t.i=t.i||[],t.g=t.g||[],t.h=t.h||{}}function kf(t){if(t.i&&t.i.length){for(var o,s=t.i,l=0;l<s.length;l++){var h=s[l];pf(h);var m=h.__shady_parentNode;pf(m),(m=L(m)).ka=(m.ka||0)+1,m=lf(h),t.h[m]?((o=o||{})[m]=!0,t.h[m].push(h)):t.h[m]=[h],t.g.push(h)}if(o)for(var _ in o)t.h[_]=mf(t.h[_]);t.i=[]}}function lf(t){var o=t.name||t.getAttribute("name")||"__catchall";return t.Ua=o}function mf(t){return t.sort((function(t,o){t=Tf(t);for(var s=Tf(o),l=0;l<t.length;l++){o=t[l];var h=s[l];if(o!==h)return(t=Yc(o.__shady_parentNode)).indexOf(o)-t.indexOf(h)}}))}function Nc(t){return kf(t),!(!t.g||!t.g.length)}if(qf.prototype._renderSelf=function(){var t=So;if(So=!0,this.Y=!1,this.g){kf(this);for(var o,s=0;s<this.g.length;s++){var l=L(o=this.g[s]),h=l.assignedNodes;if(l.assignedNodes=[],l.aa=[],l.Ja=h)for(l=0;l<h.length;l++){var m=L(h[l]);m.xa=m.assignedSlot,m.assignedSlot===o&&(m.assignedSlot=null)}}for(s=this.host.__shady_firstChild;s;s=s.__shady_nextSibling)Uf(this,s);for(s=0;s<this.g.length;s++){if(!(h=L(o=this.g[s])).assignedNodes.length)for(l=o.__shady_firstChild;l;l=l.__shady_nextSibling)Uf(this,l,o);if((l=(l=L(o.__shady_parentNode))&&l.root)&&(Nc(l)||l.Y)&&l._renderSelf(),Vf(this,h.aa,h.assignedNodes),l=h.Ja){for(m=0;m<l.length;m++)L(l[m]).xa=null;h.Ja=null,l.length>h.assignedNodes.length&&(h.Aa=!0)}h.Aa&&(h.Aa=!1,Wf(this,o))}for(o=this.g,s=[],h=0;h<o.length;h++)(m=L(l=o[h].__shady_parentNode))&&m.root||!(0>s.indexOf(l))||s.push(l);for(o=0;o<s.length;o++){for(h=(m=s[o])===this?this.host:m,l=[],m=m.__shady_firstChild;m;m=m.__shady_nextSibling)if("slot"==m.localName)for(var _=L(m).aa,E=0;E<_.length;E++)l.push(_[E]);else l.push(m);m=Xc(h),_=ue(l,l.length,m,m.length);for(var $=E=0,B=void 0;E<_.length&&(B=_[E]);E++){for(var q=0,j=void 0;q<B.ia.length&&(j=B.ia[q]);q++)j.__shady_native_parentNode===h&&h.__shady_native_removeChild(j),m.splice(B.index+$,1);$-=B.pa}for($=0,B=void 0;$<_.length&&(B=_[$]);$++)for(E=m[B.index],q=B.index;q<B.index+B.pa;q++)j=l[q],h.__shady_native_insertBefore(j,E),m.splice(q,0,j)}}if(!Zt.preferPerformance&&!this.Ia)for(s=this.host.__shady_firstChild;s;s=s.__shady_nextSibling)o=L(s),s.__shady_native_parentNode!==this.host||"slot"!==s.localName&&o.assignedSlot||this.host.__shady_native_removeChild(s);this.Ia=!0,So=t,ko&&ko()},function(t){t.__proto__=DocumentFragment.prototype,Qf(t,"__shady_"),Qf(t),Object.defineProperties(t,{nodeType:{value:Node.DOCUMENT_FRAGMENT_NODE,configurable:!0},nodeName:{value:"#document-fragment",configurable:!0},nodeValue:{value:null,configurable:!0}}),["localName","namespaceURI","prefix"].forEach((function(o){Object.defineProperty(t,o,{value:void 0,configurable:!0})})),["ownerDocument","baseURI","isConnected"].forEach((function(o){Object.defineProperty(t,o,{get:function(){return this.host[o]},configurable:!0})}))}(qf.prototype),window.customElements&&window.customElements.define&&Zt.Ba&&!Zt.preferPerformance){var To=new Map;ko=function(){var t=[];To.forEach((function(o,s){t.push([s,o])})),To.clear();for(var o=0;o<t.length;o++){var s=t[o][0];t[o][1]?s.__shadydom_connectedCallback():s.__shadydom_disconnectedCallback()}},So&&document.addEventListener("readystatechange",(function(){So=!1,ko()}),{once:!0});var Eo=window.customElements.define,$f=function(t,o){var s=o.prototype.connectedCallback,l=o.prototype.disconnectedCallback;Eo.call(window.customElements,t,function(t,o,s){var l=0,h="__isConnected"+l++;return(o||s)&&(t.prototype.connectedCallback=t.prototype.__shadydom_connectedCallback=function(){So?To.set(this,!0):this[h]||(this[h]=!0,o&&o.call(this))},t.prototype.disconnectedCallback=t.prototype.__shadydom_disconnectedCallback=function(){So?this.isConnected||To.set(this,!1):this[h]&&(this[h]=!1,s&&s.call(this))}),t}(o,s,l)),o.prototype.connectedCallback=s,o.prototype.disconnectedCallback=l};window.customElements.define=$f,Object.defineProperty(window.CustomElementRegistry.prototype,"define",{value:$f,configurable:!0})}function Ne(t){if(O(t=t.__shady_getRootNode()))return t}function ag(t){this.node=t}function bg(t){Object.defineProperty(ag.prototype,t,{get:function(){return this.node["__shady_"+t]},set:function(o){this.node["__shady_"+t]=o},configurable:!0})}(o=ag.prototype).addEventListener=function(t,o,s){return this.node.__shady_addEventListener(t,o,s)},o.removeEventListener=function(t,o,s){return this.node.__shady_removeEventListener(t,o,s)},o.appendChild=function(t){return this.node.__shady_appendChild(t)},o.insertBefore=function(t,o){return this.node.__shady_insertBefore(t,o)},o.removeChild=function(t){return this.node.__shady_removeChild(t)},o.replaceChild=function(t,o){return this.node.__shady_replaceChild(t,o)},o.cloneNode=function(t){return this.node.__shady_cloneNode(t)},o.getRootNode=function(t){return this.node.__shady_getRootNode(t)},o.contains=function(t){return this.node.__shady_contains(t)},o.dispatchEvent=function(t){return this.node.__shady_dispatchEvent(t)},o.setAttribute=function(t,o){this.node.__shady_setAttribute(t,o)},o.getAttribute=function(t){return this.node.__shady_native_getAttribute(t)},o.hasAttribute=function(t){return this.node.__shady_native_hasAttribute(t)},o.removeAttribute=function(t){this.node.__shady_removeAttribute(t)},o.toggleAttribute=function(t,o){return this.node.__shady_toggleAttribute(t,o)},o.attachShadow=function(t){return this.node.__shady_attachShadow(t)},o.focus=function(){this.node.__shady_native_focus()},o.blur=function(){this.node.__shady_blur()},o.importNode=function(t,o){if(this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_importNode(t,o)},o.getElementById=function(t){if(this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_getElementById(t)},o.elementsFromPoint=function(t,o){return this.node.__shady_elementsFromPoint(t,o)},o.elementFromPoint=function(t,o){return this.node.__shady_elementFromPoint(t,o)},o.querySelector=function(t){return this.node.__shady_querySelector(t)},o.querySelectorAll=function(t,o){return this.node.__shady_querySelectorAll(t,o)},o.assignedNodes=function(t){if("slot"===this.node.localName)return this.node.__shady_assignedNodes(t)},o.append=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];return this.node.__shady_append.apply(this.node,w(o))},o.prepend=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];return this.node.__shady_prepend.apply(this.node,w(o))},o.after=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];return this.node.__shady_after.apply(this.node,w(o))},o.before=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];return this.node.__shady_before.apply(this.node,w(o))},o.remove=function(){return this.node.__shady_remove()},o.replaceWith=function(t){for(var o=[],s=0;s<arguments.length;++s)o[s]=arguments[s];return this.node.__shady_replaceWith.apply(this.node,w(o))},h.Object.defineProperties(ag.prototype,{activeElement:{configurable:!0,enumerable:!0,get:function(){if(O(this.node)||this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_activeElement}},_activeElement:{configurable:!0,enumerable:!0,get:function(){return this.activeElement}},host:{configurable:!0,enumerable:!0,get:function(){if(O(this.node))return this.node.host}},parentNode:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_parentNode}},firstChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_firstChild}},lastChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_lastChild}},nextSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_nextSibling}},previousSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_previousSibling}},childNodes:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_childNodes}},parentElement:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_parentElement}},firstElementChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_firstElementChild}},lastElementChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_lastElementChild}},nextElementSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_nextElementSibling}},previousElementSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_previousElementSibling}},children:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_children}},childElementCount:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_childElementCount}},shadowRoot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_shadowRoot}},assignedSlot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_assignedSlot}},isConnected:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_isConnected}},innerHTML:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_innerHTML},set:function(t){this.node.__shady_innerHTML=t}},textContent:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_textContent},set:function(t){this.node.__shady_textContent=t}},slot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_slot},set:function(t){this.node.__shady_slot=t}},className:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_className},set:function(t){this.node.__shady_className=t}}}),Hr.forEach((function(t){return bg(t)})),Ur.forEach((function(t){return bg(t)}));var Ao=new WeakMap;function dg(t){if(O(t)||t instanceof ag)return t;var o=Ao.get(t);return o||(o=new ag(t),Ao.set(t,o)),o}if(Zt.Ba){var Io=Zt.D?function(t){return t}:function(t){return Tr(t),Sr(t),t},Po={inUse:Zt.Ba,patch:Io,isShadyRoot:O,enqueue:hd,flush:id,flushInitial:function(t){!t.Ia&&t.Y&&Ue(t)},settings:Zt,filterMutations:function nd(t,o){var s=o.getRootNode();return t.map((function(t){var o=s===t.target.getRootNode();if(o&&t.addedNodes){if(o=[].slice.call(t.addedNodes).filter((function(t){return s===t.getRootNode()})),o.length)return t=Object.create(t),Object.defineProperty(t,"addedNodes",{value:o,configurable:!0}),t}else if(o)return t})).filter((function(t){return t}))},observeChildren:function ld(t,o){var s=D(t);s.ga||(s.ga=new jd),s.ga.qa.add(o);var l=s.ga;return{Va:o,X:l,Wa:t,takeRecords:function(){return l.takeRecords()}}},unobserveChildren:function md(t){var o=t&&t.X;o&&(o.qa.delete(t.Va),o.qa.size||(D(t.Wa).ga=null))},deferConnectionCallbacks:Zt.deferConnectionCallbacks,preferPerformance:Zt.preferPerformance,handlesDynamicScoping:!0,wrap:Zt.J?dg:Io,wrapIfNeeded:!0===Zt.J?dg:function(t){return t},Wrapper:ag,composedPath:function Wd(t){return t.__composedPath||(t.__composedPath=Vd(t.target,!0)),t.__composedPath},noPatch:Zt.J,patchOnDemand:Zt.Da,nativeMethods:fr,nativeTree:gr,patchElementProto:Kf,querySelectorImplementation:Zt.querySelectorImplementation};window.ShadyDOM=Po,function Gd(){var t=["dispatchEvent","addEventListener","removeEventListener"];window.EventTarget?(S(window.EventTarget.prototype,t),void 0===window.__shady_native_addEventListener&&S(Window.prototype,t)):(S(Node.prototype,t),S(Window.prototype,t),S(XMLHttpRequest.prototype,t)),pr?S(Node.prototype,"parentNode firstChild lastChild previousSibling nextSibling childNodes parentElement textContent".split(" ")):zd(Node.prototype,{parentNode:{get:function(){return vr.currentNode=this,vr.parentNode()}},firstChild:{get:function(){return vr.currentNode=this,vr.firstChild()}},lastChild:{get:function(){return vr.currentNode=this,vr.lastChild()}},previousSibling:{get:function(){return vr.currentNode=this,vr.previousSibling()}},nextSibling:{get:function(){return vr.currentNode=this,vr.nextSibling()}},childNodes:{get:function(){var t=[];vr.currentNode=this;for(var o=vr.firstChild();o;)t.push(o),o=vr.nextSibling();return t}},parentElement:{get:function(){return mr.currentNode=this,mr.parentNode()}},textContent:{get:function(){switch(this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:for(var t,o=document.createTreeWalker(this,NodeFilter.SHOW_TEXT,null,!1),s="";t=o.nextNode();)s+=t.nodeValue;return s;default:return this.nodeValue}},set:function(t){switch(null==t&&(t=""),this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:Dd(this),(0<t.length||this.nodeType===Node.ELEMENT_NODE)&&this.__shady_native_insertBefore(document.createTextNode(t),void 0);break;default:this.nodeValue=t}}}}),S(Node.prototype,"appendChild insertBefore removeChild replaceChild cloneNode contains".split(" ")),S(HTMLElement.prototype,["parentElement","contains"]),t={firstElementChild:{get:function(){return mr.currentNode=this,mr.firstChild()}},lastElementChild:{get:function(){return mr.currentNode=this,mr.lastChild()}},children:{get:function(){var t=[];mr.currentNode=this;for(var o=mr.firstChild();o;)t.push(o),o=mr.nextSibling();return Wc(t)}},childElementCount:{get:function(){return this.children?this.children.length:0}}},pr?(S(Element.prototype,br),S(Element.prototype,["previousElementSibling","nextElementSibling","innerHTML","className"]),S(HTMLElement.prototype,["children","innerHTML","className"])):(zd(Element.prototype,t),zd(Element.prototype,{previousElementSibling:{get:function(){return mr.currentNode=this,mr.previousSibling()}},nextElementSibling:{get:function(){return mr.currentNode=this,mr.nextSibling()}},innerHTML:{get:function(){return ud(this,Xc)},set:function(t){var o="template"===this.localName?this.content:this;Dd(o);var s=this.localName||"div";for((s=this.namespaceURI&&this.namespaceURI!==yr.namespaceURI?yr.createElementNS(this.namespaceURI,s):yr.createElement(s)).innerHTML=t,t="template"===this.localName?s.content:s;s=t.__shady_native_firstChild;)o.__shady_native_insertBefore(s,void 0)}},className:{get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}}})),S(Element.prototype,"setAttribute getAttribute hasAttribute removeAttribute toggleAttribute focus blur".split(" ")),S(Element.prototype,wr),S(HTMLElement.prototype,["focus","blur"]),window.HTMLTemplateElement&&S(window.HTMLTemplateElement.prototype,["innerHTML"]),pr?S(DocumentFragment.prototype,br):zd(DocumentFragment.prototype,t),S(DocumentFragment.prototype,wr),pr?(S(Document.prototype,br),S(Document.prototype,["activeElement"])):zd(Document.prototype,t),S(Document.prototype,["importNode","getElementById","elementFromPoint",Jc()]),S(Document.prototype,wr)}(),Jf("__shady_"),Object.defineProperty(document,"_activeElement",po.activeElement),P(Window.prototype,vo,"__shady_"),Zt.J?Zt.Da&&P(Element.prototype,io):(Jf(),function pe(){if(!Ar&&Object.getOwnPropertyDescriptor(Event.prototype,"isTrusted")){var a=function(){var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,composed:!0});this.__shady_dispatchEvent(t)};Element.prototype.click?Element.prototype.click=a:HTMLElement.prototype.click&&(HTMLElement.prototype.click=a)}}()),function ke(){for(var t in Or)window.__shady_native_addEventListener(t,(function(t){t.__target||(he(t),ee(t))}),!0)}(),window.Event=Lr,window.CustomEvent=Fr,window.MouseEvent=Br,window.ShadowRoot=qf}var Ro=window.Document.prototype.createElement,$o=window.Document.prototype.createElementNS,Mo=window.Document.prototype.importNode,Oo=window.Document.prototype.prepend,No=window.Document.prototype.append,Do=window.DocumentFragment.prototype.prepend,Lo=window.DocumentFragment.prototype.append,Fo=window.Node.prototype.cloneNode,Bo=window.Node.prototype.appendChild,Ho=window.Node.prototype.insertBefore,Uo=window.Node.prototype.removeChild,qo=window.Node.prototype.replaceChild,jo=Object.getOwnPropertyDescriptor(window.Node.prototype,"textContent"),zo=window.Element.prototype.attachShadow,Vo=Object.getOwnPropertyDescriptor(window.Element.prototype,"innerHTML"),Go=window.Element.prototype.getAttribute,Ko=window.Element.prototype.setAttribute,Wo=window.Element.prototype.removeAttribute,Qo=window.Element.prototype.toggleAttribute,Yo=window.Element.prototype.getAttributeNS,Zo=window.Element.prototype.setAttributeNS,Jo=window.Element.prototype.removeAttributeNS,Xo=window.Element.prototype.insertAdjacentElement,en=window.Element.prototype.insertAdjacentHTML,tn=window.Element.prototype.prepend,rn=window.Element.prototype.append,on=window.Element.prototype.before,nn=window.Element.prototype.after,sn=window.Element.prototype.replaceWith,an=window.Element.prototype.remove,ln=window.HTMLElement,cn=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML"),dn=window.HTMLElement.prototype.insertAdjacentElement,un=window.HTMLElement.prototype.insertAdjacentHTML,hn=new Set;function Og(t){var o=hn.has(t);return t=/^[a-z][.0-9_a-z]*-[-.0-9_a-z]*$/.test(t),!o&&t}"annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" ").forEach((function(t){return hn.add(t)}));var pn=document.contains?document.contains.bind(document):document.documentElement.contains.bind(document.documentElement);function T(t){var o=t.isConnected;if(void 0!==o)return o;if(pn(t))return!0;for(;t&&!(t.__CE_isImportDocument||t instanceof Document);)t=t.parentNode||(window.ShadowRoot&&t instanceof ShadowRoot?t.host:void 0);return!(!t||!(t.__CE_isImportDocument||t instanceof Document))}function Qg(t){var o=t.children;if(o)return Array.prototype.slice.call(o);for(o=[],t=t.firstChild;t;t=t.nextSibling)t.nodeType===Node.ELEMENT_NODE&&o.push(t);return o}function Rg(t,o){for(;o&&o!==t&&!o.nextSibling;)o=o.parentNode;return o&&o!==t?o.nextSibling:null}function Sg(t,o,s){for(var l=t;l;){if(l.nodeType===Node.ELEMENT_NODE){var h=l;o(h);var m=h.localName;if("link"===m&&"import"===h.getAttribute("rel")){if(l=h.import,void 0===s&&(s=new Set),l instanceof Node&&!s.has(l))for(s.add(l),l=l.firstChild;l;l=l.nextSibling)Sg(l,o,s);l=Rg(t,h);continue}if("template"===m){l=Rg(t,h);continue}if(h=h.__CE_shadowRoot)for(h=h.firstChild;h;h=h.nextSibling)Sg(h,o,s)}l=l.firstChild?l.firstChild:Rg(t,l)}}function Tg(){var t=!(null==gn||!gn.noDocumentConstructionObserver),o=!(null==gn||!gn.shadyDomFastWalk);this.ca=[],this.g=[],this.W=!1,this.shadyDomFastWalk=o,this.sb=!t}function Vg(t,o,s,l){var h=window.ShadyDOM;if(t.shadyDomFastWalk&&h&&h.inUse){if(o.nodeType===Node.ELEMENT_NODE&&s(o),o.querySelectorAll)for(t=h.nativeMethods.querySelectorAll.call(o,"*"),o=0;o<t.length;o++)s(t[o])}else Sg(o,s,l)}function Yg(t,o){t.W&&Vg(t,o,(function(o){return Zg(t,o)}))}function Zg(t,o){if(t.W&&!o.__CE_patched){o.__CE_patched=!0;for(var s=0;s<t.ca.length;s++)t.ca[s](o);for(s=0;s<t.g.length;s++)t.g[s](o)}}function $g(t,o){var s=[];for(Vg(t,o,(function(t){return s.push(t)})),o=0;o<s.length;o++){var l=s[o];1===l.__CE_state?t.connectedCallback(l):ah(t,l)}}function bh(t,o){var s=[];for(Vg(t,o,(function(t){return s.push(t)})),o=0;o<s.length;o++){var l=s[o];1===l.__CE_state&&t.disconnectedCallback(l)}}function ch(t,o,s){var l=(s=void 0===s?{}:s).tb,h=s.upgrade||function(o){return ah(t,o)},m=[];for(Vg(t,o,(function(o){if(t.W&&Zg(t,o),"link"===o.localName&&"import"===o.getAttribute("rel")){var s=o.import;s instanceof Node&&(s.__CE_isImportDocument=!0,s.__CE_registry=document.__CE_registry),s&&"complete"===s.readyState?s.__CE_documentLoadHandled=!0:o.addEventListener("load",(function(){var s=o.import;if(!s.__CE_documentLoadHandled){s.__CE_documentLoadHandled=!0;var m=new Set;l&&(l.forEach((function(t){return m.add(t)})),m.delete(s)),ch(t,s,{tb:m,upgrade:h})}}))}else m.push(o)}),l),o=0;o<m.length;o++)h(m[o])}function ah(t,o){try{var s=o.ownerDocument,l=s.__CE_registry,h=l&&(s.defaultView||s.__CE_isImportDocument)?dh(l,o.localName):void 0;if(h&&void 0===o.__CE_state){h.constructionStack.push(o);try{try{if(new h.constructorFunction!==o)throw Error("The custom element constructor did not produce the element being upgraded.")}finally{h.constructionStack.pop()}}catch(t){throw o.__CE_state=2,t}if(o.__CE_state=1,o.__CE_definition=h,h.attributeChangedCallback&&o.hasAttributes()){var m=h.observedAttributes;for(h=0;h<m.length;h++){var _=m[h],E=o.getAttribute(_);null!==E&&t.attributeChangedCallback(o,_,null,E,null)}}T(o)&&t.connectedCallback(o)}}catch(t){eh(t)}}function fh(t,o,s,l){var h=o.__CE_registry;if(h&&(null===l||"http://www.w3.org/1999/xhtml"===l)&&(h=dh(h,s)))try{var m=new h.constructorFunction;if(void 0===m.__CE_state||void 0===m.__CE_definition)throw Error("Failed to construct '"+s+"': The returned value was not constructed with the HTMLElement constructor.");if("http://www.w3.org/1999/xhtml"!==m.namespaceURI)throw Error("Failed to construct '"+s+"': The constructed element's namespace must be the HTML namespace.");if(m.hasAttributes())throw Error("Failed to construct '"+s+"': The constructed element must not have any attributes.");if(null!==m.firstChild)throw Error("Failed to construct '"+s+"': The constructed element must not have any children.");if(null!==m.parentNode)throw Error("Failed to construct '"+s+"': The constructed element must not have a parent node.");if(m.ownerDocument!==o)throw Error("Failed to construct '"+s+"': The constructed element's owner document is incorrect.");if(m.localName!==s)throw Error("Failed to construct '"+s+"': The constructed element's local name is incorrect.");return m}catch(h){return eh(h),o=null===l?Ro.call(o,s):$o.call(o,l,s),Object.setPrototypeOf(o,HTMLUnknownElement.prototype),o.__CE_state=2,o.__CE_definition=void 0,Zg(t,o),o}return Zg(t,o=null===l?Ro.call(o,s):$o.call(o,l,s)),o}function eh(t){var o="",s="",l=0,h=0;t instanceof Error?(o=t.message,s=t.sourceURL||t.fileName||"",l=t.line||t.lineNumber||0,h=t.column||t.columnNumber||0):o="Uncaught "+String(t);var m=void 0;void 0===ErrorEvent.prototype.initErrorEvent?m=new ErrorEvent("error",{cancelable:!0,message:o,filename:s,lineno:l,colno:h,error:t}):((m=document.createEvent("ErrorEvent")).initErrorEvent("error",!1,!0,o,s,l),m.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{configurable:!0,get:function(){return!0}})}),void 0===m.error&&Object.defineProperty(m,"error",{configurable:!0,enumerable:!0,get:function(){return t}}),window.dispatchEvent(m),m.defaultPrevented||console.error(t)}function gh(){var t=this;this.I=void 0,this.Ka=new Promise((function(o){t.g=o}))}function hh(t){var o=document;this.X=void 0,this.S=t,this.g=o,ch(this.S,this.g),"loading"===this.g.readyState&&(this.X=new MutationObserver(this.h.bind(this)),this.X.observe(this.g,{childList:!0,subtree:!0}))}function ih(t){t.X&&t.X.disconnect()}function U(t){this.ma=new Map,this.na=new Map,this.Fa=new Map,this.wa=!1,this.za=new Map,this.la=function(t){return t()},this.V=!1,this.oa=[],this.S=t,this.Ga=t.sb?new hh(t):void 0}function jh(t,o){if(!Og(o))throw new SyntaxError("The element name '"+o+"' is not valid.");if(dh(t,o))throw Error("A custom element with name '"+o+"' has already been defined.");if(t.wa)throw Error("A custom element is already being defined.")}function lh(t,o,s){var l;t.wa=!0;try{var h=s.prototype;if(!(h instanceof Object))throw new TypeError("The custom element constructor's prototype is not an object.");var f=function(t){var o=h[t];if(void 0!==o&&!(o instanceof Function))throw Error("The '"+t+"' callback must be a function.");return o},m=f("connectedCallback"),_=f("disconnectedCallback"),E=f("adoptedCallback"),$=(l=f("attributeChangedCallback"))&&s.observedAttributes||[]}catch(t){throw t}finally{t.wa=!1}return s={localName:o,constructorFunction:s,connectedCallback:m,disconnectedCallback:_,adoptedCallback:E,attributeChangedCallback:l,observedAttributes:$,constructionStack:[]},t.na.set(o,s),t.Fa.set(s.constructorFunction,s),s}function kh(t){if(!1!==t.V){t.V=!1;for(var o=[],s=t.oa,l=new Map,h=0;h<s.length;h++)l.set(s[h],[]);for(ch(t.S,document,{upgrade:function(s){if(void 0===s.__CE_state){var h=s.localName,m=l.get(h);m?m.push(s):t.na.has(h)&&o.push(s)}}}),h=0;h<o.length;h++)ah(t.S,o[h]);for(h=0;h<s.length;h++){for(var m=s[h],_=l.get(m),E=0;E<_.length;E++)ah(t.S,_[E]);(m=t.za.get(m))&&m.resolve(void 0)}s.length=0}}function dh(t,o){var s=t.na.get(o);if(s)return s;if(s=t.ma.get(o)){t.ma.delete(o);try{return lh(t,o,s())}catch(t){eh(t)}}}function mh(t,o,s){function d(o){return function(s){for(var l=[],h=0;h<arguments.length;++h)l[h]=arguments[h];h=[];for(var m=[],_=0;_<l.length;_++){var E=l[_];if(E instanceof Element&&T(E)&&m.push(E),E instanceof DocumentFragment)for(E=E.firstChild;E;E=E.nextSibling)h.push(E);else h.push(E)}for(o.apply(this,l),l=0;l<m.length;l++)bh(t,m[l]);if(T(this))for(l=0;l<h.length;l++)(m=h[l])instanceof Element&&$g(t,m)}}void 0!==s.prepend&&(o.prepend=d(s.prepend)),void 0!==s.append&&(o.append=d(s.append))}function ph(t){function b(o,s){Object.defineProperty(o,"innerHTML",{enumerable:s.enumerable,configurable:!0,get:s.get,set:function(o){var l=this,h=void 0;if(T(this)&&(h=[],Vg(t,this,(function(t){t!==l&&h.push(t)}))),s.set.call(this,o),h)for(var m=0;m<h.length;m++){var _=h[m];1===_.__CE_state&&t.disconnectedCallback(_)}return this.ownerDocument.__CE_registry?ch(t,this):Yg(t,this),o}})}function c(o,s){o.insertAdjacentElement=function(o,l){var h=T(l);return o=s.call(this,o,l),h&&bh(t,l),T(o)&&$g(t,l),o}}function d(o,s){function g(o,s){for(var l=[];o!==s;o=o.nextSibling)l.push(o);for(s=0;s<l.length;s++)ch(t,l[s])}o.insertAdjacentHTML=function(t,o){if("beforebegin"===(t=t.toLowerCase())){var l=this.previousSibling;s.call(this,t,o),g(l||this.parentNode.firstChild,this)}else if("afterbegin"===t)l=this.firstChild,s.call(this,t,o),g(this.firstChild,l);else if("beforeend"===t)l=this.lastChild,s.call(this,t,o),g(l||this.firstChild,null);else{if("afterend"!==t)throw new SyntaxError("The value provided ("+String(t)+") is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'.");l=this.nextSibling,s.call(this,t,o),g(this.nextSibling,l)}}}zo&&(Element.prototype.attachShadow=function(o){if(o=zo.call(this,o),t.W&&!o.__CE_patched){o.__CE_patched=!0;for(var s=0;s<t.ca.length;s++)t.ca[s](o)}return this.__CE_shadowRoot=o}),Vo&&Vo.get?b(Element.prototype,Vo):cn&&cn.get?b(HTMLElement.prototype,cn):function Xg(t,o){t.W=!0,t.g.push(o)}(t,(function(t){b(t,{enumerable:!0,configurable:!0,get:function(){return Fo.call(this,!0).innerHTML},set:function(t){var o="template"===this.localName,s=o?this.content:this,l=$o.call(document,this.namespaceURI,this.localName);for(l.innerHTML=t;0<s.childNodes.length;)Uo.call(s,s.childNodes[0]);for(t=o?l.content:l;0<t.childNodes.length;)Bo.call(s,t.childNodes[0])}})})),Element.prototype.setAttribute=function(o,s){if(1!==this.__CE_state)return Ko.call(this,o,s);var l=Go.call(this,o);Ko.call(this,o,s),s=Go.call(this,o),t.attributeChangedCallback(this,o,l,s,null)},Element.prototype.setAttributeNS=function(o,s,l){if(1!==this.__CE_state)return Zo.call(this,o,s,l);var h=Yo.call(this,o,s);Zo.call(this,o,s,l),l=Yo.call(this,o,s),t.attributeChangedCallback(this,s,h,l,o)},Element.prototype.removeAttribute=function(o){if(1!==this.__CE_state)return Wo.call(this,o);var s=Go.call(this,o);Wo.call(this,o),null!==s&&t.attributeChangedCallback(this,o,s,null,null)},Qo&&(Element.prototype.toggleAttribute=function(o,s){if(1!==this.__CE_state)return Qo.call(this,o,s);var l=Go.call(this,o);return null!==l!==(s=Qo.call(this,o,s))&&t.attributeChangedCallback(this,o,l,s?"":null,null),s}),Element.prototype.removeAttributeNS=function(o,s){if(1!==this.__CE_state)return Jo.call(this,o,s);var l=Yo.call(this,o,s);Jo.call(this,o,s);var h=Yo.call(this,o,s);l!==h&&t.attributeChangedCallback(this,s,l,h,o)},dn?c(HTMLElement.prototype,dn):Xo&&c(Element.prototype,Xo),un?d(HTMLElement.prototype,un):en&&d(Element.prototype,en),mh(t,Element.prototype,{prepend:tn,append:rn}),function oh(t){function b(o){return function(s){for(var l=[],h=0;h<arguments.length;++h)l[h]=arguments[h];h=[];for(var m=[],_=0;_<l.length;_++){var E=l[_];if(E instanceof Element&&T(E)&&m.push(E),E instanceof DocumentFragment)for(E=E.firstChild;E;E=E.nextSibling)h.push(E);else h.push(E)}for(o.apply(this,l),l=0;l<m.length;l++)bh(t,m[l]);if(T(this))for(l=0;l<h.length;l++)(m=h[l])instanceof Element&&$g(t,m)}}var o=Element.prototype;void 0!==on&&(o.before=b(on)),void 0!==nn&&(o.after=b(nn)),void 0!==sn&&(o.replaceWith=function(o){for(var s=[],l=0;l<arguments.length;++l)s[l]=arguments[l];l=[];for(var h=[],m=0;m<s.length;m++){var _=s[m];if(_ instanceof Element&&T(_)&&h.push(_),_ instanceof DocumentFragment)for(_=_.firstChild;_;_=_.nextSibling)l.push(_);else l.push(_)}for(m=T(this),sn.apply(this,s),s=0;s<h.length;s++)bh(t,h[s]);if(m)for(bh(t,this),s=0;s<l.length;s++)(h=l[s])instanceof Element&&$g(t,h)}),void 0!==an&&(o.remove=function(){var o=T(this);an.call(this),o&&bh(t,this)})}(t)}Tg.prototype.connectedCallback=function(t){var o=t.__CE_definition;if(o.connectedCallback)try{o.connectedCallback.call(t)}catch(t){eh(t)}},Tg.prototype.disconnectedCallback=function(t){var o=t.__CE_definition;if(o.disconnectedCallback)try{o.disconnectedCallback.call(t)}catch(t){eh(t)}},Tg.prototype.attributeChangedCallback=function(t,o,s,l,h){var m=t.__CE_definition;if(m.attributeChangedCallback&&-1<m.observedAttributes.indexOf(o))try{m.attributeChangedCallback.call(t,o,s,l,h)}catch(t){eh(t)}},gh.prototype.resolve=function(t){if(this.I)throw Error("Already resolved.");this.I=t,this.g(t)},hh.prototype.h=function(t){var o=this.g.readyState;for("interactive"!==o&&"complete"!==o||ih(this),o=0;o<t.length;o++)for(var s=t[o].addedNodes,l=0;l<s.length;l++)ch(this.S,s[l])},(o=U.prototype).jb=function(t,o){var s=this;if(!(o instanceof Function))throw new TypeError("Custom element constructor getters must be functions.");jh(this,t),this.ma.set(t,o),this.oa.push(t),this.V||(this.V=!0,this.la((function(){return kh(s)})))},o.define=function(t,o){var s=this;if(!(o instanceof Function))throw new TypeError("Custom element constructors must be functions.");jh(this,t),lh(this,t,o),this.oa.push(t),this.V||(this.V=!0,this.la((function(){return kh(s)})))},o.upgrade=function(t){ch(this.S,t)},o.get=function(t){if(t=dh(this,t))return t.constructorFunction},o.whenDefined=function(t){if(!Og(t))return Promise.reject(new SyntaxError("'"+t+"' is not a valid custom element name."));var o=this.za.get(t);if(o)return o.Ka;o=new gh,this.za.set(t,o);var s=this.na.has(t)||this.ma.has(t);return t=-1===this.oa.indexOf(t),s&&t&&o.resolve(void 0),o.Ka},o.polyfillWrapFlushCallback=function(t){this.Ga&&ih(this.Ga);var o=this.la;this.la=function(s){return t((function(){return o(s)}))}},U.prototype.define=U.prototype.define,U.prototype.upgrade=U.prototype.upgrade,U.prototype.get=U.prototype.get,U.prototype.whenDefined=U.prototype.whenDefined,U.prototype.polyfillDefineLazy=U.prototype.jb,U.prototype.polyfillWrapFlushCallback=U.prototype.polyfillWrapFlushCallback;var fn={};var gn=window.customElements;function th(){var t=new Tg;!function rh(t){function b(){var o=this.constructor,s=document.__CE_registry.Fa.get(o);if(!s)throw Error("Failed to construct a custom element: The constructor was not registered with `customElements`.");var l=s.constructionStack;if(0===l.length)return l=Ro.call(document,s.localName),Object.setPrototypeOf(l,o.prototype),l.__CE_state=1,l.__CE_definition=s,Zg(t,l),l;var h=l.length-1,m=l[h];if(m===fn)throw Error("Failed to construct '"+s.localName+"': This element was already constructed.");return l[h]=fn,Object.setPrototypeOf(m,o.prototype),Zg(t,m),m}b.prototype=ln.prototype,Object.defineProperty(HTMLElement.prototype,"constructor",{writable:!0,configurable:!0,enumerable:!1,value:b}),window.HTMLElement=b}(t),function nh(t){Document.prototype.createElement=function(o){return fh(t,this,o,null)},Document.prototype.importNode=function(o,s){return o=Mo.call(this,o,!!s),this.__CE_registry?ch(t,o):Yg(t,o),o},Document.prototype.createElementNS=function(o,s){return fh(t,this,s,o)},mh(t,Document.prototype,{prepend:Oo,append:No})}(t),mh(t,DocumentFragment.prototype,{prepend:Do,append:Lo}),function sh(t){function b(o,s){Object.defineProperty(o,"textContent",{enumerable:s.enumerable,configurable:!0,get:s.get,set:function(o){if(this.nodeType===Node.TEXT_NODE)s.set.call(this,o);else{var l=void 0;if(this.firstChild){var h=this.childNodes,m=h.length;if(0<m&&T(this)){l=Array(m);for(var _=0;_<m;_++)l[_]=h[_]}}if(s.set.call(this,o),l)for(o=0;o<l.length;o++)bh(t,l[o])}}})}Node.prototype.insertBefore=function(o,s){if(o instanceof DocumentFragment){var l=Qg(o);if(o=Ho.call(this,o,s),T(this))for(s=0;s<l.length;s++)$g(t,l[s]);return o}return l=o instanceof Element&&T(o),s=Ho.call(this,o,s),l&&bh(t,o),T(this)&&$g(t,o),s},Node.prototype.appendChild=function(o){if(o instanceof DocumentFragment){var s=Qg(o);if(o=Bo.call(this,o),T(this))for(var l=0;l<s.length;l++)$g(t,s[l]);return o}return s=o instanceof Element&&T(o),l=Bo.call(this,o),s&&bh(t,o),T(this)&&$g(t,o),l},Node.prototype.cloneNode=function(o){return o=Fo.call(this,!!o),this.ownerDocument.__CE_registry?ch(t,o):Yg(t,o),o},Node.prototype.removeChild=function(o){var s=o instanceof Element&&T(o),l=Uo.call(this,o);return s&&bh(t,o),l},Node.prototype.replaceChild=function(o,s){if(o instanceof DocumentFragment){var l=Qg(o);if(o=qo.call(this,o,s),T(this))for(bh(t,s),s=0;s<l.length;s++)$g(t,l[s]);return o}l=o instanceof Element&&T(o);var h=qo.call(this,o,s),m=T(this);return m&&bh(t,s),l&&bh(t,o),m&&$g(t,o),h},jo&&jo.get?b(Node.prototype,jo):function Wg(t,o){t.W=!0,t.ca.push(o)}(t,(function(t){b(t,{enumerable:!0,configurable:!0,get:function(){for(var t=[],o=this.firstChild;o;o=o.nextSibling)o.nodeType!==Node.COMMENT_NODE&&t.push(o.textContent);return t.join("")},set:function(t){for(;this.firstChild;)Uo.call(this,this.firstChild);null!=t&&""!==t&&Bo.call(this,document.createTextNode(t))}})}))}(t),ph(t),window.CustomElementRegistry=U,t=new U(t),document.__CE_registry=t,Object.defineProperty(window,"customElements",{configurable:!0,enumerable:!0,value:t})}function uh(){this.end=this.start=0,this.rules=this.parent=this.previous=null,this.cssText=this.parsedCssText="",this.atRule=!1,this.type=0,this.parsedSelector=this.selector=this.keyframesName=""}function vh(t){var o=t=t.replace(_n,"").replace(kn,""),s=new uh;s.start=0,s.end=o.length;for(var l=s,h=0,m=o.length;h<m;h++)if("{"===o[h]){l.rules||(l.rules=[]);var _=l,E=_.rules[_.rules.length-1]||null;(l=new uh).start=h+1,l.parent=_,l.previous=E,_.rules.push(l)}else"}"===o[h]&&(l.end=h+1,l=l.parent||s);return yh(s,t)}function yh(t,o){var s=o.substring(t.start,t.end-1);if(t.parsedCssText=t.cssText=s.trim(),t.parent&&(s=function zh(t){return t.replace(/\\([0-9a-f]{1,6})\s/gi,(function(t,o){for(o=6-(t=o).length;o--;)t="0"+t;return"\\"+t}))}(s=o.substring(t.previous?t.previous.end:t.parent.start,t.start-1)),s=(s=s.replace(In," ")).substring(s.lastIndexOf(";")+1),s=t.parsedSelector=t.selector=s.trim(),t.atRule=0===s.indexOf("@"),t.atRule?0===s.indexOf("@media")?t.type=wn:s.match(An)&&(t.type=bn,t.keyframesName=t.selector.split(In).pop()):t.type=0===s.indexOf("--")?Cn:yn),s=t.rules)for(var l=0,h=s.length,m=void 0;l<h&&(m=s[l]);l++)yh(m,o);return t}function Gh(t,o,s){s=void 0===s?"":s;var l="";if(t.cssText||t.rules){var h,m=t.rules;if((h=m)&&(h=!((h=m[0])&&h.selector&&0===h.selector.indexOf("--"))),h){h=0;for(var _=m.length,E=void 0;h<_&&(E=m[h]);h++)l=Gh(E,o,l)}else o?o=t.cssText:o=(o=(o=t.cssText).replace(xn,"").replace(Sn,"")).replace(Tn,"").replace(En,""),(l=o.trim())&&(l="  "+l+"\n")}return l&&(t.selector&&(s+=t.selector+" {\n"),s+=l,t.selector&&(s+="}\n\n")),s}gn&&!gn.forcePolyfill&&"function"==typeof gn.define&&"function"==typeof gn.get||th(),window.__CE_installPolyfill=th;var vn,mn,yn=1,bn=7,wn=4,Cn=1e3,_n=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,kn=/@import[^;]*;/gim,xn=/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,Sn=/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,Tn=/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,En=/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,An=/^@[^\s]*keyframes/,In=/\s+/g,Pn=!(window.ShadyDOM&&window.ShadyDOM.inUse);function Mh(t){vn=(!t||!t.shimcssproperties)&&(Pn||!(navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)||!window.CSS||!CSS.supports||!CSS.supports("box-shadow","0 0 0 var(--foo)")))}window.ShadyCSS&&void 0!==window.ShadyCSS.cssBuild&&(mn=window.ShadyCSS.cssBuild);var Rn=!(!window.ShadyCSS||!window.ShadyCSS.disableRuntime);window.ShadyCSS&&void 0!==window.ShadyCSS.nativeCss?vn=window.ShadyCSS.nativeCss:window.ShadyCSS?(Mh(window.ShadyCSS),window.ShadyCSS=void 0):Mh(window.WebComponents&&window.WebComponents.flags);var $n=vn,Mn=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,On=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,Nn=/(--[\w-]+)\s*([:,;)]|$)/gi,Dn=/(animation\s*:)|(animation-name\s*:)/,Ln=/@media\s(.*)/,Fn=/\{[^}]*\}/g,Bn=new Set;function Wh(t,o){return t?("string"==typeof t&&(t=vh(t)),o&&Xh(t,o),Gh(t,$n)):""}function Yh(t){return!t.__cssRules&&t.textContent&&(t.__cssRules=vh(t.textContent)),t.__cssRules||null}function $h(t){return!!t.parent&&t.parent.type===bn}function Xh(t,o,s,l){if(t){var h=!1,m=t.type;if(l&&m===wn){var _=t.selector.match(Ln);_&&(window.matchMedia(_[1]).matches||(h=!0))}if(m===yn?o(t):s&&m===bn?s(t):m===Cn&&(h=!0),(t=t.rules)&&!h)for(h=0,m=t.length,_=void 0;h<m&&(_=t[h]);h++)Xh(_,o,s,l)}}function ai(t,o,s,l){var h=document.createElement("style");return o&&h.setAttribute("scope",o),h.textContent=t,bi(h,s,l),h}var Hn=null;function di(t){t=document.createComment(" Shady DOM styles for "+t+" ");var o=document.head;return o.insertBefore(t,(Hn?Hn.nextSibling:null)||o.firstChild),Hn=t}function bi(t,o,s){(o=o||document.head).insertBefore(t,s&&s.nextSibling||o.firstChild),Hn?t.compareDocumentPosition(Hn)===Node.DOCUMENT_POSITION_PRECEDING&&(Hn=t):Hn=t}function ei(t,o){for(var s=0,l=t.length;o<l;o++)if("("===t[o])s++;else if(")"===t[o]&&0==--s)return o;return-1}function fi(t,o){var s=t.indexOf("var(");if(-1===s)return o(t,"","","");var l=ei(t,s+3),h=t.substring(s+4,l);return s=t.substring(0,s),t=fi(t.substring(l+1),o),-1===(l=h.indexOf(","))?o(s,h.trim(),"",t):o(s,h.substring(0,l).trim(),h.substring(l+1).trim(),t)}function gi(t,o){Pn?t.setAttribute("class",o):window.ShadyDOM.nativeMethods.setAttribute.call(t,"class",o)}var Un=window.ShadyDOM&&window.ShadyDOM.wrap||function(t){return t};function ii(t){var o=t.localName,s="";return o?-1<o.indexOf("-")||(s=o,o=t.getAttribute&&t.getAttribute("is")||""):(o=t.is,s=t.extends),{is:o,ja:s}}function ji(t){for(var o=[],s="",l=0;0<=l&&l<t.length;l++)if("("===t[l]){var h=ei(t,l);s+=t.slice(l,h+1),l=h}else","===t[l]?(o.push(s),s=""):s+=t[l];return s&&o.push(s),o}function ki(t){if(void 0!==mn)return mn;if(void 0===t.__cssBuild){var o=t.getAttribute("css-build");if(o)t.__cssBuild=o;else{if(""!==(o=(o="template"===t.localName?t.content.firstChild:t.firstChild)instanceof Comment&&"css-build"===(o=o.textContent.trim().split(":"))[0]?o[1]:"")){var s="template"===t.localName?t.content.firstChild:t.firstChild;s.parentNode.removeChild(s)}t.__cssBuild=o}}return t.__cssBuild||""}function li(t){return!(""===(t=void 0===t?"":t)||!$n)&&(Pn?"shadow"===t:"shady"===t)}function mi(){}function oi(t,o,s){var l;if(o.nodeType===Node.ELEMENT_NODE&&s(o),l="template"===o.localName?(o.content||o._content||o).childNodes:o.children||o.childNodes)for(o=0;o<l.length;o++)oi(t,l[o],s)}function qi(t,o,s){if(o)if(t.classList)s?(t.classList.remove("style-scope"),t.classList.remove(o)):(t.classList.add("style-scope"),t.classList.add(o));else if(t.getAttribute){var l=t.getAttribute("class");s?l&&gi(t,o=l.replace("style-scope","").replace(o,"")):gi(t,(l?l+" ":"")+"style-scope "+o)}}function ri(t,o,s){oi(Yn,t,(function(t){qi(t,o,!0),qi(t,s)}))}function si(t,o){oi(Yn,t,(function(t){qi(t,o||"",!0)}))}function ti(t,o,s,l,h){var m=Yn;return""===(h=void 0===h?"":h)&&(Pn||"shady"===(void 0===l?"":l)?h=Wh(o,s):h=function ui(t,o,s,l,h){var m=vi(s,l);return s=s?"."+s:"",Wh(o,(function(o){o.i||(o.selector=o.G=wi(t,o,t.h,s,m),o.i=!0),h&&h(o,s,m)}))}(m,o,(t=ii(t)).is,t.ja,s)+"\n\n"),h.trim()}function vi(t,o){return o?"[is="+t+"]":t}function wi(t,o,s,l,h){var m=ji(o.selector);if(!$h(o)){o=0;for(var _=m.length,E=void 0;o<_&&(E=m[o]);o++)m[o]=s.call(t,E,l,h)}return m.filter((function(t){return!!t})).join(",")}function xi(t){return t.replace(qn,(function(t,o,s){return-1<s.indexOf("+")?s=s.replace(/\+/g,"___"):-1<s.indexOf("___")&&(s=s.replace(/___/g,"+")),":"+o+"("+s+")"}))}function Hi(t,o){t=t.split(/(\[.+?\])/);for(var s=[],l=0;l<t.length;l++)if(1==l%2)s.push(t[l]);else{var h=t[l];""===h&&l===t.length-1||((h=h.split(":"))[0]+=o,s.push(h.join(":")))}return s.join("")}function Li(t){":root"===t.selector&&(t.selector="html")}mi.prototype.h=function(t,o,s){var l=!1;t=t.trim();var h=qn.test(t);h&&(t=t.replace(qn,(function(t,o,s){return":"+o+"("+s.replace(/\s/g,"")+")"})),t=xi(t));var m=Qn.test(t);if(m){var _=function zi(t){for(var o,s=[];o=t.match(Qn);){var l=o.index,h=ei(t,l);if(-1===h)throw Error(o.input+" selector missing ')'");o=t.slice(l,h+1),t=t.replace(o,"î"),s.push(o)}return{Ea:t,matches:s}}(t);t=_.Ea,_=_.matches}return t=(t=t.replace(Vn,":host $1")).replace(jn,(function(t,h,m){return l||(t=function Ei(t,o,s,l){var h=t.indexOf("::slotted");if(0<=t.indexOf(":host")?t=function Gi(t,o){var s=t.match(Gn);return(s=s&&s[2].trim()||"")?s[0].match(zn)?t.replace(Gn,(function(t,s,l){return o+l})):s.split(zn)[0]===o?s:"should_not_match":t.replace(":host",o)}(t,l):0!==h&&(t=s?Hi(t,s):t),s=!1,0<=h&&(o="",s=!0),s){var m=!0;s&&(t=t.replace(Kn,(function(t,o){return" > "+o})))}return{value:t,Ya:o,stop:m}}(m,h,o,s),l=l||t.stop,h=t.Ya,m=t.value),h+m})),m&&(t=function Bi(t,o){var s=t.split("î");return o.reduce((function(t,o,l){return t+o+s[l+1]}),s[0])}(t,_)),h&&(t=xi(t)),t.replace(Wn,(function(t,o,s,l){return'[dir="'+s+'"] '+o+l+", "+o+'[dir="'+s+'"]'+l}))},mi.prototype.i=function(t){return t.match(":host")?"":t.match("::slotted")?this.h(t,":not(.style-scope)"):Hi(t.trim(),":not(.style-scope)")},h.Object.defineProperties(mi.prototype,{g:{configurable:!0,enumerable:!0,get:function(){return"style-scope"}}});var qn=/:(nth[-\w]+)\(([^)]+)\)/,jn=/(^|[\s>+~]+)((?:\[.+?\]|[^\s>+~=[])+)/g,zn=/[[.:#*]/,Vn=/^(::slotted)/,Gn=/(:host)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,Kn=/(?:::slotted)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,Wn=/(.*):dir\((?:(ltr|rtl))\)(.*)/,Qn=/:(?:matches|any|-(?:webkit|moz)-any)/,Yn=new mi;function Mi(t,o,s,l,h){this.M=t||null,this.h=o||null,this.Ca=s||[],this.K=null,this.cssBuild=h||"",this.ja=l||"",this.g=this.L=this.R=null}function Ni(t){return t?t.__styleInfo:null}function Oi(t,o){return t.__styleInfo=o}function Pi(t){var o=this.matches||this.matchesSelector||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector;return o&&o.call(this,t)}Mi.prototype.i=function(){return this.M},Mi.prototype._getStyleRules=Mi.prototype.i;var Zn=/:host\s*>\s*/,Jn=navigator.userAgent.match("Trident");function Si(){}function Ui(t){if(!t.F){var o={},s={};Vi(t,s)&&(o.P=s,t.rules=null),o.cssText=t.parsedCssText.replace(Fn,"").replace(Mn,""),t.F=o}}function Vi(t,o){var s=t.F;if(!s){s=t.parsedCssText;for(var l;t=Mn.exec(s);)"inherit"===(l=(t[2]||t[3]).trim())&&"unset"===l||(o[t[1].trim()]=l),l=!0;return l}if(s.P)return Object.assign(o,s.P),!0}function Wi(t,o,s){return o&&(o=0<=o.indexOf(";")?Xi(t,o,s):fi(o,(function(o,l,h,m){return l?((l=Wi(t,s[l],s))&&"initial"!==l?"apply-shim-inherit"===l&&(l="inherit"):l=Wi(t,s[h]||h,s)||h,o+(l||"")+m):o+m}))),o&&o.trim()||""}function Xi(t,o,s){o=o.split(";");for(var l,h,m=0;m<o.length;m++)if(l=o[m]){if(On.lastIndex=0,h=On.exec(l))l=Wi(t,s[h[1]],s);else if(-1!==(h=l.indexOf(":"))){var _=l.substring(h);_=Wi(t,_=_.trim(),s)||_,l=l.substring(0,h)+_}o[m]=l&&l.lastIndexOf(";")===l.length-1?l.slice(0,-1):l||""}return o.join(";")}function $i(t,o,s){var l={},h={};return Xh(o,(function(o){!function Zi(t,o,s,l){if(o.F||Ui(o),o.F.P){var h=ii(t);t=h.is,h=h.ja,h=t?vi(t,h):"html";var m=o.parsedSelector,_=!!m.match(Zn)||"html"===h&&-1<m.indexOf("html"),E=0===m.indexOf(":host")&&!_;"shady"===s&&(E=!(_=m===h+" > *."+h||-1!==m.indexOf("html"))&&0===m.indexOf(h)),(_||E)&&(s=h,E&&(o.G||(o.G=wi(Yn,o,Yn.h,t?"."+t:"",h)),s=o.G||h),_&&"html"===h&&(s=o.G||o.O),l({Ea:s,gb:E,vb:_}))}}(t,o,s,(function(s){Pi.call(t._element||t,s.Ea)&&(s.gb?Vi(o,l):Vi(o,h))}))}),null,!0),{mb:h,eb:l}}function aj(t,o,s,l){var h=ii(o),m=vi(h.is,h.ja),_=new RegExp("(?:^|[^.#[:])"+(o.extends?"\\"+m.slice(0,-1)+"\\]":m)+"($|[.:[\\s>+~])"),E=Ni(o);h=E.M,E=E.cssBuild;var $=function bj(t,o){t=t.h;var s={};if(!Pn&&t)for(var l=0,h=t[l];l<t.length;h=t[++l]){var m=h,_=o;m.u=new RegExp("\\b"+m.keyframesName+"(?!\\B|-)","g"),m.g=m.keyframesName+"-"+_,m.G=m.G||m.selector,m.selector=m.G.replace(m.keyframesName,m.g),s[h.keyframesName]=cj(h)}return s}(h,l);return ti(o,h,(function(o){var h="";if(o.F||Ui(o),o.F.cssText&&(h=Xi(t,o.F.cssText,s)),o.cssText=h,!Pn&&!$h(o)&&o.cssText){var E=h=o.cssText;if(null==o.Ma&&(o.Ma=Dn.test(h)),o.Ma)if(null==o.ra)for(var B in o.ra=[],$)h!==(E=(E=$[B])(h))&&(h=E,o.ra.push(B));else{for(B=0;B<o.ra.length;++B)h=(E=$[o.ra[B]])(h);E=h}o.cssText=E,o.G=o.G||o.selector,h="."+l,E=0;for(var q=(B=ji(o.G)).length,j=void 0;E<q&&(j=B[E]);E++)B[E]=j.match(_)?j.replace(m,h):h+" "+j;o.selector=B.join(",")}}),E)}function cj(t){return function(o){return o.replace(t.u,t.g)}}function dj(t,o){var s=Xn,l=Yh(t);t.textContent=Wh(l,(function(t){var l=t.cssText=t.parsedCssText;t.F&&t.F.cssText&&(l=l.replace(xn,"").replace(Sn,""),t.cssText=Xi(s,l,o))}))}h.Object.defineProperties(Si.prototype,{g:{configurable:!0,enumerable:!0,get:function(){return"x-scope"}}});var Xn=new Si,ci={},hi=window.customElements;if(hi&&!Pn&&!Rn){var pi=hi.define;hi.define=function(t,o,s){ci[t]||(ci[t]=di(t)),pi.call(hi,t,o,s)}}function ij(){this.cache={}}function jj(){}ij.prototype.store=function(t,o,s,l){var h=this.cache[t]||[];h.push({P:o,styleElement:s,L:l}),100<h.length&&h.shift(),this.cache[t]=h};var yi=new RegExp(Yn.g+"\\s*([^\\s]*)");function lj(t){return(t=(t.classList&&t.classList.value?t.classList.value:t.getAttribute("class")||"").match(yi))?t[1]:""}function mj(t){var o=Un(t).getRootNode();return o===t||o===t.ownerDocument?"":(t=o.host)?ii(t).is:""}function nj(t){for(var o=0;o<t.length;o++){var s=t[o];if(s.target!==document.documentElement&&s.target!==document.head)for(var l=0;l<s.addedNodes.length;l++){var h=s.addedNodes[l];if(h.nodeType===Node.ELEMENT_NODE){var m=h.getRootNode(),_=lj(h);if(_&&m===h.ownerDocument&&("style"!==h.localName&&"template"!==h.localName||""===ki(h)))si(h,_);else if(m instanceof ShadowRoot)for((m=mj(h))!==_&&ri(h,_,m),h=window.ShadyDOM.nativeMethods.querySelectorAll.call(h,":not(."+Yn.g+")"),_=0;_<h.length;_++){var E=mj(m=h[_]);E&&qi(m,E)}}}}}if(!(Pn||window.ShadyDOM&&window.ShadyDOM.handlesDynamicScoping)){var Ci=new MutationObserver(nj),pj=function(t){Ci.observe(t,{childList:!0,subtree:!0})};if(window.customElements&&!window.customElements.polyfillWrapFlushCallback)pj(document);else{var qj=function(){pj(document.body)};window.HTMLImports?window.HTMLImports.whenReady(qj):requestAnimationFrame((function(){if("loading"===document.readyState){var a=function(){qj(),document.removeEventListener("readystatechange",a)};document.addEventListener("readystatechange",a)}else qj()}))}jj=function(){nj(Ci.takeRecords())}}var _i={},Ai=Promise.resolve();function tj(t){(t=_i[t])&&(t._applyShimCurrentVersion=t._applyShimCurrentVersion||0,t._applyShimValidatingVersion=t._applyShimValidatingVersion||0,t._applyShimNextVersion=(t._applyShimNextVersion||0)+1)}function uj(t){return t._applyShimCurrentVersion===t._applyShimNextVersion}var Ii={},Ri=new ij;function Y(){this.ea={},this.i=document.documentElement;var t=new uh;t.rules=[],this.u=Oi(this.i,new Mi(t)),this.O=!1,this.g=this.h=null}function zj(t){var o=ii(t),s=o.is;o=o.ja;var l=ci[s]||null,h=_i[s];if(h)return Oi(t,o=new Mi(s=h._styleAst,l,h.g,o,h=ki(h))),o}function yj(t){if(!t.h&&window.ShadyCSS&&window.ShadyCSS.ApplyShim){t.h=window.ShadyCSS.ApplyShim,t.h.invalidCallback=tj;var o=!0}else o=!1;return function Aj(t){!t.g&&window.ShadyCSS&&window.ShadyCSS.CustomStyleInterface&&(t.g=window.ShadyCSS.CustomStyleInterface,t.g.transformCallback=function(o){t.Qa(o)},t.g.validateCallback=function(){requestAnimationFrame((function(){(t.g.enqueued||t.O)&&t.flushCustomStyles()}))})}(t),o}function Dj(t,o,s){var l=ii(o).is;if(s.K){var h,m=s.K;for(h in m)null===h?o.style.removeProperty(h):o.style.setProperty(h,m[h])}!(m=_i[l])&&o!==t.i||m&&""!==ki(m)||!m||!m._style||uj(m)||((uj(m)||m._applyShimValidatingVersion!==m._applyShimNextVersion)&&(yj(t),t.h&&t.h.transformRules(m._styleAst,l),m._style.textContent=ti(o,s.M),function vj(t){t._applyShimValidatingVersion=t._applyShimNextVersion,t._validating||(t._validating=!0,Ai.then((function(){t._applyShimCurrentVersion=t._applyShimNextVersion,t._validating=!1})))}(m)),Pn&&(t=o.shadowRoot)&&(t=t.querySelector("style"))&&(t.textContent=ti(o,s.M)),s.M=m._styleAst)}function Ej(t,o){return(o=Un(o).getRootNode().host)?Ni(o)||zj(o)?o:Ej(t,o):t.i}function Cj(t,o,s){var l=Ej(t,o),h=Ni(l),m=h.R;for(var _ in l===t.i||m||(Cj(t,l,h),m=h.R),t=Object.create(m||null),l=$i(o,s.M,s.cssBuild),o=function Yi(t,o){var s={},l=[];return Xh(t,(function(t){t.F||Ui(t);var h=t.G||t.parsedSelector;o&&t.F.P&&h&&Pi.call(o,h)&&(Vi(t,s),t=t.index,h=parseInt(t/32,10),l[h]=(l[h]||0)|1<<t%32)}),null,!0),{P:s,key:l}}(h.M,o).P,Object.assign(t,l.eb,o,l.mb),o=s.K)((h=o[_])||0===h)&&(t[_]=h);for(_=Xn,o=Object.getOwnPropertyNames(t),h=0;h<o.length;h++)t[l=o[h]]=Wi(_,t[l],t);s.R=t}(o=Y.prototype).flush=function(){jj()},o.bb=function(t){return Yh(t)},o.qb=function(t){return Wh(t)},o.prepareTemplate=function(t,o,s){this.prepareTemplateDom(t,o),this.prepareTemplateStyles(t,o,s)},o.prepareTemplateStyles=function(t,o,s){if(!t._prepared&&!Rn){Pn||ci[o]||(ci[o]=di(o)),t._prepared=!0,t.name=o,t.extends=s,_i[o]=t;var l=ki(t),h=li(l);s={is:o,extends:s};for(var m=[],_=t.content.querySelectorAll("style"),E=0;E<_.length;E++){var $=_[E];if($.hasAttribute("shady-unscoped")){if(!Pn){var B=$.textContent;if(!Bn.has(B)){Bn.add(B);var q=document.createElement("style");q.setAttribute("shady-unscoped",""),q.textContent=B,document.head.appendChild(q)}$.parentNode.removeChild($)}}else m.push($.textContent),$.parentNode.removeChild($)}m=m.join("").trim()+(Ii[o]||""),yj(this),h||((_=!l)&&(_=On.test(m)||Mn.test(m),On.lastIndex=0,Mn.lastIndex=0),E=vh(m),_&&$n&&this.h&&this.h.transformRules(E,o),t._styleAst=E),_=[],$n||(_=function Ti(t){var o={},s=[],l=0;for(var h in Xh(t,(function(t){Ui(t),t.index=l++,t=t.F.cssText;for(var s;s=Nn.exec(t);){var h=s[1];":"!==s[2]&&(o[h]=!0)}}),(function(t){s.push(t)})),t.h=s,t=[],o)t.push(h);return t}(t._styleAst)),_.length&&!$n||(E=Pn?t.content:null,o=ci[o]||null,l=(l=ti(s,t._styleAst,null,l,h?m:"")).length?ai(l,s.is,E,o):null,t._style=l),t.g=_}},o.kb=function(t,o){Ii[o]=t.join(" ")},o.prepareTemplateDom=function(t,o){if(!Rn){var s=ki(t);Pn||"shady"===s||t._domPrepared||(t._domPrepared=!0,function ni(t,o){oi(Yn,t,(function(t){qi(t,o||"")}))}(t.content,o))}},o.flushCustomStyles=function(){if(!Rn){var t=yj(this);if(this.g){var o=this.g.processStyles();if((t||this.g.enqueued)&&!li(this.u.cssBuild)){if($n){if(!this.u.cssBuild)for(t=0;t<o.length;t++){var s=this.g.getStyleForCustomStyle(o[t]);if(s&&$n&&this.h){var l=Yh(s);yj(this),this.h.transformRules(l),s.textContent=Wh(l)}}}else{for(function Bj(t,o){o=o.map((function(o){return t.g.getStyleForCustomStyle(o)})).filter((function(t){return!!t})),o.sort((function(t,o){return(t=o.compareDocumentPosition(t))&Node.DOCUMENT_POSITION_FOLLOWING?1:t&Node.DOCUMENT_POSITION_PRECEDING?-1:0})),t.u.M.rules=o.map((function(t){return Yh(t)}))}(this,o),Cj(this,this.i,this.u),t=0;t<o.length;t++)(s=this.g.getStyleForCustomStyle(o[t]))&&dj(s,this.u.R);this.O&&this.styleDocument()}this.g.enqueued=!1}}}},o.styleElement=function(t,o){if(Rn){if(o){Ni(t)||Oi(t,new Mi(null));var s=Ni(t);s.K=s.K||{},Object.assign(s.K,o),Dj(this,t,s)}}else if(s=Ni(t)||zj(t))if(t!==this.i&&(this.O=!0),o&&(s.K=s.K||{},Object.assign(s.K,o)),$n)Dj(this,t,s);else if(this.flush(),Cj(this,t,s),s.Ca&&s.Ca.length){var l;o=ii(t).is;e:{if(l=Ri.cache[o])for(var h=l.length-1;0<=h;h--){var m=l[h];t:{for(var _=s.Ca,E=0;E<_.length;E++){var $=_[E];if(m.P[$]!==s.R[$]){_=!1;break t}}_=!0}if(_){l=m;break e}}l=void 0}_=l?l.styleElement:null,h=s.L,(m=l&&l.L)||(m=o+"-"+(m=this.ea[o]=(this.ea[o]||0)+1)),s.L=m,m=s.L,E=Xn,E=_?_.textContent||"":aj(E,t,s.R,m);var B=($=Ni(t)).g;B&&!Pn&&B!==_&&(B._useCount--,0>=B._useCount&&B.parentNode&&B.parentNode.removeChild(B)),Pn?$.g?($.g.textContent=E,_=$.g):E&&(_=ai(E,m,t.shadowRoot,$.h)):_?_.parentNode||(Jn&&-1<E.indexOf("@media")&&(_.textContent=E),bi(_,null,$.h)):E&&(_=ai(E,m,null,$.h)),_&&(_._useCount=_._useCount||0,$.g!=_&&_._useCount++,$.g=_),m=_,Pn||(_=s.L,$=E=t.getAttribute("class")||"",h&&($=E.replace(new RegExp("\\s*x-scope\\s*"+h+"\\s*","g")," ")),E!==($+=($?" ":"")+"x-scope "+_)&&gi(t,$)),l||Ri.store(o,s.R,m,s.L)}},o.styleDocument=function(t){this.styleSubtree(this.i,t)},o.styleSubtree=function(t,o){var s=Un(t),l=s.shadowRoot,h=t===this.i;if((l||h)&&this.styleElement(t,o),t=h?s:l)for(t=Array.from(t.querySelectorAll("*")).filter((function(t){return Un(t).shadowRoot})),o=0;o<t.length;o++)this.styleSubtree(t[o])},o.Qa=function(t){var o=this,s=ki(t);if(s!==this.u.cssBuild&&(this.u.cssBuild=s),!li(s)){var l=Yh(t);Xh(l,(function(t){if(Pn)Li(t);else{var l=Yn;t.selector=t.parsedSelector,Li(t),t.selector=t.G=wi(l,t,l.i,void 0,void 0)}$n&&""===s&&(yj(o),o.h&&o.h.transformRule(t))})),$n?t.textContent=Wh(l):this.u.M.rules.push(l)}},o.getComputedStyleValue=function(t,o){var s;return $n||(s=(Ni(t)||Ni(Ej(this,t))).R[o]),(s=s||window.getComputedStyle(t).getPropertyValue(o))?s.trim():""},o.pb=function(t,o){var s=Un(t).getRootNode();if(o=o?("string"==typeof o?o:String(o)).split(/\s/):[],!(s=s.host&&s.host.localName)){var l=t.getAttribute("class");if(l){l=l.split(/\s/);for(var h=0;h<l.length;h++)if(l[h]===Yn.g){s=l[h+1];break}}}s&&o.push(Yn.g,s),$n||(s=Ni(t))&&s.L&&o.push(Xn.g,s.L),gi(t,o.join(" "))},o.Xa=function(t){return Ni(t)},o.ob=function(t,o){qi(t,o)},o.rb=function(t,o){qi(t,o,!0)},o.nb=function(t){return mj(t)},o.$a=function(t){return lj(t)},Y.prototype.flush=Y.prototype.flush,Y.prototype.prepareTemplate=Y.prototype.prepareTemplate,Y.prototype.styleElement=Y.prototype.styleElement,Y.prototype.styleDocument=Y.prototype.styleDocument,Y.prototype.styleSubtree=Y.prototype.styleSubtree,Y.prototype.getComputedStyleValue=Y.prototype.getComputedStyleValue,Y.prototype.setElementClass=Y.prototype.pb,Y.prototype._styleInfoForNode=Y.prototype.Xa,Y.prototype.transformCustomStyleForDocument=Y.prototype.Qa,Y.prototype.getStyleAst=Y.prototype.bb,Y.prototype.styleAstToString=Y.prototype.qb,Y.prototype.flushCustomStyles=Y.prototype.flushCustomStyles,Y.prototype.scopeNode=Y.prototype.ob,Y.prototype.unscopeNode=Y.prototype.rb,Y.prototype.scopeForNode=Y.prototype.nb,Y.prototype.currentScopeForNode=Y.prototype.$a,Y.prototype.prepareAdoptedCssText=Y.prototype.kb,Object.defineProperties(Y.prototype,{nativeShadow:{get:function(){return Pn}},nativeCss:{get:function(){return $n}}});var Di,Fi,Ki=new Y;window.ShadyCSS&&(Di=window.ShadyCSS.ApplyShim,Fi=window.ShadyCSS.CustomStyleInterface),window.ShadyCSS={ScopingShim:Ki,prepareTemplate:function(t,o,s){Ki.flushCustomStyles(),Ki.prepareTemplate(t,o,s)},prepareTemplateDom:function(t,o){Ki.prepareTemplateDom(t,o)},prepareTemplateStyles:function(t,o,s){Ki.flushCustomStyles(),Ki.prepareTemplateStyles(t,o,s)},styleSubtree:function(t,o){Ki.flushCustomStyles(),Ki.styleSubtree(t,o)},styleElement:function(t){Ki.flushCustomStyles(),Ki.styleElement(t)},styleDocument:function(t){Ki.flushCustomStyles(),Ki.styleDocument(t)},flushCustomStyles:function(){Ki.flushCustomStyles()},getComputedStyleValue:function(t,o){return Ki.getComputedStyleValue(t,o)},nativeCss:$n,nativeShadow:Pn,cssBuild:mn,disableRuntime:Rn},Di&&(window.ShadyCSS.ApplyShim=Di),Fi&&(window.ShadyCSS.CustomStyleInterface=Fi),function(t){function b(t){return""==t&&(f.call(this),this.m=!0),t.toLowerCase()}function c(t){var o=t.charCodeAt(0);return 32<o&&127>o&&-1==[34,35,60,62,63,96].indexOf(o)?t:encodeURIComponent(t)}function d(t){var o=t.charCodeAt(0);return 32<o&&127>o&&-1==[34,35,60,62,96].indexOf(o)?t:encodeURIComponent(t)}function e(t,o,s){var E=o||"scheme start",$=0,B="",q=!1,j=!1;e:for(;(null!=t[$-1]||0==$)&&!this.m;){var K=t[$];switch(E){case"scheme start":if(!K||!m.test(K)){if(o)break e;B="",E="no scheme";continue}B+=K.toLowerCase(),E="scheme";break;case"scheme":if(K&&_.test(K))B+=K.toLowerCase();else{if(":"!=K){if(o)break e;B="",$=0,E="no scheme";continue}if(this.l=B,B="",o)break e;void 0!==l[this.l]&&(this.H=!0),E="file"==this.l?"relative":this.H&&s&&s.l==this.l?"relative or authority":this.H?"authority first slash":"scheme data"}break;case"scheme data":"?"==K?(this.A="?",E="query"):"#"==K?(this.C="#",E="fragment"):null!=K&&"\t"!=K&&"\n"!=K&&"\r"!=K&&(this.ya+=c(K));break;case"no scheme":if(s&&void 0!==l[s.l]){E="relative";continue}f.call(this),this.m=!0;break;case"relative or authority":if("/"!=K||"/"!=t[$+1]){E="relative";continue}E="authority ignore slashes";break;case"relative":if(this.H=!0,"file"!=this.l&&(this.l=s.l),null==K){this.o=s.o,this.v=s.v,this.s=s.s.slice(),this.A=s.A,this.B=s.B,this.j=s.j;break e}if("/"==K||"\\"==K)E="relative slash";else if("?"==K)this.o=s.o,this.v=s.v,this.s=s.s.slice(),this.A="?",this.B=s.B,this.j=s.j,E="query";else{if("#"!=K){E=t[$+1];var W=t[$+2];("file"!=this.l||!m.test(K)||":"!=E&&"|"!=E||null!=W&&"/"!=W&&"\\"!=W&&"?"!=W&&"#"!=W)&&(this.o=s.o,this.v=s.v,this.B=s.B,this.j=s.j,this.s=s.s.slice(),this.s.pop()),E="relative path";continue}this.o=s.o,this.v=s.v,this.s=s.s.slice(),this.A=s.A,this.C="#",this.B=s.B,this.j=s.j,E="fragment"}break;case"relative slash":if("/"!=K&&"\\"!=K){"file"!=this.l&&(this.o=s.o,this.v=s.v,this.B=s.B,this.j=s.j),E="relative path";continue}E="file"==this.l?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!=K){E="authority ignore slashes";continue}E="authority second slash";break;case"authority second slash":if(E="authority ignore slashes","/"!=K)continue;break;case"authority ignore slashes":if("/"!=K&&"\\"!=K){E="authority";continue}break;case"authority":if("@"==K){for(q&&(B+="%40"),q=!0,K=0;K<B.length;K++)"\t"==(W=B[K])||"\n"==W||"\r"==W||(":"==W&&null===this.j?this.j="":(W=c(W),null!==this.j?this.j+=W:this.B+=W));B=""}else{if(null==K||"/"==K||"\\"==K||"?"==K||"#"==K){$-=B.length,B="",E="host";continue}B+=K}break;case"file host":if(null==K||"/"==K||"\\"==K||"?"==K||"#"==K){2!=B.length||!m.test(B[0])||":"!=B[1]&&"|"!=B[1]?(0!=B.length&&(this.o=b.call(this,B),B=""),E="relative path start"):E="relative path";continue}"\t"==K||"\n"==K||"\r"==K||(B+=K);break;case"host":case"hostname":if(":"!=K||j){if(null==K||"/"==K||"\\"==K||"?"==K||"#"==K){if(this.o=b.call(this,B),B="",E="relative path start",o)break e;continue}"\t"!=K&&"\n"!=K&&"\r"!=K&&("["==K?j=!0:"]"==K&&(j=!1),B+=K)}else if(this.o=b.call(this,B),B="",E="port","hostname"==o)break e;break;case"port":if(/[0-9]/.test(K))B+=K;else{if(null==K||"/"==K||"\\"==K||"?"==K||"#"==K||o){if(""!=B&&((B=parseInt(B,10))!=l[this.l]&&(this.v=B+""),B=""),o)break e;E="relative path start";continue}"\t"==K||"\n"==K||"\r"==K||(f.call(this),this.m=!0)}break;case"relative path start":if(E="relative path","/"!=K&&"\\"!=K)continue;break;case"relative path":null!=K&&"/"!=K&&"\\"!=K&&(o||"?"!=K&&"#"!=K)?"\t"!=K&&"\n"!=K&&"\r"!=K&&(B+=c(K)):((W=h[B.toLowerCase()])&&(B=W),".."==B?(this.s.pop(),"/"!=K&&"\\"!=K&&this.s.push("")):"."==B&&"/"!=K&&"\\"!=K?this.s.push(""):"."!=B&&("file"==this.l&&0==this.s.length&&2==B.length&&m.test(B[0])&&"|"==B[1]&&(B=B[0]+":"),this.s.push(B)),B="","?"==K?(this.A="?",E="query"):"#"==K&&(this.C="#",E="fragment"));break;case"query":o||"#"!=K?null!=K&&"\t"!=K&&"\n"!=K&&"\r"!=K&&(this.A+=d(K)):(this.C="#",E="fragment");break;case"fragment":null!=K&&"\t"!=K&&"\n"!=K&&"\r"!=K&&(this.C+=K)}$++}}function f(){this.B=this.ya=this.l="",this.j=null,this.v=this.o="",this.s=[],this.C=this.A="",this.H=this.m=!1}function g(t,o){void 0===o||o instanceof g||(o=new g(String(o))),this.g=t,f.call(this),e.call(this,this.g.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,""),null,o)}var o=!1;try{var s=new URL("b","http://a");s.pathname="c%20d",o="http://a/c%20d"===s.href}catch(t){}if(!o){var l=Object.create(null);l.ftp=21,l.file=0,l.gopher=70,l.http=80,l.https=443,l.ws=80,l.wss=443;var h=Object.create(null);h["%2e"]=".",h[".%2e"]="..",h["%2e."]="..",h["%2e%2e"]="..";var m=/[a-zA-Z]/,_=/[a-zA-Z0-9+\-.]/;g.prototype={toString:function(){return this.href},get href(){if(this.m)return this.g;var t="";return""==this.B&&null==this.j||(t=this.B+(null!=this.j?":"+this.j:"")+"@"),this.protocol+(this.H?"//"+t+this.host:"")+this.pathname+this.A+this.C},set href(t){f.call(this),e.call(this,t)},get protocol(){return this.l+":"},set protocol(t){this.m||e.call(this,t+":","scheme start")},get host(){return this.m?"":this.v?this.o+":"+this.v:this.o},set host(t){!this.m&&this.H&&e.call(this,t,"host")},get hostname(){return this.o},set hostname(t){!this.m&&this.H&&e.call(this,t,"hostname")},get port(){return this.v},set port(t){!this.m&&this.H&&e.call(this,t,"port")},get pathname(){return this.m?"":this.H?"/"+this.s.join("/"):this.ya},set pathname(t){!this.m&&this.H&&(this.s=[],e.call(this,t,"relative path start"))},get search(){return this.m||!this.A||"?"==this.A?"":this.A},set search(t){!this.m&&this.H&&(this.A="?","?"==t[0]&&(t=t.slice(1)),e.call(this,t,"query"))},get hash(){return this.m||!this.C||"#"==this.C?"":this.C},set hash(t){this.m||(t?(this.C="#","#"==t[0]&&(t=t.slice(1)),e.call(this,t,"fragment")):this.C="")},get origin(){var t;if(this.m||!this.l)return"";switch(this.l){case"data":case"file":case"javascript":case"mailto":return"null"}return(t=this.host)?this.l+"://"+t:""}};var E=t.URL;E&&(g.createObjectURL=function(t){return E.createObjectURL.apply(E,arguments)},g.revokeObjectURL=function(t){E.revokeObjectURL(t)}),t.URL=g}}(window);var Qi=window.customElements,Ji=!1,es=null;function Kj(){window.HTMLTemplateElement.bootstrap&&window.HTMLTemplateElement.bootstrap(window.document),es&&es(),Ji=!0,window.WebComponents.ready=!0,document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}))}Qi.polyfillWrapFlushCallback&&Qi.polyfillWrapFlushCallback((function(t){es=t,Ji&&t()})),"complete"!==document.readyState?(window.addEventListener("load",Kj),window.addEventListener("DOMContentLoaded",(function(){window.removeEventListener("load",Kj),Kj()}))):Kj()}.call(t);class BatchResponse{}const NA="https://graph.microsoft.com",DA=new Set([NA,"https://graph.microsoft.us","https://dod-graph.microsoft.us","https://graph.microsoft.de","https://microsoftgraph.chinacloudapi.cn","https://canary.graph.microsoft.com"]);function __awaiter$K(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))}var LA;"function"==typeof SuppressedError&&SuppressedError,function(t){t.GET="GET",t.PATCH="PATCH",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE"}(LA||(LA={}));class BatchRequestContent{constructor(t){if(this.requests=new Map,void 0!==t){const o=BatchRequestContent.requestLimit;if(t.length>o){const t=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${o}`);throw t.name="Limit Exceeded Error",t}for(const o of t)this.addRequest(o)}}static validateDependencies(t){if(0===t.size){const t=new Error("Empty requests map, Please provide at least one request.");throw t.name="Empty Requests Error",t}return(t=>{const o=t.entries();let s=o.next();for(;!s.done;){const t=s.value[1];if(void 0!==t.dependsOn&&t.dependsOn.length>0)return!1;s=o.next()}return!0})(t)||(t=>{const o=t.entries();let s=o.next();const l=s.value[1];if(void 0!==l.dependsOn&&l.dependsOn.length>0)return!1;let h=s;for(s=o.next();!s.done;){const t=s.value[1];if(void 0===t.dependsOn||1!==t.dependsOn.length||t.dependsOn[0]!==h.value[1].id)return!1;h=s,s=o.next()}return!0})(t)||(t=>{const o=t.entries();let s=o.next();const l=s.value[1];let h;if(void 0===l.dependsOn||0===l.dependsOn.length)h=l.id;else{if(1!==l.dependsOn.length)return!1;{const o=l.dependsOn[0];if(o===l.id||!t.has(o))return!1;h=o}}for(s=o.next();!s.done;){const t=s.value[1];if((void 0===t.dependsOn||0===t.dependsOn.length)&&h!==t.id)return!1;if(void 0!==t.dependsOn&&0!==t.dependsOn.length){if(1===t.dependsOn.length&&(t.id===h||t.dependsOn[0]!==h))return!1;if(t.dependsOn.length>1)return!1}s=o.next()}return!0})(t)}static getRequestData(t){return __awaiter$K(this,void 0,void 0,(function*(){const o={url:""},s=new RegExp("^https?://");o.url=s.test(t.url)?"/"+t.url.split(/.*?\/\/.*?\//)[1]:t.url,o.method=t.method;const l={};return t.headers.forEach(((t,o)=>{l[o]=t})),Object.keys(l).length&&(o.headers=l),t.method!==LA.PATCH&&t.method!==LA.POST&&t.method!==LA.PUT||(o.body=yield BatchRequestContent.getRequestBody(t)),o}))}static getRequestBody(t){return __awaiter$K(this,void 0,void 0,(function*(){let o,s=!1;try{const l=t.clone();o=yield l.json(),s=!0}catch(t){}if(!s)try{if("undefined"!=typeof Blob){const s=yield t.blob(),l=new FileReader;o=yield new Promise((t=>{l.addEventListener("load",(()=>{const o=l.result,s=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(o);t(s[4])}),!1),l.readAsDataURL(s)}))}else if("undefined"!=typeof Buffer){o=(yield t.buffer()).toString("base64")}s=!0}catch(t){}return o}))}addRequest(t){const o=BatchRequestContent.requestLimit;if(""===t.id){const t=new Error("Id for a request is empty, Please provide an unique id");throw t.name="Empty Id For Request",t}if(this.requests.size===o){const t=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${o}`);throw t.name="Limit Exceeded Error",t}if(this.requests.has(t.id)){const o=new Error(`Adding request with duplicate id ${t.id}, Make the id of the requests unique`);throw o.name="Duplicate RequestId Error",o}return this.requests.set(t.id,t),t.id}removeRequest(t){const o=this.requests.delete(t),s=this.requests.entries();let l=s.next();for(;!l.done;){const o=l.value[1].dependsOn;if(void 0!==o){const s=o.indexOf(t);-1!==s&&o.splice(s,1),0===o.length&&delete l.value[1].dependsOn}l=s.next()}return o}getContent(){return __awaiter$K(this,void 0,void 0,(function*(){const t=[],o={requests:t},s=this.requests.entries();let l=s.next();if(l.done){const t=new Error("No requests added yet, Please add at least one request.");throw t.name="Empty Payload",t}if(!BatchRequestContent.validateDependencies(this.requests)){const t=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw t.name="Invalid Dependency",t}for(;!l.done;){const o=l.value[1],h=yield BatchRequestContent.getRequestData(o.request);if(void 0!==h.body&&(void 0===h.headers||void 0===h.headers["content-type"])){const t=new Error(`Content-type header is not mentioned for request #${o.id}, For request having body, Content-type header should be mentioned`);throw t.name="Invalid Content-type header",t}h.id=o.id,void 0!==o.dependsOn&&o.dependsOn.length>0&&(h.dependsOn=o.dependsOn),t.push(h),l=s.next()}return o.requests=t,o}))}addDependency(t,o){if(!this.requests.has(t)){const o=new Error(`Dependent ${t} does not exists, Please check the id`);throw o.name="Invalid Dependent",o}if(void 0!==o&&!this.requests.has(o)){const t=new Error(`Dependency ${o} does not exists, Please check the id`);throw t.name="Invalid Dependency",t}if(void 0!==o){const s=this.requests.get(t);if(void 0===s.dependsOn&&(s.dependsOn=[]),-1!==s.dependsOn.indexOf(o)){const s=new Error(`Dependency ${o} is already added for the request ${t}`);throw s.name="Duplicate Dependency",s}s.dependsOn.push(o)}else{const s=this.requests.entries();let l,h=s.next();for(;!h.done&&h.value[1].id!==t;)l=h,h=s.next();if(void 0===l){const t=new Error(`Can't add dependency ${o}, There is only a dependent request in the batch`);throw t.name="Invalid Dependency Addition",t}{const o=l.value[0];if(void 0===h.value[1].dependsOn&&(h.value[1].dependsOn=[]),-1!==h.value[1].dependsOn.indexOf(o)){const s=new Error(`Dependency ${o} is already added for the request ${t}`);throw s.name="Duplicate Dependency",s}h.value[1].dependsOn.push(o)}}}removeDependency(t,o){const s=this.requests.get(t);if(void 0===s||void 0===s.dependsOn||0===s.dependsOn.length)return!1;if(void 0!==o){const t=s.dependsOn.indexOf(o);return-1!==t&&(s.dependsOn.splice(t,1),!0)}return delete s.dependsOn,!0}}BatchRequestContent.requestLimit=20;const FA=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class GraphClientError extends Error{constructor(t){super(t),Object.setPrototypeOf(this,GraphClientError.prototype)}static setGraphClientError(t){let o;return t instanceof Error?o=t:(o=new GraphClientError,o.customError=t),o}}const BA=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],serializeContent=t=>{const o=t&&t.constructor&&t.constructor.name;if("Buffer"===o||"Blob"===o||"File"===o||"FormData"===o||"string"==typeof t)return t;if("ArrayBuffer"===o)t=Buffer.from(t);else if("Int8Array"===o||"Int16Array"===o||"Int32Array"===o||"Uint8Array"===o||"Uint16Array"===o||"Uint32Array"===o||"Uint8ClampedArray"===o||"Float32Array"===o||"Float64Array"===o||"DataView"===o)t=Buffer.from(t.buffer);else try{t=JSON.stringify(t)}catch(t){throw new Error("Unable to stringify the content")}return t},isGraphURL=t=>isValidEndpoint(t),isCustomHost=(t,o)=>(o.forEach((t=>isCustomHostValid(t))),isValidEndpoint(t,o)),isValidEndpoint=(t,o=FA)=>{if(-1!==(t=t.toLowerCase()).indexOf("https://")){const s=(t=t.replace("https://","")).indexOf(":"),l=t.indexOf("/");let h="";if(-1!==l)return-1!==s&&s<l?(h=t.substring(0,s),o.has(h)):(h=t.substring(0,l),o.has(h))}return!1},isCustomHostValid=t=>{if(-1!==t.indexOf("/"))throw new GraphClientError("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class MiddlewareControl{constructor(t=[]){this.middlewareOptions=new Map;for(const o of t){const t=o.constructor;this.middlewareOptions.set(t,o)}}getMiddlewareOptions(t){return this.middlewareOptions.get(t)}setMiddlewareOptions(t,o){this.middlewareOptions.set(t,o)}}const getRequestHeader=(t,o,s)=>{let l=null;if("undefined"!=typeof Request&&t instanceof Request)l=t.headers.get(s);else if(void 0!==o&&void 0!==o.headers)if("undefined"!=typeof Headers&&o.headers instanceof Headers)l=o.headers.get(s);else if(o.headers instanceof Array){const t=o.headers;for(let o=0,h=t.length;o<h;o++)if(t[o][0]===s){l=t[o][1];break}}else void 0!==o.headers[s]&&(l=o.headers[s]);return l},setRequestHeader=(t,o,s,l)=>{if("undefined"!=typeof Request&&t instanceof Request)t.headers.set(s,l);else if(void 0!==o)if(void 0===o.headers)o.headers=new Headers({[s]:l});else if("undefined"!=typeof Headers&&o.headers instanceof Headers)o.headers.set(s,l);else if(o.headers instanceof Array){let t=0;const h=o.headers.length;for(;t<h;t++){const h=o.headers[t];if(h[0]===s){h[1]=l;break}}t===h&&o.headers.push([s,l])}else Object.assign(o.headers,{[s]:l})},appendRequestHeader=(t,o,s,l)=>{"undefined"!=typeof Request&&t instanceof Request?t.headers.append(s,l):void 0!==o&&(void 0===o.headers?o.headers=new Headers({[s]:l}):"undefined"!=typeof Headers&&o.headers instanceof Headers?o.headers.append(s,l):o.headers instanceof Array?o.headers.push([s,l]):void 0===o.headers?o.headers={[s]:l}:void 0===o.headers[s]?o.headers[s]=l:o.headers[s]+=`, ${l}`)};class AuthenticationHandlerOptions{constructor(t,o){this.authenticationProvider=t,this.authenticationProviderOptions=o}}var HA;!function(t){t[t.NONE=0]="NONE",t[t.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",t[t.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",t[t.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(HA||(HA={}));class TelemetryHandlerOptions{constructor(){this.featureUsage=HA.NONE}static updateFeatureUsageFlag(t,o){let s;t.middlewareControl instanceof MiddlewareControl?s=t.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions):t.middlewareControl=new MiddlewareControl,void 0===s&&(s=new TelemetryHandlerOptions,t.middlewareControl.setMiddlewareOptions(TelemetryHandlerOptions,s)),s.setFeatureUsage(o)}setFeatureUsage(t){this.featureUsage=this.featureUsage|t}getFeatureUsage(){return this.featureUsage.toString(16)}}class AuthenticationHandler{constructor(t){this.authenticationProvider=t}execute(t){return __awaiter$K(this,void 0,void 0,(function*(){const o="string"==typeof t.request?t.request:t.request.url;if(isGraphURL(o)||t.customHosts&&isCustomHost(o,t.customHosts)){let o,s,l;t.middlewareControl instanceof MiddlewareControl&&(o=t.middlewareControl.getMiddlewareOptions(AuthenticationHandlerOptions)),o&&(s=o.authenticationProvider,l=o.authenticationProviderOptions),s||(s=this.authenticationProvider);const h=`Bearer ${yield s.getAccessToken(l)}`;appendRequestHeader(t.request,t.options,AuthenticationHandler.AUTHORIZATION_HEADER,h),TelemetryHandlerOptions.updateFeatureUsageFlag(t,HA.AUTHENTICATION_HANDLER_ENABLED)}else t.options.headers&&delete t.options.headers[AuthenticationHandler.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(t)}))}setNext(t){this.nextMiddleware=t}}AuthenticationHandler.AUTHORIZATION_HEADER="Authorization";class HTTPMessageHandler{execute(t){return __awaiter$K(this,void 0,void 0,(function*(){t.response=yield fetch(t.request,t.options)}))}}class RetryHandlerOptions{constructor(t=RetryHandlerOptions.DEFAULT_DELAY,o=RetryHandlerOptions.DEFAULT_MAX_RETRIES,s=RetryHandlerOptions.defaultShouldRetry){if(t>RetryHandlerOptions.MAX_DELAY&&o>RetryHandlerOptions.MAX_MAX_RETRIES){const t=new Error(`Delay and MaxRetries should not be more than ${RetryHandlerOptions.MAX_DELAY} and ${RetryHandlerOptions.MAX_MAX_RETRIES}`);throw t.name="MaxLimitExceeded",t}if(t>RetryHandlerOptions.MAX_DELAY){const t=new Error(`Delay should not be more than ${RetryHandlerOptions.MAX_DELAY}`);throw t.name="MaxLimitExceeded",t}if(o>RetryHandlerOptions.MAX_MAX_RETRIES){const t=new Error(`MaxRetries should not be more than ${RetryHandlerOptions.MAX_MAX_RETRIES}`);throw t.name="MaxLimitExceeded",t}if(t<0&&o<0){const t=new Error("Delay and MaxRetries should not be negative");throw t.name="MinExpectationNotMet",t}if(t<0){const t=new Error("Delay should not be negative");throw t.name="MinExpectationNotMet",t}if(o<0){const t=new Error("MaxRetries should not be negative");throw t.name="MinExpectationNotMet",t}this.delay=Math.min(t,RetryHandlerOptions.MAX_DELAY),this.maxRetries=Math.min(o,RetryHandlerOptions.MAX_MAX_RETRIES),this.shouldRetry=s}getMaxDelay(){return RetryHandlerOptions.MAX_DELAY}}RetryHandlerOptions.DEFAULT_DELAY=3,RetryHandlerOptions.DEFAULT_MAX_RETRIES=3,RetryHandlerOptions.MAX_DELAY=180,RetryHandlerOptions.MAX_MAX_RETRIES=10,RetryHandlerOptions.defaultShouldRetry=()=>!0;class RetryHandler{constructor(t=new RetryHandlerOptions){this.options=t}isRetry(t){return-1!==RetryHandler.RETRY_STATUS_CODES.indexOf(t.status)}isBuffered(t,o){const s="string"==typeof t?o.method:t.method;if(s===LA.PUT||s===LA.PATCH||s===LA.POST){if("application/octet-stream"===getRequestHeader(t,o,"Content-Type"))return!1}return!0}getDelay(t,o,s){const getRandomness=()=>Number(Math.random().toFixed(3)),l=void 0!==t.headers?t.headers.get(RetryHandler.RETRY_AFTER_HEADER):null;let h;return h=null!==l?Number.isNaN(Number(l))?Math.round((new Date(l).getTime()-Date.now())/1e3):Number(l):o>=2?this.getExponentialBackOffTime(o)+s+getRandomness():s+getRandomness(),Math.min(h,this.options.getMaxDelay()+getRandomness())}getExponentialBackOffTime(t){return Math.round(.5*(Math.pow(2,t)-1))}sleep(t){return __awaiter$K(this,void 0,void 0,(function*(){const o=1e3*t;return new Promise((t=>setTimeout(t,o)))}))}getOptions(t){let o;return t.middlewareControl instanceof MiddlewareControl&&(o=t.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===o&&(o=Object.assign(new RetryHandlerOptions,this.options)),o}executeWithRetry(t,o,s){return __awaiter$K(this,void 0,void 0,(function*(){if(yield this.nextMiddleware.execute(t),o<s.maxRetries&&this.isRetry(t.response)&&this.isBuffered(t.request,t.options)&&s.shouldRetry(s.delay,o,t.request,t.options,t.response)){++o,setRequestHeader(t.request,t.options,RetryHandler.RETRY_ATTEMPT_HEADER,o.toString());const l=this.getDelay(t.response,o,s.delay);return yield this.sleep(l),yield this.executeWithRetry(t,o,s)}}))}execute(t){return __awaiter$K(this,void 0,void 0,(function*(){const o=this.getOptions(t);return TelemetryHandlerOptions.updateFeatureUsageFlag(t,HA.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(t,0,o)}))}setNext(t){this.nextMiddleware=t}}RetryHandler.RETRY_STATUS_CODES=[429,503,504],RetryHandler.RETRY_ATTEMPT_HEADER="Retry-Attempt",RetryHandler.RETRY_AFTER_HEADER="Retry-After";class RedirectHandlerOptions{constructor(t=RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS,o=RedirectHandlerOptions.defaultShouldRedirect){if(t>RedirectHandlerOptions.MAX_MAX_REDIRECTS){const t=new Error(`MaxRedirects should not be more than ${RedirectHandlerOptions.MAX_MAX_REDIRECTS}`);throw t.name="MaxLimitExceeded",t}if(t<0){const t=new Error("MaxRedirects should not be negative");throw t.name="MinExpectationNotMet",t}this.maxRedirects=t,this.shouldRedirect=o}}RedirectHandlerOptions.DEFAULT_MAX_REDIRECTS=5,RedirectHandlerOptions.MAX_MAX_REDIRECTS=20,RedirectHandlerOptions.defaultShouldRedirect=()=>!0;class RedirectHandler$1{constructor(t=new RedirectHandlerOptions){this.options=t}isRedirect(t){return-1!==RedirectHandler$1.REDIRECT_STATUS_CODES.indexOf(t.status)}hasLocationHeader(t){return t.headers.has(RedirectHandler$1.LOCATION_HEADER)}getLocationHeader(t){return t.headers.get(RedirectHandler$1.LOCATION_HEADER)}isRelativeURL(t){return-1===t.indexOf("://")}shouldDropAuthorizationHeader(t,o){const s=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,l=s.exec(t);let h,m;null!==l&&(h=l[0]);const _=s.exec(o);return null!==_&&(m=_[0]),void 0!==h&&void 0!==m&&h!==m}updateRequestUrl(t,o){return __awaiter$K(this,void 0,void 0,(function*(){var s,l;o.request="string"==typeof o.request?t:yield(s=t,l=o.request,__awaiter$K(void 0,void 0,void 0,(function*(){const t=l.headers.get("Content-Type")?yield l.blob():yield Promise.resolve(void 0),{method:o,headers:h,referrer:m,referrerPolicy:_,mode:E,credentials:$,cache:B,redirect:q,integrity:j,keepalive:K,signal:W}=l;return new Request(s,{method:o,headers:h,body:t,referrer:m,referrerPolicy:_,mode:E,credentials:$,cache:B,redirect:q,integrity:j,keepalive:K,signal:W})})))}))}getOptions(t){let o;return t.middlewareControl instanceof MiddlewareControl&&(o=t.middlewareControl.getMiddlewareOptions(RedirectHandlerOptions)),void 0===o&&(o=Object.assign(new RedirectHandlerOptions,this.options)),o}executeWithRedirect(t,o,s){return __awaiter$K(this,void 0,void 0,(function*(){yield this.nextMiddleware.execute(t);const l=t.response;if(o<s.maxRedirects&&this.isRedirect(l)&&this.hasLocationHeader(l)&&s.shouldRedirect(l)){if(++o,l.status===RedirectHandler$1.STATUS_CODE_SEE_OTHER)t.options.method=LA.GET,delete t.options.body;else{const o=this.getLocationHeader(l);!this.isRelativeURL(o)&&this.shouldDropAuthorizationHeader(l.url,o)&&delete t.options.headers[RedirectHandler$1.AUTHORIZATION_HEADER],yield this.updateRequestUrl(o,t)}yield this.executeWithRedirect(t,o,s)}}))}execute(t){return __awaiter$K(this,void 0,void 0,(function*(){const o=this.getOptions(t);return t.options.redirect=RedirectHandler$1.MANUAL_REDIRECT,TelemetryHandlerOptions.updateFeatureUsageFlag(t,HA.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(t,0,o)}))}setNext(t){this.nextMiddleware=t}}RedirectHandler$1.REDIRECT_STATUS_CODES=[301,302,303,307,308],RedirectHandler$1.STATUS_CODE_SEE_OTHER=303,RedirectHandler$1.LOCATION_HEADER="Location",RedirectHandler$1.AUTHORIZATION_HEADER="Authorization",RedirectHandler$1.MANUAL_REDIRECT="manual";class TelemetryHandler{execute(t){return __awaiter$K(this,void 0,void 0,(function*(){const o="string"==typeof t.request?t.request:t.request.url;if(isGraphURL(o)||t.customHosts&&isCustomHost(o,t.customHosts)){let o=getRequestHeader(t.request,t.options,TelemetryHandler.CLIENT_REQUEST_ID_HEADER);o||(o=(()=>{let t="";for(let o=0;o<32;o++)8!==o&&12!==o&&16!==o&&20!==o||(t+="-"),t+=Math.floor(16*Math.random()).toString(16);return t})(),setRequestHeader(t.request,t.options,TelemetryHandler.CLIENT_REQUEST_ID_HEADER,o));let s,l=`${TelemetryHandler.PRODUCT_NAME}/3.0.2`;if(t.middlewareControl instanceof MiddlewareControl&&(s=t.middlewareControl.getMiddlewareOptions(TelemetryHandlerOptions)),s){const t=s.getFeatureUsage();l+=` (${TelemetryHandler.FEATURE_USAGE_STRING}=${t})`}appendRequestHeader(t.request,t.options,TelemetryHandler.SDK_VERSION_HEADER,l)}else delete t.options.headers[TelemetryHandler.CLIENT_REQUEST_ID_HEADER],delete t.options.headers[TelemetryHandler.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(t)}))}setNext(t){this.nextMiddleware=t}}var UA,qA,jA,zA,VA;TelemetryHandler.CLIENT_REQUEST_ID_HEADER="client-request-id",TelemetryHandler.SDK_VERSION_HEADER="SdkVersion",TelemetryHandler.PRODUCT_NAME="graph-js",TelemetryHandler.FEATURE_USAGE_STRING="featureUsage",function(t){t[t.MANUAL=0]="MANUAL",t[t.RANDOM=1]="RANDOM"}(UA||(UA={})),function(t){t.ARRAYBUFFER="arraybuffer",t.BLOB="blob",t.DOCUMENT="document",t.JSON="json",t.RAW="raw",t.STREAM="stream",t.TEXT="text"}(qA||(qA={})),function(t){t.TEXT_HTML="text/html",t.TEXT_XML="text/xml",t.APPLICATION_XML="application/xml",t.APPLICATION_XHTML="application/xhtml+xml"}(jA||(jA={})),function(t){t.TEXT_PLAIN="text/plain",t.APPLICATION_JSON="application/json"}(zA||(zA={})),function(t){t.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",t.IMAGE="^image\\/.+"}(VA||(VA={}));class GraphResponseHandler{static parseDocumentResponse(t,o){return"undefined"!=typeof DOMParser?new Promise(((s,l)=>{t.text().then((t=>{try{const l=(new DOMParser).parseFromString(t,o);s(l)}catch(t){l(t)}}))})):Promise.resolve(t.body)}static convertResponse(t,o){return __awaiter$K(this,void 0,void 0,(function*(){if(204===t.status)return Promise.resolve();let s;const l=t.headers.get("Content-type");switch(o){case qA.ARRAYBUFFER:s=yield t.arrayBuffer();break;case qA.BLOB:s=yield t.blob();break;case qA.DOCUMENT:s=yield GraphResponseHandler.parseDocumentResponse(t,jA.TEXT_XML);break;case qA.JSON:s=yield t.json();break;case qA.STREAM:s=yield Promise.resolve(t.body);break;case qA.TEXT:s=yield t.text();break;default:if(null!==l){const o=l.split(";")[0];s=new RegExp(VA.DOCUMENT).test(o)?yield GraphResponseHandler.parseDocumentResponse(t,o):new RegExp(VA.IMAGE).test(o)?t.blob():o===zA.TEXT_PLAIN?yield t.text():o===zA.APPLICATION_JSON?yield t.json():Promise.resolve(t.body)}else s=Promise.resolve(t.body)}return s}))}static getResponse(t,o,s){return __awaiter$K(this,void 0,void 0,(function*(){if(o===qA.RAW)return Promise.resolve(t);{const l=yield GraphResponseHandler.convertResponse(t,o);if(!t.ok)throw l;if("function"!=typeof s)return l;s(null,l)}}))}}class CustomAuthenticationProvider{constructor(t){this.provider=t}getAccessToken(){return __awaiter$K(this,void 0,void 0,(function*(){return new Promise(((t,o)=>{this.provider(((s,l)=>__awaiter$K(this,void 0,void 0,(function*(){if(l)t(l);else{if(!s){s=new GraphClientError("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md")}const t=yield GraphClientError.setGraphClientError(s);o(t)}}))))}))}))}}class GraphError extends Error{constructor(t=-1,o,s){super(o||s&&s.message),Object.setPrototypeOf(this,GraphError.prototype),this.statusCode=t,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=s?s.stack:this.stack}}class GraphErrorHandler{static constructError(t,o){const s=new GraphError(o,"",t);return void 0!==t.name&&(s.code=t.name),s.body=t.toString(),s.date=new Date,s}static constructErrorFromResponse(t,o){const s=t.error,l=new GraphError(o,s.message);return l.code=s.code,void 0!==s.innerError&&(l.requestId=s.innerError["request-id"],l.date=new Date(s.innerError.date)),l.body=JSON.stringify(s),l}static getError(t=null,o=-1,s){return __awaiter$K(this,void 0,void 0,(function*(){let l;if(t&&t.error?l=GraphErrorHandler.constructErrorFromResponse(t,o):t instanceof Error?l=GraphErrorHandler.constructError(t,o):(l=new GraphError(o),l.body=t),"function"!=typeof s)return l;s(l,null)}))}}class GraphRequest{constructor(t,o,s){this.parsePath=t=>{if(-1!==t.indexOf("https://")){const o=(t=t.replace("https://","")).indexOf("/");-1!==o&&(this.urlComponents.host="https://"+t.substring(0,o),t=t.substring(o+1,t.length));const s=t.indexOf("/");-1!==s&&(this.urlComponents.version=t.substring(0,s),t=t.substring(s+1,t.length))}"/"===t.charAt(0)&&(t=t.substr(1));const o=t.indexOf("?");if(-1===o)this.urlComponents.path=t;else{this.urlComponents.path=t.substr(0,o);const s=t.substring(o+1,t.length).split("&");for(const t of s)this.parseQueryParameter(t)}},this.httpClient=t,this.config=o,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(s)}addCsvQueryParameter(t,o,s){this.urlComponents.oDataQueryParams[t]=this.urlComponents.oDataQueryParams[t]?this.urlComponents.oDataQueryParams[t]+",":"";let l=[];s.length>1&&"string"==typeof o?l=Array.prototype.slice.call(s):"string"==typeof o?l.push(o):l=l.concat(o),this.urlComponents.oDataQueryParams[t]+=l.join(",")}buildFullUrl(){const t=(t=>{const removePostSlash=t=>t.replace(/\/+$/,""),removePreSlash=t=>t.replace(/^\/+/,"");return Array.prototype.slice.call(t).reduce(((t,o)=>[removePostSlash(t),removePreSlash(o)].join("/")))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(t),t}createQueryString(){const t=this.urlComponents,o=[];if(0!==Object.keys(t.oDataQueryParams).length)for(const s in t.oDataQueryParams)Object.prototype.hasOwnProperty.call(t.oDataQueryParams,s)&&o.push(s+"="+t.oDataQueryParams[s]);if(0!==Object.keys(t.otherURLQueryParams).length)for(const s in t.otherURLQueryParams)Object.prototype.hasOwnProperty.call(t.otherURLQueryParams,s)&&o.push(s+"="+t.otherURLQueryParams[s]);if(0!==t.otherURLQueryOptions.length)for(const s of t.otherURLQueryOptions)o.push(s);return o.length>0?"?"+o.join("&"):""}parseQueryParameter(t){if("string"==typeof t)if("?"===t.charAt(0)&&(t=t.substring(1)),-1!==t.indexOf("&")){const o=t.split("&");for(const t of o)this.parseQueryParamenterString(t)}else this.parseQueryParamenterString(t);else if(t.constructor===Object)for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&this.setURLComponentsQueryParamater(o,t[o]);return this}parseQueryParamenterString(t){if(this.isValidQueryKeyValuePair(t)){const o=t.indexOf("="),s=t.substring(0,o),l=t.substring(o+1);this.setURLComponentsQueryParamater(s,l)}else this.urlComponents.otherURLQueryOptions.push(t)}setURLComponentsQueryParamater(t,o){if(-1!==BA.indexOf(t)){const s=this.urlComponents.oDataQueryParams[t],l=s&&("$expand"===t||"$select"===t||"$orderby"===t);this.urlComponents.oDataQueryParams[t]=l?s+","+o:o}else this.urlComponents.otherURLQueryParams[t]=o}isValidQueryKeyValuePair(t){const o=t.indexOf("=");if(-1===o)return!1;return!(-1!==t.indexOf("(")&&t.indexOf("(")<o)}updateRequestOptions(t){const o=Object.assign({},t.headers);if(void 0!==this.config.fetchOptions){const o=Object.assign({},this.config.fetchOptions);Object.assign(t,o),void 0!==typeof this.config.fetchOptions.headers&&(t.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(t,this._options),void 0!==t.headers&&Object.assign(o,t.headers),Object.assign(o,this._headers),t.headers=o}send(t,o,s){var l;return __awaiter$K(this,void 0,void 0,(function*(){let h;const m=new MiddlewareControl(this._middlewareOptions);this.updateRequestOptions(o);const _=null===(l=this.config)||void 0===l?void 0:l.customHosts;try{h=(yield this.httpClient.sendRequest({request:t,options:o,middlewareControl:m,customHosts:_})).response;return yield GraphResponseHandler.getResponse(h,this._responseType,s)}catch(t){if(t instanceof GraphClientError)throw t;let o;h&&(o=h.status);throw yield GraphErrorHandler.getError(t,o,s)}}))}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const t=Object.keys(this._headers);for(const o of t)if("content-type"===o.toLowerCase())return;this.header("Content-Type","application/json")}header(t,o){return this._headers[t]=o,this}headers(t){for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(this._headers[o]=t[o]);return this}option(t,o){return this._options[t]=o,this}options(t){for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(this._options[o]=t[o]);return this}middlewareOptions(t){return this._middlewareOptions=t,this}version(t){return this.urlComponents.version=t,this}responseType(t){return this._responseType=t,this}select(t){return this.addCsvQueryParameter("$select",t,arguments),this}expand(t){return this.addCsvQueryParameter("$expand",t,arguments),this}orderby(t){return this.addCsvQueryParameter("$orderby",t,arguments),this}filter(t){return this.urlComponents.oDataQueryParams.$filter=t,this}search(t){return this.urlComponents.oDataQueryParams.$search=t,this}top(t){return this.urlComponents.oDataQueryParams.$top=t,this}skip(t){return this.urlComponents.oDataQueryParams.$skip=t,this}skipToken(t){return this.urlComponents.oDataQueryParams.$skipToken=t,this}count(t=!0){return this.urlComponents.oDataQueryParams.$count=t.toString(),this}query(t){return this.parseQueryParameter(t)}get(t){return __awaiter$K(this,void 0,void 0,(function*(){const o=this.buildFullUrl(),s={method:LA.GET};return yield this.send(o,s,t)}))}post(t,o){return __awaiter$K(this,void 0,void 0,(function*(){const s=this.buildFullUrl(),l={method:LA.POST,body:serializeContent(t)};return"FormData"===(t&&t.constructor&&t.constructor.name)?l.headers={}:(this.setHeaderContentType(),l.headers=this._headers),yield this.send(s,l,o)}))}create(t,o){return __awaiter$K(this,void 0,void 0,(function*(){return yield this.post(t,o)}))}put(t,o){return __awaiter$K(this,void 0,void 0,(function*(){const s=this.buildFullUrl();this.setHeaderContentType();const l={method:LA.PUT,body:serializeContent(t)};return yield this.send(s,l,o)}))}patch(t,o){return __awaiter$K(this,void 0,void 0,(function*(){const s=this.buildFullUrl();this.setHeaderContentType();const l={method:LA.PATCH,body:serializeContent(t)};return yield this.send(s,l,o)}))}update(t,o){return __awaiter$K(this,void 0,void 0,(function*(){return yield this.patch(t,o)}))}delete(t){return __awaiter$K(this,void 0,void 0,(function*(){const o=this.buildFullUrl(),s={method:LA.DELETE};return yield this.send(o,s,t)}))}del(t){return __awaiter$K(this,void 0,void 0,(function*(){return yield this.delete(t)}))}getStream(t){return __awaiter$K(this,void 0,void 0,(function*(){const o=this.buildFullUrl(),s={method:LA.GET};return this.responseType(qA.STREAM),yield this.send(o,s,t)}))}putStream(t,o){return __awaiter$K(this,void 0,void 0,(function*(){const s=this.buildFullUrl(),l={method:LA.PUT,headers:{"Content-Type":"application/octet-stream"},body:t};return yield this.send(s,l,o)}))}}class HTTPClient{constructor(...t){if(!t||!t.length){const t=new Error;throw t.name="InvalidMiddlewareChain",t.message="Please provide a default middleware chain or custom middleware chain",t}this.setMiddleware(...t)}setMiddleware(...t){t.length>1?this.parseMiddleWareArray(t):this.middleware=t[0]}parseMiddleWareArray(t){t.forEach(((o,s)=>{s<t.length-1&&o.setNext(t[s+1])})),this.middleware=t[0]}sendRequest(t){return __awaiter$K(this,void 0,void 0,(function*(){if("string"==typeof t.request&&void 0===t.options){const t=new Error;throw t.name="InvalidRequestOptions",t.message="Unable to execute the middleware, Please provide valid options for a request",t}return yield this.middleware.execute(t),t}))}}class HTTPClientFactory{static createWithAuthenticationProvider(t){const o=new AuthenticationHandler(t),s=new RetryHandler(new RetryHandlerOptions),l=new TelemetryHandler,h=new HTTPMessageHandler;if(o.setNext(s),"object"==typeof process&&"function"==typeof require){const t=new RedirectHandler$1(new RedirectHandlerOptions);s.setNext(t),t.setNext(l)}else s.setNext(l);return l.setNext(h),HTTPClientFactory.createWithMiddleware(o)}static createWithMiddleware(...t){return new HTTPClient(...t)}}class Client{constructor(t){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"},(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const t=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw t.name="PolyFillNotAvailable",t}if("undefined"==typeof Promise){const t=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}if("undefined"==typeof fetch){const t=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}})();for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(this.config[o]=t[o]);let o;if(void 0!==t.authProvider&&void 0!==t.middleware){const t=new Error;throw t.name="AmbiguityInInitialization",t.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",t}if(void 0!==t.authProvider)o=HTTPClientFactory.createWithAuthenticationProvider(t.authProvider);else{if(void 0===t.middleware){const t=new Error;throw t.name="InvalidMiddlewareChain",t.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",t}o=new HTTPClient(...[].concat(t.middleware))}this.httpClient=o}static init(t){const o={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(o[s]="authProvider"===s?new CustomAuthenticationProvider(t[s]):t[s]);return Client.initWithMiddleware(o)}static initWithMiddleware(t){return new Client(t)}api(t){return new GraphRequest(this.httpClient,this.config,t)}}var __awaiter$J=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class EventDispatcher{constructor(){this.eventHandlers=[]}fire(t){for(const o of this.eventHandlers)o(t)}add(t){this.eventHandlers.push(t)}remove(t){for(let o=0;o<this.eventHandlers.length;o++)this.eventHandlers[o]===t&&(this.eventHandlers.splice(o,1),o--)}}class IProvider{get isMultiAccountSupportedAndEnabled(){return!1}set baseURL(t){if(!validateBaseURL(t))throw new Error(`${t} is not a valid Graph URL endpoint.`);this._baseURL=t}get baseURL(){return this._baseURL}set customHosts(t){this._customHosts=t}get customHosts(){return this._customHosts}get isMultiAccountSupported(){return this.isMultipleAccountSupported}get state(){return this._state}get isIncrementalConsentDisabled(){return this._isIncrementalConsentDisabled}set isIncrementalConsentDisabled(t){this._isIncrementalConsentDisabled=t}get name(){return"MgtIProvider"}constructor(){this.isMultipleAccountDisabled=!0,this._loginChangedDispatcher=new EventDispatcher,this._activeAccountChangedDispatcher=new EventDispatcher,this._baseURL=NA,this._customHosts=void 0,this._isIncrementalConsentDisabled=!1,this.isMultipleAccountSupported=!1,this._state=exports.ProviderState.Loading}setState(t){t!==this._state&&(this._state=t,this._loginChangedDispatcher.fire({}))}onStateChanged(t){this._loginChangedDispatcher.add(t)}removeStateChangedHandler(t){this._loginChangedDispatcher.remove(t)}setActiveAccount(t){this.fireActiveAccountChanged()}onActiveAccountChanged(t){this._activeAccountChangedDispatcher.add(t)}removeActiveAccountChangedHandler(t){this._activeAccountChangedDispatcher.remove(t)}fireActiveAccountChanged(){this._activeAccountChangedDispatcher.fire({})}getAccessTokenForScopes(...t){return this.getAccessToken({scopes:t})}}var GA,KA;exports.LoginType=void 0,(GA=exports.LoginType||(exports.LoginType={}))[GA.Popup=0]="Popup",GA[GA.Redirect=1]="Redirect",exports.ProviderState=void 0,(KA=exports.ProviderState||(exports.ProviderState={}))[KA.Loading=0]="Loading",KA[KA.SignedOut=1]="SignedOut",KA[KA.SignedIn=2]="SignedIn";var WA,__awaiter$I=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class Providers{static get globalProvider(){return this._globalProvider}static set globalProvider(t){t!==this._globalProvider&&(this._globalProvider&&(this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),this._globalProvider.isMultiAccountSupportedAndEnabled&&this._globalProvider.removeActiveAccountChangedHandler(this.handleActiveAccountChanged)),t&&(t.onStateChanged(this.handleProviderStateChanged),t.isMultiAccountSupportedAndEnabled&&t.onActiveAccountChanged(this.handleActiveAccountChanged)),this._globalProvider=t,this._eventDispatcher.fire(exports.ProvidersChangedState.ProviderChanged))}static onProviderUpdated(t){this._eventDispatcher.add(t)}static removeProviderUpdatedListener(t){this._eventDispatcher.remove(t)}static onActiveAccountChanged(t){this._activeAccountChangedDispatcher.add(t)}static removeActiveAccountChangedListener(t){this._activeAccountChangedDispatcher.remove(t)}static me(){return this.client?(this._mePromise||(this._mePromise=this.getMe()),this._mePromise):(this._mePromise=null,null)}static getMe(){return __awaiter$I(this,void 0,void 0,(function*(){try{const t=yield this.client.api("me").get();if(null==t?void 0:t.id)return t}catch(t){}return null}))}static getCacheId(){var t;return __awaiter$I(this,void 0,void 0,(function*(){if(this._cacheId)return this._cacheId;if((null===(t=Providers.globalProvider)||void 0===t?void 0:t.state)===exports.ProviderState.SignedIn&&!this._cacheId){if(this.client)try{this._cacheId=yield this.createCacheId()}catch(t){}}return this._cacheId}))}static unsetCacheId(){this._cacheId=null,this._mePromise=null}static createCacheId(){return __awaiter$I(this,void 0,void 0,(function*(){if(Providers.globalProvider.isMultiAccountSupportedAndEnabled){const t=this.createCacheIdWithAccountDetails();if(t)return t}return yield this.createCacheIdWithUserDetails()}))}static createCacheIdWithUserDetails(){return __awaiter$I(this,void 0,void 0,(function*(){const t=yield this.me();return(null==t?void 0:t.id)?t.id+"-"+t.userPrincipalName:null}))}static createCacheIdWithAccountDetails(){const t=Providers.globalProvider.getActiveAccount();return t.tenantId&&t.id?t.tenantId+t.id:null}static get client(){return Providers.globalProvider&&Providers.globalProvider.state===exports.ProviderState.SignedIn?Providers.globalProvider.graph.client:null}}Providers._eventDispatcher=new EventDispatcher,Providers._activeAccountChangedDispatcher=new EventDispatcher,Providers.handleProviderStateChanged=()=>{Providers.globalProvider&&Providers.globalProvider.state===exports.ProviderState.SignedIn||(Providers._mePromise=null),Providers._eventDispatcher.fire(exports.ProvidersChangedState.ProviderStateChanged)},Providers.handleActiveAccountChanged=()=>{Providers.unsetCacheId(),Providers._activeAccountChangedDispatcher.fire(null)},exports.ProvidersChangedState=void 0,(WA=exports.ProvidersChangedState||(exports.ProvidersChangedState={}))[WA.ProviderChanged=0]="ProviderChanged",WA[WA.ProviderStateChanged=1]="ProviderStateChanged";const prepScopes=(...t)=>{const o={scopes:t};return Providers.globalProvider.isIncrementalConsentDisabled?[]:[new AuthenticationHandlerOptions(void 0,o)]},chainMiddleware=(...t)=>{const o=t[0];let s=o;for(let o=1;o<t.length;++o){const l=t[o];s.setNext&&s.setNext(l),s=l}return o},validateBaseURL=t=>{try{const o=new URL(t).origin;if(DA.has(o))return o}catch(t){return}};class BatchRequest{constructor(t,o,s,l){this.resource=s.startsWith("/")?s:`/${s}`,this.method=l,this.index=t,this.id=o}}var __awaiter$H=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class Batch{static get baseUrl(){return"https://graph.microsoft.com"}constructor(t){this.graph=t,this.allRequests=[],this.requestsQueue=[],this.scopes=[],this.nextIndex=0,this.retryAfter=0}get hasRequests(){return this.requestsQueue.length>0}get(t,o,s,l){const h=this.nextIndex++,m=new BatchRequest(h,t,o,"GET");m.headers=l,this.allRequests.push(m),this.requestsQueue.push(h),s&&(this.scopes=this.scopes.concat(s))}executeNext(){return __awaiter$H(this,void 0,void 0,(function*(){const t=new Map;var o;if(this.retryAfter&&(yield(o=1e3*this.retryAfter,__awaiter$J(void 0,void 0,void 0,(function*(){return new Promise((t=>{setTimeout(t,o)}))}))),this.retryAfter=0),!this.hasRequests)return t;const s=this.requestsQueue.splice(0,20),l=new BatchRequestContent;for(const t of s.map((t=>this.allRequests[t])))l.addRequest({id:t.index.toString(),request:new Request(Batch.baseUrl+t.resource,{method:t.method,headers:t.headers})});const h=this.scopes.length?prepScopes(...this.scopes):[],m=this.graph.api("$batch").middlewareOptions(h),_=yield l.getContent(),E=yield m.post(_);for(const o of E.responses){const s=new BatchResponse,l=parseInt(o.id,10),h=this.allRequests[l];if(s.id=h.id,s.index=h.index,s.headers=o.headers,200===o.status)"string"==typeof o.body?o.headers["Content-Type"].includes("image/jpeg")?s.content="data:image/jpeg;base64,"+o.body:o.headers["Content-Type"].includes("image/pjpeg")?s.content="data:image/pjpeg;base64,"+o.body:o.headers["Content-Type"].includes("image/png")&&(s.content="data:image/png;base64,"+o.body):s.content=o.body,t.set(h.id,s);else if(429===o.status){this.requestsQueue.unshift(l);const t=o.headers["Retry-After"];this.retryAfter=Math.max(this.retryAfter,parseInt(t,10)||1)}}return t}))}executeAll(){return __awaiter$H(this,void 0,void 0,(function*(){const t=new Map;for(;this.hasRequests;){const o=yield this.executeNext();for(const[s,l]of o)t.set(s,l)}return t}))}}class ComponentMiddlewareOptions{constructor(t){this.componentName="string"==typeof t?t:t.tagName.toLowerCase()}}var __awaiter$G=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class SdkVersionMiddleware{constructor(t,o){this._packageVersion=t,this._providerName=o}execute(t){var o;return __awaiter$G(this,void 0,void 0,(function*(){try{if("string"==typeof t.request)if(validateBaseURL(t.request)){const o=[],s=t.middlewareControl.getMiddlewareOptions(ComponentMiddlewareOptions);if(s){const t=`${s.componentName}/${this._packageVersion}`;o.push(t)}if(this._providerName){const t=`${this._providerName}/${this._packageVersion}`;o.push(t)}const l=`mgt/${this._packageVersion}`;o.push(l),o.push(getRequestHeader(t.request,t.options,"SdkVersion"));const h=o.join(", ");setRequestHeader(t.request,t.options,"SdkVersion",h)}else null===(o=null==t?void 0:t.options)||void 0===o||delete o.headers.SdkVersion}catch(t){}return yield this._nextMiddleware.execute(t)}))}setNext(t){this._nextMiddleware=t}}const QA="3.1.3";const YA=new class CustomElementHelper{constructor(){this._disambiguation=""}get defaultPrefix(){return"mgt"}withDisambiguation(t){return t&&!this._disambiguation&&(this._disambiguation=t),this}get prefix(){return this._disambiguation?`${this.defaultPrefix}-${this._disambiguation}`:this.defaultPrefix}get disambiguation(){return this._disambiguation}get isDisambiguated(){return Boolean(this._disambiguation)}normalize(t){return this.isDisambiguated?t.toUpperCase().replace(this.prefix.toUpperCase(),this.defaultPrefix.toUpperCase()):t}};class Graph{get client(){return this._client}get componentName(){return this._componentName}get version(){return this._version}constructor(t,o="v1.0"){this._client=t,this._version=o}forComponent(t){const o=new Graph(this._client,this._version);return o.setComponent(t),o}api(t){let o=this._client.api(t).version(this._version);return this._componentName&&(o.middlewareOptions=t=>(o._middlewareOptions=o._middlewareOptions.concat(t),o),o=o.middlewareOptions([new ComponentMiddlewareOptions(this._componentName)])),o}createBatch(){return new Batch(this)}setComponent(t){this._componentName=t instanceof Element?YA.normalize(t.tagName):t}}const createFromProvider=(t,o,s)=>{const l=[new AuthenticationHandler(t),new RetryHandler(new RetryHandlerOptions),new TelemetryHandler,new SdkVersionMiddleware(QA,t.name),new HTTPMessageHandler],h=t.baseURL?t.baseURL:NA,m=Client.initWithMiddleware({middleware:chainMiddleware(...l),customHosts:t.customHosts?new Set(t.customHosts):null,baseUrl:h}),_=new Graph(m,o);return s?_.forComponent(s):_};class BetaGraph extends Graph{static fromGraph(t){const o=new BetaGraph(t.client);return o.setComponent(t.componentName),o}constructor(t,o="beta"){super(t,o)}forComponent(t){const o=new BetaGraph(this.client);return this.setComponent(t),o}}
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ZA=window,JA=ZA.ShadowRoot&&(void 0===ZA.ShadyCSS||ZA.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,XA=Symbol(),eI=new WeakMap;class o$4{constructor(t,o,s){if(this._$cssResult$=!0,s!==XA)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=o}get styleSheet(){let t=this.o;const o=this.t;if(JA&&void 0===t){const s=void 0!==o&&1===o.length;s&&(t=eI.get(o)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),s&&eI.set(o,t))}return t}toString(){return this.cssText}}const i$3=(t,...o)=>{const s=1===t.length?t[0]:o.reduce(((o,s,l)=>o+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[l+1]),t[0]);return new o$4(s,t,XA)},tI=JA?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let o="";for(const s of t.cssRules)o+=s.cssText;return(t=>new o$4("string"==typeof t?t:t+"",void 0,XA))(o)})(t):t
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;var rI;const oI=window,nI=oI.trustedTypes,iI=nI?nI.emptyScript:"",sI=oI.reactiveElementPolyfillSupport,aI={toAttribute(t,o){switch(o){case Boolean:t=t?iI:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,o){let s=t;switch(o){case Boolean:s=null!==t;break;case Number:s=null===t?null:Number(t);break;case Object:case Array:try{s=JSON.parse(t)}catch(t){s=null}}return s}},a$2=(t,o)=>o!==t&&(o==o||t==t),lI={attribute:!0,type:String,converter:aI,reflect:!1,hasChanged:a$2},cI="finalized";class u$2 extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this._$Eu()}static addInitializer(t){var o;this.finalize(),(null!==(o=this.h)&&void 0!==o?o:this.h=[]).push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach(((o,s)=>{const l=this._$Ep(s,o);void 0!==l&&(this._$Ev.set(l,s),t.push(l))})),t}static createProperty(t,o=lI){if(o.state&&(o.attribute=!1),this.finalize(),this.elementProperties.set(t,o),!o.noAccessor&&!this.prototype.hasOwnProperty(t)){const s="symbol"==typeof t?Symbol():"__"+t,l=this.getPropertyDescriptor(t,s,o);void 0!==l&&Object.defineProperty(this.prototype,t,l)}}static getPropertyDescriptor(t,o,s){return{get(){return this[o]},set(l){const h=this[t];this[o]=l,this.requestUpdate(t,h,s)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||lI}static finalize(){if(this.hasOwnProperty(cI))return!1;this[cI]=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),void 0!==t.h&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const t=this.properties,o=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const s of o)this.createProperty(s,t[s])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const o=[];if(Array.isArray(t)){const s=new Set(t.flat(1/0).reverse());for(const t of s)o.unshift(tI(t))}else void 0!==t&&o.push(tI(t));return o}static _$Ep(t,o){const s=o.attribute;return!1===s?void 0:"string"==typeof s?s:"string"==typeof t?t.toLowerCase():void 0}_$Eu(){var t;this._$E_=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(t=this.constructor.h)||void 0===t||t.forEach((t=>t(this)))}addController(t){var o,s;(null!==(o=this._$ES)&&void 0!==o?o:this._$ES=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(s=t.hostConnected)||void 0===s||s.call(t))}removeController(t){var o;null===(o=this._$ES)||void 0===o||o.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((t,o)=>{this.hasOwnProperty(o)&&(this._$Ei.set(o,this[o]),delete this[o])}))}createRenderRoot(){var t;const o=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return((t,o)=>{JA?t.adoptedStyleSheets=o.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):o.forEach((o=>{const s=document.createElement("style"),l=ZA.litNonce;void 0!==l&&s.setAttribute("nonce",l),s.textContent=o.cssText,t.appendChild(s)}))})(o,this.constructor.elementStyles),o}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var o;return null===(o=t.hostConnected)||void 0===o?void 0:o.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$ES)||void 0===t||t.forEach((t=>{var o;return null===(o=t.hostDisconnected)||void 0===o?void 0:o.call(t)}))}attributeChangedCallback(t,o,s){this._$AK(t,s)}_$EO(t,o,s=lI){var l;const h=this.constructor._$Ep(t,s);if(void 0!==h&&!0===s.reflect){const m=(void 0!==(null===(l=s.converter)||void 0===l?void 0:l.toAttribute)?s.converter:aI).toAttribute(o,s.type);this._$El=t,null==m?this.removeAttribute(h):this.setAttribute(h,m),this._$El=null}}_$AK(t,o){var s;const l=this.constructor,h=l._$Ev.get(t);if(void 0!==h&&this._$El!==h){const t=l.getPropertyOptions(h),m="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==(null===(s=t.converter)||void 0===s?void 0:s.fromAttribute)?t.converter:aI;this._$El=h,this[h]=m.fromAttribute(o,t.type),this._$El=null}}requestUpdate(t,o,s){let l=!0;void 0!==t&&(((s=s||this.constructor.getPropertyOptions(t)).hasChanged||a$2)(this[t],o)?(this._$AL.has(t)||this._$AL.set(t,o),!0===s.reflect&&this._$El!==t&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(t,s))):l=!1),!this.isUpdatePending&&l&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((t,o)=>this[o]=t)),this._$Ei=void 0);let o=!1;const s=this._$AL;try{o=this.shouldUpdate(s),o?(this.willUpdate(s),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var o;return null===(o=t.hostUpdate)||void 0===o?void 0:o.call(t)})),this.update(s)):this._$Ek()}catch(t){throw o=!1,this._$Ek(),t}o&&this._$AE(s)}willUpdate(t){}_$AE(t){var o;null===(o=this._$ES)||void 0===o||o.forEach((t=>{var o;return null===(o=t.hostUpdated)||void 0===o?void 0:o.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){void 0!==this._$EC&&(this._$EC.forEach(((t,o)=>this._$EO(o,this[o],t))),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var dI;u$2[cI]=!0,u$2.elementProperties=new Map,u$2.elementStyles=[],u$2.shadowRootOptions={mode:"open"},null==sI||sI({ReactiveElement:u$2}),(null!==(rI=oI.reactiveElementVersions)&&void 0!==rI?rI:oI.reactiveElementVersions=[]).push("1.6.3");const uI=window,hI=uI.trustedTypes,pI=hI?hI.createPolicy("lit-html",{createHTML:t=>t}):void 0,fI="$lit$",gI=`lit$${(Math.random()+"").slice(9)}$`,vI="?"+gI,mI=`<${vI}>`,yI=document,u$1=()=>yI.createComment(""),d=t=>null===t||"object"!=typeof t&&"function"!=typeof t,bI=Array.isArray,v=t=>bI(t)||"function"==typeof(null==t?void 0:t[Symbol.iterator]),wI="[ \t\n\f\r]",CI=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,_I=/-->/g,kI=/>/g,xI=RegExp(`>|${wI}(?:([^\\s"'>=/]+)(${wI}*=${wI}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),SI=/'/g,TI=/"/g,EI=/^(?:script|style|textarea|title)$/i,AI=(t=>(o,...s)=>({_$litType$:t,strings:o,values:s}))(1),II=Symbol.for("lit-noChange"),PI=Symbol.for("lit-nothing"),RI=new WeakMap,$I=yI.createTreeWalker(yI,129,null,!1);function P(t,o){if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==pI?pI.createHTML(o):o}const V=(t,o)=>{const s=t.length-1,l=[];let h,m=2===o?"<svg>":"",_=CI;for(let o=0;o<s;o++){const s=t[o];let E,$,B=-1,q=0;for(;q<s.length&&(_.lastIndex=q,$=_.exec(s),null!==$);)q=_.lastIndex,_===CI?"!--"===$[1]?_=_I:void 0!==$[1]?_=kI:void 0!==$[2]?(EI.test($[2])&&(h=RegExp("</"+$[2],"g")),_=xI):void 0!==$[3]&&(_=xI):_===xI?">"===$[0]?(_=null!=h?h:CI,B=-1):void 0===$[1]?B=-2:(B=_.lastIndex-$[2].length,E=$[1],_=void 0===$[3]?xI:'"'===$[3]?TI:SI):_===TI||_===SI?_=xI:_===_I||_===kI?_=CI:(_=xI,h=void 0);const j=_===xI&&t[o+1].startsWith("/>")?" ":"";m+=_===CI?s+mI:B>=0?(l.push(E),s.slice(0,B)+fI+s.slice(B)+gI+j):s+gI+(-2===B?(l.push(void 0),o):j)}return[P(t,m+(t[s]||"<?>")+(2===o?"</svg>":"")),l]};class N{constructor({strings:t,_$litType$:o},s){let l;this.parts=[];let h=0,m=0;const _=t.length-1,E=this.parts,[$,B]=V(t,o);if(this.el=N.createElement($,s),$I.currentNode=this.el.content,2===o){const t=this.el.content,o=t.firstChild;o.remove(),t.append(...o.childNodes)}for(;null!==(l=$I.nextNode())&&E.length<_;){if(1===l.nodeType){if(l.hasAttributes()){const t=[];for(const o of l.getAttributeNames())if(o.endsWith(fI)||o.startsWith(gI)){const s=B[m++];if(t.push(o),void 0!==s){const t=l.getAttribute(s.toLowerCase()+fI).split(gI),o=/([.?@])?(.*)/.exec(s);E.push({type:1,index:h,name:o[2],strings:t,ctor:"."===o[1]?H:"?"===o[1]?L:"@"===o[1]?z:k})}else E.push({type:6,index:h})}for(const o of t)l.removeAttribute(o)}if(EI.test(l.tagName)){const t=l.textContent.split(gI),o=t.length-1;if(o>0){l.textContent=hI?hI.emptyScript:"";for(let s=0;s<o;s++)l.append(t[s],u$1()),$I.nextNode(),E.push({type:2,index:++h});l.append(t[o],u$1())}}}else if(8===l.nodeType)if(l.data===vI)E.push({type:2,index:h});else{let t=-1;for(;-1!==(t=l.data.indexOf(gI,t+1));)E.push({type:7,index:h}),t+=gI.length-1}h++}}static createElement(t,o){const s=yI.createElement("template");return s.innerHTML=t,s}}function S(t,o,s=t,l){var h,m,_,E;if(o===II)return o;let $=void 0!==l?null===(h=s._$Co)||void 0===h?void 0:h[l]:s._$Cl;const B=d(o)?void 0:o._$litDirective$;return(null==$?void 0:$.constructor)!==B&&(null===(m=null==$?void 0:$._$AO)||void 0===m||m.call($,!1),void 0===B?$=void 0:($=new B(t),$._$AT(t,s,l)),void 0!==l?(null!==(_=(E=s)._$Co)&&void 0!==_?_:E._$Co=[])[l]=$:s._$Cl=$),void 0!==$&&(o=S(t,$._$AS(t,o.values),$,l)),o}class M{constructor(t,o){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=o}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){var o;const{el:{content:s},parts:l}=this._$AD,h=(null!==(o=null==t?void 0:t.creationScope)&&void 0!==o?o:yI).importNode(s,!0);$I.currentNode=h;let m=$I.nextNode(),_=0,E=0,$=l[0];for(;void 0!==$;){if(_===$.index){let o;2===$.type?o=new R(m,m.nextSibling,this,t):1===$.type?o=new $.ctor(m,$.name,$.strings,this,t):6===$.type&&(o=new Z(m,this,t)),this._$AV.push(o),$=l[++E]}_!==(null==$?void 0:$.index)&&(m=$I.nextNode(),_++)}return $I.currentNode=yI,h}v(t){let o=0;for(const s of this._$AV)void 0!==s&&(void 0!==s.strings?(s._$AI(t,s,o),o+=s.strings.length-2):s._$AI(t[o])),o++}}class R{constructor(t,o,s,l){var h;this.type=2,this._$AH=PI,this._$AN=void 0,this._$AA=t,this._$AB=o,this._$AM=s,this.options=l,this._$Cp=null===(h=null==l?void 0:l.isConnected)||void 0===h||h}get _$AU(){var t,o;return null!==(o=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==o?o:this._$Cp}get parentNode(){let t=this._$AA.parentNode;const o=this._$AM;return void 0!==o&&11===(null==t?void 0:t.nodeType)&&(t=o.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,o=this){t=S(this,t,o),d(t)?t===PI||null==t||""===t?(this._$AH!==PI&&this._$AR(),this._$AH=PI):t!==this._$AH&&t!==II&&this._(t):void 0!==t._$litType$?this.g(t):void 0!==t.nodeType?this.$(t):v(t)?this.T(t):this._(t)}k(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}$(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}_(t){this._$AH!==PI&&d(this._$AH)?this._$AA.nextSibling.data=t:this.$(yI.createTextNode(t)),this._$AH=t}g(t){var o;const{values:s,_$litType$:l}=t,h="number"==typeof l?this._$AC(t):(void 0===l.el&&(l.el=N.createElement(P(l.h,l.h[0]),this.options)),l);if((null===(o=this._$AH)||void 0===o?void 0:o._$AD)===h)this._$AH.v(s);else{const t=new M(h,this),o=t.u(this.options);t.v(s),this.$(o),this._$AH=t}}_$AC(t){let o=RI.get(t.strings);return void 0===o&&RI.set(t.strings,o=new N(t)),o}T(t){bI(this._$AH)||(this._$AH=[],this._$AR());const o=this._$AH;let s,l=0;for(const h of t)l===o.length?o.push(s=new R(this.k(u$1()),this.k(u$1()),this,this.options)):s=o[l],s._$AI(h),l++;l<o.length&&(this._$AR(s&&s._$AB.nextSibling,l),o.length=l)}_$AR(t=this._$AA.nextSibling,o){var s;for(null===(s=this._$AP)||void 0===s||s.call(this,!1,!0,o);t&&t!==this._$AB;){const o=t.nextSibling;t.remove(),t=o}}setConnected(t){var o;void 0===this._$AM&&(this._$Cp=t,null===(o=this._$AP)||void 0===o||o.call(this,t))}}class k{constructor(t,o,s,l,h){this.type=1,this._$AH=PI,this._$AN=void 0,this.element=t,this.name=o,this._$AM=l,this.options=h,s.length>2||""!==s[0]||""!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=PI}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,o=this,s,l){const h=this.strings;let m=!1;if(void 0===h)t=S(this,t,o,0),m=!d(t)||t!==this._$AH&&t!==II,m&&(this._$AH=t);else{const l=t;let _,E;for(t=h[0],_=0;_<h.length-1;_++)E=S(this,l[s+_],o,_),E===II&&(E=this._$AH[_]),m||(m=!d(E)||E!==this._$AH[_]),E===PI?t=PI:t!==PI&&(t+=(null!=E?E:"")+h[_+1]),this._$AH[_]=E}m&&!l&&this.j(t)}j(t){t===PI?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}class H extends k{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===PI?void 0:t}}const MI=hI?hI.emptyScript:"";class L extends k{constructor(){super(...arguments),this.type=4}j(t){t&&t!==PI?this.element.setAttribute(this.name,MI):this.element.removeAttribute(this.name)}}class z extends k{constructor(t,o,s,l,h){super(t,o,s,l,h),this.type=5}_$AI(t,o=this){var s;if((t=null!==(s=S(this,t,o,0))&&void 0!==s?s:PI)===II)return;const l=this._$AH,h=t===PI&&l!==PI||t.capture!==l.capture||t.once!==l.once||t.passive!==l.passive,m=t!==PI&&(l===PI||h);h&&this.element.removeEventListener(this.name,this,l),m&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var o,s;"function"==typeof this._$AH?this._$AH.call(null!==(s=null===(o=this.options)||void 0===o?void 0:o.host)&&void 0!==s?s:this.element,t):this._$AH.handleEvent(t)}}class Z{constructor(t,o,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=o,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){S(this,t)}}const OI={O:fI,P:gI,A:vI,C:1,M:V,L:M,R:v,D:S,I:R,V:k,H:L,N:z,U:H,F:Z},NI=uI.litHtmlPolyfillSupport;null==NI||NI(N,R),(null!==(dI=uI.litHtmlVersions)&&void 0!==dI?dI:uI.litHtmlVersions=[]).push("2.8.0");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var DI,LI;class s$1 extends u$2{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,o;const s=super.createRenderRoot();return null!==(t=(o=this.renderOptions).renderBefore)&&void 0!==t||(o.renderBefore=s.firstChild),s}update(t){const o=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,o,s)=>{var l,h;const m=null!==(l=null==s?void 0:s.renderBefore)&&void 0!==l?l:o;let _=m._$litPart$;if(void 0===_){const t=null!==(h=null==s?void 0:s.renderBefore)&&void 0!==h?h:null;m._$litPart$=_=new R(o.insertBefore(u$1(),t),t,void 0,null!=s?s:{})}return _._$AI(t),_})(o,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!1)}render(){return II}}s$1.finalized=!0,s$1._$litElement$=!0,null===(DI=globalThis.litElementHydrateSupport)||void 0===DI||DI.call(globalThis,{LitElement:s$1});const FI=globalThis.litElementPolyfillSupport;null==FI||FI({LitElement:s$1}),(null!==(LI=globalThis.litElementVersions)&&void 0!==LI?LI:globalThis.litElementVersions=[]).push("3.3.3");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const i$1=(t,o)=>"method"===o.kind&&o.descriptor&&!("value"in o.descriptor)?{...o,finisher(s){s.createProperty(o.key,t)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:o.key,initializer(){"function"==typeof o.initializer&&(this[o.key]=o.initializer.call(this))},finisher(s){s.createProperty(o.key,t)}},e$1=(t,o,s)=>{o.constructor.createProperty(s,t)};
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function n$1(t){return(o,s)=>void 0!==s?e$1(t,o,s):i$1(t,o)
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */}function t$1(t){return n$1({...t,state:!0})}
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var BI;null===(BI=window.HTMLSlotElement)||void 0===BI||BI.prototype.assignedElements;class LocalizationHelper{static get strings(){return this._strings}static set strings(t){this._strings=t,this._stringsEventDispatcher.fire(null)}static getDocumentDirection(){var t,o;switch((null===(t=document.body)||void 0===t?void 0:t.getAttribute("dir"))||(null===(o=document.documentElement)||void 0===o?void 0:o.getAttribute("dir"))){case"rtl":return"rtl";case"auto":return"auto";default:return"ltr"}}static onStringsUpdated(t){this._stringsEventDispatcher.add(t)}static removeOnStringsUpdated(t){this._stringsEventDispatcher.remove(t)}static onDirectionUpdated(t){this._directionEventDispatcher.add(t),this.initDirection()}static removeOnDirectionUpdated(t){this._directionEventDispatcher.remove(t)}static initDirection(){if(this._isDirectionInit)return;this._isDirectionInit=!0,this.mutationObserver=new MutationObserver((t=>{t.forEach((t=>{"dir"===t.attributeName&&this._directionEventDispatcher.fire(null)}))}));const t={attributes:!0,attributeFilter:["dir"]};this.mutationObserver.observe(document.body,t),this.mutationObserver.observe(document.documentElement,t)}static updateStringsForTag(t,o){var s;if((t=t.toLowerCase()).startsWith("mgt-")&&(t=t.substring(4)),this._strings&&o){for(const t of Object.entries(o)){const s=this._strings[t[0]];"string"==typeof s&&(o[t[0]]=s)}if(null===(s=this._strings._components)||void 0===s?void 0:s[t]){const s=this._strings._components[t];for(const t of Object.keys(s))o[t]&&(o[t]=s[t])}}return o}}LocalizationHelper._stringsEventDispatcher=new EventDispatcher,LocalizationHelper._directionEventDispatcher=new EventDispatcher,LocalizationHelper._isDirectionInit=!1;var HI,__decorate$z=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$w=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$F=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};exports.ComponentMediaQuery=void 0,(HI=exports.ComponentMediaQuery||(exports.ComponentMediaQuery={})).mobile="",HI.tablet="tablet",HI.desktop="desktop";class MgtBaseComponent extends s$1{static get packageVersion(){return QA}get mediaQuery(){return this.offsetWidth<768?exports.ComponentMediaQuery.mobile:this.offsetWidth<1200?exports.ComponentMediaQuery.tablet:exports.ComponentMediaQuery.desktop}get isLoadingState(){return this._isLoadingState}get isFirstUpdated(){return this._isFirstUpdated}get strings(){return{}}constructor(){super(),this.direction="ltr",this._isLoadingState=!1,this._isFirstUpdated=!1,this.setLoadingState=t=>{this._isLoadingState!==t&&(this._isLoadingState=t,this.requestUpdate("isLoadingState"))},this.handleProviderUpdates=()=>{this.requestStateUpdate()},this.handleActiveAccountUpdates=()=>{this.clearState(),this.requestStateUpdate()},this.handleLocalizationChanged=()=>{LocalizationHelper.updateStringsForTag(this.tagName,this.strings),this.requestUpdate()},this.handleDirectionChanged=()=>{this.direction=LocalizationHelper.getDocumentDirection()},this.handleDirectionChanged(),this.handleLocalizationChanged()}connectedCallback(){super.connectedCallback(),LocalizationHelper.onStringsUpdated(this.handleLocalizationChanged),LocalizationHelper.onDirectionUpdated(this.handleDirectionChanged)}disconnectedCallback(){super.disconnectedCallback(),LocalizationHelper.removeOnStringsUpdated(this.handleLocalizationChanged),LocalizationHelper.removeOnDirectionUpdated(this.handleDirectionChanged),Providers.removeProviderUpdatedListener(this.handleProviderUpdates),Providers.removeActiveAccountChangedListener(this.handleActiveAccountUpdates)}firstUpdated(t){super.firstUpdated(t),this._isFirstUpdated=!0,Providers.onProviderUpdated(this.handleProviderUpdates),Providers.onActiveAccountChanged(this.handleActiveAccountUpdates),this.requestStateUpdate()}loadState(){return Promise.resolve()}clearState(){}fireCustomEvent(t,o,s=!1,l=!1,h=!1){const m=new CustomEvent(t,{bubbles:s,cancelable:l,composed:h,detail:o});return this.dispatchEvent(m)}updated(t){super.updated(t);const o=new CustomEvent("updated",{bubbles:!0,cancelable:!0});this.dispatchEvent(o)}requestStateUpdate(t=!1){return __awaiter$F(this,void 0,void 0,(function*(){if(!this._isFirstUpdated)return;this.isLoadingState&&!t&&(yield this._currentLoadStatePromise);const o=Providers.globalProvider;if(!o)return Promise.resolve();if(o.state!==exports.ProviderState.SignedOut){if(o.state===exports.ProviderState.Loading)return Promise.resolve();{const o=new Promise(((s,l)=>__awaiter$F(this,void 0,void 0,(function*(){try{this.setLoadingState(!0),this.fireCustomEvent("loadingInitiated"),yield this.loadState(),this.setLoadingState(!1),this.fireCustomEvent("loadingCompleted"),s()}catch(t){this.clearState(),this.setLoadingState(!1),this.fireCustomEvent("loadingFailed"),l(t)}return this._currentLoadStatePromise=this.isLoadingState&&this._currentLoadStatePromise&&t?this._currentLoadStatePromise.then((()=>o)):o}))))}}else this.clearState()}))}}__decorate$z([t$1(),__metadata$w("design:type",String)],MgtBaseComponent.prototype,"direction",void 0);var __decorate$y=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$v=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};class MgtBaseProvider extends MgtBaseComponent{constructor(){super(...arguments),this.stateChangedHandler=()=>{this.fireCustomEvent("onStateChanged",this.provider.state)}}get provider(){return this._provider}set provider(t){this._provider&&this.provider.removeStateChangedHandler((()=>this.stateChangedHandler)),this._provider=t,this._provider&&this.provider.onStateChanged((()=>this.stateChangedHandler))}get isAvailable(){return!0}firstUpdated(t){super.firstUpdated(t);let o=!1;if(this.dependsOn){let t=this.dependsOn;for(;t;){if(t.isAvailable){o=!0;break}t=t.dependsOn}}!o&&this.isAvailable&&this.initializeProvider()}initializeProvider(){}}__decorate$y([n$1({attribute:"depends-on",converter:t=>document.querySelector(t),type:String}),__metadata$v("design:type",MgtBaseProvider)],MgtBaseProvider.prototype,"dependsOn",void 0),__decorate$y([n$1({attribute:"base-url",type:String}),__metadata$v("design:type",String)],MgtBaseProvider.prototype,"baseUrl",void 0),__decorate$y([n$1({attribute:"custom-hosts",type:String,converter:t=>t.split(",").map((t=>t.trim()))}),__metadata$v("design:type",Array)],MgtBaseProvider.prototype,"customHosts",void 0);const equals=(t,o)=>equalsInternal(t,o,new Set),equalsInternal=(t,o,s)=>{const l=Object.prototype.toString.call(t),h=Object.prototype.toString.call(o);if("object"==typeof t&&"object"==typeof o&&l===h&&"[object Object]"===l&&!s.has(t)){s.add(t);for(const l in t)if(!equalsInternal(t[l],o[l],s))return!1;for(const s in o)if(!Object.prototype.hasOwnProperty.call(t,s))return!1;return!0}if(Array.isArray(t)&&Array.isArray(o)&&!s.has(t)){if(s.add(t),t.length!==o.length)return!1;for(let l=0;l<t.length;l++)if(!equalsInternal(t[l],o[l],s))return!1;return!0}return t===o},arraysAreEqual=(t,o)=>{if(t===o)return!0;if(!t||!o)return!1;if(t.length!==o.length)return!1;if(0===t.length)return!0;const s=new Set(t);for(const t of o)if(!s.has(t))return!1;return!0};class TemplateHelper{static renderTemplate(t,o,s){var l;let h;if(o.$parentTemplateContext&&(s=Object.assign(Object.assign({},s),{$parent:o.$parentTemplateContext})),null===(l=o.content)||void 0===l?void 0:l.childNodes.length){const l=o.content.cloneNode(!0);h=this.renderNode(l,t,s)}else if(o.childNodes.length){const l=document.createElement("div");for(const t of o.childNodes)l.appendChild(this.simpleCloneNode(t));h=this.renderNode(l,t,s)}h&&t.appendChild(h)}static setBindingSyntax(t,o){this._startExpression=t,this._endExpression=o;const s=this.escapeRegex(this._startExpression),l=this.escapeRegex(this._endExpression);this._expression=new RegExp(`${s}\\s*([$\\w\\.,'"\\s()\\[\\]]+)\\s*${l}`,"g")}static get globalContext(){return this._globalContext}static get expression(){return this._expression||this.setBindingSyntax("{{","}}"),this._expression}static escapeRegex(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}static simpleCloneNode(t){if(!t)return null;const o=t.cloneNode(!1);for(const s of t.childNodes){const t=this.simpleCloneNode(s);t&&o.appendChild(t)}return o}static expandExpressionsAsString(t,o){return t.replace(this.expression,((t,s)=>{const l=this.evalInContext(s||this.trimExpression(t),o);return l?"object"==typeof l?JSON.stringify(l):l.toString():""}))}static renderNode(t,o,s){if("#text"===t.nodeName)return t.textContent=this.expandExpressionsAsString(t.textContent,s),t;if("TEMPLATE"===t.nodeName)return t.$parentTemplateContext=s,t;const l=t;if(l.attributes)for(const t of l.attributes)if("data-props"===t.name){const h=this.trimExpression(t.value);for(const t of h.split(",")){const h=t.trim().split(":");if(2===h.length){const t=h[0].trim(),m=this.evalInContext(h[1].trim(),s);t.startsWith("@")?"function"==typeof m&&l.addEventListener(t.substring(1),(t=>m(t,s,o))):l[t]=m}}}else l.setAttribute(t.name,this.expandExpressionsAsString(t.value,s));const h=[],m=[];let _=!1;for(const l of t.childNodes){const t=l;let E=!1;if(t.dataset){let $=!1;if(t.dataset.if){const o=t.dataset.if;this.evalBoolInContext(this.trimExpression(o),s)?(t.removeAttribute("data-if"),_=!0,E=!0):(m.push(t),$=!0)}else void 0!==t.dataset.else&&(_?(m.push(t),$=!0):t.removeAttribute("data-else"));t.dataset.for&&!$?h.push(t):$||this.renderNode(l,o,s)}else this.renderNode(l,o,s);E||"#text"===l.nodeName||(_=!1)}for(const t of m)l.removeChild(t);for(const t of h){const h=t.dataset.for,m=this.trimExpression(h).split(/\s(in|of)\s/i);if(3===m.length){const h=m[0].trim(),_=m[2].trim(),E=this.evalInContext(_,s);if(Array.isArray(E)){t.removeAttribute("data-for");for(let m=0;m<E.length;m++){const _=Object.assign({$index:m},s);_[h]=E[m];const $=t.cloneNode(!0);this.renderNode($,o,_),l.insertBefore($,t)}}l.removeChild(t)}}return t}static evalBoolInContext(t,o){return o=Object.assign(Object.assign({},o),this.globalContext),new Function("with(this) { return !!("+t+")}").call(o)}static evalInContext(t,o){o=Object.assign(Object.assign({},o),this.globalContext);const s=new Function("with(this) { return "+t+";}");let l;try{l=s.call(o)}catch(t){}return l}static trimExpression(t){return(t=t.trim()).startsWith(this._startExpression)&&t.endsWith(this._endExpression)&&(t=(t=t.substr(this._startExpression.length,t.length-this._startExpression.length-this._endExpression.length)).trim()),t}}TemplateHelper._globalContext={};var __decorate$x=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$u=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};class MgtTemplatedComponent extends MgtBaseComponent{constructor(){super(),this.templates={},this._renderedSlots=!1,this._renderedTemplates={},this._slotNamesAddedDuringRender=[],this.templateContext=this.templateContext||{}}update(t){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],super.update(t)}updated(t){super.updated(t),this.removeUnusedSlottedElements()}renderTemplate(t,o,s){if(!this.hasTemplate(t))return null;s=s||t,this._slotNamesAddedDuringRender.push(s),this._renderedSlots=!0;const l=AI`
      <slot name=${s}></slot>
    `,h=Object.assign(Object.assign({},o),this.templateContext);if(Object.prototype.hasOwnProperty.call(this._renderedTemplates,s)){const{context:t,slot:o}=this._renderedTemplates[s];if(equals(t,h))return l;this.removeChild(o)}const m=document.createElement("div");m.slot=s,m.dataset.generated="template",TemplateHelper.renderTemplate(m,this.templates[t],h),this.appendChild(m),this._renderedTemplates[s]={context:h,slot:m};const _={templateType:t,context:h,element:m};return this.fireCustomEvent("templateRendered",_),l}hasTemplate(t){var o;return Boolean(null===(o=this.templates)||void 0===o?void 0:o[t])}getTemplates(){const t={};for(let o=0;o<this.children.length;o++){const s=this.children[o];if("TEMPLATE"===s.nodeName){const l=s;l.dataset.type?t[l.dataset.type]=l:t.default=l,l.templateOrder=o}}return t}renderError(){return this.hasTemplate("error")?this.renderTemplate("error",this.error):AI`
      <div class="error">
        ${this.error}
      </div>
    `}removeUnusedSlottedElements(){var t;if(this._renderedSlots){for(let o=0;o<this.children.length;o++){const s=this.children[o];(null===(t=s.dataset)||void 0===t?void 0:t.generated)&&!this._slotNamesAddedDuringRender.includes(s.slot)&&(this.removeChild(s),delete this._renderedTemplates[s.slot],o--)}this._renderedSlots=!1}}}__decorate$x([n$1({attribute:!1}),__metadata$u("design:type",Object)],MgtTemplatedComponent.prototype,"templateContext",void 0),__decorate$x([t$1(),__metadata$u("design:type",Object)],MgtTemplatedComponent.prototype,"error",void 0);const instanceOfAny=(t,o)=>o.some((o=>t instanceof o));let UI,qI;const jI=new WeakMap,zI=new WeakMap,VI=new WeakMap,GI=new WeakMap,KI=new WeakMap;let WI={get(t,o,s){if(t instanceof IDBTransaction){if("done"===o)return zI.get(t);if("objectStoreNames"===o)return t.objectStoreNames||VI.get(t);if("store"===o)return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return wrap(t[o])},set:(t,o,s)=>(t[o]=s,!0),has:(t,o)=>t instanceof IDBTransaction&&("done"===o||"store"===o)||o in t};function wrapFunction(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function getCursorAdvanceMethods(){return qI||(qI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(t)?function(...o){return t.apply(unwrap(this),o),wrap(jI.get(this))}:function(...o){return wrap(t.apply(unwrap(this),o))}:function(o,...s){const l=t.call(unwrap(this),o,...s);return VI.set(l,o.sort?o.sort():[o]),wrap(l)}}function transformCachableValue(t){return"function"==typeof t?wrapFunction(t):(t instanceof IDBTransaction&&function cacheDonePromiseForTransaction(t){if(zI.has(t))return;const o=new Promise(((o,s)=>{const unlisten=()=>{t.removeEventListener("complete",complete),t.removeEventListener("error",error),t.removeEventListener("abort",error)},complete=()=>{o(),unlisten()},error=()=>{s(t.error||new DOMException("AbortError","AbortError")),unlisten()};t.addEventListener("complete",complete),t.addEventListener("error",error),t.addEventListener("abort",error)}));zI.set(t,o)}(t),instanceOfAny(t,function getIdbProxyableTypes(){return UI||(UI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(t,WI):t)}function wrap(t){if(t instanceof IDBRequest)return function promisifyRequest(t){const o=new Promise(((o,s)=>{const unlisten=()=>{t.removeEventListener("success",success),t.removeEventListener("error",error)},success=()=>{o(wrap(t.result)),unlisten()},error=()=>{s(t.error),unlisten()};t.addEventListener("success",success),t.addEventListener("error",error)}));return o.then((o=>{o instanceof IDBCursor&&jI.set(o,t)})).catch((()=>{})),KI.set(o,t),o}(t);if(GI.has(t))return GI.get(t);const o=transformCachableValue(t);return o!==t&&(GI.set(t,o),KI.set(o,t)),o}const unwrap=t=>KI.get(t);const QI=["get","getKey","getAll","getAllKeys","count"],YI=["put","add","delete","clear"],ZI=new Map;function getMethod(t,o){if(!(t instanceof IDBDatabase)||o in t||"string"!=typeof o)return;if(ZI.get(o))return ZI.get(o);const s=o.replace(/FromIndex$/,""),l=o!==s,h=YI.includes(s);if(!(s in(l?IDBIndex:IDBObjectStore).prototype)||!h&&!QI.includes(s))return;const method=async function(t,...o){const m=this.transaction(t,h?"readwrite":"readonly");let _=m.store;return l&&(_=_.index(o.shift())),(await Promise.all([_[s](...o),h&&m.done]))[0]};return ZI.set(o,method),method}!function replaceTraps(t){WI=t(WI)}((t=>({...t,get:(o,s,l)=>getMethod(o,s)||t.get(o,s,l),has:(o,s)=>!!getMethod(o,s)||t.has(o,s)})));var __awaiter$E=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class CacheStore{constructor(t,o){if(!(o in t.stores))throw Error('"store" must be defined in the "schema"');this.schema=t,this.store=o}getValue(t){return __awaiter$E(this,void 0,void 0,(function*(){if(!window.indexedDB)return null;try{return(yield this.getDb()).get(this.store,t)}catch(t){return null}}))}putValue(t,o){return __awaiter$E(this,void 0,void 0,(function*(){if(window.indexedDB)try{yield(yield this.getDb()).put(this.store,Object.assign(Object.assign({},o),{timeCached:Date.now()}),t)}catch(t){return}}))}clearStore(){return __awaiter$E(this,void 0,void 0,(function*(){if(window.indexedDB)try{yield(yield this.getDb()).clear(this.store)}catch(t){return}}))}getDBName(){return __awaiter$E(this,void 0,void 0,(function*(){const t=yield Providers.getCacheId();if(t)return`mgt-${this.schema.name}-${t}`}))}getDb(){return __awaiter$E(this,void 0,void 0,(function*(){const t=yield this.getDBName();if(t)return function openDB(t,o,{blocked:s,upgrade:l,blocking:h,terminated:m}={}){const _=indexedDB.open(t,o),E=wrap(_);return l&&_.addEventListener("upgradeneeded",(t=>{l(wrap(_.result),t.oldVersion,t.newVersion,wrap(_.transaction))})),s&&_.addEventListener("blocked",(()=>s())),E.then((t=>{m&&t.addEventListener("close",(()=>m())),h&&t.addEventListener("versionchange",(()=>h()))})).catch((()=>{})),E}(t,this.schema.version,{upgrade:(o,s,l,h)=>{const m=JSON.parse(localStorage.getItem(JI))||[];m.includes(t)||m.push(t),localStorage.setItem(JI,JSON.stringify(m));for(const t in this.schema.stores)Object.prototype.hasOwnProperty.call(this.schema.stores,t)&&!o.objectStoreNames.contains(t)&&o.createObjectStore(t)}})}))}}var __awaiter$D=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const JI="mgt-db-list";class CacheService{static getCache(t,o){const s=`${t.name}/${o}`;return this.isInitialized||this.init(),this.cacheStore.has(o)||this.cacheStore.set(s,new CacheStore(t,o)),this.cacheStore.get(s)}static clearCacheById(t){const o=[],s=JSON.parse(localStorage.getItem(JI));if(s){const l=[];s.forEach((s=>{s.includes(t)?o.push(new Promise(((t,o)=>{const l=indexedDB.deleteDatabase(s);l.onsuccess=()=>t(),l.onerror=()=>{console.error(`ð¦: ${l.error.name} occurred deleting cache: ${s}`,l.error.message),o()}}))):l.push(s)})),l.length>0?localStorage.setItem(JI,JSON.stringify(l)):localStorage.removeItem(JI)}return Promise.all(o)}static get config(){return this.cacheConfig}static init(){let t;Providers.globalProvider&&(t=Providers.globalProvider.state),Providers.onProviderUpdated((()=>__awaiter$D(this,void 0,void 0,(function*(){if(t===exports.ProviderState.SignedIn&&Providers.globalProvider.state===exports.ProviderState.SignedOut){const t=yield Providers.getCacheId();null!==t&&(yield this.clearCacheById(t))}t=Providers.globalProvider.state})))),this.isInitialized=!0}}CacheService.cacheStore=new Map,CacheService.isInitialized=!1,CacheService.cacheConfig={defaultInvalidationPeriod:36e5,groups:{invalidationPeriod:null,isEnabled:!0},isEnabled:!0,people:{invalidationPeriod:null,isEnabled:!0},photos:{invalidationPeriod:null,isEnabled:!0},presence:{invalidationPeriod:3e5,isEnabled:!0},users:{invalidationPeriod:null,isEnabled:!0},response:{invalidationPeriod:null,isEnabled:!0},files:{invalidationPeriod:null,isEnabled:!0},fileLists:{invalidationPeriod:null,isEnabled:!0}};class TeamsHelper{static get microsoftTeamsLib(){return this._microsoftTeamsLib||window.microsoftTeams}static set microsoftTeamsLib(t){this._microsoftTeamsLib=t}static get isAvailable(){return!!this.microsoftTeamsLib&&(!(window.parent!==window.self||!window.nativeInterface)||("embedded-page-container"===window.name||"extension-tab-frame"===window.name))}static executeDeepLink(t,o){const s=this.microsoftTeamsLib;s.initialize(),s.executeDeepLink(t,o)}}var __awaiter$C=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class GraphPageIterator{get value(){return this._value}get hasNext(){return Boolean(this._nextLink)}static create(t,o,s){return __awaiter$C(this,void 0,void 0,(function*(){const l=yield o.get();if(null==l?void 0:l.value){const o=new GraphPageIterator;return o._graph=t,o._value=l.value,o._nextLink=l["@odata.nextLink"],o._version=s||t.version,o}return null}))}static createFromValue(t,o,s=null){const l=new GraphPageIterator;return l._graph=t,l._value=o,l._nextLink=s,l._version=t.version,l}get nextLink(){return this._nextLink||""}next(){var t;return __awaiter$C(this,void 0,void 0,(function*(){if(this._nextLink){const o=this._nextLink.split(this._version)[1],s=yield this._graph.api(o).version(this._version).get();if(null===(t=null==s?void 0:s.value)||void 0===t?void 0:t.length)return this._value=this._value.concat(s.value),this._nextLink=s["@odata.nextLink"],s.value}return null}))}}const XI=new WeakMap,rewriteStrings=(t,o,s)=>{const l=[];for(const h of t)l.push(h.replace(o,s));return l},mgtHtml=(t,...o)=>{if(YA.isDisambiguated){let o=XI.get(t);if(!o){const s=new RegExp("(</?)mgt-(?!"+YA.disambiguation+"-)"),l=`$1${YA.prefix}-`;o=Object.assign(rewriteStrings(t,s,l),{raw:rewriteStrings(t.raw,s,l)}),XI.set(t,o)}t=o}return AI(t,...o)},customElement=t=>{const o=`${YA.prefix}-${t}`,s=customElements.get(o),version=t=>t.packageVersion||" Unknown likely <3.0.0";return s?t=>(console.error(`ð¦: Tag name ${o} is already defined using class ${s.name} version ${version(s)}\n`,`Currently registering class ${t.name} with version ${version(t)}\n`,"Please use the disambiguation feature to define a unique tag name for this component see: https://github.com/microsoftgraph/microsoft-graph-toolkit/tree/main/packages/mgt-components#disambiguation"),t):(t=>o=>"function"==typeof o?((t,o)=>(customElements.define(t,o),o))(t,o):((t,o)=>{const{kind:s,elements:l}=o;return{kind:s,elements:l,finisher(o){customElements.define(t,o)}}})(t,o))(o)};class SessionCache{constructor(){this.session=window.sessionStorage}setItem(t,o){this.session.setItem(t,o)}getItem(t){return this.session.getItem(t)}clear(){this.session.clear()}}var __awaiter$B=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class MockMiddleware{static get _sessionCache(){return!this._cache&&(t=>{let o;try{o="sessionStorage"===t?window.sessionStorage:window.localStorage;const s="__storage_test__";return o.setItem(s,s),o.removeItem(s),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&o&&0!==o.length}})("sessionStorage")&&(this._cache=new SessionCache),this._cache}execute(t){return __awaiter$B(this,void 0,void 0,(function*(){try{const o=yield MockMiddleware.getBaseUrl();t.request=o+encodeURIComponent(t.request)}catch(t){}return yield this._nextMiddleware.execute(t)}))}setNext(t){this._nextMiddleware=t}static getBaseUrl(){var t,o;return __awaiter$B(this,void 0,void 0,(function*(){if(!this._baseUrl){const s=null===(t=this._sessionCache)||void 0===t?void 0:t.getItem("endpointURL");if(s)this._baseUrl=s;else{try{const t=yield fetch("https://cdn.graph.office.net/en-us/graph/api/proxy/endpoint"),o=yield t.json();"string"!=typeof o?MockMiddleware.setBaseFallbackUrl():this._baseUrl=o+"?url="}catch(t){MockMiddleware.setBaseFallbackUrl()}null===(o=this._sessionCache)||void 0===o||o.setItem("endpointURL",this._baseUrl)}}return this._baseUrl}))}static setBaseFallbackUrl(){this._baseUrl="https://proxy.apisandbox.msdn.microsoft.com/svc?url="}}var __awaiter$A=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class MockGraph extends Graph{static create(t){return __awaiter$A(this,void 0,void 0,(function*(){const o=[new AuthenticationHandler(t),new RetryHandler(new RetryHandlerOptions),new TelemetryHandler,new MockMiddleware,new HTTPMessageHandler];return new MockGraph(Client.initWithMiddleware({middleware:chainMiddleware(...o),customHosts:new Set([new URL(yield MockMiddleware.getBaseUrl()).hostname])}))}))}forComponent(t){return this}}var __awaiter$z=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class MockProvider extends IProvider{constructor(t=!1,o=[]){super(),this._accounts=[],this._mockGraphPromise=MockGraph.create(this);const s=Boolean(o.length);this.isMultipleAccountSupported=s,this.isMultipleAccountDisabled=!s,this._accounts=o,this.initializeMockGraph(t)}get isMultiAccountSupportedAndEnabled(){return!this.isMultipleAccountDisabled&&this.isMultipleAccountSupported}getAllAccounts(){return this._accounts}getActiveAccount(){if(this._accounts.length)return this._accounts[0]}login(){return __awaiter$z(this,void 0,void 0,(function*(){this.setState(exports.ProviderState.Loading),yield this._mockGraphPromise,yield new Promise((t=>setTimeout(t,3e3))),this.setState(exports.ProviderState.SignedIn)}))}logout(){return __awaiter$z(this,void 0,void 0,(function*(){this.setState(exports.ProviderState.Loading),yield this._mockGraphPromise,yield new Promise((t=>setTimeout(t,3e3))),this.setState(exports.ProviderState.SignedOut)}))}getAccessToken(){return Promise.resolve("{token:https://graph.microsoft.com/}")}get name(){return"MgtMockProvider"}initializeMockGraph(t=!1){return __awaiter$z(this,void 0,void 0,(function*(){this.graph=yield this._mockGraphPromise,t?this.setState(exports.ProviderState.SignedIn):this.setState(exports.ProviderState.SignedOut)}))}}const eP=[i$3`

`],tP=document.createElement("style");tP.appendChild(document.createTextNode("\n@font-face {\n    font-family: 'FabricMDL2Icons';\n    src: url('https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff2') format('woff2'),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff) format(\"woff\"),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.ttf) format(\"truetype\");\n}\n")),document.head.appendChild(tP);const rP=document.createElement("style");rP.innerHTML=eP.toString(),document.head.appendChild(rP);
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const oP=1,nP=2,e=t=>(...o)=>({_$litDirective$:t,values:o});class i{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,o,s){this._$Ct=t,this._$AM=o,this._$Ci=s}_$AS(t,o){return this.update(t,o)}update(t,o){return this.render(...o)}}
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const iP=e(class extends i{constructor(t){var o;if(super(t),t.type!==oP||"class"!==t.name||(null===(o=t.strings)||void 0===o?void 0:o.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter((o=>t[o])).join(" ")+" "}update(t,[o]){var s,l;if(void 0===this.it){this.it=new Set,void 0!==t.strings&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter((t=>""!==t))));for(const t in o)o[t]&&!(null===(s=this.nt)||void 0===s?void 0:s.has(t))&&this.it.add(t);return this.render(o)}const h=t.element.classList;this.it.forEach((t=>{t in o||(h.remove(t),this.it.delete(t))}));for(const t in o){const s=!!o[t];s===this.it.has(t)||(null===(l=this.nt)||void 0===l?void 0:l.has(t))||(s?(h.add(t),this.it.add(t)):(h.remove(t),this.it.delete(t)))}return II}}),getRelativeDisplayDate=t=>{const o=new Date,s=new Date(o.getFullYear(),o.getMonth(),o.getDate());if(t>=s)return t.toLocaleString("default",{hour:"numeric",minute:"numeric"});const l=new Date(s);if(l.setDate(o.getDate()-o.getDay()),t>=l)return t.toLocaleString("default",{hour:"numeric",minute:"numeric",weekday:"short"});const h=new Date(l);return h.setDate(l.getDate()-7),t>=h?t.toLocaleString("default",{day:"numeric",month:"numeric",weekday:"short"}):t.toLocaleString("default",{day:"numeric",month:"numeric",year:"numeric"})},getMonthString=t=>{switch(t){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December";default:return"Month"}},debounce=(t,o)=>{let s;return function(){window.clearTimeout(s),s=window.setTimeout((()=>t.apply(this,arguments)),o)}},blobToBase64=t=>new Promise(((o,s)=>{const l=new FileReader;l.onerror=s,l.onload=()=>{o(l.result)},l.readAsDataURL(t)})),extractEmailAddress=t=>t.startsWith("[")?t.match(/([a-zA-Z0-9+._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi).toString():t,isValidEmail=t=>/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),formatBytes=(t,o=2)=>{if(0===t)return"0 Bytes";const s=o<0?0:o,l=Math.floor(Math.log(t)/Math.log(1024));return`${parseFloat((t/Math.pow(1024,l)).toFixed(s))} ${["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][l]}`},sanitizeSummary=t=>(t&&(t=null==(t=null==(t=null==t?void 0:t.replace(/<ddd\/>/gi,"..."))?void 0:t.replace(/<c0>/gi,"<b>"))?void 0:t.replace(/<\/c0>/gi,"</b>")),t),trimFileExtension=t=>null==t?void 0:t.replace(/\.[^/.]+$/,""),getNameFromUrl=t=>new URL(t).pathname.split("/").pop().replace(/-/g," "),getIsResponseCacheEnabled$1=()=>CacheService.config.response.isEnabled&&CacheService.config.isEnabled,sP={name:"presence",stores:{presence:"presence"},version:2},aP={name:"users",stores:{users:"users",usersQuery:"usersQuery",userFilters:"userFilters"},version:3},lP={name:"photos",stores:{contacts:"contacts",users:"users",groups:"groups",teams:"teams"},version:2},cP={name:"people",stores:{contacts:"contacts",groupPeople:"groupPeople",peopleQuery:"peopleQuery"},version:3},dP={name:"groups",stores:{groups:"groups",groupsQuery:"groupsQuery"},version:5},uP={name:"responses",stores:{responses:"responses"},version:2},hP={name:"search",stores:{responses:"responses"},version:2},pP={name:"files",stores:{driveFiles:"driveFiles",groupFiles:"groupFiles",siteFiles:"siteFiles",userFiles:"userFiles",insightFiles:"insightFiles",fileQueries:"fileQueries"},version:2},fP={name:"file-lists",stores:{fileLists:"fileLists",insightfileLists:"insightfileLists"},version:2};var gP,vP,__awaiter$y=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};exports.PersonType=void 0,(gP=exports.PersonType||(exports.PersonType={}))[gP.any=0]="any",gP.person="person",gP.group="group",exports.UserType=void 0,(vP=exports.UserType||(exports.UserType={})).any="any",vP.user="user",vP.contact="contact";const getPeopleInvalidationTime=()=>CacheService.config.people.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsPeopleCacheEnabled=()=>CacheService.config.people.isEnabled&&CacheService.config.isEnabled,findPeople=(t,o,s=10,l=exports.UserType.any,h="")=>__awaiter$y(void 0,void 0,void 0,(function*(){const m=`${o}:${s}:${l}`;let _;if(getIsPeopleCacheEnabled()){const t=cP,o=cP.stores.peopleQuery;_=CacheService.getCache(t,o);const s=getIsPeopleCacheEnabled()?yield _.getValue(m):null;if(s&&getPeopleInvalidationTime()>Date.now()-s.timeCached)return s.results.map((t=>JSON.parse(t)))}let E,$="personType/class eq 'Person'";l!==exports.UserType.any&&(l===exports.UserType.user?$+="and personType/subclass eq 'OrganizationUser'":$+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),""!==h&&($+=`${$} and ${h}`);try{let h=t.api("/me/people").search('"'+o+'"').top(s).filter($).middlewareOptions(prepScopes("people.read"));if(l!==exports.UserType.contact&&(h=h.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),E=yield h.get(),getIsPeopleCacheEnabled()&&E){const t={maxResults:s,results:null};t.results=E.value.map((t=>JSON.stringify(t))),yield _.putValue(m,t)}}catch(t){}return null==E?void 0:E.value})),getPeople=(t,o=exports.UserType.any,s="",l=10)=>__awaiter$y(void 0,void 0,void 0,(function*(){let h;const m=`${s||`*:${o}`}:${l}`;if(getIsPeopleCacheEnabled()){h=CacheService.getCache(cP,cP.stores.peopleQuery);const t=yield h.getValue(m);if(t&&getPeopleInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}let _,E="personType/class eq 'Person'";o!==exports.UserType.any&&(o===exports.UserType.user?E+="and personType/subclass eq 'OrganizationUser'":E+="and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')"),s&&(E+=` and ${s}`);try{let s=t.api("/me/people").middlewareOptions(prepScopes("people.read")).top(l).filter(E);o!==exports.UserType.contact&&(s=s.header("X-PeopleQuery-QuerySources","Mailbox,Directory")),_=yield s.get(),getIsPeopleCacheEnabled()&&_&&(yield h.putValue(m,{maxResults:10,results:_.value.map((t=>JSON.stringify(t)))}))}catch(t){}return _?_.value:null})),getEmailFromGraphEntity=t=>{var o,s;const l=t,h=t,m=t;return h.mail?extractEmailAddress(h.mail):(null===(o=l.scoredEmailAddresses)||void 0===o?void 0:o.length)?extractEmailAddress(l.scoredEmailAddresses[0].address):(null===(s=m.emailAddresses)||void 0===s?void 0:s.length)?extractEmailAddress(m.emailAddresses[0].address):null},findContactsByEmail=(t,o)=>__awaiter$y(void 0,void 0,void 0,(function*(){let s;if(getIsPeopleCacheEnabled()){s=CacheService.getCache(cP,cP.stores.contacts);const t=yield s.getValue(o);if(t&&getPeopleInvalidationTime()>Date.now()-t.timeCached)return JSON.parse(t.person)}const l=`${o.replace(/#/g,"%2523")}`,h=yield t.api("/me/contacts").filter(`emailAddresses/any(a:a/address eq '${l}')`).middlewareOptions(prepScopes("contacts.read")).get();return getIsPeopleCacheEnabled()&&h&&(yield s.putValue(o,{person:JSON.stringify(h.value)})),h?h.value:null}));var __awaiter$x=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const getUserInvalidationTime=()=>CacheService.config.users.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsUsersCacheEnabled=()=>CacheService.config.users.isEnabled&&CacheService.config.isEnabled,getMe=(t,o)=>__awaiter$x(void 0,void 0,void 0,(function*(){let s;if(getIsUsersCacheEnabled()){s=CacheService.getCache(aP,aP.stores.users);const t=yield s.getValue("me");if(t&&getUserInvalidationTime()>Date.now()-t.timeCached){const s=JSON.parse(t.user),l=o?o.filter((t=>!Object.keys(s).includes(t))):null;if(!l||l.length<=1)return s}}let l="me";o&&(l=l+"?$select="+o.toString());const h=yield t.api(l).middlewareOptions(prepScopes("user.read")).get();return getIsUsersCacheEnabled()&&(yield s.putValue("me",{user:JSON.stringify(h)})),h})),getUser=(t,o,s)=>__awaiter$x(void 0,void 0,void 0,(function*(){let l;if(getIsUsersCacheEnabled()){l=CacheService.getCache(aP,aP.stores.users);const t=yield l.getValue(o);if(t&&getUserInvalidationTime()>Date.now()-t.timeCached){const o=t.user?JSON.parse(t.user):null,l=s&&o?s.filter((t=>!Object.keys(o).includes(t))):null;if(!l||l.length<=1)return o}}let h,m=`/users/${o}`;s&&(m=m+"?$select="+s.toString());try{h=yield t.api(m).middlewareOptions(prepScopes("user.readbasic.all")).get()}catch(t){}return getIsUsersCacheEnabled()&&(yield l.putValue(o,{user:JSON.stringify(h)})),h})),getUsersForUserIds=(t,o,s="",l="",h)=>__awaiter$x(void 0,void 0,void 0,(function*(){if(!o||0===o.length)return[];const m=t.createBatch(),_={},E={},$=[];let B;s=s.toLowerCase(),getIsUsersCacheEnabled()&&(B=CacheService.getCache(aP,aP.stores.users));for(const h of o){_[h]=null;let o,q,j=`/users/${h}`;if(getIsUsersCacheEnabled()&&(q=yield B.getValue(h)),(null==q?void 0:q.user)&&getUserInvalidationTime()>Date.now()-q.timeCached)if(o=JSON.parse(null==q?void 0:q.user),s){if(o){const t=o.displayName;(null==t?void 0:t.toLowerCase().includes(s))&&(E[h]=o)}}else o?_[h]=o:(m.get(h,j,["user.readbasic.all"]),$.push(h));else""!==h&&("me"===h.toString()?_[h]=yield getMe(t):(j=`/users/${h}`,l&&(j+=`${j}?$filter=${l}`),m.get(h,j,["user.readbasic.all"]),$.push(h)))}try{if(m.hasRequests){const t=yield m.executeAll();for(const l of o){const o=t.get(l);if(null==o?void 0:o.content){const t=o.content;if(s){((null==t?void 0:t.displayName.toLowerCase())||"").includes(s)&&(E[l]=t)}else _[l]=t;getIsUsersCacheEnabled()&&(yield B.putValue(l,{user:JSON.stringify(t)}))}else{const t=h.find((t=>Object.values(t).includes(l)));t&&(_[l]=t)}}}return s&&Object.keys(E).length?Promise.all(Object.values(E)):Promise.all(Object.values(_))}catch(s){try{return o.filter((t=>$.includes(t))).forEach((o=>{_[o]=getUser(t,o)})),getIsUsersCacheEnabled()&&(yield Promise.all(o.filter((t=>$.includes(t))).map((t=>__awaiter$x(void 0,void 0,void 0,(function*(){return yield B.putValue(t,{user:JSON.stringify(yield _[t])})})))))),Promise.all(Object.values(_))}catch(t){return[]}}})),findUsers=(t,o,s=10,l="")=>__awaiter$x(void 0,void 0,void 0,(function*(){const h={maxResults:s,results:null},m=`${o}:${s}:${l}`;let _;if(getIsUsersCacheEnabled()){_=CacheService.getCache(aP,aP.stores.usersQuery);const t=yield _.getValue(m);if(t&&getUserInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}const E=`${o.replace(/#/g,"%2523")}`,$=t.api("users").header("ConsistencyLevel","eventual").count(!0).search(`"displayName:${E}" OR "mail:${E}"`);let B;""!==l&&$.filter(l);try{B=yield $.top(s).middlewareOptions(prepScopes("User.ReadBasic.All")).get()}catch(t){}return getIsUsersCacheEnabled()&&B&&(h.results=B.value.map((t=>JSON.stringify(t))),yield _.putValue(o,h)),B?B.value:null})),findGroupMembers=(t,o,s,l=10,h=exports.PersonType.person,m=!1,_="",E="")=>__awaiter$x(void 0,void 0,void 0,(function*(){const $={maxResults:l,results:null};let B;const q=`${s||"*"}:${o||"*"}:${l}:${h}:${m}:${_}`;if(getIsUsersCacheEnabled()){B=CacheService.getCache(aP,aP.stores.usersQuery);const t=yield B.getValue(q);if(t&&getUserInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}let j="";o&&(j=`startswith(displayName,'${o}') or startswith(givenName,'${o}') or startswith(surname,'${o}') or startswith(mail,'${o}') or startswith(userPrincipalName,'${o}')`);let K=`/groups/${s}/${m?"transitiveMembers":"members"}`;h===exports.PersonType.person?K+="/microsoft.graph.user":h===exports.PersonType.group&&(K+="/microsoft.graph.group",o&&(j=`startswith(displayName,'${o}') or startswith(mail,'${o}')`)),_&&(j+=o?` and ${_}`:_),E&&(j+=o?` and ${E}`:E);const W=yield t.api(K).count(!0).top(l).filter(j).header("ConsistencyLevel","eventual").middlewareOptions(prepScopes("GroupMember.Read.All")).get();return getIsUsersCacheEnabled()&&W&&($.results=W.value.map((t=>JSON.stringify(t))),yield B.putValue(q,$)),W?W.value:null})),findUsersFromGroupIds=(t,o,s,l=10,h=exports.PersonType.person,m=!1,_="")=>__awaiter$x(void 0,void 0,void 0,(function*(){const E=[];for(const $ of s)try{const s=yield findGroupMembers(t,o,$,l,h,m,_);E.push(...s)}catch(t){continue}return E}));var __awaiter$w=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const getPhotoInvalidationTime=()=>CacheService.config.photos.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsPhotosCacheEnabled=()=>CacheService.config.photos.isEnabled&&CacheService.config.isEnabled,getPhotoForResource=(t,o,s)=>__awaiter$w(void 0,void 0,void 0,(function*(){try{const l=yield t.api(`${o}/photo/$value`).responseType(qA.RAW).middlewareOptions(prepScopes(...s)).get();if(404===l.status)return{eTag:null,photo:null};if(!l.ok)return null;const h=l["@odata.mediaEtag"];return{eTag:h,photo:yield blobToBase64(yield l.blob())}}catch(t){return null}})),getContactPhoto=(t,o)=>__awaiter$w(void 0,void 0,void 0,(function*(){let s,l;return getIsPhotosCacheEnabled()&&(s=CacheService.getCache(lP,lP.stores.contacts),l=yield s.getValue(o),l&&getPhotoInvalidationTime()>Date.now()-l.timeCached)?l.photo:(l=yield getPhotoForResource(t,`me/contacts/${o}`,["contacts.read"]),getIsPhotosCacheEnabled()&&l&&(yield s.putValue(o,l)),l?l.photo:null)})),getUserPhoto=(t,o)=>__awaiter$w(void 0,void 0,void 0,(function*(){let s,l;if(getIsPhotosCacheEnabled()){if(s=CacheService.getCache(lP,lP.stores.users),l=yield s.getValue(o),l&&getPhotoInvalidationTime()>Date.now()-l.timeCached)return l.photo;if(l)try{const s=yield t.api(`users/${o}/photo`).get();s&&(s["@odata.mediaEtag"]!==l.eTag||null===s["@odata.mediaEtag"]&&null===l.eTag)&&(l=null)}catch(t){return null}}return l=l||(yield getPhotoForResource(t,`users/${o}`,["user.readbasic.all"])),getIsPhotosCacheEnabled()&&l&&(yield s.putValue(o,l)),l?l.photo:null})),getPersonImage=(t,o,s=!0)=>__awaiter$w(void 0,void 0,void 0,(function*(){if("personType"in o&&"OrganizationUser"!==o.personType.subclass){if("PersonalContact"===o.personType.subclass&&s){const s=getEmailFromGraphEntity(o),l=yield findContactsByEmail(t,s);if((null==l?void 0:l.length)&&l[0].id)return yield getContactPhoto(t,l[0].id)}return null}if(o.userPrincipalName||o.id){const s=o.userPrincipalName||o.id;return yield getUserPhoto(t,s)}if(o.id){const s=yield getUserPhoto(t,o.id);if(s)return s}const l=getEmailFromGraphEntity(o);if(l){const o=yield findUsers(t,l,1);if(null==o?void 0:o.length)return yield getUserPhoto(t,o[0].id);if(s){const o=yield findContactsByEmail(t,l);if(null==o?void 0:o.length)return yield getContactPhoto(t,o[0].id)}}return null})),storePhotoInCache=(t,o,s)=>__awaiter$w(void 0,void 0,void 0,(function*(){const l=CacheService.getCache(lP,o);yield l.putValue(t,s)}));var __awaiter$v=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const getPresenceInvalidationTime=()=>CacheService.config.presence.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsPresenceCacheEnabled=()=>CacheService.config.presence.isEnabled&&CacheService.config.isEnabled,getUserPresence=(t,o)=>__awaiter$v(void 0,void 0,void 0,(function*(){let s;if(getIsPresenceCacheEnabled()){s=CacheService.getCache(sP,sP.stores.presence);const t=yield s.getValue(o||"me");if(t&&getPresenceInvalidationTime()>Date.now()-t.timeCached)return JSON.parse(t.presence)}const l=o?["presence.read.all"]:["presence.read"],h=o?`/users/${o}/presence`:"/me/presence",m=yield t.api(h).middlewareOptions(prepScopes(...l)).get();return getIsPresenceCacheEnabled()&&(yield s.putValue(o||"me",{presence:JSON.stringify(m)})),m})),isGraphError=t=>{const o=t;return o.statusCode&&"code"in o&&"body"in o&&o.date&&"message"in o&&"name"in o&&"requestId"in o};var __awaiter$u=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const getUserWithPhoto=(t,o,s)=>__awaiter$u(void 0,void 0,void 0,(function*(){let l,h,m,_=null;const E=o?`users/${o}`:"me",$=E+(s?`?$select=${s.toString()}`:""),B=o?["user.readbasic.all"]:["user.read"];if(getIsUsersCacheEnabled()){const t=CacheService.getCache(aP,aP.stores.users);if(m=yield t.getValue(o||"me"),m&&getUserInvalidationTime()>Date.now()-m.timeCached){if(_=m.user?JSON.parse(m.user):null,null!==_&&s){s.filter((t=>!Object.keys(_).includes(t))).length>=1&&(_=null,m=null)}}else m=null}if(getIsPhotosCacheEnabled())if(h=yield((t,o)=>__awaiter$w(void 0,void 0,void 0,(function*(){const s=CacheService.getCache(lP,o);return yield s.getValue(t)})))(o||"me",lP.stores.users),h&&getPhotoInvalidationTime()>Date.now()-h.timeCached)l=h.photo;else if(h)try{const s=yield t.api(`${E}/photo`).get();(null==s?void 0:s["@odata.mediaEtag"])&&s["@odata.mediaEtag"]===h.eTag?(yield storePhotoInCache(o||"me",lP.stores.users,h),l=h.photo):h=null}catch(t){isGraphError(t)&&("ErrorItemNotFound"!==t.code&&"ImageNotFound"!==t.code||(yield storePhotoInCache(o||"me",lP.stores.users,{eTag:null,photo:null})))}if(h||m)if(h){if(!m)try{const s=yield t.api($).middlewareOptions(prepScopes(...B)).get();if(s){if(getIsUsersCacheEnabled()){const t=CacheService.getCache(aP,aP.stores.users);yield t.putValue(o||"me",{user:JSON.stringify(s)})}_=s}}catch(t){}}else try{const s=yield getPhotoForResource(t,E,B);s&&(getIsPhotosCacheEnabled()&&(yield storePhotoInCache(o||"me",lP.stores.users,{eTag:s.eTag,photo:s.photo})),l=s.photo)}catch(t){}else{let h;const m=t.createBatch();o?(m.get("user",`/users/${o}${s?"?$select="+s.toString():""}`,["user.readbasic.all"]),m.get("photo",`users/${o}/photo/$value`,["user.readbasic.all"])):(m.get("user","me",["user.read"]),m.get("photo","me/photo/$value",["user.read"]));const E=yield m.executeAll(),$=E.get("photo");$&&(h=$.headers.ETag,l=$.content);const B=E.get("user");if(B&&(_=B.content),getIsUsersCacheEnabled()){const t=CacheService.getCache(aP,aP.stores.users);yield t.putValue(o||"me",{user:JSON.stringify(_)})}getIsPhotosCacheEnabled()&&(yield storePhotoInCache(o||"me",lP.stores.users,{eTag:h,photo:l}))}return _&&(_.personImage=l),_}));var mP,yP;exports.ViewType=void 0,(mP=exports.ViewType||(exports.ViewType={}))[mP.image=2]="image",mP[mP.oneline=3]="oneline",mP[mP.twolines=4]="twolines",mP[mP.threelines=5]="threelines",mP[mP.fourlines=6]="fourlines",function(t){t[t.ArrowDown=0]="ArrowDown",t[t.TeamSeparator=1]="TeamSeparator",t[t.Search=2]="Search",t[t.SkypeArrow=3]="SkypeArrow",t[t.SmallEmail=4]="SmallEmail",t[t.SmallEmailHovered=5]="SmallEmailHovered",t[t.SmallChat=6]="SmallChat",t[t.SmallChatHovered=7]="SmallChatHovered",t[t.Video=8]="Video",t[t.VideoHovered=9]="VideoHovered",t[t.ExpandDown=10]="ExpandDown",t[t.Overview=11]="Overview",t[t.Send=12]="Send",t[t.Contact=13]="Contact",t[t.Copy=14]="Copy",t[t.Phone=15]="Phone",t[t.CellPhone=16]="CellPhone",t[t.Chat=17]="Chat",t[t.Call=18]="Call",t[t.CallHovered=19]="CallHovered",t[t.Confirmation=20]="Confirmation",t[t.Department=21]="Department",t[t.Email=22]="Email",t[t.OfficeLocation=23]="OfficeLocation",t[t.Person=24]="Person",t[t.Messages=25]="Messages",t[t.Organization=26]="Organization",t[t.ExpandRight=27]="ExpandRight",t[t.Profile=28]="Profile",t[t.Birthday=29]="Birthday",t[t.File=30]="File",t[t.Files=31]="Files",t[t.Back=32]="Back",t[t.Close=33]="Close",t[t.Upload=34]="Upload",t[t.FileCloud=35]="FileCloud",t[t.DragFile=36]="DragFile",t[t.Cancel=37]="Cancel",t[t.CheckMark=38]="CheckMark",t[t.Success=39]="Success",t[t.Fail=40]="Fail",t[t.SelectAccount=41]="SelectAccount",t[t.News=42]="News",t[t.DoubleBookmark=43]="DoubleBookmark",t[t.ChevronLeft=44]="ChevronLeft",t[t.ChevronRight=45]="ChevronRight",t[t.Event=46]="Event",t[t.BookOpen=47]="BookOpen",t[t.FileOuter=48]="FileOuter",t[t.BookQuestion=49]="BookQuestion",t[t.Globe=50]="Globe",t[t.Delete=51]="Delete",t[t.Add=52]="Add",t[t.Calendar=53]="Calendar",t[t.Planner=54]="Planner",t[t.Milestone=55]="Milestone",t[t.PersonAdd=56]="PersonAdd",t[t.PresenceAvailable=57]="PresenceAvailable",t[t.PresenceOofAvailable=58]="PresenceOofAvailable",t[t.PresenceBusy=59]="PresenceBusy",t[t.PresenceOofBusy=60]="PresenceOofBusy",t[t.PresenceDnd=61]="PresenceDnd",t[t.PresenceOofDnd=62]="PresenceOofDnd",t[t.PresenceAway=63]="PresenceAway",t[t.PresenceOofAway=64]="PresenceOofAway",t[t.PresenceOffline=65]="PresenceOffline",t[t.PresenceStatusUnknown=66]="PresenceStatusUnknown"}(yP||(yP={}));const getSvg=(t,o)=>{switch(t){case yP.ArrowDown:return AI`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9L2.46447 5.46447H6H9.53553L6 9Z" />
        </svg>
      `;case yP.TeamSeparator:return AI`
        <svg width="6" height="10" viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M5.70711 5L1.49999 9.20711L0.792886 8.50001L4.29289 5L0.792887 1.49999L1.49999 0.792885L5.70711 5Z"
            fill=${o}
          />
        </svg>
      `;case yP.Search:return AI`
        <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M7.30887 8.01596C6.53903 8.63179 5.56252 9.00004 4.5 9.00004C2.01472 9.00004 0 6.98531 0 4.50002C0 2.01473 2.01472 0 4.5 0C6.98528 0 9 2.01473 9 4.50002C9 5.56252 8.63177 6.53901 8.01597 7.30885L11.8536 11.1464C12.0488 11.3417 12.0488 11.6583 11.8536 11.8536C11.6583 12.0488 11.3417 12.0488 11.1464 11.8536L7.30887 8.01596ZM8 4.50002C8 2.56701 6.433 1 4.5 1C2.567 1 1 2.56701 1 4.50002C1 6.43302 2.567 8.00003 4.5 8.00003C6.433 8.00003 8 6.43302 8 4.50002Z" fill="currentColor"/>
        </svg>`;case yP.SkypeArrow:return AI`
        <svg viewBox="0 0 12 10" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M3.95184 0.480534C4.23385 0.10452 4.70926 -0.0724722 5.1685 0.0275755C5.62775 0.127623 5.98645 0.486329 6.0865 0.945575C6.18655 1.40482 6.00956 1.88023 5.63354 2.16224L4.07196 3.72623H10.7988C11.4622 3.72623 12 4.26403 12 4.92744C12 5.59086 11.4622 6.12866 10.7988 6.12866H4.07196L5.63114 7.68784C6.0955 8.15225 6.0955 8.90515 5.63114 9.36955C5.51655 9.48381 5.38119 9.57514 5.23234 9.63862C5.09341 9.69857 4.94399 9.73042 4.79269 9.73232C4.63498 9.73233 4.4789 9.70046 4.33382 9.63862C4.18765 9.57669 4.05593 9.48507 3.94703 9.36955L0.343377 5.7659C-0.114459 5.29881 -0.114459 4.55128 0.343377 4.08419L3.95184 0.480534Z"
            fill="#B4009E"
          />
        </svg>
      `;case yP.SmallEmail:return AI`
        <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path class="filled" d="M16 3.373V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 -7.62939e-05 11.8807 -7.62939e-05 10.5V3.373L7.74649 7.93097C7.90297 8.02301 8.09704 8.02301 8.25351 7.93097L16 3.373ZM13.5 0C14.7871 0 15.847 0.972604 15.9848 2.22293L8 6.91991L0.0151832 2.22293C0.15304 0.972604 1.21294 0 2.5 0H13.5Z" fill="currentColor"/>
          <path class="regular" d="M13.608 0.833496C14.9887 0.833496 16.108 1.95278 16.108 3.3335V11.3335C16.108 12.7142 14.9887 13.8335 13.608 13.8335H2.60803C1.22732 13.8335 0.108032 12.7142 0.108032 11.3335V3.3335C0.108032 1.95278 1.22732 0.833496 2.60803 0.833496H13.608ZM15.108 4.7945L8.36154 8.76446C8.23115 8.84117 8.07464 8.85395 7.93554 8.80281L7.85452 8.76446L1.10803 4.7965V11.3335C1.10803 12.1619 1.77961 12.8335 2.60803 12.8335H13.608C14.4365 12.8335 15.108 12.1619 15.108 11.3335V4.7945ZM13.608 1.8335H2.60803C1.77961 1.8335 1.10803 2.50507 1.10803 3.3335V3.6355L8.10803 7.75341L15.108 3.6345V3.3335C15.108 2.50507 14.4365 1.8335 13.608 1.8335Z" fill="currentColor"/>
        </svg>
      `;case yP.SmallChat:return AI`
        <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path class="filled" d="M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8.5 9H5.5L5.41012 9.00806C5.17688 9.05039 5 9.25454 5 9.5C5 9.74546 5.17688 9.94961 5.41012 9.99194L5.5 10H8.5L8.58988 9.99194C8.82312 9.94961 9 9.74546 9 9.5C9 9.25454 8.82312 9.05039 8.58988 9.00806L8.5 9ZM10.5 6H5.5L5.41012 6.00806C5.17688 6.05039 5 6.25454 5 6.5C5 6.74546 5.17688 6.94961 5.41012 6.99194L5.5 7H10.5L10.5899 6.99194C10.8231 6.94961 11 6.74546 11 6.5C11 6.25454 10.8231 6.05039 10.5899 6.00806L10.5 6Z" fill="currentColor"/>
          <path class="regular" d="M8.38599 0.833496C12.8043 0.833496 16.386 4.41522 16.386 8.8335C16.386 13.2518 12.8043 16.8335 8.38599 16.8335C7.11277 16.8335 5.8819 16.5353 4.77267 15.9728L4.65199 15.9085L1.00708 16.8186C0.697255 16.8959 0.41221 16.6704 0.387296 16.3773L0.387128 16.2959L0.400919 16.2122L1.31099 12.5685L1.24768 12.4488C0.792589 11.5521 0.510317 10.5757 0.418733 9.56176L0.393362 9.17984L0.385986 8.8335C0.385986 4.41522 3.96771 0.833496 8.38599 0.833496ZM8.38599 1.8335C4.51999 1.8335 1.38599 4.9675 1.38599 8.8335C1.38599 10.0505 1.69653 11.2213 2.27951 12.2584C2.32645 12.3419 2.34809 12.4365 2.34291 12.5308L2.32873 12.6247L1.57299 15.6455L4.59703 14.8918C4.65892 14.8764 4.72261 14.8731 4.78472 14.8814L4.87629 14.9026L4.963 14.941C5.9996 15.5233 7.16969 15.8335 8.38599 15.8335C12.252 15.8335 15.386 12.6995 15.386 8.8335C15.386 4.9675 12.252 1.8335 8.38599 1.8335ZM8.88599 9.8335C9.16213 9.8335 9.38599 10.0574 9.38599 10.3335C9.38599 10.579 9.20911 10.7831 8.97586 10.8254L8.88599 10.8335H5.88599C5.60984 10.8335 5.38599 10.6096 5.38599 10.3335C5.38599 10.088 5.56286 9.88389 5.79611 9.84155L5.88599 9.8335H8.88599ZM10.886 6.8335C11.1621 6.8335 11.386 7.05735 11.386 7.3335C11.386 7.57896 11.2091 7.7831 10.9759 7.82544L10.886 7.8335L5.88599 7.8335C5.60984 7.8335 5.38599 7.60964 5.38599 7.3335C5.38599 7.08804 5.56286 6.88389 5.79611 6.84155L5.88599 6.8335L10.886 6.8335Z" fill="currentColor"/>
        </svg>
      `;case yP.Video:return AI`
        <svg width="17" height="13" viewBox="0 0 17 13" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path class="filled" d="M11 2.5C11 1.11929 9.88071 0 8.5 0H2.5C1.11929 0 0 1.11929 0 2.5V9.5C0 10.8807 1.11929 12 2.5 12H8.5C9.88071 12 11 10.8807 11 9.5V2.5ZM12 3.93082V8.08149L14.7642 10.4319C15.2512 10.8461 16 10.4999 16 9.86055V2.19315C16 1.55685 15.2575 1.20962 14.7692 1.61756L12 3.93082Z" fill="currentColor"/>
          <path class="regular" d="M2.72095 0.833496C1.34024 0.833496 0.220947 1.95278 0.220947 3.3335V10.3335C0.220947 11.7142 1.34024 12.8335 2.72095 12.8335H9.72095C11.1017 12.8335 12.2209 11.7142 12.2209 10.3335V9.33348L14.6209 11.1335C15.2802 11.6279 16.2209 11.1575 16.2209 10.3335V3.33348C16.2209 2.50944 15.2802 2.03905 14.6209 2.53348L12.2209 4.33348V3.3335C12.2209 1.95278 11.1017 0.833496 9.72095 0.833496H2.72095ZM12.2209 5.58348L15.2209 3.33348V10.3335L12.2209 8.08348V5.58348ZM11.2209 3.3335V10.3335C11.2209 11.1619 10.5494 11.8335 9.72095 11.8335H2.72095C1.89252 11.8335 1.22095 11.1619 1.22095 10.3335V3.3335C1.22095 2.50507 1.89252 1.8335 2.72095 1.8335H9.72095C10.5494 1.8335 11.2209 2.50507 11.2209 3.3335Z" fill="currentColor"/>
        </svg>
      `;case yP.ExpandDown:return AI`
        <svg width="15" height="8" viewBox="0 0 15 8" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14 1L7.5 7L1 1" stroke="currentColor" />
        </svg>
      `;case yP.Overview:return AI`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3.5 10.5C2.67157 10.5 2 9.82843 2 9V4C2 3.17157 2.67157 2.5 3.5 2.5H12.5C13.3284 2.5 14 3.17157 14 4V9C14 9.82843 13.3284 10.5 12.5 10.5H3.5ZM3.5 3.5C3.22386 3.5 3 3.72386 3 4V5.5H13V4C13 3.72386 12.7761 3.5 12.5 3.5H3.5ZM5 6.5H3V9C3 9.27614 3.22386 9.5 3.5 9.5H5V6.5ZM6 9.5H12.5C12.7761 9.5 13 9.27614 13 9V6.5H6V9.5ZM0 3C0 1.61929 1.11929 0.5 2.5 0.5H13.5C14.8807 0.5 16 1.61929 16 3V10C16 11.3807 14.8807 12.5 13.5 12.5H2.5C1.11929 12.5 0 11.3807 0 10V3ZM2.5 1.5C1.67157 1.5 1 2.17157 1 3V10C1 10.8284 1.67157 11.5 2.5 11.5H13.5C14.3284 11.5 15 10.8284 15 10V3C15 2.17157 14.3284 1.5 13.5 1.5H2.5Z" fill="#717171"/>
        </svg>
      `;case yP.Send:return AI`
        <svg xmlns="http://www.w3.org/2000/svg">
          <path
            d="M4.27144 8.99999L1.72572 2.45387C1.54854 1.99826 1.9928 1.56256 2.43227 1.71743L2.50153 1.74688L16.0015 8.49688C16.3902 8.69122 16.4145 9.22336 16.0744 9.45992L16.0015 9.50311L2.50153 16.2531C2.0643 16.4717 1.58932 16.0697 1.70282 15.6178L1.72572 15.5461L4.27144 8.99999L1.72572 2.45387L4.27144 8.99999ZM3.3028 3.4053L5.25954 8.43705L10.2302 8.43749C10.515 8.43749 10.7503 8.64911 10.7876 8.92367L10.7927 8.99999C10.7927 9.28476 10.5811 9.52011 10.3065 9.55736L10.2302 9.56249L5.25954 9.56205L3.3028 14.5947L14.4922 8.99999L3.3028 3.4053Z"
          />
        </svg>
      `;case yP.Contact:return AI`
        <svg width="16" height="12" viewBox="0 0 16 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 4.5C6 5.32843 5.32843 6 4.5 6C3.67157 6 3 5.32843 3 4.5C3 3.67157 3.67157 3 4.5 3C5.32843 3 6 3.67157 6 4.5ZM2 7.69879C2 7.17479 2.42479 6.75 2.94879 6.75H6.05121C6.57521 6.75 7 7.17479 7 7.69879C7 8.54603 6.42338 9.28454 5.60144 9.49003L5.54243 9.50478C4.85801 9.67589 4.14199 9.67589 3.45757 9.50478L3.39856 9.49003C2.57661 9.28454 2 8.54603 2 7.69879ZM9.5 4C9.22386 4 9 4.22386 9 4.5C9 4.77614 9.22386 5 9.5 5H12.5C12.7761 5 13 4.77614 13 4.5C13 4.22386 12.7761 4 12.5 4H9.5ZM9.5 7C9.22386 7 9 7.22386 9 7.5C9 7.77614 9.22386 8 9.5 8H12.5C12.7761 8 13 7.77614 13 7.5C13 7.22386 12.7761 7 12.5 7H9.5ZM0 1.75C0 0.783502 0.783502 0 1.75 0H14.25C15.2165 0 16 0.783502 16 1.75V10.25C16 11.2165 15.2165 12 14.25 12H1.75C0.783501 12 0 11.2165 0 10.25V1.75ZM1.75 1C1.33579 1 1 1.33579 1 1.75V10.25C1 10.6642 1.33579 11 1.75 11H14.25C14.6642 11 15 10.6642 15 10.25V1.75C15 1.33579 14.6642 1 14.25 1H1.75Z" fill="#717171"/>
        </svg>
      `;case yP.Call:return AI`
        <svg width="13" height="17" viewBox="0 0 13 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path class="filled" d="M3.98706 1.06589C4.89545 0.792081 5.86254 1.19479 6.31418 2.01224L6.38841 2.16075L7.04987 3.63213C7.46246 4.54992 7.28209 5.61908 6.60754 6.3496L6.47529 6.48248L5.43194 7.45541C5.24417 7.63298 5.38512 8.32181 6.06527 9.49986C6.67716 10.5597 7.17487 11.0552 7.41986 11.0823L7.4628 11.082L7.5158 11.0716L9.56651 10.4446C10.1332 10.2713 10.7438 10.4487 11.1298 10.8865L11.2215 11.0014L12.5781 12.8815C13.1299 13.6462 13.0689 14.6842 12.4533 15.378L12.3314 15.5039L11.7886 16.018C10.7948 16.9592 9.34348 17.2346 8.07389 16.7231C6.13867 15.9433 4.38077 14.1607 2.78368 11.3945C1.18323 8.62242 0.519004 6.20438 0.815977 4.13565C0.99977 2.85539 1.87301 1.78674 3.07748 1.3462L3.27036 1.28192L3.98706 1.06589Z" fill="currentColor"/>
          <path class="regular" d="M3.9292 0.399388L3.2125 0.615419C1.90898 1.00834 0.951582 2.1215 0.758116 3.46915C0.461142 5.53787 1.12537 7.95591 2.72582 10.728C4.32291 13.4942 6.0808 15.2768 8.01603 16.0565C9.28562 16.5681 10.7369 16.2927 11.7308 15.3515L12.2736 14.8374C13.0011 14.1485 13.1065 13.0275 12.5202 12.215L11.1636 10.3349C10.788 9.81423 10.1226 9.59039 9.50865 9.7781L7.45794 10.4051L7.40494 10.4154C7.17877 10.4485 6.65754 9.95942 6.00741 8.83335C5.32726 7.65531 5.1863 6.96648 5.37408 6.7889L6.41743 5.81598C7.19937 5.08681 7.43039 3.94078 6.99201 2.96562L6.33055 1.49424C5.91866 0.578005 4.89102 0.109471 3.9292 0.399388ZM5.41847 1.90427L6.07993 3.37564C6.34277 3.96031 6.20426 4.64744 5.73543 5.08463L4.68953 6.05994C4.02044 6.69268 4.24206 7.77567 5.14138 9.33335C5.98759 10.799 6.75958 11.5233 7.58908 11.3977L7.71341 11.3711L9.80102 10.7344C10.0057 10.6718 10.2275 10.7464 10.3527 10.92L11.7093 12.8001C12.0024 13.2064 11.9497 13.7669 11.586 14.1113L11.0432 14.6254C10.3333 15.2977 9.29663 15.4944 8.38977 15.129C6.6917 14.4448 5.08689 12.8175 3.59185 10.228C2.09375 7.63319 1.48745 5.42604 1.74797 3.61125C1.88616 2.64864 2.57001 1.85352 3.5011 1.57287L4.2178 1.35684C4.69871 1.21188 5.21253 1.44615 5.41847 1.90427Z" fill="currentColor"/>
        </svg>
      `;case yP.Confirmation:return AI`
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.03212 13.9072L3.56056 10.0017C3.28538 9.69214 2.81132 9.66425 2.50174 9.93944C2.19215 10.2146 2.16426 10.6887 2.43945 10.9983L6.43945 15.4983C6.72614 15.8208 7.2252 15.8355 7.53034 15.5303L18.0303 5.03033C18.3232 4.73744 18.3232 4.26256 18.0303 3.96967C17.7374 3.67678 17.2626 3.67678 16.9697 3.96967L7.03212 13.9072Z" fill="#009E00"/>
      </svg>
      `;case yP.Copy:return AI`
        <svg width="13" height="14" viewBox="0 0 13 14" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M12.625 5.50293V14H3.875V11.375H0.375V0H6.24707L8.87207 2.625H9.74707L12.625 5.50293ZM10 5.25H11.1279L10 4.12207V5.25ZM3.875 2.625H7.62793L5.87793 0.875H1.25V10.5H3.875V2.625ZM11.75 6.125H9.125V3.5H4.75V13.125H11.75V6.125Z"
          />
        </svg>
      `;case yP.Phone:return AI`
        <svg width="15" height="15" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2048 2048" fill="none">
            <path d="M1607 1213q44 0 84 16t72 48l220 220q31 31 47 71t17 85q0 44-16 84t-48 72l-14 14q-54 54-99 96t-94 70-109 44-143 15q-125 0-257-39t-262-108-256-164-237-207-206-238-162-256T38 775 0 523q0-83 14-142t43-108 70-93 96-99l16-16q31-31 71-48t85-17q44 0 84 17t72 48l220 220q31 31 47 71t17 85q0 44-15 78t-37 63-48 51-49 45-37 44-15 49q0 38 27 65l551 551q27 27 65 27 26 0 48-15t45-37 45-48 51-49 62-37 79-15zm-83 707q72 0 120-13t88-39 76-64 85-86q27-27 27-65 0-18-14-42t-38-52-51-55-56-54-51-47-37-35q-27-27-66-27-26 0-48 15t-44 37-45 48-52 49-62 37-79 15q-44 0-84-16t-72-48L570 927q-31-31-47-71t-17-85q0-44 15-78t37-63 48-51 49-46 37-44 15-48q0-39-27-66-13-13-34-36t-47-51-54-56-56-52-51-37-43-15q-38 0-65 27l-85 85q-37 37-64 76t-40 87-14 120q0 112 36 231t101 238 153 234 192 219 219 190 234 150 236 99 226 36z" fill="${o}"></path>
        </svg>
      `;case yP.CellPhone:return AI`
        <svg width="10" height="16" viewBox="0 0 10 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 12C3.72386 12 3.5 12.2239 3.5 12.5C3.5 12.7761 3.72386 13 4 13H6C6.27614 13 6.5 12.7761 6.5 12.5C6.5 12.2239 6.27614 12 6 12H4ZM2 0C0.89543 0 0 0.895431 0 2V14C0 15.1046 0.895431 16 2 16H8C9.10457 16 10 15.1046 10 14V2C10 0.89543 9.10457 0 8 0H2ZM1 2C1 1.44772 1.44772 1 2 1H8C8.55228 1 9 1.44772 9 2V14C9 14.5523 8.55228 15 8 15H2C1.44772 15 1 14.5523 1 14V2Z" fill="#717171"/>
        </svg>
      `;case yP.Chat:return AI`
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8 1C4.13401 1 1 4.13401 1 8C1 9.21704 1.31054 10.3878 1.89352 11.4249C1.94046 11.5084 1.9621 11.603 1.95692 11.6973L1.94274 11.7912L1.187 14.812L4.21104 14.0583C4.27294 14.0429 4.33662 14.0396 4.39873 14.0479L4.4903 14.0691L4.57701 14.1075C5.61362 14.6898 6.7837 15 8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1ZM8.5 9C8.77614 9 9 9.22386 9 9.5C9 9.74546 8.82312 9.94961 8.58988 9.99194L8.5 10H5.5C5.22386 10 5 9.77614 5 9.5C5 9.25454 5.17688 9.05039 5.41012 9.00806L5.5 9H8.5ZM10.5 6C10.7761 6 11 6.22386 11 6.5C11 6.74546 10.8231 6.94961 10.5899 6.99194L10.5 7L5.5 7C5.22386 7 5 6.77614 5 6.5C5 6.25454 5.17688 6.05039 5.41012 6.00806L5.5 6L10.5 6Z" fill="#717171"/>
        </svg>
      `;case yP.Department:return AI`
        <svg width="17" height="14" viewBox="0 0 17 14" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 1.5V3H2C0.895431 3 0 3.89543 0 5V12C0 13.1046 0.895432 14 2 14H14.0026C15.1071 14 16.0026 13.1046 16.0026 12V5C16.0026 3.89543 15.1071 3 14.0026 3H12V1.5C12 0.671573 11.3284 0 10.5 0H5.5C4.67157 0 4 0.671573 4 1.5ZM5.5 1H10.5C10.7761 1 11 1.22386 11 1.5V3H5V1.5C5 1.22386 5.22386 1 5.5 1ZM2 4H14.0026C14.5549 4 15.0026 4.44772 15.0026 5V7H12L12 6.50073C12 6.22459 11.7761 6.00073 11.5 6.00073C11.2239 6.00073 11 6.22459 11 6.50074L11 7H5V6.50073C5 6.22459 4.77614 6.00073 4.5 6.00073C4.22386 6.00073 4 6.22459 4 6.50073V7H1V5C1 4.44772 1.44772 4 2 4ZM11 8L11 8.5C11 8.77615 11.2239 9 11.5 9C11.7762 9 12 8.77614 12 8.5L12 8H15.0026V12C15.0026 12.5523 14.5549 13 14.0026 13H2C1.44772 13 1 12.5523 1 12V8H4V8.5C4 8.77614 4.22386 9 4.5 9C4.77614 9 5 8.77614 5 8.5V8H11Z" fill="#717171"/>
        </svg>
      `;case yP.Email:return AI`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z" fill="#717171"/>
        </svg>
      `;case yP.OfficeLocation:return AI`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <title>Location icon</title>
          <path d="M10 7C10 8.65685 8.65685 10 7 10C5.34315 10 4 8.65685 4 7C4 5.34315 5.34315 4 7 4C8.65685 4 10 5.34315 10 7ZM9 7C9 5.89543 8.10457 5 7 5C5.89543 5 5 5.89543 5 7C5 8.10457 5.89543 9 7 9C8.10457 9 9 8.10457 9 7ZM11.9497 11.955C14.6834 9.2201 14.6834 4.78601 11.9497 2.05115C9.21608 -0.683716 4.78392 -0.683716 2.05025 2.05115C-0.683418 4.78601 -0.683418 9.2201 2.05025 11.955L3.57128 13.4538L5.61408 15.4389L5.74691 15.5567C6.52168 16.1847 7.65623 16.1455 8.38611 15.4391L10.8223 13.0691L11.9497 11.955ZM2.75499 2.75619C5.09944 0.410715 8.90055 0.410715 11.245 2.75619C13.5294 5.04153 13.5879 8.71039 11.4207 11.0667L11.245 11.2499L9.92371 12.5539L7.69315 14.7225L7.60016 14.8021C7.24594 15.0699 6.7543 15.0698 6.40012 14.802L6.30713 14.7224L3.3263 11.817L2.75499 11.2499L2.57927 11.0667C0.412077 8.71039 0.47065 5.04153 2.75499 2.75619Z" fill="#717171"/>
        </svg>
      `;case yP.Birthday:return AI`
        <svg width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.81357 0.667333C6.07581 0.320242 6.48151 0 7 0C7.51849 0 7.92419 0.320242 8.18643 0.667333C8.45471 1.0224 8.63508 1.47991 8.69561 1.93392C8.75552 2.3832 8.70532 2.89341 8.42852 3.3086C8.134 3.75039 7.63965 4 7 4C6.36035 4 5.866 3.75039 5.57148 3.3086C5.29468 2.89341 5.24448 2.3832 5.30439 1.93392C5.36492 1.47991 5.54529 1.0224 5.81357 0.667333ZM6.40353 2.7539C6.484 2.87461 6.63965 3 7 3C7.36035 3 7.516 2.87461 7.59647 2.7539C7.69468 2.60659 7.74448 2.3668 7.70439 2.06608C7.66492 1.77009 7.54529 1.4776 7.38857 1.27017C7.22581 1.05476 7.08151 1 7 1C6.91849 1 6.77419 1.05476 6.61143 1.27017C6.45471 1.4776 6.33508 1.77009 6.29561 2.06608C6.25552 2.3668 6.30532 2.60659 6.40353 2.7539ZM1 7C1 5.89543 1.89543 5 3 5H11C12.1046 5 13 5.89543 13 7V12H13.5C13.7761 12 14 12.2239 14 12.5C14 12.7761 13.7761 13 13.5 13H0.5C0.223858 13 0 12.7761 0 12.5C0 12.2239 0.223858 12 0.5 12H1V7ZM2 12H12V9.01931C11.9109 9.10285 11.8174 9.18842 11.7208 9.27412C11.4006 9.55804 11.0346 9.85319 10.6715 10.0802C10.3274 10.2953 9.90815 10.5 9.5 10.5C8.77182 10.5 8.30806 9.98986 8.00471 9.65617C7.9834 9.63273 7.96289 9.61016 7.94312 9.58869C7.5876 9.20261 7.35769 9 7 9C6.64231 9 6.4124 9.20261 6.05688 9.58869C6.03711 9.61016 6.0166 9.63273 5.99529 9.65617C5.69194 9.98986 5.22818 10.5 4.5 10.5C4.10587 10.5 3.69263 10.2897 3.35907 10.0789C3.00198 9.85313 2.63516 9.55951 2.31117 9.27666C2.20329 9.18247 2.09896 9.08844 2 8.9971V12ZM2 7.59993C2.05039 7.65198 2.11363 7.71652 2.1873 7.7902C2.38843 7.99132 2.6649 8.25801 2.96883 8.52334C3.27484 8.79049 3.59802 9.04687 3.89343 9.23362C4.21237 9.43525 4.41413 9.5 4.5 9.5C4.75817 9.5 4.93171 9.33433 5.32125 8.91131L5.32447 8.90781C5.65956 8.5439 6.16039 8 7 8C7.83961 8 8.34044 8.5439 8.67553 8.90781L8.67875 8.91131C9.06828 9.33433 9.24183 9.5 9.5 9.5C9.6106 9.5 9.82569 9.42967 10.1414 9.23229C10.4381 9.04681 10.7573 8.79196 11.0573 8.52588C11.3554 8.26163 11.6238 7.99594 11.8184 7.7955C11.89 7.72165 11.9513 7.65703 12 7.60506V7C12 6.44772 11.5523 6 11 6H3C2.44772 6 2 6.44772 2 7V7.59993Z" fill="#717171"/>
        </svg>
      `;case yP.Person:return AI`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z" fill="#717171"/>
        </svg>
      `;case yP.Messages:return AI`
        <svg width="16" height="13" viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z" fill="#717171"/>
        </svg>
      `;case yP.Organization:return AI`
        <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7.99992 0C6.34271 0 4.99927 1.34344 4.99927 3.00066C4.99927 4.48754 6.08073 5.72183 7.49999 5.95985V7.5H4.5C3.67157 7.5 3 8.17157 3 9V10.0416C1.5811 10.2799 0.5 11.514 0.5 13.0007C0.5 14.6579 1.84344 16.0013 3.50066 16.0013C5.15787 16.0013 6.50131 14.6579 6.50131 13.0007C6.50131 11.5136 5.41954 10.2791 4 10.0414V9C4 8.72386 4.22386 8.5 4.5 8.5H11.5C11.7761 8.5 12 8.72386 12 9V10.0416C10.5811 10.2799 9.5 11.514 9.5 13.0007C9.5 14.6579 10.8434 16.0013 12.5007 16.0013C14.1579 16.0013 15.5013 14.6579 15.5013 13.0007C15.5013 11.5136 14.4195 10.2791 13 10.0414V9C13 8.17157 12.3284 7.5 11.5 7.5H8.49999V5.95983C9.91918 5.72176 11.0006 4.48749 11.0006 3.00066C11.0006 1.34344 9.65714 0 7.99992 0ZM5.99927 3.00066C5.99927 1.89572 6.89499 1 7.99992 1C9.10485 1 10.0006 1.89572 10.0006 3.00066C10.0006 4.10559 9.10485 5.00131 7.99992 5.00131C6.89499 5.00131 5.99927 4.10559 5.99927 3.00066ZM1.5 13.0007C1.5 11.8957 2.39572 11 3.50066 11C4.60559 11 5.50131 11.8957 5.50131 13.0007C5.50131 14.1056 4.60559 15.0013 3.50066 15.0013C2.39572 15.0013 1.5 14.1056 1.5 13.0007ZM12.5007 11C13.6056 11 14.5013 11.8957 14.5013 13.0007C14.5013 14.1056 13.6056 15.0013 12.5007 15.0013C11.3957 15.0013 10.5 14.1056 10.5 13.0007C10.5 11.8957 11.3957 11 12.5007 11Z" fill="#717171"/>
        </svg>
      `;case yP.ExpandRight:return AI`
        <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M1 12L6.5 6.5L1 1" stroke="#B8B8B8" stroke-width="2" />
        </svg>
      `;case yP.Profile:return AI`
        <svg width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z" fill="#717171"/>
        </svg>
      `;case yP.File:return AI`
        <svg width="28" height="28" viewBox="0 0 20 28" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            opacity="0.64"
            d="M19.613 6.993L13.018 0.421C12.7473 0.15221 12.3815 0.000947397 12 0H1.4C0.628 0 0 0.615 0 1.372V24.642C0 25.391 0.622 26 1.386 26H18.6C19.372 26 20 25.385 20 24.628V7.923C20 7.577 19.86 7.237 19.613 6.993Z"
            fill="#605E5C"
          />
          <path
            d="M19 24.628C19 24.83 18.816 25 18.6 25H1.386C1.173 25 1 24.84 1 24.642V1.372C1 1.17 1.184 1 1.4 1H12V6.6C12 7.372 12.628 8 13.4 8H19V24.628Z"
            fill="white"
          />
          <path d="M18.204 6.99994L13 1.81494V6.59994C13 6.81994 13.18 6.99994 13.4 6.99994H18.204Z" fill="white" />
        </svg>
      `;case yP.Files:return AI`
        <svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M14.9956 4.07309V4C14.9956 2.61929 13.8763 1.5 12.4956 1.5H7.66418L6.06391 0.299946C5.80428 0.105247 5.48851 0 5.16399 0H2.5C1.11916 0 -0.000181445 1.11949 2.20615e-08 2.50033L0.0011832 11.4978C0.00135142 12.7772 0.962583 13.8321 2.2023 13.9798C2.2867 13.9945 2.37375 14.0021 2.46289 14.0021H13.1798C13.8981 14.0021 14.5156 13.4929 14.6524 12.7877L16.0097 5.78769C16.1587 5.01967 15.696 4.29703 14.9956 4.07309ZM2.5 1H5.16399C5.27216 1 5.37742 1.03508 5.46396 1.09998L7.19756 2.40002C7.2841 2.46492 7.38936 2.5 7.49753 2.5H12.4956C13.324 2.5 13.9956 3.17157 13.9956 4V4.00214H3.824C3.10596 4.00214 2.48863 4.511 2.35158 5.21583L1.05351 11.8916C1.01941 11.7661 1.0012 11.634 1.00118 11.4976L1 2.5002C0.999891 1.67169 1.6715 1 2.5 1ZM3.33319 5.4067C3.37888 5.17176 3.58465 5.00214 3.824 5.00214H14.5372C14.8515 5.00214 15.0879 5.28874 15.028 5.59732L13.6706 12.5973C13.6251 12.8324 13.4192 13.0021 13.1798 13.0021H2.46289C2.14845 13.0021 1.91206 12.7154 1.97208 12.4067L3.33319 5.4067Z" fill="#717171"/>
        </svg>
      `;case yP.Back:return AI`
        <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M16 8.5H1.95312L8.10156 14.6484L7.39844 15.3516L0.046875 8L7.39844 0.648438L8.10156 1.35156L1.95312 7.5H16V8.5Z"
          />
        </svg>
      `;case yP.Close:return AI`
        <svg width="10" height="10" viewBox="0 0 10 10" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.73838 5.032L9.70337 1.067L8.99638 0.360001L5.03137 4.325L1.06637 0.360001L0.359375 1.067L4.32438 5.032L0.359375 8.997L1.06637 9.704L5.03137 5.739L8.99638 9.704L9.70337 8.997L5.73838 5.032Z" fill="currentColor"/>
        </svg>
     `;case yP.Upload:return AI`
        <svg class="upload-icon" width="21" height="12" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4.5 2C4.08579 2 3.75 2.33579 3.75 2.75C3.75 3.16421 4.08579 3.5 4.5 3.5H15C15.4142 3.5 15.75 3.16421 15.75 2.75C15.75 2.33579 15.4142 2 15 2H4.5ZM10.4963 17.3493C10.4466 17.7154 10.1328 17.9976 9.75311 17.9976C9.3389 17.9976 9.00311 17.6618 9.00311 17.2476L9.00249 7.05856L6.02995 10.026L5.94578 10.0986C5.65202 10.3162 5.23537 10.2917 4.96929 10.0253C4.67661 9.73215 4.67695 9.25728 4.97005 8.96459L9.25962 4.67989C9.33377 4.61512 9.42089 4.56485 9.5169 4.53385L9.59777 4.51072C9.64749 4.50019 9.69837 4.4947 9.74849 4.4947L9.80855 4.49661L9.87781 4.50451L9.99828 4.53462L10.0895 4.57254L10.1259 4.59371L10.2169 4.6523L10.2875 4.71481L14.5303 8.96546L14.6029 9.04964C14.8205 9.34345 14.7959 9.7601 14.5294 10.0261L14.4452 10.0987C14.1514 10.3162 13.7347 10.2917 13.4687 10.0251L10.5025 7.05456L10.5031 17.2476L10.4963 17.3493Z" fill="#ffffff"/>
        </svg>
      `;case yP.FileCloud:return AI`
        <svg width="16" height="16"  xmlns="http://www.w3.org/2000/svg">
          <path
            d="m8,0c2.8166,0 4.4145,1.9233 4.6469,4.246l0.071,0c1.8127,0 3.2821,1.5119 3.2821,3.377c0,0.0953 -0.0038,0.1897 -0.0114,0.283c-0.322,-0.4017 -0.6967,-0.7591 -1.1138,-1.062c-0.3104,-0.9329 -1.1627,-1.598 -2.1568,-1.598l-0.0711,0c-0.5137,0 -0.9439,-0.3893 -0.9951,-0.9005c-0.2021,-2.0206 -1.5433,-3.3455 -3.6518,-3.3455c-2.1139,0 -3.4489,1.3159 -3.6518,3.3455c-0.0511,0.5112 -0.4813,0.9005 -0.9951,0.9005l-0.071,0c-1.2539,0 -2.2821,1.0579 -2.2821,2.377c0,1.3191 1.0282,2.377 2.2821,2.377l2.6655,0c-0.087,0.323 -0.1466,0.6572 -0.1762,1l-2.4893,0c-1.8127,0 -3.2821,-1.5119 -3.2821,-3.377c0,-1.8029 1.3731,-3.2758 3.102,-3.372l0.2511,-0.005c0.2338,-2.338 1.8303,-4.246 4.6469,-4.246zm3.5,16c2.4853,0 4.5,-2.0147 4.5,-4.5c0,-2.4853 -2.0147,-4.5 -4.5,-4.5c-2.4853,0 -4.5,2.0147 -4.5,4.5c0,2.4853 2.0147,4.5 4.5,4.5zm0,-7c0.2761,0 0.5,0.2239 0.5,0.5l0,1.5l1.5,0c0.2761,0 0.5,0.2239 0.5,0.5c0,0.2761 -0.2239,0.5 -0.5,0.5l-1.5,0l0,1.5c0,0.2761 -0.2239,0.5 -0.5,0.5c-0.2761,0 -0.5,-0.2239 -0.5,-0.5l0,-1.5l-1.5,0c-0.2761,0 -0.5,-0.2239 -0.5,-0.5c0,-0.2761 0.2239,-0.5 0.5,-0.5l1.5,0l0,-1.5c0,-0.2761 0.2239,-0.5 0.5,-0.5z" fill="#0078D4"
          />
        </svg>
      `;case yP.DragFile:return AI`
        <svg width="13" height="16" xmlns="http://www.w3.org/2000/svg">
          <path
            d="m0,1.00189c0,-0.8451 0.983,-1.3091 1.636,-0.772l11.006,9.0622c0.724,0.5964 0.302,1.772 -0.636,1.772l-5.592,0c-0.435,0 -0.849,0.1892 -1.134,0.5185l-3.524,4.0725c-0.606,0.7003 -1.756,0.2717 -1.756,-0.6544l0,-13.9988zm12.006,9.0622l-11.006,-9.0622l0,13.9988l3.524,-4.0724c0.475,-0.5488 1.164,-0.8642 1.89,-0.8642l5.592,0z"
          />
        </svg>
      `;case yP.Cancel:return AI`
        <svg width="11" height="11" viewBox="0 0 11 11" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.588591 0.715694L0.646447 0.646447C0.820013 0.47288 1.08944 0.453595 1.28431 0.588591L1.35355 0.646447L6 5.293L10.6464 0.646447C10.8417 0.451185 11.1583 0.451185 11.3536 0.646447C11.5488 0.841709 11.5488 1.15829 11.3536 1.35355L6.707 6L11.3536 10.6464C11.5271 10.82 11.5464 11.0894 11.4114 11.2843L11.3536 11.3536C11.18 11.5271 10.9106 11.5464 10.7157 11.4114L10.6464 11.3536L6 6.707L1.35355 11.3536C1.15829 11.5488 0.841709 11.5488 0.646447 11.3536C0.451185 11.1583 0.451185 10.8417 0.646447 10.6464L5.293 6L0.646447 1.35355C0.47288 1.17999 0.453595 0.910563 0.588591 0.715694L0.646447 0.646447L0.588591 0.715694Z" fill="currentColor"/>
        </svg>
     `;case yP.Success:return AI`
        <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
          <path fill="#009E00" d="m6.322,12c3.492,0 6.323,-2.6863 6.323,-6c0,-3.3137 -2.831,-6 -6.323,-6c-3.491,0 -6.322,2.6863 -6.322,6c0,3.3137 2.831,6 6.322,6z"/>
          <path fill="white" d="m9.629,3.7509c-0.131,-0.125 -0.31,-0.1952 -0.496,-0.1952c-0.187,0 -0.365,0.0702 -0.497,0.1952l-3.267,3.1l-1.393,-1.3222c-0.177,-0.1695 -0.436,-0.2361 -0.68,-0.1746c-0.243,0.0615 -0.433,0.2418 -0.497,0.4725c-0.065,0.2307 0.005,0.4767 0.184,0.6449l1.807,1.7154c0.019,0.0331 0.041,0.0646 0.066,0.094c0.289,0.2562 0.738,0.2562 1.027,0c0.024,-0.0294 0.047,-0.0609 0.065,-0.0941l3.681,-3.4931c0.275,-0.2603 0.275,-0.6824 0,-0.9428z"/>
        </svg>
      `;case yP.CheckMark:return AI`
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path class="filled" d="M10 0C15.5228 0 20 4.47715 20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10C0 4.47715 4.47715 0 10 0ZM13.2197 6.96967L8.75 11.4393L6.78033 9.46967C6.48744 9.17678 6.01256 9.17678 5.71967 9.46967C5.42678 9.76256 5.42678 10.2374 5.71967 10.5303L8.21967 13.0303C8.51256 13.3232 8.98744 13.3232 9.28033 13.0303L14.2803 8.03033C14.5732 7.73744 14.5732 7.26256 14.2803 6.96967C13.9874 6.67678 13.5126 6.67678 13.2197 6.96967Z" fill="currentColor"/>
        <path class="regular" d="M10 1.5C5.30558 1.5 1.5 5.30558 1.5 10C1.5 14.6944 5.30558 18.5 10 18.5C14.6944 18.5 18.5 14.6944 18.5 10C18.5 5.30558 14.6944 1.5 10 1.5ZM0 10C0 4.47715 4.47715 0 10 0C15.5228 0 20 4.47715 20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10Z" fill="currentColor"/>
      </svg>
      `;case yP.Fail:return AI`
        <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">
          <path fill="#EF355D" d="m6,12c3.314,0 6,-2.6863 6,-6c0,-3.3137 -2.686,-6 -6,-6c-3.314,0 -6,2.6863 -6,6c0,3.3137 2.686,6 6,6z"/>
          <path fill="white" d="m6.943,6.0004l1.544,-1.5444c0.169,-0.1683 0.236,-0.4142 0.174,-0.6448c-0.061,-0.2306 -0.241,-0.4107 -0.472,-0.4722c-0.231,-0.0616 -0.477,0.0049 -0.645,0.1742l-1.544,1.5443l-1.545,-1.5443c-0.26,-0.259 -0.681,-0.2583 -0.941,0.0014c-0.26,0.2598 -0.26,0.6808 -0.001,0.9414l1.544,1.5444l-1.544,1.5444c-0.259,0.2606 -0.259,0.6815 0.001,0.9413c0.26,0.2598 0.681,0.2604 0.941,0.0015l1.545,-1.5444l1.544,1.5444c0.261,0.2589 0.682,0.2583 0.942,-0.0015c0.259,-0.2598 0.26,-0.6807 0.001,-0.9413l-1.544,-1.5444z" />
        </svg>
      `;case yP.SelectAccount:return AI`
    <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 17 17" fill="none">
      <path fill=${o} d="M6.22176 13.9567C3.55468 13.653 2 11.8026 2 10V9.5C2 8.67157 2.67157 8 3.5 8H5.59971C5.43777 8.31679 5.30564 8.65136 5.20703 9H3.5C3.22386 9 3 9.22386 3 9.5V10C3 11.1281 3.88187 12.333 5.50235 12.7996C5.69426 13.216 5.93668 13.6043 6.22176 13.9567ZM9.62596 5.06907C9.70657 4.81036 9.75 4.53525 9.75 4.25C9.75 2.73122 8.51878 1.5 7 1.5C5.48122 1.5 4.25 2.73122 4.25 4.25C4.25 5.53662 5.13357 6.61687 6.32704 6.91706C6.64202 6.55055 7.00446 6.226 7.40482 5.95294C7.27488 5.98371 7.13934 6 7 6C6.0335 6 5.25 5.2165 5.25 4.25C5.25 3.2835 6.0335 2.5 7 2.5C7.9665 2.5 8.75 3.2835 8.75 4.25C8.75 4.73141 8.55561 5.16743 8.24104 5.48382C8.67558 5.28783 9.14016 5.14664 9.62596 5.06907ZM10.5 15C12.9853 15 15 12.9853 15 10.5C15 8.01472 12.9853 6 10.5 6C8.01472 6 6 8.01472 6 10.5C6 12.9853 8.01472 15 10.5 15ZM10.5 8C10.7761 8 11 8.22386 11 8.5V10H12.5C12.7761 10 13 10.2239 13 10.5C13 10.7761 12.7761 11 12.5 11H11V12.5C11 12.7761 10.7761 13 10.5 13C10.2239 13 10 12.7761 10 12.5V11H8.5C8.22386 11 8 10.7761 8 10.5C8 10.2239 8.22386 10 8.5 10H10V8.5C10 8.22386 10.2239 8 10.5 8Z"/>
    </svg>
  `;case yP.News:return AI`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
        <path d="M18.75 20H5.25C3.51697 20 2.10075 18.6435 2.00514 16.9344L2 16.75V6.25C2 5.05914 2.92516 4.08436 4.09595 4.00519L4.25 4H16.75C17.9409 4 18.9156 4.92516 18.9948 6.09595L19 6.25V7H19.75C20.9409 7 21.9156 7.92516 21.9948 9.09595L22 9.25V16.75C22 18.483 20.6435 19.8992 18.9344 19.9949L18.75 20H5.25H18.75ZM5.25 18.5H18.75C19.6682 18.5 20.4212 17.7929 20.4942 16.8935L20.5 16.75V9.25C20.5 8.8703 20.2178 8.55651 19.8518 8.50685L19.75 8.5H19V16.25C19 16.6297 18.7178 16.9435 18.3518 16.9932L18.25 17C17.8703 17 17.5565 16.7178 17.5068 16.3518L17.5 16.25V6.25C17.5 5.8703 17.2178 5.55651 16.8518 5.50685L16.75 5.5H4.25C3.8703 5.5 3.55651 5.78215 3.50685 6.14823L3.5 6.25V16.75C3.5 17.6682 4.20711 18.4212 5.10647 18.4942L5.25 18.5H18.75H5.25ZM12.246 14.5H15.2522C15.6665 14.5 16.0022 14.8358 16.0022 15.25C16.0022 15.6297 15.7201 15.9435 15.354 15.9932L15.2522 16H12.246C11.8318 16 11.496 15.6642 11.496 15.25C11.496 14.8703 11.7782 14.5565 12.1442 14.5068L12.246 14.5H15.2522H12.246ZM9.24328 11.0045C9.6575 11.0045 9.99328 11.3403 9.99328 11.7545V15.25C9.99328 15.6642 9.6575 16 9.24328 16H5.74776C5.33355 16 4.99776 15.6642 4.99776 15.25V11.7545C4.99776 11.3403 5.33355 11.0045 5.74776 11.0045H9.24328ZM8.49328 12.5045H6.49776V14.5H8.49328V12.5045ZM12.246 11.0045H15.2522C15.6665 11.0045 16.0022 11.3403 16.0022 11.7545C16.0022 12.1342 15.7201 12.448 15.354 12.4976L15.2522 12.5045H12.246C11.8318 12.5045 11.496 12.1687 11.496 11.7545C11.496 11.3748 11.7782 11.061 12.1442 11.0113L12.246 11.0045H15.2522H12.246ZM5.74776 7.50247H15.2522C15.6665 7.50247 16.0022 7.83826 16.0022 8.25247C16.0022 8.63217 15.7201 8.94596 15.354 8.99563L15.2522 9.00247H5.74776C5.33355 9.00247 4.99776 8.66669 4.99776 8.25247C4.99776 7.87278 5.27991 7.55898 5.64599 7.50932L5.74776 7.50247H15.2522H5.74776Z" fill="none" />
      </svg>
      `;case yP.DoubleBookmark:return AI`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 6.74814C4 5.50535 5.00742 4.49786 6.25013 4.49786H15.2506C16.4933 4.49786 17.5008 5.50535 17.5008 6.74814V21.2499C17.5008 21.5185 17.3572 21.7666 17.1243 21.9003C16.8914 22.0341 16.6048 22.0332 16.3728 21.8978L10.7504 18.6179L5.12797 21.8978C4.89599 22.0332 4.60936 22.0341 4.37648 21.9003C4.14359 21.7666 4 21.5185 4 21.2499V6.74814ZM6.25013 5.99805C5.83589 5.99805 5.50008 6.33387 5.50008 6.74814V19.944L10.3725 17.1016C10.606 16.9653 10.8948 16.9653 11.1283 17.1016L16.0007 19.944V6.74814C16.0007 6.33387 15.6649 5.99805 15.2506 5.99805H6.25013ZM15.2497 2C17.8732 2 20 4.12691 20 6.75058V18.6232C20 19.0374 19.6642 19.3733 19.25 19.3733C18.8357 19.3733 18.4999 19.0374 18.4999 18.6232V6.75058C18.4999 4.95543 17.0448 3.50018 15.2497 3.50018H6.63687C6.63687 3.50018 6.75016 2.94339 7.43379 2.41948C8.00023 2 8.60182 2 8.60182 2H15.2497Z" fill="none" />
        </svg>
      `;case yP.ChevronLeft:return AI`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M15.5303 4.21967C15.8232 4.51256 15.8232 4.98744 15.5303 5.28033L8.81066 12L15.5303 18.7197C15.8232 19.0126 15.8232 19.4874 15.5303 19.7803C15.2374 20.0732 14.7626 20.0732 14.4697 19.7803L7.21967 12.5303C6.92678 12.2374 6.92678 11.7626 7.21967 11.4697L14.4697 4.21967C14.7626 3.92678 15.2374 3.92678 15.5303 4.21967Z" fill="none" />
        </svg>`;case yP.ChevronRight:return AI`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.46967 4.21967C8.17678 4.51256 8.17678 4.98744 8.46967 5.28033L15.1893 12L8.46967 18.7197C8.17678 19.0126 8.17678 19.4874 8.46967 19.7803C8.76256 20.0732 9.23744 20.0732 9.53033 19.7803L16.7803 12.5303C17.0732 12.2374 17.0732 11.7626 16.7803 11.4697L9.53033 4.21967C9.23744 3.92678 8.76256 3.92678 8.46967 4.21967Z" fill="currentColor" />
        </svg>`;case yP.Delete:return AI`
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.5 4H11.5C11.5 3.17157 10.8284 2.5 10 2.5C9.17157 2.5 8.5 3.17157 8.5 4ZM7.5 4C7.5 2.61929 8.61929 1.5 10 1.5C11.3807 1.5 12.5 2.61929 12.5 4H17.5C17.7761 4 18 4.22386 18 4.5C18 4.77614 17.7761 5 17.5 5H16.4456L15.2521 15.3439C15.0774 16.8576 13.7957 18 12.2719 18H7.72813C6.20431 18 4.92256 16.8576 4.7479 15.3439L3.55437 5H2.5C2.22386 5 2 4.77614 2 4.5C2 4.22386 2.22386 4 2.5 4H7.5ZM5.74131 15.2292C5.85775 16.2384 6.71225 17 7.72813 17H12.2719C13.2878 17 14.1422 16.2384 14.2587 15.2292L15.439 5H4.56101L5.74131 15.2292ZM8.5 7.5C8.77614 7.5 9 7.72386 9 8V14C9 14.2761 8.77614 14.5 8.5 14.5C8.22386 14.5 8 14.2761 8 14V8C8 7.72386 8.22386 7.5 8.5 7.5ZM12 8C12 7.72386 11.7761 7.5 11.5 7.5C11.2239 7.5 11 7.72386 11 8V14C11 14.2761 11.2239 14.5 11.5 14.5C11.7761 14.5 12 14.2761 12 14V8Z" fill="currentColor"/>
        </svg>
    `;case yP.Add:return AI`
        <svg width="16" height="15" viewBox="0 0 16 15" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M8.39563 0.5C8.39563 0.223858 8.17177 0 7.89563 0C7.61949 0 7.39563 0.223858 7.39563 0.5V7H0.89563C0.619487 7 0.39563 7.22386 0.39563 7.5C0.39563 7.77614 0.619487 8 0.89563 8H7.39563V14.5C7.39563 14.7761 7.61949 15 7.89563 15C8.17177 15 8.39563 14.7761 8.39563 14.5V8H14.8956C15.1718 8 15.3956 7.77614 15.3956 7.5C15.3956 7.22386 15.1718 7 14.8956 7H8.39563V0.5Z" fill="${o}"/>
        </svg>`;case yP.Calendar:return AI`
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 11C7.55228 11 8 10.5523 8 10C8 9.44771 7.55228 9 7 9C6.44772 9 6 9.44771 6 10C6 10.5523 6.44772 11 7 11ZM8 13C8 13.5523 7.55228 14 7 14C6.44772 14 6 13.5523 6 13C6 12.4477 6.44772 12 7 12C7.55228 12 8 12.4477 8 13ZM10 11C10.5523 11 11 10.5523 11 10C11 9.44771 10.5523 9 10 9C9.44771 9 9 9.44771 9 10C9 10.5523 9.44771 11 10 11ZM11 13C11 13.5523 10.5523 14 10 14C9.44771 14 9 13.5523 9 13C9 12.4477 9.44771 12 10 12C10.5523 12 11 12.4477 11 13ZM13 11C13.5523 11 14 10.5523 14 10C14 9.44771 13.5523 9 13 9C12.4477 9 12 9.44771 12 10C12 10.5523 12.4477 11 13 11ZM17 5.5C17 4.11929 15.8807 3 14.5 3H5.5C4.11929 3 3 4.11929 3 5.5V14.5C3 15.8807 4.11929 17 5.5 17H14.5C15.8807 17 17 15.8807 17 14.5V5.5ZM4 7H16V14.5C16 15.3284 15.3284 16 14.5 16H5.5C4.67157 16 4 15.3284 4 14.5V7ZM5.5 4H14.5C15.3284 4 16 4.67157 16 5.5V6H4V5.5C4 4.67157 4.67157 4 5.5 4Z" fill=${o}/>
        </svg>
    `;case yP.Planner:return AI`
        <svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M17.75 3A3.25 3.25 0 0 1 21 6.25v11.5A3.25 3.25 0 0 1 17.75 21H6.25A3.25 3.25 0 0 1 3 17.75V6.25A3.25 3.25 0 0 1 6.25 3h11.5Zm1.75 5.5h-15v9.25c0 .966.784 1.75 1.75 1.75h11.5a1.75 1.75 0 0 0 1.75-1.75V8.5Zm-11.75 6a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm-4.25-4a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm1.5-6H6.25A1.75 1.75 0 0 0 4.5 6.25V7h15v-.75a1.75 1.75 0 0 0-1.75-1.75Z" fill="${o}"/>
        </svg>`;case yP.Milestone:return AI`
        <svg width="24" height="24" fill="${o}" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M15.25 13c.966 0 1.75.784 1.75 1.75v4.5A1.75 1.75 0 0 1 15.25 21H3.75A1.75 1.75 0 0 1 2 19.25v-4.5c0-.966.783-1.75 1.75-1.75h11.5ZM21 14.899v5.351a.75.75 0 0 1-1.494.102l-.006-.102v-5.338a3.006 3.006 0 0 0 1.5-.013Zm-5.75-.399H3.75a.25.25 0 0 0-.25.25v4.5c0 .138.111.25.25.25h11.5a.25.25 0 0 0 .25-.25v-4.5a.25.25 0 0 0-.25-.25Zm5-4.408a1.908 1.908 0 1 1 0 3.816 1.908 1.908 0 0 1 0-3.816ZM15.244 3c.967 0 1.75.784 1.75 1.75v4.5a1.75 1.75 0 0 1-1.75 1.75h-11.5a1.75 1.75 0 0 1-1.75-1.75v-4.5a1.75 1.75 0 0 1 1.607-1.744L3.745 3h11.5Zm0 1.5h-11.5l-.057.007a.25.25 0 0 0-.193.243v4.5c0 .138.112.25.25.25h11.5a.25.25 0 0 0 .25-.25v-4.5a.25.25 0 0 0-.25-.25ZM20.25 3a.75.75 0 0 1 .743.648L21 3.75v5.351a3.004 3.004 0 0 0-1.5-.013V3.75a.75.75 0 0 1 .75-.75Z" fill="${o}"/>
        </svg>`;case yP.PersonAdd:return AI`
        <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="svg" fill="currentColor">
          <path d="M9 2a4 4 0 100 8 4 4 0 000-8zM6 6a3 3 0 116 0 3 3 0 01-6 0z"></path>
          <path d="M4 11a2 2 0 00-2 2c0 1.7.83 2.97 2.13 3.8A9.14 9.14 0 009 18c.41 0 .82-.02 1.21-.06A5.5 5.5 0 019.6 17 12 12 0 019 17a8.16 8.16 0 01-4.33-1.05A3.36 3.36 0 013 13a1 1 0 011-1h5.6c.18-.36.4-.7.66-1H4z"></path>
          <path d="M14.5 19a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-7c.28 0 .5.22.5.5V14h1.5a.5.5 0 010 1H15v1.5a.5.5 0 01-1 0V15h-1.5a.5.5 0 010-1H14v-1.5c0-.28.22-.5.5-.5z"></path>
        </svg>`;case yP.Event:return AI`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M17.75 3C19.5449 3 21 4.45507 21 6.25V17.75C21 19.5449 19.5449 21 17.75 21H6.25C4.45507 21 3 19.5449 3 17.75V6.25C3 4.45507 4.45507 3 6.25 3H17.75ZM19.5 8.5H4.5V17.75C4.5 18.7165 5.2835 19.5 6.25 19.5H17.75C18.7165 19.5 19.5 18.7165 19.5 17.75V8.5ZM7.75 14.5C8.44036 14.5 9 15.0596 9 15.75C9 16.4404 8.44036 17 7.75 17C7.05964 17 6.5 16.4404 6.5 15.75C6.5 15.0596 7.05964 14.5 7.75 14.5ZM12 14.5C12.6904 14.5 13.25 15.0596 13.25 15.75C13.25 16.4404 12.6904 17 12 17C11.3096 17 10.75 16.4404 10.75 15.75C10.75 15.0596 11.3096 14.5 12 14.5ZM7.75 10.5C8.44036 10.5 9 11.0596 9 11.75C9 12.4404 8.44036 13 7.75 13C7.05964 13 6.5 12.4404 6.5 11.75C6.5 11.0596 7.05964 10.5 7.75 10.5ZM12 10.5C12.6904 10.5 13.25 11.0596 13.25 11.75C13.25 12.4404 12.6904 13 12 13C11.3096 13 10.75 12.4404 10.75 11.75C10.75 11.0596 11.3096 10.5 12 10.5ZM16.25 10.5C16.9404 10.5 17.5 11.0596 17.5 11.75C17.5 12.4404 16.9404 13 16.25 13C15.5596 13 15 12.4404 15 11.75C15 11.0596 15.5596 10.5 16.25 10.5ZM17.75 4.5H6.25C5.2835 4.5 4.5 5.2835 4.5 6.25V7H19.5V6.25C19.5 5.2835 18.7165 4.5 17.75 4.5Z" fill="none" />
        </svg>
      `;case yP.BookOpen:return AI`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 19.1375C11.4986 19.6686 10.788 20 10 20H3.75C2.7835 20 2 19.2165 2 18.25V5.75C2 4.7835 2.7835 4 3.75 4H10C10.788 4 11.4986 4.33145 12 4.86253C12.5014 4.33145 13.212 4 14 4H20.25C21.2165 4 22 4.7835 22 5.75V18.25C22 19.2165 21.2165 20 20.25 20H14C13.212 20 12.5014 19.6686 12 19.1375ZM3.5 5.75V18.25C3.5 18.3881 3.61193 18.5 3.75 18.5H10C10.6904 18.5 11.25 17.9404 11.25 17.25V6.75C11.25 6.05964 10.6904 5.5 10 5.5H3.75C3.61193 5.5 3.5 5.61193 3.5 5.75ZM12.75 17.25C12.75 17.9404 13.3096 18.5 14 18.5H20.25C20.3881 18.5 20.5 18.3881 20.5 18.25V5.75C20.5 5.61193 20.3881 5.5 20.25 5.5H14C13.3096 5.5 12.75 6.05964 12.75 6.75V17.25Z" fill="none" />
        </svg>
      `;case yP.FileOuter:return AI`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 2C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V9.82777C20 9.29733 19.7893 8.78863 19.4142 8.41355L13.5864 2.58579C13.2114 2.21071 12.7027 2 12.1722 2H6ZM5.5 4C5.5 3.72386 5.72386 3.5 6 3.5H12V8C12 9.10457 12.8954 10 14 10H18.5V20C18.5 20.2761 18.2761 20.5 18 20.5H6C5.72386 20.5 5.5 20.2761 5.5 20V4ZM17.3793 8.5H14C13.7239 8.5 13.5 8.27614 13.5 8V4.62066L17.3793 8.5Z" fill="none" />
        </svg>
      `;case yP.BookQuestion:return AI`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M10.9998 8.01752C10.9905 8.42363 10.6584 8.74999 10.25 8.74999C9.5 8.74999 9.5 7.9989 9.5 7.9989L9.5 7.99777L9.50001 7.99539L9.50006 7.99017C9.50032 7.9755 9.50072 7.96084 9.50144 7.94618C9.50262 7.92198 9.50473 7.89159 9.50846 7.8559C9.51591 7.78477 9.52996 7.69092 9.55665 7.58186C9.60973 7.36492 9.71565 7.07652 9.92848 6.78906C10.3825 6.17582 11.1982 5.72727 12.513 5.7501C13.4627 5.76659 14.3059 6.16497 14.834 6.82047C15.371 7.48704 15.5517 8.3902 15.1964 9.27853C14.8342 10.1839 14.0149 10.5437 13.5442 10.7503L13.4932 10.7728C13.2147 10.8957 13.0813 10.9599 13.0013 11.024L13 11.0251L13 11.7492C13.0001 12.1634 12.6643 12.4999 12.2501 12.5C11.8359 12.5 11.5001 12.1643 11.5 11.7501L11.5 11C11.5 10.4769 11.752 10.1029 12.0633 9.85345C12.3134 9.65303 12.6276 9.51483 12.8491 9.4174L12.8875 9.40049C13.4292 9.16137 13.6868 9.01346 13.8036 8.72145C13.9483 8.35977 13.8789 8.02596 13.6659 7.76153C13.4439 7.48604 13.0371 7.25943 12.487 7.24988C11.5518 7.23364 11.2425 7.53509 11.134 7.68162C11.0656 7.77404 11.0309 7.86797 11.0137 7.93838C11.0052 7.973 11.0017 7.99908 11.0003 8.01197L10.9998 8.01752ZM12.25 15.5C12.8023 15.5 13.25 15.0523 13.25 14.5C13.25 13.9477 12.8023 13.5 12.25 13.5C11.6977 13.5 11.25 13.9477 11.25 14.5C11.25 15.0523 11.6977 15.5 12.25 15.5ZM4 4.5C4 3.11929 5.11929 2 6.5 2H18C19.3807 2 20.5 3.11929 20.5 4.5V18.75C20.5 19.1642 20.1642 19.5 19.75 19.5H5.5C5.5 20.0523 5.94772 20.5 6.5 20.5H19.75C20.1642 20.5 20.5 20.8358 20.5 21.25C20.5 21.6642 20.1642 22 19.75 22H6.5C5.11929 22 4 20.8807 4 19.5V4.5ZM5.5 4.5V18H19V4.5C19 3.94772 18.5523 3.5 18 3.5H6.5C5.94772 3.5 5.5 3.94772 5.5 4.5Z" fill="none" />
        </svg>
      `;case yP.Globe:return AI`
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
          <path d="M12.0001 1.99805C17.5238 1.99805 22.0016 6.47589 22.0016 11.9996C22.0016 17.5233 17.5238 22.0011 12.0001 22.0011C6.47638 22.0011 1.99854 17.5233 1.99854 11.9996C1.99854 6.47589 6.47638 1.99805 12.0001 1.99805ZM14.939 16.4993H9.06118C9.71322 18.9135 10.8466 20.5011 12.0001 20.5011C13.1536 20.5011 14.2869 18.9135 14.939 16.4993ZM7.5084 16.4999L4.78591 16.4998C5.74425 18.0328 7.1777 19.2384 8.88008 19.9104C8.3578 19.0906 7.92681 18.0643 7.60981 16.8949L7.5084 16.4999ZM19.2143 16.4998L16.4918 16.4999C16.168 17.8337 15.7004 18.9995 15.119 19.9104C16.716 19.2804 18.0757 18.1814 19.0291 16.7833L19.2143 16.4998ZM7.09351 9.99895H3.7359L3.73115 10.0162C3.57906 10.6525 3.49854 11.3166 3.49854 11.9996C3.49854 13.0558 3.69112 14.0669 4.0431 14.9999L7.21626 14.9995C7.07396 14.0504 6.99854 13.0422 6.99854 11.9996C6.99854 11.3156 7.031 10.6464 7.09351 9.99895ZM15.397 9.99901H8.60316C8.53514 10.6393 8.49853 11.309 8.49853 11.9996C8.49853 13.0591 8.58468 14.0694 8.73827 14.9997H15.2619C15.4155 14.0694 15.5016 13.0591 15.5016 11.9996C15.5016 11.309 15.465 10.6393 15.397 9.99901ZM20.2647 9.99811L16.9067 9.99897C16.9692 10.6464 17.0016 11.3156 17.0016 11.9996C17.0016 13.0422 16.9262 14.0504 16.7839 14.9995L19.9571 14.9999C20.309 14.0669 20.5016 13.0558 20.5016 11.9996C20.5016 11.3102 20.4196 10.64 20.2647 9.99811ZM8.88114 4.08875L8.85823 4.09747C6.81092 4.91218 5.1549 6.49949 4.25023 8.49935L7.29835 8.49972C7.61171 6.74693 8.15855 5.221 8.88114 4.08875ZM12.0001 3.49805L11.8844 3.50335C10.619 3.6191 9.39651 5.62107 8.8288 8.4993H15.1714C14.6052 5.62914 13.388 3.63033 12.1264 3.50436L12.0001 3.49805ZM15.1201 4.08881L15.2269 4.2629C15.8961 5.37537 16.4043 6.83525 16.7018 8.49972L19.7499 8.49935C18.8853 6.58795 17.3343 5.05341 15.4113 4.21008L15.1201 4.08881Z" />
        </svg>
      `;case yP.PresenceAvailable:return AI`
        <svg fill="#13a10e" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10Zm2.1-5.9L4.85 6.35a.5.5 0 0 1-.7 0l-1-1a.5.5 0 0 1 .7-.7l.65.64 1.9-1.9a.5.5 0 0 1 .7.71Z" fill="#13a10e"></path>
        </svg>`;case yP.PresenceOofAvailable:return AI`
        <svg fill="#13a10e" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Zm6.1-1.6c.2.2.2.5 0 .7L4.85 6.35a.5.5 0 0 1-.7 0l-1-1a.5.5 0 1 1 .7-.7l.65.64 1.9-1.9c.2-.19.5-.19.7 0Z" fill="#13a10e"></path>
        </svg>`;case yP.PresenceBusy:return AI`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M10 5A5 5 0 1 1 0 5a5 5 0 0 1 10 0Z" fill="#d13438"></path>
        </svg>`;case yP.PresenceOofBusy:return AI`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 1a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Z" fill="#d13438"></path>
        </svg>
      `;case yP.PresenceDnd:return AI`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10ZM3.5 4.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1Z" fill="#d13438"></path>
        </svg>`;case yP.PresenceOofDnd:return AI`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Zm2 0c0-.28.22-.5.5-.5h3a.5.5 0 0 1 0 1h-3A.5.5 0 0 1 3 5Z" fill="#d13438"></path>
        </svg>`;case yP.PresenceAway:return AI`
        <svg fill="#eaa300" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10Zm0-7v1.8l1.35 1.35a.5.5 0 1 1-.7.7l-1.5-1.5A.5.5 0 0 1 4 5V3a.5.5 0 0 1 1 0Z" fill="#eaa300"></path>
        </svg>`;case yP.PresenceOofAway:return AI`
        <svg fill="#c239b3" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5.35 3.85a.5.5 0 1 0-.7-.7l-1.5 1.5a.5.5 0 0 0 0 .7l1.5 1.5a.5.5 0 1 0 .7-.7L4.7 5.5h1.8a.5.5 0 1 0 0-1H4.7l.65-.65ZM5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Z" fill="#c239b3"></path>
        </svg>`;case yP.PresenceOffline:return AI`
        <svg fill="#929292" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M6.85 3.15c.2.2.2.5 0 .7L5.71 5l1.14 1.15a.5.5 0 1 1-.7.7L5 5.71 3.85 6.85a.5.5 0 1 1-.7-.7L4.29 5 3.15 3.85a.5.5 0 1 1 .7-.7L5 4.29l1.15-1.14c.2-.2.5-.2.7 0ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Zm5-4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z" fill="#929292"></path>
        </svg>`;case yP.PresenceStatusUnknown:return AI`
        <svg fill="#d13438" aria-hidden="true" width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 1a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Z" fill="#d13438"></path>
        </svg>`}},isWindowSegmentAware=()=>void 0!==window.getWindowSegments,bP=[i$3`
.root .scout-top{position:fixed;top:0;left:0}.root .scout-bottom{position:fixed;bottom:0;right:0}.root .flyout{display:none;position:fixed;z-index:9999999;opacity:0;box-shadow:var(--mgt-flyout-box-shadow,var(--elevation-shadow-card-rest));border-radius:8px}.root .flyout.small{overflow-y:auto;overflow-x:hidden}.root.visible .flyout{display:inline-block;animation-name:fade-in;animation-duration:.3s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;transition:top .3s ease,bottom .3s ease,left .3s ease}.root.visible .flyout.small{overflow-y:auto;overflow-x:hidden}@keyframes fade-in{from{opacity:0;margin-top:-10px;margin-bottom:-10px}to{opacity:1;margin-top:0;margin-bottom:0}}
`];var __decorate$w=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$t=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};let wP=class MgtFlyout extends MgtBaseComponent{static get styles(){return bP}get isOpen(){return this._isOpen}set isOpen(t){const o=this._isOpen;o!==t&&(this._isOpen=t,window.requestAnimationFrame((()=>{this.setupWindowEvents(this.isOpen);const t=this._flyout;!this.isOpen&&t&&(t.style.width=null,t.style.setProperty("--mgt-flyout-set-width",null),t.style.setProperty("--mgt-flyout-set-height",null),t.style.maxHeight=null,t.style.top=null,t.style.left=null,t.style.bottom=null)})),this.requestUpdate("isOpen",o),this.dispatchEvent(new Event(t?"opened":"closed")))}get _edgePadding(){return 24}get _flyout(){return this.renderRoot.querySelector(".flyout")}get _anchor(){return this.renderRoot.querySelector(".anchor")}get _topScout(){return this.renderRoot.querySelector(".scout-top")}get _bottomScout(){return this.renderRoot.querySelector(".scout-bottom")}constructor(){super(),this._renderedOnce=!1,this._isOpen=!1,this._smallView=!1,this.handleWindowEvent=t=>{const o=this._flyout;if(o)if(t.composedPath){const s=t.composedPath();if(s.includes(o)||"pointerdown"===t.type&&s.includes(this))return}else{let s=t.target;for(;s;)if(s=s.parentElement,s===o||"pointerdown"===t.type&&s===this)return}this.close()},this.handleResize=()=>{this.close()},this.handleKeyUp=t=>{"Escape"===t.key&&this.close()},this.handleFlyoutWheel=t=>{t.preventDefault()},this.avoidHidingAnchor=!0,this.addEventListener("expanded",(()=>{window.requestAnimationFrame((()=>{this.updateFlyout()}))}))}open(){this.isOpen=!0}close(){this.isOpen=!1}disconnectedCallback(){this.setupWindowEvents(!1),super.disconnectedCallback()}updated(t){super.updated(t),window.requestAnimationFrame((()=>{this.updateFlyout()}))}render(){const t={root:!0,visible:this.isOpen},o=this.renderAnchor();let s=null;if(this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0),this.isOpen||this._renderedOnce){this._renderedOnce=!0;const t=iP({flyout:!0,small:this._smallView});s=AI`
        <div class=${t} @wheel=${this.handleFlyoutWheel}>
          ${this.renderFlyout()}
        </div>
      `}return AI`
      <div class=${iP(t)}>
        <div class="anchor">
          ${o}
        </div>
        <div class="scout-top"></div>
        <div class="scout-bottom"></div>
        ${s}
      </div>
    `}renderAnchor(){return AI`
      <slot name="anchor"></slot>
    `}renderFlyout(){return AI`
      <slot name="flyout"></slot>
    `}updateFlyout(t=!0){if(!this.isOpen)return;const o=this._anchor,s=this._flyout;if(s&&o){const l=window.innerWidth&&document.documentElement.clientWidth?Math.min(window.innerWidth,document.documentElement.clientWidth):window.innerWidth||document.documentElement.clientWidth;this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight;let h,m,_,E=0,$=0;const B=s.getBoundingClientRect(),q=o.getBoundingClientRect(),j=this._topScout.getBoundingClientRect(),K=this._bottomScout.getBoundingClientRect(),W={height:this._windowHeight,left:0,top:0,width:l};if(isWindowSegmentAware()){const t=(isWindowSegmentAware()?window:null).getWindowSegments();let o;const s=q.left+q.width/2,l=q.top+q.height/2;for(const h of t)if(s>=h.left&&l>=h.top){o=h;break}o&&(W.left=o.left,W.top=o.top,W.width=o.width,W.height=o.height)}B.width+2*this._edgePadding>W.width?B.width>W.width?(_=W.width,E=0):E=(W.width-B.width)/2:E=q.left+B.width+this._edgePadding>W.width?q.left-(q.left+B.width+this._edgePadding-W.width):q.left<this._edgePadding?this._edgePadding:q.left;const X=W.height-(q.top+q.height),re=q.top;this.avoidHidingAnchor?X<=B.height?re<B.height?re>X?(h=W.height-q.top,m=re):($=q.bottom,m=X):(h=W.height-q.top,m=re):($=q.bottom,m=X):B.height+2*this._edgePadding>W.height?B.height>=W.height?(m=W.height,$=0):$=(W.height-B.height)/2:$=q.top+q.height+B.height+this._edgePadding>W.height?W.height-B.height-this._edgePadding:Math.max(q.top+q.height,this._edgePadding),0===j.top&&0===j.left||(E-=j.left,void 0!==h?h+=K.top-this._windowHeight:$-=j.top),"rtl"===this.direction?E>100&&this.offsetLeft>100&&(s.style.left=W.width-E+B.left-B.width-30+"px"):s.style.left=`${E+W.left}px`,void 0!==h?(s.style.top="unset",s.style.bottom=`${h}px`):(s.style.bottom="unset",s.style.top=`${$+W.top}px`),_&&(s.style.width=`${_}px`,s.style.setProperty("--mgt-flyout-set-width",`${_}px`),window.requestAnimationFrame((()=>this.updateFlyout()))),m?(s.style.maxHeight=`${m}px`,s.style.setProperty("--mgt-flyout-set-height",`${m}px`)):(s.style.maxHeight=null,s.style.setProperty("--mgt-flyout-set-height","unset")),t&&window.requestAnimationFrame((()=>this.updateFlyout(!1)))}}setupWindowEvents(t){t&&this.isLightDismiss?(window.addEventListener("wheel",this.handleWindowEvent),window.addEventListener("pointerdown",this.handleWindowEvent),window.addEventListener("resize",this.handleResize),window.addEventListener("keyup",this.handleKeyUp)):(window.removeEventListener("wheel",this.handleWindowEvent),window.removeEventListener("pointerdown",this.handleWindowEvent),window.removeEventListener("resize",this.handleResize),window.removeEventListener("keyup",this.handleKeyUp))}};var CP;__decorate$w([n$1({attribute:"light-dismiss",type:Boolean}),__metadata$t("design:type",Boolean)],wP.prototype,"isLightDismiss",void 0),__decorate$w([n$1({attribute:null,type:Boolean}),__metadata$t("design:type",Boolean)],wP.prototype,"avoidHidingAnchor",void 0),__decorate$w([n$1({attribute:"isOpen",type:Boolean}),__metadata$t("design:type",Boolean),__metadata$t("design:paramtypes",[Boolean])],wP.prototype,"isOpen",null),wP=__decorate$w([customElement("flyout"),__metadata$t("design:paramtypes",[])],wP),exports.PersonCardInteraction=void 0,(CP=exports.PersonCardInteraction||(exports.PersonCardInteraction={}))[CP.none=0]="none",CP[CP.hover=1]="hover",CP[CP.click=2]="click";const _P=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{font-size:var(--default-font-size)}:host .flyout [slot=anchor]{display:flex;cursor:pointer}:host .flyout [slot=anchor].vertical{flex-direction:column;justify-content:center;align-items:center;margin-inline-start:0;--person-avatar-size:72px}:host .person-root{display:flex;flex-direction:row;align-items:center;background-color:var(--person-background-color,transparent);border-radius:var(--person-border-radius,4px)}:host .person-root.small .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px)}:host .person-root.noline .presence-basic,:host .person-root.oneline .presence-basic{border-width:1px;position:relative;bottom:calc(var(--person-avatar-size,24px) * .12 - 4px)}:host .person-root.twolines .avatar-wrapper{min-width:var(--person-avatar-size,40px);width:var(--person-avatar-size,40px);height:var(--person-avatar-size,40px)}:host .person-root.twolines .avatar-wrapper .contact-icon,:host .person-root.twolines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,40px) * .4)}:host .person-root.twolines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,40px) * .28);height:calc(var(--person-avatar-size,40px) * .28)}:host .person-root.large .avatar-wrapper,:host .person-root.threelines .avatar-wrapper{min-width:var(--person-avatar-size,56px);width:var(--person-avatar-size,56px);height:var(--person-avatar-size,56px)}:host .person-root.large .avatar-wrapper .contact-icon,:host .person-root.large .avatar-wrapper .initials,:host .person-root.threelines .avatar-wrapper .contact-icon,:host .person-root.threelines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,56px) * .4)}:host .person-root.large .avatar-wrapper .presence-wrapper svg,:host .person-root.threelines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,56px) * .28);height:calc(var(--person-avatar-size,56px) * .28)}:host .person-root.fourlines .avatar-wrapper{min-width:var(--person-avatar-size,72px);width:var(--person-avatar-size,72px);height:var(--person-avatar-size,72px)}:host .person-root.fourlines .avatar-wrapper .contact-icon,:host .person-root.fourlines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,72px) * .4)}:host .person-root.fourlines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,72px) * .28);height:calc(var(--person-avatar-size,72px) * .28)}:host .person-root.vertical{flex-direction:column;justify-content:center;align-items:center}:host .person-root.vertical .avatar-wrapper{min-width:var(--person-avatar-size,72px);width:var(--person-avatar-size,72px);height:var(--person-avatar-size,72px)}:host .person-root.vertical .avatar-wrapper .contact-icon,:host .person-root.vertical .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,72px) * .4)}:host .person-root.vertical .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,72px) * .28);height:calc(var(--person-avatar-size,72px) * .28)}:host .person-root .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px);position:relative;box-sizing:border-box}:host .person-root .avatar-wrapper .contact-icon,:host .person-root .avatar-wrapper .initials,:host .person-root .avatar-wrapper img{height:100%;width:100%;border:var(--person-avatar-border,none);border-radius:var(--person-avatar-border-radius,50%);margin-block-start:var(--person-avatar-top-spacing,0)}:host .person-root .avatar-wrapper .contact-icon,:host .person-root .avatar-wrapper .initials{display:flex;justify-content:center;align-items:center;font-size:calc(var(--person-avatar-size,24px) * .4);font-weight:400;background:var(--person-initials-background-color,var(--neutral-fill-secondary-rest));color:var(--person-initials-text-color,var(--neutral-fill-strong-hover))}:host .person-root .avatar-wrapper .presence-wrapper{bottom:var(--person-presence-wrapper-bottom,0);right:0;position:absolute;border-radius:50%;background-color:var(--neutral-layer-1);border:1px solid var(--neutral-layer-1)}:host .person-root .avatar-wrapper .presence-wrapper svg{display:flex;width:calc(var(--person-avatar-size,24px) * .28);height:calc(var(--person-avatar-size,24px) * .28)}:host .person-root .details-wrapper{display:flex;flex-direction:column;align-items:flex-start;min-width:var(--person-details-wrapper-width,168px);margin-inline-start:var(--person-details-left-spacing,12px);margin-block-end:var(--person-details-bottom-spacing,0)}:host .person-root .details-wrapper.vertical{display:inline-flex;flex-direction:column;justify-content:center;align-items:center;margin-inline-start:0}:host .person-root .details-wrapper .line1{font-size:var(--person-line1-font-size,ms-font-size-14);font-weight:var(--person-line1-font-weight,600);color:var(--person-line1-text-color,var(--neutral-foreground-rest));text-transform:var(--person-line1-text-transform,inherit);line-height:var(--person-line1-text-line-height,20px)}:host .person-root .details-wrapper .line2{font-size:var(--person-line2-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line2-font-weight,400);color:var(--person-line2-text-color,var(--secondary-text-color));text-transform:var(--person-line2-text-transform,inherit);line-height:var(--person-line2-text-line-height,16px)}:host .person-root .details-wrapper .line3{font-size:var(--person-line3-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line3-font-weight,400);color:var(--person-line3-text-color,var(--secondary-text-color));text-transform:var(--person-line3-text-transform,inherit);line-height:var(--person-line3-text-line-height,16px)}:host .person-root .details-wrapper .line4{font-size:var(--person-line4-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line4-font-weight,400);color:var(--person-line4-text-color,var(--secondary-text-color));text-transform:var(--person-line4-text-transform,inherit);line-height:var(--person-line4-text-line-height,16px)}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}[dir=rtl] .presence-wrapper{right:unset!important;left:0}
`];var kP,xP;exports.PersonViewType=void 0,(kP=exports.PersonViewType||(exports.PersonViewType={}))[kP.avatar=2]="avatar",kP[kP.oneline=3]="oneline",kP[kP.twolines=4]="twolines",kP[kP.threelines=5]="threelines",kP[kP.fourlines=6]="fourlines",exports.avatarType=void 0,(xP=exports.avatarType||(exports.avatarType={})).photo="photo",xP.initials="initials";const SP=Object.assign(Object.assign({},{Available:"Available",Away:"Away",BeRightBack:"Be right back",Busy:"Busy",DoNotDisturb:"Do not disturb",InACall:"In a call",InAConferenceCall:"In a conference call",Inactive:"Inactive",InAMeeting:"In a meeting",Offline:"Offline",OffWork:"Off work",OutOfOffice:"Out of office",PresenceUnknown:"Presence unknown",Presenting:"Presenting",UrgentInterruptionsOnly:"Urgent interruptions only"}),{photoFor:"Photo for",emailAddress:"Email address",initials:"Initials"}),isUser=t=>"personType"in t||"userType"in t,isContact=t=>"initials"in t,l$1=t=>null!=t?t:PI;var TP,__decorate$v=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$s=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$t=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const EP=["businessPhones","displayName","givenName","jobTitle","department","mail","mobilePhone","officeLocation","preferredLanguage","surname","userPrincipalName","id","userType"];exports.MgtPerson=TP=class MgtPerson extends MgtTemplatedComponent{static get styles(){return _P}get strings(){return SP}get personQuery(){return this._personQuery}set personQuery(t){t!==this._personQuery&&(this._personQuery=t,this.personDetailsInternal=null,this.requestStateUpdate())}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(t){t!==this._fallbackDetails&&(this._fallbackDetails=t,this.personDetailsInternal||this.requestStateUpdate())}get userId(){return this._userId}set userId(t){t!==this._userId&&(this._userId=t,this.personDetailsInternal=null,this.requestStateUpdate())}get usage(){return this._usage}set usage(t){t!==this._usage&&(this._usage=t,this.requestStateUpdate())}get personDetailsInternal(){return this._personDetailsInternal}set personDetailsInternal(t){this._personDetailsInternal!==t&&(this._personDetailsInternal=t,this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate(),this.requestUpdate("personDetailsInternal"))}get personDetails(){return this._personDetails}set personDetails(t){this._personDetails!==t&&(this._personDetails=t,this._fetchedImage=null,this._fetchedPresence=null,this.requestStateUpdate(),this.requestUpdate("personDetails"))}get personImage(){return this._personImage||this._fetchedImage}set personImage(t){if(t===this._personImage)return;this._isInvalidImageSrc=!t;const o=this._personImage;this._personImage=t,this.requestUpdate("personImage",o)}get avatarType(){return this._avatarType}set avatarType(t){t!==this._avatarType&&(this._avatarType=t,this.requestStateUpdate())}get personPresence(){return this._personPresence||this._fetchedPresence}set personPresence(t){if(t===this._personPresence)return;const o=this._personPresence;this._personPresence=t,this.requestUpdate("personPresence",o)}static get requiredScopes(){const t=["user.readbasic.all","user.read","people.read","presence.read.all","presence.read"];return TP.config.useContactApis&&t.push("contacts.read"),t}get flyout(){return this.renderRoot.querySelector(".flyout")}constructor(){super(),this._mouseLeaveTimeout=-1,this._mouseEnterTimeout=-1,this.handleMouseClick=t=>{const o=t.target;this.personCardInteraction===exports.PersonCardInteraction.click&&o.tagName!==`${YA.prefix}-PERSON-CARD`.toUpperCase()&&this.showPersonCard()},this.handleKeyDown=t=>{t&&"Enter"===t.key&&this.showPersonCard()},this.handleMouseEnter=()=>{clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this.personCardInteraction===exports.PersonCardInteraction.hover&&(this._mouseEnterTimeout=window.setTimeout(this.showPersonCard,500))},this.handleMouseLeave=()=>{clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseLeaveTimeout=window.setTimeout(this.hidePersonCard,500)},this.hidePersonCard=()=>{const t=this.flyout;t&&t.close();const o=this.querySelector(".mgt-person-card")||this.renderRoot.querySelector(".mgt-person-card");o&&(o.isExpanded=!1,o.clearHistory())},this.showPersonCard=()=>{this._personCardShouldRender||(this._personCardShouldRender=!0);const t=this.flyout;t&&t.open()},this.personCardInteraction=exports.PersonCardInteraction.none,this.line1Property="displayName",this.line2Property="jobTitle",this.line3Property="department",this.line4Property="email",this.view=exports.ViewType.image,this.avatarSize="auto",this.disableImageFetch=!1,this._isInvalidImageSrc=!1,this._avatarType=exports.avatarType.photo,this.verticalLayout=!1}render(){if(this.isLoadingState&&!this.personDetails&&!this.personDetailsInternal&&!this.fallbackDetails)return this.renderLoading();const t=this.personDetails||this.personDetailsInternal||this.fallbackDetails,o=this.getImage(),s=this.personPresence||this._fetchedPresence;if(!t&&!o)return this.renderNoData();!(null==t?void 0:t.personImage)&&o&&(t.personImage=o);let l=this.renderTemplate("default",{person:t,personImage:o,personPresence:s});if(!l){const h=this.renderDetails(t,s),m=this.renderAvatar(t,o,s);l=AI`
        ${m}
        ${h}
      `}this.personCardInteraction!==exports.PersonCardInteraction.none&&(l=this.renderFlyout(l,t,o,s));const h=iP({"person-root":!0,small:!this.isThreeLines()&&!this.isFourLines()&&!this.isLargeAvatar(),large:"auto"!==this.avatarSize&&this.isLargeAvatar(),noline:this.isNoLine(),oneline:this.isOneLine(),twolines:this.isTwoLines(),threelines:this.isThreeLines(),fourlines:this.isFourLines(),vertical:this.isVertical()});return AI`
      <div
        class="${h}"
        dir=${this.direction}
        @click=${this.handleMouseClick}
        @mouseenter=${this.handleMouseEnter}
        @mouseleave=${this.handleMouseLeave}
        @keydown=${this.handleKeyDown}
        tabindex="${l$1(this.personCardInteraction!==exports.PersonCardInteraction.none?"0":void 0)}"
      >
        ${l}
      </div>
    `}renderLoading(){return this.renderTemplate("loading",null)||AI``}clearState(){this._personImage="",this._personDetailsInternal=null,this._fetchedImage=null,this._fetchedPresence=null}renderNoData(){const t=this.renderTemplate("no-data",null);if(t)return t;const o={"avatar-icon":!0,vertical:this.isVertical(),small:!this.isLargeAvatar(),threeLines:this.isThreeLines(),fourLines:this.isFourLines()};return AI`
       <i class=${iP(o)}></i>
     `}renderPersonIcon(){return getSvg(yP.Person)}renderImage(t,o){var s;const l=`${this.strings.photoFor} ${t.displayName}`,h=o&&!this._isInvalidImageSrc&&this.avatarType===exports.avatarType.photo,m=this.avatarType===exports.avatarType.photo&&this.view===exports.ViewType.image,_=null!==(s=(null==t?void 0:t.displayName)||getEmailFromGraphEntity(t))&&void 0!==s?s:void 0,E=AI`<img
      title="${l$1(m?_:void 0)}"
      alt=${l}
      src=${o}
      @error=${()=>this._isInvalidImageSrc=!0} />`,$=t?this.getInitials(t):"",B=null==$?void 0:$.length,q=iP({initials:B&&!h,"contact-icon":!B}),j=AI`<i>${this.renderPersonIcon()}</i>`,K=AI`
      <span 
        title="${l$1(this.view===exports.ViewType.image?_:void 0)}"
        role="${l$1(this.view===exports.ViewType.image?void 0:"presentation")}"
        class="${q}"
      >
        ${B?$:j}
      </span>
`;return h?E:K}renderPresence(t){var o;if(!this.showPresence||!t)return AI``;let s;const{activity:l,availability:h}=t;switch(h){case"Available":case"AvailableIdle":if("OutOfOffice"===l)s=getSvg(yP.PresenceOofAvailable);else s=getSvg(yP.PresenceAvailable);break;case"Busy":case"BusyIdle":switch(l){case"OutOfOffice":case"OnACall":s=getSvg(yP.PresenceOofBusy);break;default:s=getSvg(yP.PresenceBusy)}break;case"DoNotDisturb":if("OutOfOffice"===l)s=getSvg(yP.PresenceOofDnd);else s=getSvg(yP.PresenceDnd);break;case"Away":if("OutOfOffice"===l)s=getSvg(yP.PresenceOofAway);else s=getSvg(yP.PresenceAway);break;case"BeRightBack":s=getSvg(yP.PresenceAway);break;case"Offline":switch(l){case"Offline":s=getSvg(yP.PresenceOffline);break;case"OutOfOffice":case"OffWork":s=getSvg(yP.PresenceOofAway);break;default:s=getSvg(yP.PresenceStatusUnknown)}break;default:s=getSvg(yP.PresenceStatusUnknown)}const m=iP({"presence-wrapper":!0,noline:this.isNoLine(),oneline:this.isOneLine()}),_=null!==(o=this.strings[l])&&void 0!==o?o:PI;return AI`
      <span
        class="${m}"
        title="${_}"
        aria-label="${_}"
        role="img">
          ${s}
      </span>
    `}renderAvatar(t,o,s){let l="";if((!o||this._isInvalidImageSrc||this._avatarType===exports.avatarType.initials)&&t?l=`${this.strings.initials} ${this.getInitials(t)}`:(l=t&&t.displayName||"",""!==l&&(l=`${this.strings.photoFor} ${l}`)),""===l){const o=getEmailFromGraphEntity(t);null!==o&&(l=`${this.strings.emailAddress} ${o}`)}const h=this.renderImage(t,o),m=this.renderPresence(s);return AI`
      <div class="avatar-wrapper">
        ${h}
        ${m}
      </div>
    `}handleLine1Clicked(){this.fireCustomEvent("line1clicked",this.personDetailsInternal)}handleLine2Clicked(){this.fireCustomEvent("line2clicked",this.personDetailsInternal)}handleLine3Clicked(){this.fireCustomEvent("line3clicked",this.personDetailsInternal)}handleLine4Clicked(){this.fireCustomEvent("line4clicked",this.personDetailsInternal)}renderDetails(t,o){if(!t||this.view===exports.ViewType.image||this.view===exports.PersonViewType.avatar)return AI``;const s=t;o&&(s.presenceActivity=null==o?void 0:o.activity,s.presenceAvailability=null==o?void 0:o.availability);const l=[];if(this.view>exports.ViewType.image){const t=this.getTextFromProperty(s,this.line1Property);if(this.hasTemplate("line1")){const o=this.renderTemplate("line1",{person:s});l.push(AI`
           <div class="line1" @click=${()=>this.handleLine1Clicked()} role="presentation" aria-label="${t}">${o}</div>
         `)}else t&&l.push(AI`
             <div class="line1" @click=${()=>this.handleLine1Clicked()} role="presentation" aria-label="${t}">${t}</div>
           `)}if(this.view>exports.ViewType.oneline){const t=this.getTextFromProperty(s,this.line2Property);if(this.hasTemplate("line2")){const o=this.renderTemplate("line2",{person:s});l.push(AI`
           <div class="line2" @click=${()=>this.handleLine2Clicked()} role="presentation" aria-label="${t}">${o}</div>
         `)}else t&&l.push(AI`
             <div class="line2" @click=${()=>this.handleLine2Clicked()} role="presentation" aria-label="${t}">${t}</div>
           `)}if(this.view>exports.ViewType.twolines){const t=this.getTextFromProperty(s,this.line3Property);if(this.hasTemplate("line3")){const o=this.renderTemplate("line3",{person:s});l.push(AI`
           <div class="line3" @click=${()=>this.handleLine3Clicked()} role="presentation" aria-label="${t}">${o}</div>
         `)}else t&&l.push(AI`
             <div class="line3" @click=${()=>this.handleLine3Clicked()} role="presentation" aria-label="${t}">${t}</div>
           `)}if(this.view>exports.ViewType.threelines){const t=this.getTextFromProperty(s,this.line4Property);if(this.hasTemplate("line4")){const o=this.renderTemplate("line4",{person:s});l.push(AI`
          <div class="line4" @click=${()=>this.handleLine4Clicked()} role="presentation" aria-label="${t}">${o}</div>
        `)}else t&&l.push(AI`
            <div class="line4" @click=${()=>this.handleLine4Clicked()} role="presentation" aria-label="${t}">${t}</div>
          `)}const h=iP({"details-wrapper":!0,vertical:this.isVertical()});return AI`
      <div class="${h}">
        ${l}
      </div>
    `}renderFlyout(t,o,s,l){const h=this._personCardShouldRender?AI`
           <div slot="flyout" data-testid="flyout-slot">
             ${this.renderFlyoutContent(o,s,l)}
           </div>`:AI``,m=iP({vertical:this.isVertical()});return mgtHtml`
      <mgt-flyout light-dismiss class="flyout" .avoidHidingAnchor=${!1}>
        <div slot="anchor" class="${m}">${t}</div>
        ${h}
      </mgt-flyout>`}renderFlyoutContent(t,o,s){return this.renderTemplate("person-card",{person:t,personImage:o})||mgtHtml`
        <mgt-person-card
          class="mgt-person-card"
          lock-tab-navigation
          .personDetails=${t}
          .personImage=${o}
          .personPresence=${s}
          .showPresence=${this.showPresence}>
        </mgt-person-card>`}loadState(){return __awaiter$t(this,void 0,void 0,(function*(){const t=Providers.globalProvider;if(!t||t.state===exports.ProviderState.Loading)return;if(t&&t.state===exports.ProviderState.SignedOut)return void(this.personDetailsInternal=null);const o=t.graph.forComponent(this);this.fallbackDetails&&(this.line2Property="email"),this.verticalLayout&&this.view<exports.ViewType.fourlines&&(this.line2Property="email");let s=[...EP,this.line1Property,this.line2Property,this.line3Property,this.line4Property];s=s.filter((t=>"email"!==t));let l=this.personDetailsInternal||this.personDetails||this.fallbackDetails;if(l){if(!l.personImage&&this.fetchImage&&this._avatarType===exports.avatarType.photo&&!this.personImage&&!this._fetchedImage){let t;t="groupTypes"in l?yield((t,o)=>__awaiter$w(void 0,void 0,void 0,(function*(){let s,l;const h=o.id;if(getIsPhotosCacheEnabled()){if(l=CacheService.getCache(lP,lP.stores.groups),s=yield l.getValue(h),s&&getPhotoInvalidationTime()>Date.now()-s.timeCached)return s.photo;if(s)try{const o=yield t.api(`groups/${h}/photo`).get();o&&(o["@odata.mediaEtag"]!==s.eTag||null===o["@odata.mediaEtag"]&&null===s.eTag)&&(s=null)}catch(t){return null}}return s=s||(yield getPhotoForResource(t,`groups/${h}`,["user.readbasic.all"])),getIsPhotosCacheEnabled()&&s&&(yield l.putValue(h,s)),s?s.photo:null})))(o,l):yield getPersonImage(o,l,TP.config.useContactApis),t&&(l.personImage=t,this._fetchedImage=t)}}else if(this.userId||"me"===this.personQuery){let t;t=this._avatarType!==exports.avatarType.photo||this.disableImageFetch?"me"===this.personQuery?yield getMe(o,s):yield getUser(o,this.userId,s):yield getUserWithPhoto(o,this.userId,s),this.personDetailsInternal=t,this.personDetails=t,this._fetchedImage=this.getImage()}else if(this.personQuery){let t=yield findPeople(o,this.personQuery,1);if(t&&0!==t.length||(t=(yield findUsers(o,this.personQuery,1))||[]),(null==t?void 0:t.length)&&(this.personDetailsInternal=t[0],this.personDetails=t[0],this._avatarType===exports.avatarType.photo&&!this.disableImageFetch)){const s=yield getPersonImage(o,t[0],TP.config.useContactApis);s&&(this.personDetailsInternal.personImage=s,this.personDetails.personImage=s,this._fetchedImage=s)}}const h={activity:"Offline",availability:"Offline",id:null};if(this.showPresence&&!this.personPresence&&!this._fetchedPresence)try{if(l=this.personDetailsInternal||this.personDetails,l){const t="me"!==this.personQuery?null==l?void 0:l.id:null;this._fetchedPresence=yield getUserPresence(o,t)}else this._fetchedPresence=h}catch(t){this._fetchedPresence=h}}))}getInitials(t){var o,s,l,h,m,_;if(t||(t=this.personDetailsInternal),isContact(t))return t.initials;let E="";if(isUser(t)&&(E+=null!==(l=null===(s=null===(o=t.givenName)||void 0===o?void 0:o[0])||void 0===s?void 0:s.toUpperCase())&&void 0!==l?l:"",E+=null!==(_=null===(m=null===(h=t.surname)||void 0===h?void 0:h[0])||void 0===m?void 0:m.toUpperCase())&&void 0!==_?_:""),!E&&t.displayName){const o=t.displayName.split(/\s+/);for(let t=0;t<2&&t<o.length;t++)o[t][0]&&this.isLetter(o[t][0])&&(E+=o[t][0].toUpperCase())}return E}getImage(){if(this.personImage)return this.personImage;if(this._fetchedImage)return this._fetchedImage;const t=this.personDetailsInternal||this.personDetails;return(null==t?void 0:t.personImage)?t.personImage:null}isLetter(t){try{return t.match(new RegExp("\\p{L}","u"))}catch(o){return t.toLowerCase()!==t.toUpperCase()}}getTextFromProperty(t,o){if(!o||0===o.length)return null;const s=o.trim().split(",");let l,h=0;for(;!l&&h<s.length;){const o=s[h].trim();switch(o){case"mail":case"email":l=getEmailFromGraphEntity(t);break;default:l=t[o]}h++}return l}isLargeAvatar(){return"large"===this.avatarSize||"auto"===this.avatarSize&&this.view>exports.ViewType.oneline}isNoLine(){return this.view<exports.ViewType.oneline}isOneLine(){return this.view===exports.ViewType.oneline}isTwoLines(){return this.view===exports.ViewType.twolines}isThreeLines(){return this.view===exports.ViewType.threelines}isFourLines(){return this.view===exports.ViewType.fourlines}isVertical(){return this.verticalLayout}},exports.MgtPerson.config={useContactApis:!0},__decorate$v([n$1({attribute:"person-query"}),__metadata$s("design:type",String),__metadata$s("design:paramtypes",[String])],exports.MgtPerson.prototype,"personQuery",null),__decorate$v([n$1({attribute:"fallback-details",type:Object}),__metadata$s("design:type",Object),__metadata$s("design:paramtypes",[Object])],exports.MgtPerson.prototype,"fallbackDetails",null),__decorate$v([n$1({attribute:"user-id"}),__metadata$s("design:type",String),__metadata$s("design:paramtypes",[String])],exports.MgtPerson.prototype,"userId",null),__decorate$v([n$1({attribute:"usage"}),__metadata$s("design:type",String),__metadata$s("design:paramtypes",[String])],exports.MgtPerson.prototype,"usage",null),__decorate$v([n$1({attribute:"show-presence",type:Boolean}),__metadata$s("design:type",Boolean)],exports.MgtPerson.prototype,"showPresence",void 0),__decorate$v([n$1({attribute:"avatar-size",type:String}),__metadata$s("design:type",String)],exports.MgtPerson.prototype,"avatarSize",void 0),__decorate$v([t$1(),__metadata$s("design:type",Object),__metadata$s("design:paramtypes",[Object])],exports.MgtPerson.prototype,"personDetailsInternal",null),__decorate$v([n$1({attribute:"person-details",type:Object}),__metadata$s("design:type",Object),__metadata$s("design:paramtypes",[Object])],exports.MgtPerson.prototype,"personDetails",null),__decorate$v([n$1({attribute:"person-image",type:String}),__metadata$s("design:type",String),__metadata$s("design:paramtypes",[String])],exports.MgtPerson.prototype,"personImage",null),__decorate$v([n$1({attribute:"fetch-image",type:Boolean}),__metadata$s("design:type",Boolean)],exports.MgtPerson.prototype,"fetchImage",void 0),__decorate$v([n$1({attribute:"disable-image-fetch",type:Boolean}),__metadata$s("design:type",Boolean)],exports.MgtPerson.prototype,"disableImageFetch",void 0),__decorate$v([n$1({attribute:"vertical-layout",type:Boolean}),__metadata$s("design:type",Boolean)],exports.MgtPerson.prototype,"verticalLayout",void 0),__decorate$v([n$1({attribute:"avatar-type",converter:t=>"initials"===(t=t.toLowerCase())?exports.avatarType.initials:exports.avatarType.photo}),__metadata$s("design:type",String),__metadata$s("design:paramtypes",[String])],exports.MgtPerson.prototype,"avatarType",null),__decorate$v([n$1({attribute:"person-presence",type:Object}),__metadata$s("design:type",Object),__metadata$s("design:paramtypes",[Object])],exports.MgtPerson.prototype,"personPresence",null),__decorate$v([n$1({attribute:"person-card",converter:t=>(t=t.toLowerCase(),void 0===exports.PersonCardInteraction[t]?exports.PersonCardInteraction.none:exports.PersonCardInteraction[t])}),__metadata$s("design:type",Number)],exports.MgtPerson.prototype,"personCardInteraction",void 0),__decorate$v([n$1({attribute:"line1-property"}),__metadata$s("design:type",String)],exports.MgtPerson.prototype,"line1Property",void 0),__decorate$v([n$1({attribute:"line2-property"}),__metadata$s("design:type",String)],exports.MgtPerson.prototype,"line2Property",void 0),__decorate$v([n$1({attribute:"line3-property"}),__metadata$s("design:type",String)],exports.MgtPerson.prototype,"line3Property",void 0),__decorate$v([n$1({attribute:"line4-property"}),__metadata$s("design:type",String)],exports.MgtPerson.prototype,"line4Property",void 0),__decorate$v([n$1({converter:t=>t&&0!==t.length?(t=t.toLowerCase(),void 0===exports.ViewType[t]?exports.ViewType.image:exports.ViewType[t]):exports.ViewType.image}),__metadata$s("design:type",Number)],exports.MgtPerson.prototype,"view",void 0),__decorate$v([t$1(),__metadata$s("design:type",String)],exports.MgtPerson.prototype,"_fetchedImage",void 0),__decorate$v([t$1(),__metadata$s("design:type",Object)],exports.MgtPerson.prototype,"_fetchedPresence",void 0),__decorate$v([t$1(),__metadata$s("design:type",Boolean)],exports.MgtPerson.prototype,"_isInvalidImageSrc",void 0),__decorate$v([t$1(),__metadata$s("design:type",Boolean)],exports.MgtPerson.prototype,"_personCardShouldRender",void 0),exports.MgtPerson=TP=__decorate$v([customElement("person"),__metadata$s("design:paramtypes",[])],exports.MgtPerson);const AP=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{--card-height:auto;--card-width:99%;background-color:var(--agenda-background-color,transparent)}:host .header{margin:var(--agenda-header-margin,18px 0 12px 10px);font-size:var(--agenda-header-font-size,24px);font-style:normal;font-weight:400;line-height:32px;color:var(--agenda-header-color,var(--neutral-foreground-rest));opacity:.9}:host .agenda,:host .group{display:flex;flex-direction:column;row-gap:var(--agenda-event-row-gap,14px)}:host .agenda>.group:first-child>.header,:host .group>.group:first-child>.header{margin-top:0}:host .agenda .event,:host .group .event{background:var(--agenda-event-background-color,var(--fill-color));border:var(--agenda-event-border,solid 2px transparent);box-shadow:var(--agenda-event-box-shadow,var(--elevation-shadow-card-rest));padding:var(--agenda-event-padding,12px);position:relative;display:flex;flex:1 1 auto;content-visibility:visible;contain:none}:host .agenda .event-container,:host .group .event-container{border-radius:calc(var(--layer-corner-radius) * 1px);padding:1px}:host .agenda .event.narrow,:host .group .event.narrow{display:flex;flex-direction:column;inset:0}:host .agenda .event-time-container,:host .group .event-time-container{font-style:normal;font-weight:600;font-size:12px;color:var(--agenda-event-time-color,var(--neutral-foreground-rest));width:112px;height:16px}:host .agenda .event-time-container.narrow,:host .group .event-time-container.narrow{margin-bottom:1px;width:100%}:host .agenda .event-time,:host .group .event-time{font-size:var(--agenda-event-time-font-size,12px);color:var(--agenda-event-time-color,var(--neutral-foreground-rest));font-weight:600}:host .agenda .event-details-container,:host .group .event-details-container{display:flex;flex-direction:column;position:relative;bottom:8px;top:0;padding-inline-start:32px}:host .agenda .event-details-container.narrow,:host .group .event-details-container.narrow{position:inherit;left:6px;display:flex;flex-direction:column;padding-inline-start:0}:host .agenda .event-subject,:host .group .event-subject{font-style:normal;font-weight:400;font-size:var(--agenda-event-subject-font-size,20px);line-height:28px;color:var(--agenda-event-subject-color,var(--neutral-foreground-rest));mix-blend-mode:normal;position:inherit;bottom:8px}:host .agenda .event-location-container,:host .group .event-location-container{display:inline-flex;flex-direction:row}:host .agenda .event-location-container .event-location,:host .group .event-location-container .event-location{padding-inline-start:3px;font-style:normal;font-weight:400;font-size:var(--agenda-event-location-font-size,12px);line-height:16px;color:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-loading,:host .group .event-location-container .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .agenda .event-location-container .event-location-icon,:host .group .event-location-container .event-location-icon{display:inline-flex}:host .agenda .event-location-container .event-location-icon svg,:host .group .event-location-container .event-location-icon svg{position:relative;top:2px;width:12px;height:12px}:host .agenda .event-location-container .event-location-icon svg path,:host .group .event-location-container .event-location-icon svg path{stroke:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-icon-loading,:host .group .event-location-container .event-location-icon-loading{width:14px;height:14px}:host .agenda .event-location-container .event-attendee-loading,:host .group .event-location-container .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}:host .agenda .event-attendees,:host .group .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}fluent-card.event.event-loading{--card-height:90px}:host .event-attendees{--color:$agenda-event-attendees-color}:host fluent-tooltip{width:auto;contain:inline-size}[dir=rtl] :host{direction:rtl}[dir=rtl] .event-time-container{direction:ltr;display:flex;justify-content:flex-end}@media (forced-colors:active) and (prefers-color-scheme:dark){:host .agenda .event-location-container .event-location-icon svg path{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host .agenda .event-location-container .event-location-icon svg path{stroke:#000!important}}
`];var __awaiter$s=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const getEventsQueryPageIterator=(t,o,s="calendars.read")=>__awaiter$s(void 0,void 0,void 0,(function*(){const l=t.api(o).middlewareOptions(prepScopes(s)).orderby("start/dateTime");return GraphPageIterator.create(t,l)})),{I:IP}=OI,r=()=>document.createComment(""),c$1=(t,o,s)=>{var l;const h=t._$AA.parentNode,m=void 0===o?t._$AB:o._$AA;if(void 0===s){const o=h.insertBefore(r(),m),l=h.insertBefore(r(),m);s=new IP(o,l,t,t.options)}else{const o=s._$AB.nextSibling,_=s._$AM,E=_!==t;if(E){let o;null===(l=s._$AQ)||void 0===l||l.call(s,t),s._$AM=t,void 0!==s._$AP&&(o=t._$AU)!==_._$AU&&s._$AP(o)}if(o!==m||E){let t=s._$AA;for(;t!==o;){const o=t.nextSibling;h.insertBefore(t,m),t=o}}}return s},f=(t,o,s=t)=>(t._$AI(o,s),t),PP={},a=(t,o=PP)=>t._$AH=o,p=t=>{var o;null===(o=t._$AP)||void 0===o||o.call(t,!1,!0);let s=t._$AA;const l=t._$AB.nextSibling;for(;s!==l;){const t=s.nextSibling;s.remove(),s=t}},u=(t,o,s)=>{const l=new Map;for(let h=o;h<=s;h++)l.set(t[h],h);return l},RP=e(class extends i{constructor(t){if(super(t),t.type!==nP)throw Error("repeat() can only be used in text expressions")}ct(t,o,s){let l;void 0===s?s=o:void 0!==o&&(l=o);const h=[],m=[];let _=0;for(const o of t)h[_]=l?l(o,_):_,m[_]=s(o,_),_++;return{values:m,keys:h}}render(t,o,s){return this.ct(t,o,s).values}update(t,[o,s,l]){var h;const m=(t=>t._$AH)(t),{values:_,keys:E}=this.ct(o,s,l);if(!Array.isArray(m))return this.ut=E,_;const $=null!==(h=this.ut)&&void 0!==h?h:this.ut=[],B=[];let q,j,K=0,W=m.length-1,X=0,re=_.length-1;for(;K<=W&&X<=re;)if(null===m[K])K++;else if(null===m[W])W--;else if($[K]===E[X])B[X]=f(m[K],_[X]),K++,X++;else if($[W]===E[re])B[re]=f(m[W],_[re]),W--,re--;else if($[K]===E[re])B[re]=f(m[K],_[re]),c$1(t,B[re+1],m[K]),K++,re--;else if($[W]===E[X])B[X]=f(m[W],_[X]),c$1(t,m[K],m[W]),W--,X++;else if(void 0===q&&(q=u(E,X,re),j=u($,K,W)),q.has($[K]))if(q.has($[W])){const o=j.get(E[X]),s=void 0!==o?m[o]:null;if(null===s){const o=c$1(t,m[K]);f(o,_[X]),B[X]=o}else B[X]=f(s,_[X]),c$1(t,m[K],s),m[o]=null;X++}else p(m[W]),W--;else p(m[K]),K++;for(;X<=re;){const o=c$1(t,B[re+1]);f(o,_[X]),B[X++]=o}for(;K<=W;){const t=m[K++];null!==t&&p(t)}return this.ut=E,a(t,B),II}}),$P=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .people-list{list-style:none;margin:var(--people-list-margin,8px 4px 8px 8px);padding:unset;display:flex;align-items:center;gap:var(--people-avatar-gap,4px)}:host .overflow span{vertical-align:middle;color:var(--people-overflow-font-color,currentColor);font-size:var(--people-overflow-font-size,12px);font-weight:var(--people-overflow-font-weight,400)}
`];var __decorate$u=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$r=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$r=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};exports.MgtPeople=class MgtPeople extends MgtTemplatedComponent{static get styles(){return $P}get groupId(){return this._groupId}set groupId(t){this._groupId!==t&&(this._groupId=t,this.requestStateUpdate(!0))}get userIds(){return this._userIds}set userIds(t){arraysAreEqual(this._userIds,t)||(this._userIds=t,this.requestStateUpdate(!0))}get peopleQueries(){return this._peopleQueries}set peopleQueries(t){arraysAreEqual(this._peopleQueries,t)||(this._peopleQueries=t,this.requestStateUpdate(!0))}get resource(){return this._resource}set resource(t){this._resource!==t&&(this._resource=t,this.requestStateUpdate(!0))}get version(){return this._version}set version(t){this._version!==t&&(this._version=t,this.requestStateUpdate(!0))}get fallbackDetails(){return this._fallbackDetails}set fallbackDetails(t){t!==this._fallbackDetails&&(this._fallbackDetails=t,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["user.read.all","people.read","user.readbasic.all","presence.read.all","contacts.read",...exports.MgtPerson.requiredScopes])]}constructor(){super(),this.personCardInteraction=exports.PersonCardInteraction.hover,this.scopes=[],this._peoplePresence={},this._version="v1.0",this._arrowKeyLocation=-1,this.handleKeyDown=t=>{const o=this.shadowRoot.querySelector(".people-list");let s;const l=null==o?void 0:o.children;for(const t of l){const o=t;o.setAttribute("tabindex","-1"),o.blur()}const h=o.childElementCount,m=t.key;if("ArrowRight"===m)this._arrowKeyLocation=(this._arrowKeyLocation+1+h)%h;else if("ArrowLeft"===m)this._arrowKeyLocation=(this._arrowKeyLocation-1+h)%h;else if("Tab"===m||"Escape"===m)this._arrowKeyLocation=-1,o.blur();else if(["Enter","space"," "].includes(m)&&this.personCardInteraction!==exports.PersonCardInteraction.none){const t=l[this._arrowKeyLocation].querySelector("mgt-person");t&&t.showPersonCard()}this._arrowKeyLocation>-1&&(s=l[this._arrowKeyLocation],s.setAttribute("tabindex","1"),s.focus())},this.showMax=3}clearState(){this.people=null}requestStateUpdate(t){return t&&(this.people=null),super.requestStateUpdate(t)}render(){return this.isLoadingState?this.renderLoading():this.people&&0!==this.people.length?this.renderTemplate("default",{people:this.people,max:this.showMax})||this.renderPeople():this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||AI``}renderPeople(){const t=this.people.slice(0,this.showMax).filter((t=>t));return AI`
      <ul
        tabindex="0"
        class="people-list"
        aria-label="people"
        @keydown=${this.handleKeyDown}>
        ${RP(t,(t=>t.id?t.id:t.displayName),(t=>AI`
            <li tabindex="-1" class="people-person">
              ${this.renderPerson(t)}
            </li>
          `))}
        ${this.people.length>this.showMax?this.renderOverflow():null}
      </ul>
    `}renderOverflow(){const t=this.people.length-this.showMax;return this.renderTemplate("overflow",{extra:t,max:this.showMax,people:this.people})||AI`
        <li tabindex="-1" aria-label="and ${t} more attendees" class="overflow"><span>+${t}</span></li>
      `}renderPerson(t){let o={activity:"Offline",availability:"Offline",id:null};this.showPresence&&this._peoplePresence&&(o=this._peoplePresence[t.id]);return this.renderTemplate("person",{person:t},t.id)||mgtHtml`
        <mgt-person
          .personDetails=${t}
          .fetchImage=${!0}
          .avatarSize=${"small"}
          .personCardInteraction=${this.personCardInteraction}
          .showPresence=${this.showPresence}
          .personPresence=${o}
          .usage=${"people"}
        ></mgt-person>
      `}renderNoData(){return this.renderTemplate("no-data",null)||AI``}loadState(){return __awaiter$r(this,void 0,void 0,(function*(){if(!this.people){const t=Providers.globalProvider;if(t&&t.state===exports.ProviderState.SignedIn){const o=t.graph.forComponent(this);this.groupId?this.people=yield findGroupMembers(o,null,this.groupId,this.showMax,exports.PersonType.person):this.userIds||this.peopleQueries?this.people=this.userIds?yield getUsersForUserIds(o,this.userIds,"","",this._fallbackDetails):yield((t,o,s)=>__awaiter$x(void 0,void 0,void 0,(function*(){var l;if(!o||0===o.length)return[];const h=t.createBatch(),m=[];let _,E;getIsUsersCacheEnabled()&&(E=CacheService.getCache(aP,aP.stores.usersQuery));for(const t of o)if(getIsUsersCacheEnabled()&&(_=yield E.getValue(t)),getIsUsersCacheEnabled()&&(null==_?void 0:_.results[0])&&getUserInvalidationTime()>Date.now()-_.timeCached){const t=JSON.parse(_.results[0]);m.push(t)}else h.get(t,`/me/people?$search="${t}"`,["people.read"],{"X-PeopleQuery-QuerySources":"Mailbox,Directory"});if(h.hasRequests)try{const t=yield h.executeAll();for(const h of o){const o=t.get(h);if((null===(l=null==o?void 0:o.content)||void 0===l?void 0:l.value)&&o.content.value.length>0)m.push(o.content.value[0]),getIsUsersCacheEnabled()&&(yield E.putValue(h,{maxResults:1,results:[JSON.stringify(o.content.value[0])]}));else{const t=s.find((t=>Object.values(t).includes(h)));t&&m.push(t)}}return m}catch(s){try{return Promise.all(o.filter((t=>t&&""!==t)).map((o=>__awaiter$x(void 0,void 0,void 0,(function*(){const s=yield findPeople(t,o,1);if(null==s?void 0:s.length)return getIsUsersCacheEnabled()&&(yield E.putValue(o,{maxResults:1,results:[JSON.stringify(s[0])]})),s[0]})))))}catch(t){return[]}}return m})))(o,this.peopleQueries,this._fallbackDetails):this.resource?this.people=yield((t,o,s,l)=>__awaiter$y(void 0,void 0,void 0,(function*(){var h;let m;const _=`${o}${s}`;if(getIsPeopleCacheEnabled()){m=CacheService.getCache(cP,cP.stores.peopleQuery);const t=yield m.getValue(_);if(t&&getPeopleInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}let E=t.api(s).version(o);(null==l?void 0:l.length)&&(E=E.middlewareOptions(prepScopes(...l)));let $=yield E.get();if($&&Array.isArray($.value)&&$["@odata.nextLink"]){let s=$;for(;null==s?void 0:s["@odata.nextLink"];){const l=s["@odata.nextLink"].split(o)[1];s=yield t.client.api(l).version(o).get(),(null===(h=null==s?void 0:s.value)||void 0===h?void 0:h.length)&&(s.value=$.value.concat(s.value),$=s)}}if(getIsPeopleCacheEnabled()&&$){const t={results:null};Array.isArray($.value)?t.results=$.value.map((t=>JSON.stringify(t))):t.results=[JSON.stringify($)],yield m.putValue(_,t)}return null==$?void 0:$.value})))(o,this.version,this.resource,this.scopes):this.people=yield getPeople(o),this.showPresence?this._peoplePresence=yield((t,o)=>__awaiter$v(void 0,void 0,void 0,(function*(){if(!o||0===o.length)return{};const s={},l=[],h=["presence.read.all"];let m;getIsPresenceCacheEnabled()&&(m=CacheService.getCache(sP,sP.stores.presence));for(const t of o)if(null==t?void 0:t.id){const o=t.id;let h;s[o]=null,getIsPresenceCacheEnabled()&&(h=yield m.getValue(o)),getIsPresenceCacheEnabled()&&h&&getPresenceInvalidationTime()>Date.now()-h.timeCached?s[o]=JSON.parse(h.presence):l.push(o)}try{if(l.length>0){const o=yield t.api("/communications/getPresencesByUserId").middlewareOptions(prepScopes(...h)).post({ids:l});for(const t of o.value)s[t.id]=t,getIsPresenceCacheEnabled()&&(yield m.putValue(t.id,{presence:JSON.stringify(t)}))}return s}catch(l){try{const l=yield Promise.all(o.filter((t=>(null==t?void 0:t.id)&&!s[t.id]&&"personType"in t&&"OrganizationUser"===t.personType.subclass)).map((o=>getUserPresence(t,o.id))));for(const t of l)s[t.id]=t;return s}catch(t){return null}}})))(o,this.people):this._peoplePresence=null}}}))}},__decorate$u([n$1({attribute:"group-id",type:String}),__metadata$r("design:type",String),__metadata$r("design:paramtypes",[Object])],exports.MgtPeople.prototype,"groupId",null),__decorate$u([n$1({attribute:"user-ids",converter:(t,o)=>t.split(",").map((t=>t.trim()))}),__metadata$r("design:type",Array),__metadata$r("design:paramtypes",[Array])],exports.MgtPeople.prototype,"userIds",null),__decorate$u([n$1({attribute:"people",type:Object}),__metadata$r("design:type",Array)],exports.MgtPeople.prototype,"people",void 0),__decorate$u([n$1({attribute:"people-queries",converter:(t,o)=>t.split(",").map((t=>t.trim()))}),__metadata$r("design:type",Array),__metadata$r("design:paramtypes",[Array])],exports.MgtPeople.prototype,"peopleQueries",null),__decorate$u([n$1({attribute:"show-max",type:Number}),__metadata$r("design:type",Number)],exports.MgtPeople.prototype,"showMax",void 0),__decorate$u([n$1({attribute:"show-presence",type:Boolean}),__metadata$r("design:type",Boolean)],exports.MgtPeople.prototype,"showPresence",void 0),__decorate$u([n$1({attribute:"person-card",converter:(t,o)=>(t=t.toLowerCase(),void 0===exports.PersonCardInteraction[t]?exports.PersonCardInteraction.hover:exports.PersonCardInteraction[t])}),__metadata$r("design:type",Number)],exports.MgtPeople.prototype,"personCardInteraction",void 0),__decorate$u([n$1({attribute:"resource",type:String}),__metadata$r("design:type",String),__metadata$r("design:paramtypes",[Object])],exports.MgtPeople.prototype,"resource",null),__decorate$u([n$1({attribute:"version",type:String}),__metadata$r("design:type",String),__metadata$r("design:paramtypes",[Object])],exports.MgtPeople.prototype,"version",null),__decorate$u([n$1({attribute:"scopes",converter:t=>t?t.toLowerCase().split(","):null,reflect:!0}),__metadata$r("design:type",Array)],exports.MgtPeople.prototype,"scopes",void 0),__decorate$u([n$1({attribute:"fallback-details",type:Array}),__metadata$r("design:type",Array),__metadata$r("design:paramtypes",[Array])],exports.MgtPeople.prototype,"fallbackDetails",null),__decorate$u([t$1(),__metadata$r("design:type",Object)],exports.MgtPeople.prototype,"_arrowKeyLocation",void 0),exports.MgtPeople=__decorate$u([customElement("people"),__metadata$r("design:paramtypes",[])],exports.MgtPeople);const MP=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof global)return global;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;try{return new Function("return this")()}catch(t){return{}}}();void 0===MP.trustedTypes&&(MP.trustedTypes={createPolicy:(t,o)=>o});const OP={configurable:!1,enumerable:!1,writable:!1};void 0===MP.FAST&&Reflect.defineProperty(MP,"FAST",Object.assign({value:Object.create(null)},OP));const NP=MP.FAST;if(void 0===NP.getById){const t=Object.create(null);Reflect.defineProperty(NP,"getById",Object.assign({value(o,s){let l=t[o];return void 0===l&&(l=s?t[o]=s():null),l}},OP))}const DP=Object.freeze([]);function createMetadataLocator(){const t=new WeakMap;return function(o){let s=t.get(o);if(void 0===s){let l=Reflect.getPrototypeOf(o);for(;void 0===s&&null!==l;)s=t.get(l),l=Reflect.getPrototypeOf(l);s=void 0===s?[]:s.slice(0),t.set(o,s)}return s}}const LP=MP.FAST.getById(1,(()=>{const t=[],o=[];function throwFirstError(){if(o.length)throw o.shift()}function tryRunTask(t){try{t.call()}catch(t){o.push(t),setTimeout(throwFirstError,0)}}function process(){let o=0;for(;o<t.length;)if(tryRunTask(t[o]),o++,o>1024){for(let s=0,l=t.length-o;s<l;s++)t[s]=t[s+o];t.length-=o,o=0}t.length=0}return Object.freeze({enqueue:function enqueue(o){t.length<1&&MP.requestAnimationFrame(process),t.push(o)},process:process})})),FP=MP.trustedTypes.createPolicy("fast-html",{createHTML:t=>t});let BP=FP;const HP=`fast-${Math.random().toString(36).substring(2,8)}`,UP=`${HP}{`,qP=`}${HP}`,jP=Object.freeze({supportsAdoptedStyleSheets:Array.isArray(document.adoptedStyleSheets)&&"replace"in CSSStyleSheet.prototype,setHTMLPolicy(t){if(BP!==FP)throw new Error("The HTML policy can only be set once.");BP=t},createHTML:t=>BP.createHTML(t),isMarker:t=>t&&8===t.nodeType&&t.data.startsWith(HP),extractDirectiveIndexFromMarker:t=>parseInt(t.data.replace(`${HP}:`,"")),createInterpolationPlaceholder:t=>`${UP}${t}${qP}`,createCustomAttributePlaceholder(t,o){return`${t}="${this.createInterpolationPlaceholder(o)}"`},createBlockPlaceholder:t=>`\x3c!--${HP}:${t}--\x3e`,queueUpdate:LP.enqueue,processUpdates:LP.process,nextUpdate:()=>new Promise(LP.enqueue),setAttribute(t,o,s){null==s?t.removeAttribute(o):t.setAttribute(o,s)},setBooleanAttribute(t,o,s){s?t.setAttribute(o,""):t.removeAttribute(o)},removeChildNodes(t){for(let o=t.firstChild;null!==o;o=t.firstChild)t.removeChild(o)},createTemplateWalker:t=>document.createTreeWalker(t,133,null,!1)});class SubscriberSet{constructor(t,o){this.sub1=void 0,this.sub2=void 0,this.spillover=void 0,this.source=t,this.sub1=o}has(t){return void 0===this.spillover?this.sub1===t||this.sub2===t:-1!==this.spillover.indexOf(t)}subscribe(t){const o=this.spillover;if(void 0===o){if(this.has(t))return;if(void 0===this.sub1)return void(this.sub1=t);if(void 0===this.sub2)return void(this.sub2=t);this.spillover=[this.sub1,this.sub2,t],this.sub1=void 0,this.sub2=void 0}else{-1===o.indexOf(t)&&o.push(t)}}unsubscribe(t){const o=this.spillover;if(void 0===o)this.sub1===t?this.sub1=void 0:this.sub2===t&&(this.sub2=void 0);else{const s=o.indexOf(t);-1!==s&&o.splice(s,1)}}notify(t){const o=this.spillover,s=this.source;if(void 0===o){const o=this.sub1,l=this.sub2;void 0!==o&&o.handleChange(s,t),void 0!==l&&l.handleChange(s,t)}else for(let l=0,h=o.length;l<h;++l)o[l].handleChange(s,t)}}class PropertyChangeNotifier{constructor(t){this.subscribers={},this.sourceSubscribers=null,this.source=t}notify(t){var o;const s=this.subscribers[t];void 0!==s&&s.notify(t),null===(o=this.sourceSubscribers)||void 0===o||o.notify(t)}subscribe(t,o){var s;if(o){let s=this.subscribers[o];void 0===s&&(this.subscribers[o]=s=new SubscriberSet(this.source)),s.subscribe(t)}else this.sourceSubscribers=null!==(s=this.sourceSubscribers)&&void 0!==s?s:new SubscriberSet(this.source),this.sourceSubscribers.subscribe(t)}unsubscribe(t,o){var s;if(o){const s=this.subscribers[o];void 0!==s&&s.unsubscribe(t)}else null===(s=this.sourceSubscribers)||void 0===s||s.unsubscribe(t)}}const zP=NP.getById(2,(()=>{const t=/(:|&&|\|\||if)/,o=new WeakMap,s=jP.queueUpdate;let l,createArrayObserver=t=>{throw new Error("Must call enableArrayObservation before observing arrays.")};function getNotifier(t){let s=t.$fastController||o.get(t);return void 0===s&&(Array.isArray(t)?s=createArrayObserver(t):o.set(t,s=new PropertyChangeNotifier(t))),s}const h=createMetadataLocator();class DefaultObservableAccessor{constructor(t){this.name=t,this.field=`_${t}`,this.callback=`${t}Changed`}getValue(t){return void 0!==l&&l.watch(t,this.name),t[this.field]}setValue(t,o){const s=this.field,l=t[s];if(l!==o){t[s]=o;const h=t[this.callback];"function"==typeof h&&h.call(t,l,o),getNotifier(t).notify(this.name)}}}class BindingObserverImplementation extends SubscriberSet{constructor(t,o,s=!1){super(t,o),this.binding=t,this.isVolatileBinding=s,this.needsRefresh=!0,this.needsQueue=!0,this.first=this,this.last=null,this.propertySource=void 0,this.propertyName=void 0,this.notifier=void 0,this.next=void 0}observe(t,o){this.needsRefresh&&null!==this.last&&this.disconnect();const s=l;l=this.needsRefresh?this:void 0,this.needsRefresh=this.isVolatileBinding;const h=this.binding(t,o);return l=s,h}disconnect(){if(null!==this.last){let t=this.first;for(;void 0!==t;)t.notifier.unsubscribe(this,t.propertyName),t=t.next;this.last=null,this.needsRefresh=this.needsQueue=!0}}watch(t,o){const s=this.last,h=getNotifier(t),m=null===s?this.first:{};if(m.propertySource=t,m.propertyName=o,m.notifier=h,h.subscribe(this,o),null!==s){if(!this.needsRefresh){let o;l=void 0,o=s.propertySource[s.propertyName],l=this,t===o&&(this.needsRefresh=!0)}s.next=m}this.last=m}handleChange(){this.needsQueue&&(this.needsQueue=!1,s(this))}call(){null!==this.last&&(this.needsQueue=!0,this.notify(this))}records(){let t=this.first;return{next:()=>{const o=t;return void 0===o?{value:void 0,done:!0}:(t=t.next,{value:o,done:!1})},[Symbol.iterator]:function(){return this}}}}return Object.freeze({setArrayObserverFactory(t){createArrayObserver=t},getNotifier:getNotifier,track(t,o){void 0!==l&&l.watch(t,o)},trackVolatile(){void 0!==l&&(l.needsRefresh=!0)},notify(t,o){getNotifier(t).notify(o)},defineProperty(t,o){"string"==typeof o&&(o=new DefaultObservableAccessor(o)),h(t).push(o),Reflect.defineProperty(t,o.name,{enumerable:!0,get:function(){return o.getValue(this)},set:function(t){o.setValue(this,t)}})},getAccessors:h,binding(t,o,s=this.isVolatileBinding(t)){return new BindingObserverImplementation(t,o,s)},isVolatileBinding:o=>t.test(o.toString())})}));function observable(t,o){zP.defineProperty(t,o)}const VP=NP.getById(3,(()=>{let t=null;return{get:()=>t,set(o){t=o}}}));class ExecutionContext{constructor(){this.index=0,this.length=0,this.parent=null,this.parentContext=null}get event(){return VP.get()}get isEven(){return this.index%2==0}get isOdd(){return this.index%2!=0}get isFirst(){return 0===this.index}get isInMiddle(){return!this.isFirst&&!this.isLast}get isLast(){return this.index===this.length-1}static setEvent(t){VP.set(t)}}zP.defineProperty(ExecutionContext.prototype,"index"),zP.defineProperty(ExecutionContext.prototype,"length");const GP=Object.seal(new ExecutionContext);class HTMLDirective{constructor(){this.targetIndex=0}}class TargetedHTMLDirective extends HTMLDirective{constructor(){super(...arguments),this.createPlaceholder=jP.createInterpolationPlaceholder}}class AttachedBehaviorHTMLDirective extends HTMLDirective{constructor(t,o,s){super(),this.name=t,this.behavior=o,this.options=s}createPlaceholder(t){return jP.createCustomAttributePlaceholder(this.name,t)}createBehavior(t){return new this.behavior(t,this.options)}}function normalBind(t,o){this.source=t,this.context=o,null===this.bindingObserver&&(this.bindingObserver=zP.binding(this.binding,this,this.isBindingVolatile)),this.updateTarget(this.bindingObserver.observe(t,o))}function triggerBind(t,o){this.source=t,this.context=o,this.target.addEventListener(this.targetName,this)}function normalUnbind(){this.bindingObserver.disconnect(),this.source=null,this.context=null}function contentUnbind(){this.bindingObserver.disconnect(),this.source=null,this.context=null;const t=this.target.$fastView;void 0!==t&&t.isComposed&&(t.unbind(),t.needsBindOnly=!0)}function triggerUnbind(){this.target.removeEventListener(this.targetName,this),this.source=null,this.context=null}function updateAttributeTarget(t){jP.setAttribute(this.target,this.targetName,t)}function updateBooleanAttributeTarget(t){jP.setBooleanAttribute(this.target,this.targetName,t)}function updateContentTarget(t){if(null==t&&(t=""),t.create){this.target.textContent="";let o=this.target.$fastView;void 0===o?o=t.create():this.target.$fastTemplate!==t&&(o.isComposed&&(o.remove(),o.unbind()),o=t.create()),o.isComposed?o.needsBindOnly&&(o.needsBindOnly=!1,o.bind(this.source,this.context)):(o.isComposed=!0,o.bind(this.source,this.context),o.insertBefore(this.target),this.target.$fastView=o,this.target.$fastTemplate=t)}else{const o=this.target.$fastView;void 0!==o&&o.isComposed&&(o.isComposed=!1,o.remove(),o.needsBindOnly?o.needsBindOnly=!1:o.unbind()),this.target.textContent=t}}function updatePropertyTarget(t){this.target[this.targetName]=t}function updateClassTarget(t){const o=this.classVersions||Object.create(null),s=this.target;let l=this.version||0;if(null!=t&&t.length){const h=t.split(/\s+/);for(let t=0,m=h.length;t<m;++t){const m=h[t];""!==m&&(o[m]=l,s.classList.add(m))}}if(this.classVersions=o,this.version=l+1,0!==l){l-=1;for(const t in o)o[t]===l&&s.classList.remove(t)}}class HTMLBindingDirective extends TargetedHTMLDirective{constructor(t){super(),this.binding=t,this.bind=normalBind,this.unbind=normalUnbind,this.updateTarget=updateAttributeTarget,this.isBindingVolatile=zP.isVolatileBinding(this.binding)}get targetName(){return this.originalTargetName}set targetName(t){if(this.originalTargetName=t,void 0!==t)switch(t[0]){case":":if(this.cleanedTargetName=t.substr(1),this.updateTarget=updatePropertyTarget,"innerHTML"===this.cleanedTargetName){const t=this.binding;this.binding=(o,s)=>jP.createHTML(t(o,s))}break;case"?":this.cleanedTargetName=t.substr(1),this.updateTarget=updateBooleanAttributeTarget;break;case"@":this.cleanedTargetName=t.substr(1),this.bind=triggerBind,this.unbind=triggerUnbind;break;default:this.cleanedTargetName=t,"class"===t&&(this.updateTarget=updateClassTarget)}}targetAtContent(){this.updateTarget=updateContentTarget,this.unbind=contentUnbind}createBehavior(t){return new BindingBehavior(t,this.binding,this.isBindingVolatile,this.bind,this.unbind,this.updateTarget,this.cleanedTargetName)}}class BindingBehavior{constructor(t,o,s,l,h,m,_){this.source=null,this.context=null,this.bindingObserver=null,this.target=t,this.binding=o,this.isBindingVolatile=s,this.bind=l,this.unbind=h,this.updateTarget=m,this.targetName=_}handleChange(){this.updateTarget(this.bindingObserver.observe(this.source,this.context))}handleEvent(t){ExecutionContext.setEvent(t);const o=this.binding(this.source,this.context);ExecutionContext.setEvent(null),!0!==o&&t.preventDefault()}}let KP=null;class CompilationContext{addFactory(t){t.targetIndex=this.targetIndex,this.behaviorFactories.push(t)}captureContentBinding(t){t.targetAtContent(),this.addFactory(t)}reset(){this.behaviorFactories=[],this.targetIndex=-1}release(){KP=this}static borrow(t){const o=KP||new CompilationContext;return o.directives=t,o.reset(),KP=null,o}}function createAggregateBinding(t){if(1===t.length)return t[0];let o;const s=t.length,l=t.map((t=>"string"==typeof t?()=>t:(o=t.targetName||o,t.binding))),h=new HTMLBindingDirective(((t,o)=>{let h="";for(let m=0;m<s;++m)h+=l[m](t,o);return h}));return h.targetName=o,h}const WP=qP.length;function parseContent(t,o){const s=o.split(UP);if(1===s.length)return null;const l=[];for(let o=0,h=s.length;o<h;++o){const h=s[o],m=h.indexOf(qP);let _;if(-1===m)_=h;else{const o=parseInt(h.substring(0,m));l.push(t.directives[o]),_=h.substring(m+WP)}""!==_&&l.push(_)}return l}function compileAttributes(t,o,s=!1){const l=o.attributes;for(let h=0,m=l.length;h<m;++h){const _=l[h],E=_.value,$=parseContent(t,E);let B=null;null===$?s&&(B=new HTMLBindingDirective((()=>E)),B.targetName=_.name):B=createAggregateBinding($),null!==B&&(o.removeAttributeNode(_),h--,m--,t.addFactory(B))}}function compileContent(t,o,s){const l=parseContent(t,o.textContent);if(null!==l){let h=o;for(let m=0,_=l.length;m<_;++m){const _=l[m],E=0===m?o:h.parentNode.insertBefore(document.createTextNode(""),h.nextSibling);"string"==typeof _?E.textContent=_:(E.textContent=" ",t.captureContentBinding(_)),h=E,t.targetIndex++,E!==o&&s.nextNode()}t.targetIndex--}}const QP=document.createRange();class HTMLView{constructor(t,o){this.fragment=t,this.behaviors=o,this.source=null,this.context=null,this.firstChild=t.firstChild,this.lastChild=t.lastChild}appendTo(t){t.appendChild(this.fragment)}insertBefore(t){if(this.fragment.hasChildNodes())t.parentNode.insertBefore(this.fragment,t);else{const o=this.lastChild;if(t.previousSibling===o)return;const s=t.parentNode;let l,h=this.firstChild;for(;h!==o;)l=h.nextSibling,s.insertBefore(h,t),h=l;s.insertBefore(o,t)}}remove(){const t=this.fragment,o=this.lastChild;let s,l=this.firstChild;for(;l!==o;)s=l.nextSibling,t.appendChild(l),l=s;t.appendChild(o)}dispose(){const t=this.firstChild.parentNode,o=this.lastChild;let s,l=this.firstChild;for(;l!==o;)s=l.nextSibling,t.removeChild(l),l=s;t.removeChild(o);const h=this.behaviors,m=this.source;for(let t=0,o=h.length;t<o;++t)h[t].unbind(m)}bind(t,o){const s=this.behaviors;if(this.source!==t)if(null!==this.source){const l=this.source;this.source=t,this.context=o;for(let h=0,m=s.length;h<m;++h){const m=s[h];m.unbind(l),m.bind(t,o)}}else{this.source=t,this.context=o;for(let l=0,h=s.length;l<h;++l)s[l].bind(t,o)}}unbind(){if(null===this.source)return;const t=this.behaviors,o=this.source;for(let s=0,l=t.length;s<l;++s)t[s].unbind(o);this.source=null}static disposeContiguousBatch(t){if(0!==t.length){QP.setStartBefore(t[0].firstChild),QP.setEndAfter(t[t.length-1].lastChild),QP.deleteContents();for(let o=0,s=t.length;o<s;++o){const s=t[o],l=s.behaviors,h=s.source;for(let t=0,o=l.length;t<o;++t)l[t].unbind(h)}}}}class ViewTemplate{constructor(t,o){this.behaviorCount=0,this.hasHostBehaviors=!1,this.fragment=null,this.targetOffset=0,this.viewBehaviorFactories=null,this.hostBehaviorFactories=null,this.html=t,this.directives=o}create(t){if(null===this.fragment){let t;const o=this.html;if("string"==typeof o){t=document.createElement("template"),t.innerHTML=jP.createHTML(o);const s=t.content.firstElementChild;null!==s&&"TEMPLATE"===s.tagName&&(t=s)}else t=o;const s=function compileTemplate(t,o){const s=t.content;document.adoptNode(s);const l=CompilationContext.borrow(o);compileAttributes(l,t,!0);const h=l.behaviorFactories;l.reset();const m=jP.createTemplateWalker(s);let _;for(;_=m.nextNode();)switch(l.targetIndex++,_.nodeType){case 1:compileAttributes(l,_);break;case 3:compileContent(l,_,m);break;case 8:jP.isMarker(_)&&l.addFactory(o[jP.extractDirectiveIndexFromMarker(_)])}let E=0;(jP.isMarker(s.firstChild)||1===s.childNodes.length&&o.length)&&(s.insertBefore(document.createComment(""),s.firstChild),E=-1);const $=l.behaviorFactories;return l.release(),{fragment:s,viewBehaviorFactories:$,hostBehaviorFactories:h,targetOffset:E}}(t,this.directives);this.fragment=s.fragment,this.viewBehaviorFactories=s.viewBehaviorFactories,this.hostBehaviorFactories=s.hostBehaviorFactories,this.targetOffset=s.targetOffset,this.behaviorCount=this.viewBehaviorFactories.length+this.hostBehaviorFactories.length,this.hasHostBehaviors=this.hostBehaviorFactories.length>0}const o=this.fragment.cloneNode(!0),s=this.viewBehaviorFactories,l=new Array(this.behaviorCount),h=jP.createTemplateWalker(o);let m=0,_=this.targetOffset,E=h.nextNode();for(let t=s.length;m<t;++m){const t=s[m],o=t.targetIndex;for(;null!==E;){if(_===o){l[m]=t.createBehavior(E);break}E=h.nextNode(),_++}}if(this.hasHostBehaviors){const o=this.hostBehaviorFactories;for(let s=0,h=o.length;s<h;++s,++m)l[m]=o[s].createBehavior(t)}return new HTMLView(o,l)}render(t,o,s){"string"==typeof o&&(o=document.getElementById(o)),void 0===s&&(s=o);const l=this.create(s);return l.bind(t,GP),l.appendTo(o),l}}const YP=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function html(t,...o){const s=[];let l="";for(let h=0,m=t.length-1;h<m;++h){const m=t[h];let _=o[h];if(l+=m,_ instanceof ViewTemplate){const t=_;_=()=>t}if("function"==typeof _&&(_=new HTMLBindingDirective(_)),_ instanceof TargetedHTMLDirective){const t=YP.exec(m);null!==t&&(_.targetName=t[2])}_ instanceof HTMLDirective?(l+=_.createPlaceholder(s.length),s.push(_)):l+=_}return l+=t[t.length-1],new ViewTemplate(l,s)}class ElementStyles{constructor(){this.targets=new WeakSet}addStylesTo(t){this.targets.add(t)}removeStylesFrom(t){this.targets.delete(t)}isAttachedTo(t){return this.targets.has(t)}withBehaviors(...t){return this.behaviors=null===this.behaviors?t:this.behaviors.concat(t),this}}function reduceStyles(t){return t.map((t=>t instanceof ElementStyles?reduceStyles(t.styles):[t])).reduce(((t,o)=>t.concat(o)),[])}function reduceBehaviors(t){return t.map((t=>t instanceof ElementStyles?t.behaviors:null)).reduce(((t,o)=>null===o?t:(null===t&&(t=[]),t.concat(o))),null)}ElementStyles.create=(()=>{if(jP.supportsAdoptedStyleSheets){const t=new Map;return o=>new AdoptedStyleSheetsStyles(o,t)}return t=>new StyleElementStyles(t)})();let addAdoptedStyleSheets=(t,o)=>{t.adoptedStyleSheets=[...t.adoptedStyleSheets,...o]},removeAdoptedStyleSheets=(t,o)=>{t.adoptedStyleSheets=t.adoptedStyleSheets.filter((t=>-1===o.indexOf(t)))};if(jP.supportsAdoptedStyleSheets)try{document.adoptedStyleSheets.push(),document.adoptedStyleSheets.splice(),addAdoptedStyleSheets=(t,o)=>{t.adoptedStyleSheets.push(...o)},removeAdoptedStyleSheets=(t,o)=>{for(const s of o){const o=t.adoptedStyleSheets.indexOf(s);-1!==o&&t.adoptedStyleSheets.splice(o,1)}}}catch(e){}class AdoptedStyleSheetsStyles extends ElementStyles{constructor(t,o){super(),this.styles=t,this.styleSheetCache=o,this._styleSheets=void 0,this.behaviors=reduceBehaviors(t)}get styleSheets(){if(void 0===this._styleSheets){const t=this.styles,o=this.styleSheetCache;this._styleSheets=reduceStyles(t).map((t=>{if(t instanceof CSSStyleSheet)return t;let s=o.get(t);return void 0===s&&(s=new CSSStyleSheet,s.replaceSync(t),o.set(t,s)),s}))}return this._styleSheets}addStylesTo(t){addAdoptedStyleSheets(t,this.styleSheets),super.addStylesTo(t)}removeStylesFrom(t){removeAdoptedStyleSheets(t,this.styleSheets),super.removeStylesFrom(t)}}let ZP=0;class StyleElementStyles extends ElementStyles{constructor(t){super(),this.styles=t,this.behaviors=null,this.behaviors=reduceBehaviors(t),this.styleSheets=reduceStyles(t),this.styleClass=function getNextStyleClass(){return"fast-style-class-"+ ++ZP}()}addStylesTo(t){const o=this.styleSheets,s=this.styleClass;t=this.normalizeTarget(t);for(let l=0;l<o.length;l++){const h=document.createElement("style");h.innerHTML=o[l],h.className=s,t.append(h)}super.addStylesTo(t)}removeStylesFrom(t){const o=(t=this.normalizeTarget(t)).querySelectorAll(`.${this.styleClass}`);for(let s=0,l=o.length;s<l;++s)t.removeChild(o[s]);super.removeStylesFrom(t)}isAttachedTo(t){return super.isAttachedTo(this.normalizeTarget(t))}normalizeTarget(t){return t===document?document.body:t}}const JP=Object.freeze({locate:createMetadataLocator()}),XP={toView:t=>t?"true":"false",fromView:t=>null!=t&&"false"!==t&&!1!==t&&0!==t},eR={toView(t){if(null==t)return null;const o=1*t;return isNaN(o)?null:o.toString()},fromView(t){if(null==t)return null;const o=1*t;return isNaN(o)?null:o}};class AttributeDefinition{constructor(t,o,s=o.toLowerCase(),l="reflect",h){this.guards=new Set,this.Owner=t,this.name=o,this.attribute=s,this.mode=l,this.converter=h,this.fieldName=`_${o}`,this.callbackName=`${o}Changed`,this.hasCallback=this.callbackName in t.prototype,"boolean"===l&&void 0===h&&(this.converter=XP)}setValue(t,o){const s=t[this.fieldName],l=this.converter;void 0!==l&&(o=l.fromView(o)),s!==o&&(t[this.fieldName]=o,this.tryReflectToAttribute(t),this.hasCallback&&t[this.callbackName](s,o),t.$fastController.notify(this.name))}getValue(t){return zP.track(t,this.name),t[this.fieldName]}onAttributeChangedCallback(t,o){this.guards.has(t)||(this.guards.add(t),this.setValue(t,o),this.guards.delete(t))}tryReflectToAttribute(t){const o=this.mode,s=this.guards;s.has(t)||"fromView"===o||jP.queueUpdate((()=>{s.add(t);const l=t[this.fieldName];switch(o){case"reflect":const o=this.converter;jP.setAttribute(t,this.attribute,void 0!==o?o.toView(l):l);break;case"boolean":jP.setBooleanAttribute(t,this.attribute,l)}s.delete(t)}))}static collect(t,...o){const s=[];o.push(JP.locate(t));for(let l=0,h=o.length;l<h;++l){const h=o[l];if(void 0!==h)for(let o=0,l=h.length;o<l;++o){const l=h[o];"string"==typeof l?s.push(new AttributeDefinition(t,l)):s.push(new AttributeDefinition(t,l.property,l.attribute,l.mode,l.converter))}}return s}}function attr(t,o){let s;function decorator(t,o){arguments.length>1&&(s.property=o),JP.locate(t.constructor).push(s)}return arguments.length>1?(s={},void decorator(t,o)):(s=void 0===t?{}:t,decorator)}const tR={mode:"open"},rR={},oR=NP.getById(4,(()=>{const t=new Map;return Object.freeze({register:o=>!t.has(o.type)&&(t.set(o.type,o),!0),getByType:o=>t.get(o)})}));class FASTElementDefinition{constructor(t,o=t.definition){"string"==typeof o&&(o={name:o}),this.type=t,this.name=o.name,this.template=o.template;const s=AttributeDefinition.collect(t,o.attributes),l=new Array(s.length),h={},m={};for(let t=0,o=s.length;t<o;++t){const o=s[t];l[t]=o.attribute,h[o.name]=o,m[o.attribute]=o}this.attributes=s,this.observedAttributes=l,this.propertyLookup=h,this.attributeLookup=m,this.shadowOptions=void 0===o.shadowOptions?tR:null===o.shadowOptions?void 0:Object.assign(Object.assign({},tR),o.shadowOptions),this.elementOptions=void 0===o.elementOptions?rR:Object.assign(Object.assign({},rR),o.elementOptions),this.styles=void 0===o.styles?void 0:Array.isArray(o.styles)?ElementStyles.create(o.styles):o.styles instanceof ElementStyles?o.styles:ElementStyles.create([o.styles])}get isDefined(){return!!oR.getByType(this.type)}define(t=customElements){const o=this.type;if(oR.register(this)){const t=this.attributes,s=o.prototype;for(let o=0,l=t.length;o<l;++o)zP.defineProperty(s,t[o]);Reflect.defineProperty(o,"observedAttributes",{value:this.observedAttributes,enumerable:!0})}return t.get(this.name)||t.define(this.name,o,this.elementOptions),this}}FASTElementDefinition.forType=oR.getByType;const nR=new WeakMap,iR={bubbles:!0,composed:!0,cancelable:!0};function getShadowRoot(t){return t.shadowRoot||nR.get(t)||null}class Controller extends PropertyChangeNotifier{constructor(t,o){super(t),this.boundObservables=null,this.behaviors=null,this.needsInitialization=!0,this._template=null,this._styles=null,this._isConnected=!1,this.$fastController=this,this.view=null,this.element=t,this.definition=o;const s=o.shadowOptions;if(void 0!==s){const o=t.attachShadow(s);"closed"===s.mode&&nR.set(t,o)}const l=zP.getAccessors(t);if(l.length>0){const o=this.boundObservables=Object.create(null);for(let s=0,h=l.length;s<h;++s){const h=l[s].name,m=t[h];void 0!==m&&(delete t[h],o[h]=m)}}}get isConnected(){return zP.track(this,"isConnected"),this._isConnected}setIsConnected(t){this._isConnected=t,zP.notify(this,"isConnected")}get template(){return this._template}set template(t){this._template!==t&&(this._template=t,this.needsInitialization||this.renderTemplate(t))}get styles(){return this._styles}set styles(t){this._styles!==t&&(null!==this._styles&&this.removeStyles(this._styles),this._styles=t,this.needsInitialization||null===t||this.addStyles(t))}addStyles(t){const o=getShadowRoot(this.element)||this.element.getRootNode();if(t instanceof HTMLStyleElement)o.append(t);else if(!t.isAttachedTo(o)){const s=t.behaviors;t.addStylesTo(o),null!==s&&this.addBehaviors(s)}}removeStyles(t){const o=getShadowRoot(this.element)||this.element.getRootNode();if(t instanceof HTMLStyleElement)o.removeChild(t);else if(t.isAttachedTo(o)){const s=t.behaviors;t.removeStylesFrom(o),null!==s&&this.removeBehaviors(s)}}addBehaviors(t){const o=this.behaviors||(this.behaviors=new Map),s=t.length,l=[];for(let h=0;h<s;++h){const s=t[h];o.has(s)?o.set(s,o.get(s)+1):(o.set(s,1),l.push(s))}if(this._isConnected){const t=this.element;for(let o=0;o<l.length;++o)l[o].bind(t,GP)}}removeBehaviors(t,o=!1){const s=this.behaviors;if(null===s)return;const l=t.length,h=[];for(let m=0;m<l;++m){const l=t[m];if(s.has(l)){const t=s.get(l)-1;0===t||o?s.delete(l)&&h.push(l):s.set(l,t)}}if(this._isConnected){const t=this.element;for(let o=0;o<h.length;++o)h[o].unbind(t)}}onConnectedCallback(){if(this._isConnected)return;const t=this.element;this.needsInitialization?this.finishInitialization():null!==this.view&&this.view.bind(t,GP);const o=this.behaviors;if(null!==o)for(const[s]of o)s.bind(t,GP);this.setIsConnected(!0)}onDisconnectedCallback(){if(!this._isConnected)return;this.setIsConnected(!1);const t=this.view;null!==t&&t.unbind();const o=this.behaviors;if(null!==o){const t=this.element;for(const[s]of o)s.unbind(t)}}onAttributeChangedCallback(t,o,s){const l=this.definition.attributeLookup[t];void 0!==l&&l.onAttributeChangedCallback(this.element,s)}emit(t,o,s){return!!this._isConnected&&this.element.dispatchEvent(new CustomEvent(t,Object.assign(Object.assign({detail:o},iR),s)))}finishInitialization(){const t=this.element,o=this.boundObservables;if(null!==o){const s=Object.keys(o);for(let l=0,h=s.length;l<h;++l){const h=s[l];t[h]=o[h]}this.boundObservables=null}const s=this.definition;null===this._template&&(this.element.resolveTemplate?this._template=this.element.resolveTemplate():s.template&&(this._template=s.template||null)),null!==this._template&&this.renderTemplate(this._template),null===this._styles&&(this.element.resolveStyles?this._styles=this.element.resolveStyles():s.styles&&(this._styles=s.styles||null)),null!==this._styles&&this.addStyles(this._styles),this.needsInitialization=!1}renderTemplate(t){const o=this.element,s=getShadowRoot(o)||o;null!==this.view?(this.view.dispose(),this.view=null):this.needsInitialization||jP.removeChildNodes(s),t&&(this.view=t.render(o,s,o))}static forCustomElement(t){const o=t.$fastController;if(void 0!==o)return o;const s=FASTElementDefinition.forType(t.constructor);if(void 0===s)throw new Error("Missing FASTElement definition.");return t.$fastController=new Controller(t,s)}}function createFASTElement(t){return class extends t{constructor(){super(),Controller.forCustomElement(this)}$emit(t,o,s){return this.$fastController.emit(t,o,s)}connectedCallback(){this.$fastController.onConnectedCallback()}disconnectedCallback(){this.$fastController.onDisconnectedCallback()}attributeChangedCallback(t,o,s){this.$fastController.onAttributeChangedCallback(t,o,s)}}}const sR=Object.assign(createFASTElement(HTMLElement),{from:t=>createFASTElement(t),define:(t,o)=>new FASTElementDefinition(t,o).define().type});class CSSDirective{createCSS(){return""}createBehavior(){}}function collectStyles(t,o){const s=[];let l="";const h=[];for(let m=0,_=t.length-1;m<_;++m){l+=t[m];let _=o[m];if(_ instanceof CSSDirective){const t=_.createBehavior();_=_.createCSS(),t&&h.push(t)}_ instanceof ElementStyles||_ instanceof CSSStyleSheet?(""!==l.trim()&&(s.push(l),l=""),s.push(_)):l+=_}return l+=t[t.length-1],""!==l.trim()&&s.push(l),{styles:s,behaviors:h}}function css(t,...o){const{styles:s,behaviors:l}=collectStyles(t,o),h=ElementStyles.create(s);return l.length&&h.withBehaviors(...l),h}class CSSPartial extends CSSDirective{constructor(t,o){super(),this.behaviors=o,this.css="";const s=t.reduce(((t,o)=>("string"==typeof o?this.css+=o:t.push(o),t)),[]);s.length&&(this.styles=ElementStyles.create(s))}createBehavior(){return this}createCSS(){return this.css}bind(t){this.styles&&t.$fastController.addStyles(this.styles),this.behaviors.length&&t.$fastController.addBehaviors(this.behaviors)}unbind(t){this.styles&&t.$fastController.removeStyles(this.styles),this.behaviors.length&&t.$fastController.removeBehaviors(this.behaviors)}}function cssPartial(t,...o){const{styles:s,behaviors:l}=collectStyles(t,o);return new CSSPartial(s,l)}function newSplice(t,o,s){return{index:t,removed:o,addedCount:s}}const aR=0,lR=1,cR=2,dR=3;function calcSplices(t,o,s,l,h,m){let _=0,E=0;const $=Math.min(s-o,m-h);if(0===o&&0===h&&(_=function sharedPrefix(t,o,s){for(let l=0;l<s;++l)if(t[l]!==o[l])return l;return s}(t,l,$)),s===t.length&&m===l.length&&(E=function sharedSuffix(t,o,s){let l=t.length,h=o.length,m=0;for(;m<s&&t[--l]===o[--h];)m++;return m}(t,l,$-_)),h+=_,m-=E,(s-=E)-(o+=_)==0&&m-h==0)return DP;if(o===s){const t=newSplice(o,[],0);for(;h<m;)t.removed.push(l[h++]);return[t]}if(h===m)return[newSplice(o,[],s-o)];const B=function spliceOperationsFromEditDistances(t){let o=t.length-1,s=t[0].length-1,l=t[o][s];const h=[];for(;o>0||s>0;){if(0===o){h.push(cR),s--;continue}if(0===s){h.push(dR),o--;continue}const m=t[o-1][s-1],_=t[o-1][s],E=t[o][s-1];let $;$=_<E?_<m?_:m:E<m?E:m,$===m?(m===l?h.push(aR):(h.push(lR),l=m),o--,s--):$===_?(h.push(dR),o--,l=_):(h.push(cR),s--,l=E)}return h.reverse(),h}(function calcEditDistances(t,o,s,l,h,m){const _=m-h+1,E=s-o+1,$=new Array(_);let B,q;for(let t=0;t<_;++t)$[t]=new Array(E),$[t][0]=t;for(let t=0;t<E;++t)$[0][t]=t;for(let s=1;s<_;++s)for(let m=1;m<E;++m)t[o+m-1]===l[h+s-1]?$[s][m]=$[s-1][m-1]:(B=$[s-1][m]+1,q=$[s][m-1]+1,$[s][m]=B<q?B:q);return $}(t,o,s,l,h,m)),q=[];let j,K=o,W=h;for(let t=0;t<B.length;++t)switch(B[t]){case aR:void 0!==j&&(q.push(j),j=void 0),K++,W++;break;case lR:void 0===j&&(j=newSplice(K,[],0)),j.addedCount++,K++,j.removed.push(l[W]),W++;break;case cR:void 0===j&&(j=newSplice(K,[],0)),j.addedCount++,K++;break;case dR:void 0===j&&(j=newSplice(K,[],0)),j.removed.push(l[W]),W++}return void 0!==j&&q.push(j),q}const uR=Array.prototype.push;function mergeSplice(t,o,s,l){const h=newSplice(o,s,l);let m=!1,_=0;for(let o=0;o<t.length;o++){const s=t[o];if(s.index+=_,m)continue;const l=(E=h.index,$=h.index+h.removed.length,B=s.index,q=s.index+s.addedCount,$<B||q<E?-1:$===B||q===E?0:E<B?$<q?$-B:q-B:q<$?q-E:$-E);if(l>=0){t.splice(o,1),o--,_-=s.addedCount-s.removed.length,h.addedCount+=s.addedCount-l;const E=h.removed.length+s.removed.length-l;if(h.addedCount||E){let t=s.removed;if(h.index<s.index){const o=h.removed.slice(0,s.index-h.index);uR.apply(o,t),t=o}if(h.index+h.removed.length>s.index+s.addedCount){const o=h.removed.slice(s.index+s.addedCount-h.index);uR.apply(t,o)}h.removed=t,s.index<h.index&&(h.index=s.index)}else m=!0}else if(h.index<s.index){m=!0,t.splice(o,0,h),o++;const l=h.addedCount-h.removed.length;s.index+=l,_+=l}}var E,$,B,q;m||t.push(h)}function projectArraySplices(t,o){let s=[];const l=function createInitialSplices(t){const o=[];for(let s=0,l=t.length;s<l;s++){const l=t[s];mergeSplice(o,l.index,l.removed,l.addedCount)}return o}(o);for(let o=0,h=l.length;o<h;++o){const h=l[o];1!==h.addedCount||1!==h.removed.length?s=s.concat(calcSplices(t,h.index,h.index+h.addedCount,h.removed,0,h.removed.length)):h.removed[0]!==t[h.index]&&s.push(h)}return s}let hR=!1;function adjustIndex(t,o){let s=t.index;const l=o.length;return s>l?s=l-t.addedCount:s<0&&(s=l+t.removed.length+s-t.addedCount),s<0&&(s=0),t.index=s,t}class ArrayObserver extends SubscriberSet{constructor(t){super(t),this.oldCollection=void 0,this.splices=void 0,this.needsQueue=!0,this.call=this.flush,Reflect.defineProperty(t,"$fastController",{value:this,enumerable:!1})}subscribe(t){this.flush(),super.subscribe(t)}addSplice(t){void 0===this.splices?this.splices=[t]:this.splices.push(t),this.needsQueue&&(this.needsQueue=!1,jP.queueUpdate(this))}reset(t){this.oldCollection=t,this.needsQueue&&(this.needsQueue=!1,jP.queueUpdate(this))}flush(){const t=this.splices,o=this.oldCollection;if(void 0===t&&void 0===o)return;this.needsQueue=!0,this.splices=void 0,this.oldCollection=void 0;const s=void 0===o?projectArraySplices(this.source,t):calcSplices(this.source,0,this.source.length,o,0,o.length);this.notify(s)}}class RefBehavior{constructor(t,o){this.target=t,this.propertyName=o}bind(t){t[this.propertyName]=this.target}unbind(){}}function ref(t){return new AttachedBehaviorHTMLDirective("fast-ref",RefBehavior,t)}const isFunction=t=>"function"==typeof t,noTemplate=()=>null;function normalizeBinding(t){return void 0===t?noTemplate:isFunction(t)?t:()=>t}function when(t,o,s){const l=isFunction(t)?t:()=>t,h=normalizeBinding(o),m=normalizeBinding(s);return(t,o)=>l(t,o)?h(t,o):m(t,o)}const pR=Object.freeze({positioning:!1,recycle:!0});function bindWithoutPositioning(t,o,s,l){t.bind(o[s],l)}function bindWithPositioning(t,o,s,l){const h=Object.create(l);h.index=s,h.length=o.length,t.bind(o[s],h)}class RepeatBehavior{constructor(t,o,s,l,h,m){this.location=t,this.itemsBinding=o,this.templateBinding=l,this.options=m,this.source=null,this.views=[],this.items=null,this.itemsObserver=null,this.originalContext=void 0,this.childContext=void 0,this.bindView=bindWithoutPositioning,this.itemsBindingObserver=zP.binding(o,this,s),this.templateBindingObserver=zP.binding(l,this,h),m.positioning&&(this.bindView=bindWithPositioning)}bind(t,o){this.source=t,this.originalContext=o,this.childContext=Object.create(o),this.childContext.parent=t,this.childContext.parentContext=this.originalContext,this.items=this.itemsBindingObserver.observe(t,this.originalContext),this.template=this.templateBindingObserver.observe(t,this.originalContext),this.observeItems(!0),this.refreshAllViews()}unbind(){this.source=null,this.items=null,null!==this.itemsObserver&&this.itemsObserver.unsubscribe(this),this.unbindAllViews(),this.itemsBindingObserver.disconnect(),this.templateBindingObserver.disconnect()}handleChange(t,o){t===this.itemsBinding?(this.items=this.itemsBindingObserver.observe(this.source,this.originalContext),this.observeItems(),this.refreshAllViews()):t===this.templateBinding?(this.template=this.templateBindingObserver.observe(this.source,this.originalContext),this.refreshAllViews(!0)):this.updateViews(o)}observeItems(t=!1){if(!this.items)return void(this.items=DP);const o=this.itemsObserver,s=this.itemsObserver=zP.getNotifier(this.items),l=o!==s;l&&null!==o&&o.unsubscribe(this),(l||t)&&s.subscribe(this)}updateViews(t){const o=this.childContext,s=this.views,l=this.bindView,h=this.items,m=this.template,_=this.options.recycle,E=[];let $=0,B=0;for(let q=0,j=t.length;q<j;++q){const j=t[q],K=j.removed;let W=0,X=j.index;const re=X+j.addedCount,oe=s.splice(j.index,K.length),ne=B=E.length+oe.length;for(;X<re;++X){const t=s[X],q=t?t.firstChild:this.location;let j;_&&B>0?(W<=ne&&oe.length>0?(j=oe[W],W++):(j=E[$],$++),B--):j=m.create(),s.splice(X,0,j),l(j,h,X,o),j.insertBefore(q)}oe[W]&&E.push(...oe.slice(W))}for(let t=$,o=E.length;t<o;++t)E[t].dispose();if(this.options.positioning)for(let t=0,o=s.length;t<o;++t){const l=s[t].context;l.length=o,l.index=t}}refreshAllViews(t=!1){const o=this.items,s=this.childContext,l=this.template,h=this.location,m=this.bindView;let _=o.length,E=this.views,$=E.length;if(0!==_&&!t&&this.options.recycle||(HTMLView.disposeContiguousBatch(E),$=0),0===$){this.views=E=new Array(_);for(let t=0;t<_;++t){const _=l.create();m(_,o,t,s),E[t]=_,_.insertBefore(h)}}else{let t=0;for(;t<_;++t)if(t<$){m(E[t],o,t,s)}else{const _=l.create();m(_,o,t,s),E.push(_),_.insertBefore(h)}const B=E.splice(t,$-t);for(t=0,_=B.length;t<_;++t)B[t].dispose()}}unbindAllViews(){const t=this.views;for(let o=0,s=t.length;o<s;++o)t[o].unbind()}}class RepeatDirective extends HTMLDirective{constructor(t,o,s){super(),this.itemsBinding=t,this.templateBinding=o,this.options=s,this.createPlaceholder=jP.createBlockPlaceholder,function enableArrayObservation(){if(hR)return;hR=!0,zP.setArrayObserverFactory((t=>new ArrayObserver(t)));const t=Array.prototype;if(t.$fastPatch)return;Reflect.defineProperty(t,"$fastPatch",{value:1,enumerable:!1});const o=t.pop,s=t.push,l=t.reverse,h=t.shift,m=t.sort,_=t.splice,E=t.unshift;t.pop=function(){const t=this.length>0,s=o.apply(this,arguments),l=this.$fastController;return void 0!==l&&t&&l.addSplice(newSplice(this.length,[s],0)),s},t.push=function(){const t=s.apply(this,arguments),o=this.$fastController;return void 0!==o&&o.addSplice(adjustIndex(newSplice(this.length-arguments.length,[],arguments.length),this)),t},t.reverse=function(){let t;const o=this.$fastController;void 0!==o&&(o.flush(),t=this.slice());const s=l.apply(this,arguments);return void 0!==o&&o.reset(t),s},t.shift=function(){const t=this.length>0,o=h.apply(this,arguments),s=this.$fastController;return void 0!==s&&t&&s.addSplice(newSplice(0,[o],0)),o},t.sort=function(){let t;const o=this.$fastController;void 0!==o&&(o.flush(),t=this.slice());const s=m.apply(this,arguments);return void 0!==o&&o.reset(t),s},t.splice=function(){const t=_.apply(this,arguments),o=this.$fastController;return void 0!==o&&o.addSplice(adjustIndex(newSplice(+arguments[0],t,arguments.length>2?arguments.length-2:0),this)),t},t.unshift=function(){const t=E.apply(this,arguments),o=this.$fastController;return void 0!==o&&o.addSplice(adjustIndex(newSplice(0,[],arguments.length),this)),t}}(),this.isItemsBindingVolatile=zP.isVolatileBinding(t),this.isTemplateBindingVolatile=zP.isVolatileBinding(o)}createBehavior(t){return new RepeatBehavior(t,this.itemsBinding,this.isItemsBindingVolatile,this.templateBinding,this.isTemplateBindingVolatile,this.options)}}function repeat(t,o,s=pR){return new RepeatDirective(t,"function"==typeof o?o:()=>o,Object.assign(Object.assign({},pR),s))}function elements(t){return t?function(o,s,l){return 1===o.nodeType&&o.matches(t)}:function(t,o,s){return 1===t.nodeType}}class NodeObservationBehavior{constructor(t,o){this.target=t,this.options=o,this.source=null}bind(t){const o=this.options.property;this.shouldUpdate=zP.getAccessors(t).some((t=>t.name===o)),this.source=t,this.updateTarget(this.computeNodes()),this.shouldUpdate&&this.observe()}unbind(){this.updateTarget(DP),this.source=null,this.shouldUpdate&&this.disconnect()}handleEvent(){this.updateTarget(this.computeNodes())}computeNodes(){let t=this.getNodes();return void 0!==this.options.filter&&(t=t.filter(this.options.filter)),t}updateTarget(t){this.source[this.options.property]=t}}class SlottedBehavior extends NodeObservationBehavior{constructor(t,o){super(t,o)}observe(){this.target.addEventListener("slotchange",this)}disconnect(){this.target.removeEventListener("slotchange",this)}getNodes(){return this.target.assignedNodes(this.options)}}function slotted(t){return"string"==typeof t&&(t={property:t}),new AttachedBehaviorHTMLDirective("fast-slotted",SlottedBehavior,t)}class ChildrenBehavior extends NodeObservationBehavior{constructor(t,o){super(t,o),this.observer=null,o.childList=!0}observe(){null===this.observer&&(this.observer=new MutationObserver(this.handleEvent.bind(this))),this.observer.observe(this.target,this.options)}disconnect(){this.observer.disconnect()}getNodes(){return"subtree"in this.options?Array.from(this.target.querySelectorAll(this.options.selector)):Array.from(this.target.childNodes)}}class StartEnd{handleStartContentChange(){this.startContainer.classList.toggle("start",this.start.assignedNodes().length>0)}handleEndContentChange(){this.endContainer.classList.toggle("end",this.end.assignedNodes().length>0)}}const endSlotTemplate=(t,o)=>html`
    <span
        part="end"
        ${ref("endContainer")}
        class=${t=>o.end?"end":void 0}
    >
        <slot name="end" ${ref("end")} @slotchange="${t=>t.handleEndContentChange()}">
            ${o.end||""}
        </slot>
    </span>
`,startSlotTemplate=(t,o)=>html`
    <span
        part="start"
        ${ref("startContainer")}
        class="${t=>o.start?"start":void 0}"
    >
        <slot
            name="start"
            ${ref("start")}
            @slotchange="${t=>t.handleStartContentChange()}"
        >
            ${o.start||""}
        </slot>
    </span>
`,fR=html`
    <span part="end" ${ref("endContainer")}>
        <slot
            name="end"
            ${ref("end")}
            @slotchange="${t=>t.handleEndContentChange()}"
        ></slot>
    </span>
`,gR=html`
    <span part="start" ${ref("startContainer")}>
        <slot
            name="start"
            ${ref("start")}
            @slotchange="${t=>t.handleStartContentChange()}"
        ></slot>
    </span>
`
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */;function __decorate$t(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_}const vR=new Map;"metadata"in Reflect||(Reflect.metadata=function(t,o){return function(s){Reflect.defineMetadata(t,o,s)}},Reflect.defineMetadata=function(t,o,s){let l=vR.get(s);void 0===l&&vR.set(s,l=new Map),l.set(t,o)},Reflect.getOwnMetadata=function(t,o){const s=vR.get(o);if(void 0!==s)return s.get(t)});class ResolverBuilder{constructor(t,o){this.container=t,this.key=o}instance(t){return this.registerResolver(0,t)}singleton(t){return this.registerResolver(1,t)}transient(t){return this.registerResolver(2,t)}callback(t){return this.registerResolver(3,t)}cachedCallback(t){return this.registerResolver(3,cacheCallbackResult(t))}aliasTo(t){return this.registerResolver(5,t)}registerResolver(t,o){const{container:s,key:l}=this;return this.container=this.key=void 0,s.registerResolver(l,new ResolverImpl(l,t,o))}}function cloneArrayWithPossibleProps(t){const o=t.slice(),s=Object.keys(t),l=s.length;let h;for(let m=0;m<l;++m)h=s[m],isArrayIndex(h)||(o[h]=t[h]);return o}const mR=Object.freeze({none(t){throw Error(`${t.toString()} not registered, did you forget to add @singleton()?`)},singleton:t=>new ResolverImpl(t,1,t),transient:t=>new ResolverImpl(t,2,t)}),yR=Object.freeze({default:Object.freeze({parentLocator:()=>null,responsibleForOwnerRequests:!1,defaultResolver:mR.singleton})}),bR=new Map;function getParamTypes(t){return o=>Reflect.getOwnMetadata(t,o)}let wR=null;const CR=Object.freeze({createContainer:t=>new ContainerImpl(null,Object.assign({},yR.default,t)),findResponsibleContainer(t){const o=t.$$container$$;return o&&o.responsibleForOwnerRequests?o:CR.findParentContainer(t)},findParentContainer(t){const o=new CustomEvent(TR,{bubbles:!0,composed:!0,cancelable:!0,detail:{container:void 0}});return t.dispatchEvent(o),o.detail.container||CR.getOrCreateDOMContainer()},getOrCreateDOMContainer:(t,o)=>t?t.$$container$$||new ContainerImpl(t,Object.assign({},yR.default,o,{parentLocator:CR.findParentContainer})):wR||(wR=new ContainerImpl(null,Object.assign({},yR.default,o,{parentLocator:()=>null}))),getDesignParamtypes:getParamTypes("design:paramtypes"),getAnnotationParamtypes:getParamTypes("di:paramtypes"),getOrCreateAnnotationParamTypes(t){let o=this.getAnnotationParamtypes(t);return void 0===o&&Reflect.defineMetadata("di:paramtypes",o=[],t),o},getDependencies(t){let o=bR.get(t);if(void 0===o){const s=t.inject;if(void 0===s){const s=CR.getDesignParamtypes(t),l=CR.getAnnotationParamtypes(t);if(void 0===s)if(void 0===l){const s=Object.getPrototypeOf(t);o="function"==typeof s&&s!==Function.prototype?cloneArrayWithPossibleProps(CR.getDependencies(s)):[]}else o=cloneArrayWithPossibleProps(l);else if(void 0===l)o=cloneArrayWithPossibleProps(s);else{o=cloneArrayWithPossibleProps(s);let t,h=l.length;for(let s=0;s<h;++s)t=l[s],void 0!==t&&(o[s]=t);const m=Object.keys(l);let _;h=m.length;for(let t=0;t<h;++t)_=m[t],isArrayIndex(_)||(o[_]=l[_])}}else o=cloneArrayWithPossibleProps(s);bR.set(t,o)}return o},defineProperty(t,o,s,l=!1){const h=`$di_${o}`;Reflect.defineProperty(t,o,{get:function(){let t=this[h];if(void 0===t){const m=this instanceof HTMLElement?CR.findResponsibleContainer(this):CR.getOrCreateDOMContainer();if(t=m.get(s),this[h]=t,l&&this instanceof sR){const l=this.$fastController,handleChange=()=>{CR.findResponsibleContainer(this).get(s)!==this[h]&&(this[h]=t,l.notify(o))};l.subscribe({handleChange:handleChange},"isConnected")}}return t}})},createInterface(t,o){const s="function"==typeof t?t:o,l="string"==typeof t?t:t&&"friendlyName"in t&&t.friendlyName||PR,h="string"!=typeof t&&(t&&"respectConnection"in t&&t.respectConnection||!1),Interface=function(t,o,s){if(null==t||void 0!==new.target)throw new Error(`No registration for interface: '${Interface.friendlyName}'`);if(o)CR.defineProperty(t,o,Interface,h);else{CR.getOrCreateAnnotationParamTypes(t)[s]=Interface}};return Interface.$isInterface=!0,Interface.friendlyName=null==l?"(anonymous)":l,null!=s&&(Interface.register=function(t,o){return s(new ResolverBuilder(t,null!=o?o:Interface))}),Interface.toString=function toString(){return`InterfaceSymbol<${Interface.friendlyName}>`},Interface},inject:(...t)=>function(o,s,l){if("number"==typeof l){const s=CR.getOrCreateAnnotationParamTypes(o),h=t[0];void 0!==h&&(s[l]=h)}else if(s)CR.defineProperty(o,s,t[0]);else{const s=l?CR.getOrCreateAnnotationParamTypes(l.value):CR.getOrCreateAnnotationParamTypes(o);let h;for(let o=0;o<t.length;++o)h=t[o],void 0!==h&&(s[o]=h)}},transient:t=>(t.register=function register(o){return IR.transient(t,t).register(o)},t.registerInRequestor=!1,t),singleton:(t,o=kR)=>(t.register=function register(o){return IR.singleton(t,t).register(o)},t.registerInRequestor=o.scoped,t)}),_R=CR.createInterface("Container");CR.inject;const kR={scoped:!1};class ResolverImpl{constructor(t,o,s){this.key=t,this.strategy=o,this.state=s,this.resolving=!1}get $isResolver(){return!0}register(t){return t.registerResolver(this.key,this)}resolve(t,o){switch(this.strategy){case 0:return this.state;case 1:if(this.resolving)throw new Error(`Cyclic dependency found: ${this.state.name}`);return this.resolving=!0,this.state=t.getFactory(this.state).construct(o),this.strategy=0,this.resolving=!1,this.state;case 2:{const s=t.getFactory(this.state);if(null===s)throw new Error(`Resolver for ${String(this.key)} returned a null factory`);return s.construct(o)}case 3:return this.state(t,o,this);case 4:return this.state[0].resolve(t,o);case 5:return o.get(this.state);default:throw new Error(`Invalid resolver strategy specified: ${this.strategy}.`)}}getFactory(t){var o,s,l;switch(this.strategy){case 1:case 2:return t.getFactory(this.state);case 5:return null!==(l=null===(s=null===(o=t.getResolver(this.state))||void 0===o?void 0:o.getFactory)||void 0===s?void 0:s.call(o,t))&&void 0!==l?l:null;default:return null}}}function containerGetKey(t){return this.get(t)}function transformInstance(t,o){return o(t)}class FactoryImpl{constructor(t,o){this.Type=t,this.dependencies=o,this.transformers=null}construct(t,o){let s;return s=void 0===o?new this.Type(...this.dependencies.map(containerGetKey,t)):new this.Type(...this.dependencies.map(containerGetKey,t),...o),null==this.transformers?s:this.transformers.reduce(transformInstance,s)}registerTransformer(t){(this.transformers||(this.transformers=[])).push(t)}}const xR={$isResolver:!0,resolve:(t,o)=>o};function isRegistry(t){return"function"==typeof t.register}function isRegisterInRequester(t){return function isSelfRegistry(t){return isRegistry(t)&&"boolean"==typeof t.registerInRequestor}(t)&&t.registerInRequestor}const SR=new Set(["Array","ArrayBuffer","Boolean","DataView","Date","Error","EvalError","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Number","Object","Promise","RangeError","ReferenceError","RegExp","Set","SharedArrayBuffer","String","SyntaxError","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","URIError","WeakMap","WeakSet"]),TR="__DI_LOCATE_PARENT__",ER=new Map;class ContainerImpl{constructor(t,o){this.owner=t,this.config=o,this._parent=void 0,this.registerDepth=0,this.context=null,null!==t&&(t.$$container$$=this),this.resolvers=new Map,this.resolvers.set(_R,xR),t instanceof Node&&t.addEventListener(TR,(t=>{t.composedPath()[0]!==this.owner&&(t.detail.container=this,t.stopImmediatePropagation())}))}get parent(){return void 0===this._parent&&(this._parent=this.config.parentLocator(this.owner)),this._parent}get depth(){return null===this.parent?0:this.parent.depth+1}get responsibleForOwnerRequests(){return this.config.responsibleForOwnerRequests}registerWithContext(t,...o){return this.context=t,this.register(...o),this.context=null,this}register(...t){if(100==++this.registerDepth)throw new Error("Unable to autoregister dependency");let o,s,l,h,m;const _=this.context;for(let E=0,$=t.length;E<$;++E)if(o=t[E],isObject(o))if(isRegistry(o))o.register(this,_);else if(void 0!==o.prototype)IR.singleton(o,o).register(this);else for(s=Object.keys(o),h=0,m=s.length;h<m;++h)l=o[s[h]],isObject(l)&&(isRegistry(l)?l.register(this,_):this.register(l));return--this.registerDepth,this}registerResolver(t,o){validateKey(t);const s=this.resolvers,l=s.get(t);return null==l?s.set(t,o):l instanceof ResolverImpl&&4===l.strategy?l.state.push(o):s.set(t,new ResolverImpl(t,4,[l,o])),o}registerTransformer(t,o){const s=this.getResolver(t);if(null==s)return!1;if(s.getFactory){const t=s.getFactory(this);return null!=t&&(t.registerTransformer(o),!0)}return!1}getResolver(t,o=!0){if(validateKey(t),void 0!==t.resolve)return t;let s,l=this;for(;null!=l;){if(s=l.resolvers.get(t),null!=s)return s;if(null==l.parent){const s=isRegisterInRequester(t)?this:l;return o?this.jitRegister(t,s):null}l=l.parent}return null}has(t,o=!1){return!!this.resolvers.has(t)||!(!o||null==this.parent)&&this.parent.has(t,!0)}get(t){if(validateKey(t),t.$isResolver)return t.resolve(this,this);let o,s=this;for(;null!=s;){if(o=s.resolvers.get(t),null!=o)return o.resolve(s,this);if(null==s.parent){const l=isRegisterInRequester(t)?this:s;return o=this.jitRegister(t,l),o.resolve(s,this)}s=s.parent}throw new Error(`Unable to resolve key: ${t}`)}getAll(t,o=!1){validateKey(t);const s=this;let l,h=s;if(o){let o=DP;for(;null!=h;)l=h.resolvers.get(t),null!=l&&(o=o.concat(buildAllResponse(l,h,s))),h=h.parent;return o}for(;null!=h;){if(l=h.resolvers.get(t),null!=l)return buildAllResponse(l,h,s);if(h=h.parent,null==h)return DP}return DP}getFactory(t){let o=ER.get(t);if(void 0===o){if(RR(t))throw new Error(`${t.name} is a native function and therefore cannot be safely constructed by DI. If this is intentional, please use a callback or cachedCallback resolver.`);ER.set(t,o=new FactoryImpl(t,CR.getDependencies(t)))}return o}registerFactory(t,o){ER.set(t,o)}createChild(t){return new ContainerImpl(null,Object.assign({},this.config,t,{parentLocator:()=>this}))}jitRegister(t,o){if("function"!=typeof t)throw new Error(`Attempted to jitRegister something that is not a constructor: '${t}'. Did you forget to register this dependency?`);if(SR.has(t.name))throw new Error(`Attempted to jitRegister an intrinsic type: ${t.name}. Did you forget to add @inject(Key)`);if(isRegistry(t)){const s=t.register(o);if(!(s instanceof Object)||null==s.resolve){const s=o.resolvers.get(t);if(null!=s)return s;throw new Error("A valid resolver was not returned from the static register method")}return s}if(t.$isInterface)throw new Error(`Attempted to jitRegister an interface: ${t.friendlyName}`);{const s=this.config.defaultResolver(t,o);return o.resolvers.set(t,s),s}}}const AR=new WeakMap;function cacheCallbackResult(t){return function(o,s,l){if(AR.has(l))return AR.get(l);const h=t(o,s,l);return AR.set(l,h),h}}const IR=Object.freeze({instance:(t,o)=>new ResolverImpl(t,0,o),singleton:(t,o)=>new ResolverImpl(t,1,o),transient:(t,o)=>new ResolverImpl(t,2,o),callback:(t,o)=>new ResolverImpl(t,3,o),cachedCallback:(t,o)=>new ResolverImpl(t,3,cacheCallbackResult(o)),aliasTo:(t,o)=>new ResolverImpl(o,5,t)});function validateKey(t){if(null==t)throw new Error("key/value cannot be null or undefined. Are you trying to inject/register something that doesn't exist with DI?")}function buildAllResponse(t,o,s){if(t instanceof ResolverImpl&&4===t.strategy){const l=t.state;let h=l.length;const m=new Array(h);for(;h--;)m[h]=l[h].resolve(o,s);return m}return[t.resolve(o,s)]}const PR="(anonymous)";function isObject(t){return"object"==typeof t&&null!==t||"function"==typeof t}const RR=function(){const t=new WeakMap;let o=!1,s="",l=0;return function(h){return o=t.get(h),void 0===o&&(s=h.toString(),l=s.length,o=l>=29&&l<=100&&125===s.charCodeAt(l-1)&&s.charCodeAt(l-2)<=32&&93===s.charCodeAt(l-3)&&101===s.charCodeAt(l-4)&&100===s.charCodeAt(l-5)&&111===s.charCodeAt(l-6)&&99===s.charCodeAt(l-7)&&32===s.charCodeAt(l-8)&&101===s.charCodeAt(l-9)&&118===s.charCodeAt(l-10)&&105===s.charCodeAt(l-11)&&116===s.charCodeAt(l-12)&&97===s.charCodeAt(l-13)&&110===s.charCodeAt(l-14)&&88===s.charCodeAt(l-15),t.set(h,o)),o}}(),$R={};function isArrayIndex(t){switch(typeof t){case"number":return t>=0&&(0|t)===t;case"string":{const o=$R[t];if(void 0!==o)return o;const s=t.length;if(0===s)return $R[t]=!1;let l=0;for(let o=0;o<s;++o)if(l=t.charCodeAt(o),0===o&&48===l&&s>1||l<48||l>57)return $R[t]=!1;return $R[t]=!0}default:return!1}}function presentationKeyFromTag(t){return`${t.toLowerCase()}:presentation`}const MR=new Map,OR=Object.freeze({define(t,o,s){const l=presentationKeyFromTag(t);void 0===MR.get(l)?MR.set(l,o):MR.set(l,!1),s.register(IR.instance(l,o))},forTag(t,o){const s=presentationKeyFromTag(t),l=MR.get(s);if(!1===l){return CR.findResponsibleContainer(o).get(s)}return l||null}});class DefaultComponentPresentation{constructor(t,o){this.template=t||null,this.styles=void 0===o?null:Array.isArray(o)?ElementStyles.create(o):o instanceof ElementStyles?o:ElementStyles.create([o])}applyTo(t){const o=t.$fastController;null===o.template&&(o.template=this.template),null===o.styles&&(o.styles=this.styles)}}class FoundationElement extends sR{constructor(){super(...arguments),this._presentation=void 0}get $presentation(){return void 0===this._presentation&&(this._presentation=OR.forTag(this.tagName,this)),this._presentation}templateChanged(){void 0!==this.template&&(this.$fastController.template=this.template)}stylesChanged(){void 0!==this.styles&&(this.$fastController.styles=this.styles)}connectedCallback(){null!==this.$presentation&&this.$presentation.applyTo(this),super.connectedCallback()}static compose(t){return(o={})=>new FoundationElementRegistry(this===FoundationElement?class extends FoundationElement{}:this,t,o)}}function resolveOption(t,o,s){return"function"==typeof t?t(o,s):t}__decorate$t([observable],FoundationElement.prototype,"template",void 0),__decorate$t([observable],FoundationElement.prototype,"styles",void 0);class FoundationElementRegistry{constructor(t,o,s){this.type=t,this.elementDefinition=o,this.overrideDefinition=s,this.definition=Object.assign(Object.assign({},this.elementDefinition),this.overrideDefinition)}register(t,o){const s=this.definition,l=this.overrideDefinition,h=`${s.prefix||o.elementPrefix}-${s.baseName}`;o.tryDefineElement({name:h,type:this.type,baseClass:this.elementDefinition.baseClass,callback:t=>{const o=new DefaultComponentPresentation(resolveOption(s.template,t,s),resolveOption(s.styles,t,s));t.definePresentation(o);let h=resolveOption(s.shadowOptions,t,s);t.shadowRootMode&&(h?l.shadowOptions||(h.mode=t.shadowRootMode):null!==h&&(h={mode:t.shadowRootMode})),t.defineElement({elementOptions:resolveOption(s.elementOptions,t,s),shadowOptions:h,attributes:resolveOption(s.attributes,t,s)})}})}}function applyMixins(t,...o){const s=JP.locate(t);o.forEach((o=>{Object.getOwnPropertyNames(o.prototype).forEach((s=>{"constructor"!==s&&Object.defineProperty(t.prototype,s,Object.getOwnPropertyDescriptor(o.prototype,s))}));JP.locate(o).forEach((t=>s.push(t)))}))}const NR="horizontal";function isHTMLElement(...t){return t.every((t=>t instanceof HTMLElement))}let DR;const LR="focus",FR="focusin",BR="focusout",HR="keydown",UR="resize",qR="scroll";var jR;!function(t){t[t.alt=18]="alt",t[t.arrowDown=40]="arrowDown",t[t.arrowLeft=37]="arrowLeft",t[t.arrowRight=39]="arrowRight",t[t.arrowUp=38]="arrowUp",t[t.back=8]="back",t[t.backSlash=220]="backSlash",t[t.break=19]="break",t[t.capsLock=20]="capsLock",t[t.closeBracket=221]="closeBracket",t[t.colon=186]="colon",t[t.colon2=59]="colon2",t[t.comma=188]="comma",t[t.ctrl=17]="ctrl",t[t.delete=46]="delete",t[t.end=35]="end",t[t.enter=13]="enter",t[t.equals=187]="equals",t[t.equals2=61]="equals2",t[t.equals3=107]="equals3",t[t.escape=27]="escape",t[t.forwardSlash=191]="forwardSlash",t[t.function1=112]="function1",t[t.function10=121]="function10",t[t.function11=122]="function11",t[t.function12=123]="function12",t[t.function2=113]="function2",t[t.function3=114]="function3",t[t.function4=115]="function4",t[t.function5=116]="function5",t[t.function6=117]="function6",t[t.function7=118]="function7",t[t.function8=119]="function8",t[t.function9=120]="function9",t[t.home=36]="home",t[t.insert=45]="insert",t[t.menu=93]="menu",t[t.minus=189]="minus",t[t.minus2=109]="minus2",t[t.numLock=144]="numLock",t[t.numPad0=96]="numPad0",t[t.numPad1=97]="numPad1",t[t.numPad2=98]="numPad2",t[t.numPad3=99]="numPad3",t[t.numPad4=100]="numPad4",t[t.numPad5=101]="numPad5",t[t.numPad6=102]="numPad6",t[t.numPad7=103]="numPad7",t[t.numPad8=104]="numPad8",t[t.numPad9=105]="numPad9",t[t.numPadDivide=111]="numPadDivide",t[t.numPadDot=110]="numPadDot",t[t.numPadMinus=109]="numPadMinus",t[t.numPadMultiply=106]="numPadMultiply",t[t.numPadPlus=107]="numPadPlus",t[t.openBracket=219]="openBracket",t[t.pageDown=34]="pageDown",t[t.pageUp=33]="pageUp",t[t.period=190]="period",t[t.print=44]="print",t[t.quote=222]="quote",t[t.scrollLock=145]="scrollLock",t[t.shift=16]="shift",t[t.space=32]="space",t[t.tab=9]="tab",t[t.tilde=192]="tilde",t[t.windowsLeft=91]="windowsLeft",t[t.windowsOpera=219]="windowsOpera",t[t.windowsRight=92]="windowsRight"}(jR||(jR={}));const zR="ArrowDown",VR="ArrowLeft",GR="ArrowRight",KR="ArrowUp",WR="Enter",QR="Escape",YR="Home",ZR="End",JR=" ",XR="Tab",e$={ArrowDown:zR,ArrowLeft:VR,ArrowRight:GR,ArrowUp:KR};var t$;function limit(t,o,s){return Math.min(Math.max(s,t),o)}function inRange(t,o,s=0){return[o,s]=[o,s].sort(((t,o)=>t-o)),o<=t&&t<s}!function(t){t.ltr="ltr",t.rtl="rtl"}(t$||(t$={}));let r$=0;function uniqueId(t=""){return`${t}${r$++}`}var o$;!function(t){t.Canvas="Canvas",t.CanvasText="CanvasText",t.LinkText="LinkText",t.VisitedText="VisitedText",t.ActiveText="ActiveText",t.ButtonFace="ButtonFace",t.ButtonText="ButtonText",t.Field="Field",t.FieldText="FieldText",t.Highlight="Highlight",t.HighlightText="HighlightText",t.GrayText="GrayText"}(o$||(o$={}));class ARIAGlobalStatesAndProperties{}__decorate$t([attr({attribute:"aria-atomic"})],ARIAGlobalStatesAndProperties.prototype,"ariaAtomic",void 0),__decorate$t([attr({attribute:"aria-busy"})],ARIAGlobalStatesAndProperties.prototype,"ariaBusy",void 0),__decorate$t([attr({attribute:"aria-controls"})],ARIAGlobalStatesAndProperties.prototype,"ariaControls",void 0),__decorate$t([attr({attribute:"aria-current"})],ARIAGlobalStatesAndProperties.prototype,"ariaCurrent",void 0),__decorate$t([attr({attribute:"aria-describedby"})],ARIAGlobalStatesAndProperties.prototype,"ariaDescribedby",void 0),__decorate$t([attr({attribute:"aria-details"})],ARIAGlobalStatesAndProperties.prototype,"ariaDetails",void 0),__decorate$t([attr({attribute:"aria-disabled"})],ARIAGlobalStatesAndProperties.prototype,"ariaDisabled",void 0),__decorate$t([attr({attribute:"aria-errormessage"})],ARIAGlobalStatesAndProperties.prototype,"ariaErrormessage",void 0),__decorate$t([attr({attribute:"aria-flowto"})],ARIAGlobalStatesAndProperties.prototype,"ariaFlowto",void 0),__decorate$t([attr({attribute:"aria-haspopup"})],ARIAGlobalStatesAndProperties.prototype,"ariaHaspopup",void 0),__decorate$t([attr({attribute:"aria-hidden"})],ARIAGlobalStatesAndProperties.prototype,"ariaHidden",void 0),__decorate$t([attr({attribute:"aria-invalid"})],ARIAGlobalStatesAndProperties.prototype,"ariaInvalid",void 0),__decorate$t([attr({attribute:"aria-keyshortcuts"})],ARIAGlobalStatesAndProperties.prototype,"ariaKeyshortcuts",void 0),__decorate$t([attr({attribute:"aria-label"})],ARIAGlobalStatesAndProperties.prototype,"ariaLabel",void 0),__decorate$t([attr({attribute:"aria-labelledby"})],ARIAGlobalStatesAndProperties.prototype,"ariaLabelledby",void 0),__decorate$t([attr({attribute:"aria-live"})],ARIAGlobalStatesAndProperties.prototype,"ariaLive",void 0),__decorate$t([attr({attribute:"aria-owns"})],ARIAGlobalStatesAndProperties.prototype,"ariaOwns",void 0),__decorate$t([attr({attribute:"aria-relevant"})],ARIAGlobalStatesAndProperties.prototype,"ariaRelevant",void 0),__decorate$t([attr({attribute:"aria-roledescription"})],ARIAGlobalStatesAndProperties.prototype,"ariaRoledescription",void 0);class Anchor extends FoundationElement{constructor(){super(...arguments),this.handleUnsupportedDelegatesFocus=()=>{var t;window.ShadowRoot&&!window.ShadowRoot.prototype.hasOwnProperty("delegatesFocus")&&(null===(t=this.$fastController.definition.shadowOptions)||void 0===t?void 0:t.delegatesFocus)&&(this.focus=()=>{var t;null===(t=this.control)||void 0===t||t.focus()})}}connectedCallback(){super.connectedCallback(),this.handleUnsupportedDelegatesFocus()}}__decorate$t([attr],Anchor.prototype,"download",void 0),__decorate$t([attr],Anchor.prototype,"href",void 0),__decorate$t([attr],Anchor.prototype,"hreflang",void 0),__decorate$t([attr],Anchor.prototype,"ping",void 0),__decorate$t([attr],Anchor.prototype,"referrerpolicy",void 0),__decorate$t([attr],Anchor.prototype,"rel",void 0),__decorate$t([attr],Anchor.prototype,"target",void 0),__decorate$t([attr],Anchor.prototype,"type",void 0),__decorate$t([observable],Anchor.prototype,"defaultSlottedContent",void 0);class DelegatesARIALink{}__decorate$t([attr({attribute:"aria-expanded"})],DelegatesARIALink.prototype,"ariaExpanded",void 0),applyMixins(DelegatesARIALink,ARIAGlobalStatesAndProperties),applyMixins(Anchor,StartEnd,DelegatesARIALink);const getDirection=t=>{const o=t.closest("[dir]");return null!==o&&"rtl"===o.dir?t$.rtl:t$.ltr};class AnchoredRegion extends FoundationElement{constructor(){super(...arguments),this.anchor="",this.viewport="",this.horizontalPositioningMode="uncontrolled",this.horizontalDefaultPosition="unset",this.horizontalViewportLock=!1,this.horizontalInset=!1,this.horizontalScaling="content",this.verticalPositioningMode="uncontrolled",this.verticalDefaultPosition="unset",this.verticalViewportLock=!1,this.verticalInset=!1,this.verticalScaling="content",this.fixedPlacement=!1,this.autoUpdateMode="anchor",this.anchorElement=null,this.viewportElement=null,this.initialLayoutComplete=!1,this.resizeDetector=null,this.baseHorizontalOffset=0,this.baseVerticalOffset=0,this.pendingPositioningUpdate=!1,this.pendingReset=!1,this.currentDirection=t$.ltr,this.regionVisible=!1,this.forceUpdate=!1,this.updateThreshold=.5,this.update=()=>{this.pendingPositioningUpdate||this.requestPositionUpdates()},this.startObservers=()=>{this.stopObservers(),null!==this.anchorElement&&(this.requestPositionUpdates(),null!==this.resizeDetector&&(this.resizeDetector.observe(this.anchorElement),this.resizeDetector.observe(this)))},this.requestPositionUpdates=()=>{null===this.anchorElement||this.pendingPositioningUpdate||(AnchoredRegion.intersectionService.requestPosition(this,this.handleIntersection),AnchoredRegion.intersectionService.requestPosition(this.anchorElement,this.handleIntersection),null!==this.viewportElement&&AnchoredRegion.intersectionService.requestPosition(this.viewportElement,this.handleIntersection),this.pendingPositioningUpdate=!0)},this.stopObservers=()=>{this.pendingPositioningUpdate&&(this.pendingPositioningUpdate=!1,AnchoredRegion.intersectionService.cancelRequestPosition(this,this.handleIntersection),null!==this.anchorElement&&AnchoredRegion.intersectionService.cancelRequestPosition(this.anchorElement,this.handleIntersection),null!==this.viewportElement&&AnchoredRegion.intersectionService.cancelRequestPosition(this.viewportElement,this.handleIntersection)),null!==this.resizeDetector&&this.resizeDetector.disconnect()},this.getViewport=()=>"string"!=typeof this.viewport||""===this.viewport?document.documentElement:document.getElementById(this.viewport),this.getAnchor=()=>document.getElementById(this.anchor),this.handleIntersection=t=>{this.pendingPositioningUpdate&&(this.pendingPositioningUpdate=!1,this.applyIntersectionEntries(t)&&this.updateLayout())},this.applyIntersectionEntries=t=>{const o=t.find((t=>t.target===this)),s=t.find((t=>t.target===this.anchorElement)),l=t.find((t=>t.target===this.viewportElement));return void 0!==o&&void 0!==l&&void 0!==s&&(!!(!this.regionVisible||this.forceUpdate||void 0===this.regionRect||void 0===this.anchorRect||void 0===this.viewportRect||this.isRectDifferent(this.anchorRect,s.boundingClientRect)||this.isRectDifferent(this.viewportRect,l.boundingClientRect)||this.isRectDifferent(this.regionRect,o.boundingClientRect))&&(this.regionRect=o.boundingClientRect,this.anchorRect=s.boundingClientRect,this.viewportElement===document.documentElement?this.viewportRect=new DOMRectReadOnly(l.boundingClientRect.x+document.documentElement.scrollLeft,l.boundingClientRect.y+document.documentElement.scrollTop,l.boundingClientRect.width,l.boundingClientRect.height):this.viewportRect=l.boundingClientRect,this.updateRegionOffset(),this.forceUpdate=!1,!0))},this.updateRegionOffset=()=>{this.anchorRect&&this.regionRect&&(this.baseHorizontalOffset=this.baseHorizontalOffset+(this.anchorRect.left-this.regionRect.left)+(this.translateX-this.baseHorizontalOffset),this.baseVerticalOffset=this.baseVerticalOffset+(this.anchorRect.top-this.regionRect.top)+(this.translateY-this.baseVerticalOffset))},this.isRectDifferent=(t,o)=>Math.abs(t.top-o.top)>this.updateThreshold||Math.abs(t.right-o.right)>this.updateThreshold||Math.abs(t.bottom-o.bottom)>this.updateThreshold||Math.abs(t.left-o.left)>this.updateThreshold,this.handleResize=t=>{this.update()},this.reset=()=>{this.pendingReset&&(this.pendingReset=!1,null===this.anchorElement&&(this.anchorElement=this.getAnchor()),null===this.viewportElement&&(this.viewportElement=this.getViewport()),this.currentDirection=getDirection(this),this.startObservers())},this.updateLayout=()=>{let t,o;if("uncontrolled"!==this.horizontalPositioningMode){const t=this.getPositioningOptions(this.horizontalInset);if("center"===this.horizontalDefaultPosition)o="center";else if("unset"!==this.horizontalDefaultPosition){let t=this.horizontalDefaultPosition;if("start"===t||"end"===t){const o=getDirection(this);if(o!==this.currentDirection)return this.currentDirection=o,void this.initialize();t=this.currentDirection===t$.ltr?"start"===t?"left":"right":"start"===t?"right":"left"}switch(t){case"left":o=this.horizontalInset?"insetStart":"start";break;case"right":o=this.horizontalInset?"insetEnd":"end"}}const s=void 0!==this.horizontalThreshold?this.horizontalThreshold:void 0!==this.regionRect?this.regionRect.width:0,l=void 0!==this.anchorRect?this.anchorRect.left:0,h=void 0!==this.anchorRect?this.anchorRect.right:0,m=void 0!==this.anchorRect?this.anchorRect.width:0,_=void 0!==this.viewportRect?this.viewportRect.left:0,E=void 0!==this.viewportRect?this.viewportRect.right:0;(void 0===o||"locktodefault"!==this.horizontalPositioningMode&&this.getAvailableSpace(o,l,h,m,_,E)<s)&&(o=this.getAvailableSpace(t[0],l,h,m,_,E)>this.getAvailableSpace(t[1],l,h,m,_,E)?t[0]:t[1])}if("uncontrolled"!==this.verticalPositioningMode){const o=this.getPositioningOptions(this.verticalInset);if("center"===this.verticalDefaultPosition)t="center";else if("unset"!==this.verticalDefaultPosition)switch(this.verticalDefaultPosition){case"top":t=this.verticalInset?"insetStart":"start";break;case"bottom":t=this.verticalInset?"insetEnd":"end"}const s=void 0!==this.verticalThreshold?this.verticalThreshold:void 0!==this.regionRect?this.regionRect.height:0,l=void 0!==this.anchorRect?this.anchorRect.top:0,h=void 0!==this.anchorRect?this.anchorRect.bottom:0,m=void 0!==this.anchorRect?this.anchorRect.height:0,_=void 0!==this.viewportRect?this.viewportRect.top:0,E=void 0!==this.viewportRect?this.viewportRect.bottom:0;(void 0===t||"locktodefault"!==this.verticalPositioningMode&&this.getAvailableSpace(t,l,h,m,_,E)<s)&&(t=this.getAvailableSpace(o[0],l,h,m,_,E)>this.getAvailableSpace(o[1],l,h,m,_,E)?o[0]:o[1])}const s=this.getNextRegionDimension(o,t),l=this.horizontalPosition!==o||this.verticalPosition!==t;if(this.setHorizontalPosition(o,s),this.setVerticalPosition(t,s),this.updateRegionStyle(),!this.initialLayoutComplete)return this.initialLayoutComplete=!0,void this.requestPositionUpdates();this.regionVisible||(this.regionVisible=!0,this.style.removeProperty("pointer-events"),this.style.removeProperty("opacity"),this.classList.toggle("loaded",!0),this.$emit("loaded",this,{bubbles:!1})),this.updatePositionClasses(),l&&this.$emit("positionchange",this,{bubbles:!1})},this.updateRegionStyle=()=>{this.style.width=this.regionWidth,this.style.height=this.regionHeight,this.style.transform=`translate(${this.translateX}px, ${this.translateY}px)`},this.updatePositionClasses=()=>{this.classList.toggle("top","start"===this.verticalPosition),this.classList.toggle("bottom","end"===this.verticalPosition),this.classList.toggle("inset-top","insetStart"===this.verticalPosition),this.classList.toggle("inset-bottom","insetEnd"===this.verticalPosition),this.classList.toggle("vertical-center","center"===this.verticalPosition),this.classList.toggle("left","start"===this.horizontalPosition),this.classList.toggle("right","end"===this.horizontalPosition),this.classList.toggle("inset-left","insetStart"===this.horizontalPosition),this.classList.toggle("inset-right","insetEnd"===this.horizontalPosition),this.classList.toggle("horizontal-center","center"===this.horizontalPosition)},this.setHorizontalPosition=(t,o)=>{if(void 0===t||void 0===this.regionRect||void 0===this.anchorRect||void 0===this.viewportRect)return;let s=0;switch(this.horizontalScaling){case"anchor":case"fill":s=this.horizontalViewportLock?this.viewportRect.width:o.width,this.regionWidth=`${s}px`;break;case"content":s=this.regionRect.width,this.regionWidth="unset"}let l=0;switch(t){case"start":this.translateX=this.baseHorizontalOffset-s,this.horizontalViewportLock&&this.anchorRect.left>this.viewportRect.right&&(this.translateX=this.translateX-(this.anchorRect.left-this.viewportRect.right));break;case"insetStart":this.translateX=this.baseHorizontalOffset-s+this.anchorRect.width,this.horizontalViewportLock&&this.anchorRect.right>this.viewportRect.right&&(this.translateX=this.translateX-(this.anchorRect.right-this.viewportRect.right));break;case"insetEnd":this.translateX=this.baseHorizontalOffset,this.horizontalViewportLock&&this.anchorRect.left<this.viewportRect.left&&(this.translateX=this.translateX-(this.anchorRect.left-this.viewportRect.left));break;case"end":this.translateX=this.baseHorizontalOffset+this.anchorRect.width,this.horizontalViewportLock&&this.anchorRect.right<this.viewportRect.left&&(this.translateX=this.translateX-(this.anchorRect.right-this.viewportRect.left));break;case"center":if(l=(this.anchorRect.width-s)/2,this.translateX=this.baseHorizontalOffset+l,this.horizontalViewportLock){const t=this.anchorRect.left+l,o=this.anchorRect.right-l;t<this.viewportRect.left&&!(o>this.viewportRect.right)?this.translateX=this.translateX-(t-this.viewportRect.left):o>this.viewportRect.right&&!(t<this.viewportRect.left)&&(this.translateX=this.translateX-(o-this.viewportRect.right))}}this.horizontalPosition=t},this.setVerticalPosition=(t,o)=>{if(void 0===t||void 0===this.regionRect||void 0===this.anchorRect||void 0===this.viewportRect)return;let s=0;switch(this.verticalScaling){case"anchor":case"fill":s=this.verticalViewportLock?this.viewportRect.height:o.height,this.regionHeight=`${s}px`;break;case"content":s=this.regionRect.height,this.regionHeight="unset"}let l=0;switch(t){case"start":this.translateY=this.baseVerticalOffset-s,this.verticalViewportLock&&this.anchorRect.top>this.viewportRect.bottom&&(this.translateY=this.translateY-(this.anchorRect.top-this.viewportRect.bottom));break;case"insetStart":this.translateY=this.baseVerticalOffset-s+this.anchorRect.height,this.verticalViewportLock&&this.anchorRect.bottom>this.viewportRect.bottom&&(this.translateY=this.translateY-(this.anchorRect.bottom-this.viewportRect.bottom));break;case"insetEnd":this.translateY=this.baseVerticalOffset,this.verticalViewportLock&&this.anchorRect.top<this.viewportRect.top&&(this.translateY=this.translateY-(this.anchorRect.top-this.viewportRect.top));break;case"end":this.translateY=this.baseVerticalOffset+this.anchorRect.height,this.verticalViewportLock&&this.anchorRect.bottom<this.viewportRect.top&&(this.translateY=this.translateY-(this.anchorRect.bottom-this.viewportRect.top));break;case"center":if(l=(this.anchorRect.height-s)/2,this.translateY=this.baseVerticalOffset+l,this.verticalViewportLock){const t=this.anchorRect.top+l,o=this.anchorRect.bottom-l;t<this.viewportRect.top&&!(o>this.viewportRect.bottom)?this.translateY=this.translateY-(t-this.viewportRect.top):o>this.viewportRect.bottom&&!(t<this.viewportRect.top)&&(this.translateY=this.translateY-(o-this.viewportRect.bottom))}}this.verticalPosition=t},this.getPositioningOptions=t=>t?["insetStart","insetEnd"]:["start","end"],this.getAvailableSpace=(t,o,s,l,h,m)=>{const _=o-h,E=m-(o+l);switch(t){case"start":return _;case"insetStart":return _+l;case"insetEnd":return E+l;case"end":return E;case"center":return 2*Math.min(_,E)+l}},this.getNextRegionDimension=(t,o)=>{const s={height:void 0!==this.regionRect?this.regionRect.height:0,width:void 0!==this.regionRect?this.regionRect.width:0};return void 0!==t&&"fill"===this.horizontalScaling?s.width=this.getAvailableSpace(t,void 0!==this.anchorRect?this.anchorRect.left:0,void 0!==this.anchorRect?this.anchorRect.right:0,void 0!==this.anchorRect?this.anchorRect.width:0,void 0!==this.viewportRect?this.viewportRect.left:0,void 0!==this.viewportRect?this.viewportRect.right:0):"anchor"===this.horizontalScaling&&(s.width=void 0!==this.anchorRect?this.anchorRect.width:0),void 0!==o&&"fill"===this.verticalScaling?s.height=this.getAvailableSpace(o,void 0!==this.anchorRect?this.anchorRect.top:0,void 0!==this.anchorRect?this.anchorRect.bottom:0,void 0!==this.anchorRect?this.anchorRect.height:0,void 0!==this.viewportRect?this.viewportRect.top:0,void 0!==this.viewportRect?this.viewportRect.bottom:0):"anchor"===this.verticalScaling&&(s.height=void 0!==this.anchorRect?this.anchorRect.height:0),s},this.startAutoUpdateEventListeners=()=>{window.addEventListener(UR,this.update,{passive:!0}),window.addEventListener(qR,this.update,{passive:!0,capture:!0}),null!==this.resizeDetector&&null!==this.viewportElement&&this.resizeDetector.observe(this.viewportElement)},this.stopAutoUpdateEventListeners=()=>{window.removeEventListener(UR,this.update),window.removeEventListener(qR,this.update),null!==this.resizeDetector&&null!==this.viewportElement&&this.resizeDetector.unobserve(this.viewportElement)}}anchorChanged(){this.initialLayoutComplete&&(this.anchorElement=this.getAnchor())}viewportChanged(){this.initialLayoutComplete&&(this.viewportElement=this.getViewport())}horizontalPositioningModeChanged(){this.requestReset()}horizontalDefaultPositionChanged(){this.updateForAttributeChange()}horizontalViewportLockChanged(){this.updateForAttributeChange()}horizontalInsetChanged(){this.updateForAttributeChange()}horizontalThresholdChanged(){this.updateForAttributeChange()}horizontalScalingChanged(){this.updateForAttributeChange()}verticalPositioningModeChanged(){this.requestReset()}verticalDefaultPositionChanged(){this.updateForAttributeChange()}verticalViewportLockChanged(){this.updateForAttributeChange()}verticalInsetChanged(){this.updateForAttributeChange()}verticalThresholdChanged(){this.updateForAttributeChange()}verticalScalingChanged(){this.updateForAttributeChange()}fixedPlacementChanged(){this.$fastController.isConnected&&this.initialLayoutComplete&&this.initialize()}autoUpdateModeChanged(t,o){this.$fastController.isConnected&&this.initialLayoutComplete&&("auto"===t&&this.stopAutoUpdateEventListeners(),"auto"===o&&this.startAutoUpdateEventListeners())}anchorElementChanged(){this.requestReset()}viewportElementChanged(){this.$fastController.isConnected&&this.initialLayoutComplete&&this.initialize()}connectedCallback(){super.connectedCallback(),"auto"===this.autoUpdateMode&&this.startAutoUpdateEventListeners(),this.initialize()}disconnectedCallback(){super.disconnectedCallback(),"auto"===this.autoUpdateMode&&this.stopAutoUpdateEventListeners(),this.stopObservers(),this.disconnectResizeDetector()}adoptedCallback(){this.initialize()}disconnectResizeDetector(){null!==this.resizeDetector&&(this.resizeDetector.disconnect(),this.resizeDetector=null)}initializeResizeDetector(){this.disconnectResizeDetector(),this.resizeDetector=new window.ResizeObserver(this.handleResize)}updateForAttributeChange(){this.$fastController.isConnected&&this.initialLayoutComplete&&(this.forceUpdate=!0,this.update())}initialize(){this.initializeResizeDetector(),null===this.anchorElement&&(this.anchorElement=this.getAnchor()),this.requestReset()}requestReset(){this.$fastController.isConnected&&!1===this.pendingReset&&(this.setInitialState(),jP.queueUpdate((()=>this.reset())),this.pendingReset=!0)}setInitialState(){this.initialLayoutComplete=!1,this.regionVisible=!1,this.translateX=0,this.translateY=0,this.baseHorizontalOffset=0,this.baseVerticalOffset=0,this.viewportRect=void 0,this.regionRect=void 0,this.anchorRect=void 0,this.verticalPosition=void 0,this.horizontalPosition=void 0,this.style.opacity="0",this.style.pointerEvents="none",this.forceUpdate=!1,this.style.position=this.fixedPlacement?"fixed":"absolute",this.updatePositionClasses(),this.updateRegionStyle()}}AnchoredRegion.intersectionService=new class IntersectionService{constructor(){this.intersectionDetector=null,this.observedElements=new Map,this.requestPosition=(t,o)=>{var s;null!==this.intersectionDetector&&(this.observedElements.has(t)?null===(s=this.observedElements.get(t))||void 0===s||s.push(o):(this.observedElements.set(t,[o]),this.intersectionDetector.observe(t)))},this.cancelRequestPosition=(t,o)=>{const s=this.observedElements.get(t);if(void 0!==s){const t=s.indexOf(o);-1!==t&&s.splice(t,1)}},this.initializeIntersectionDetector=()=>{MP.IntersectionObserver&&(this.intersectionDetector=new IntersectionObserver(this.handleIntersection,{root:null,rootMargin:"0px",threshold:[0,1]}))},this.handleIntersection=t=>{if(null===this.intersectionDetector)return;const o=[],s=[];t.forEach((t=>{var l;null===(l=this.intersectionDetector)||void 0===l||l.unobserve(t.target);const h=this.observedElements.get(t.target);void 0!==h&&(h.forEach((l=>{let h=o.indexOf(l);-1===h&&(h=o.length,o.push(l),s.push([])),s[h].push(t)})),this.observedElements.delete(t.target))})),o.forEach(((t,o)=>{t(s[o])}))},this.initializeIntersectionDetector()}},__decorate$t([attr],AnchoredRegion.prototype,"anchor",void 0),__decorate$t([attr],AnchoredRegion.prototype,"viewport",void 0),__decorate$t([attr({attribute:"horizontal-positioning-mode"})],AnchoredRegion.prototype,"horizontalPositioningMode",void 0),__decorate$t([attr({attribute:"horizontal-default-position"})],AnchoredRegion.prototype,"horizontalDefaultPosition",void 0),__decorate$t([attr({attribute:"horizontal-viewport-lock",mode:"boolean"})],AnchoredRegion.prototype,"horizontalViewportLock",void 0),__decorate$t([attr({attribute:"horizontal-inset",mode:"boolean"})],AnchoredRegion.prototype,"horizontalInset",void 0),__decorate$t([attr({attribute:"horizontal-threshold"})],AnchoredRegion.prototype,"horizontalThreshold",void 0),__decorate$t([attr({attribute:"horizontal-scaling"})],AnchoredRegion.prototype,"horizontalScaling",void 0),__decorate$t([attr({attribute:"vertical-positioning-mode"})],AnchoredRegion.prototype,"verticalPositioningMode",void 0),__decorate$t([attr({attribute:"vertical-default-position"})],AnchoredRegion.prototype,"verticalDefaultPosition",void 0),__decorate$t([attr({attribute:"vertical-viewport-lock",mode:"boolean"})],AnchoredRegion.prototype,"verticalViewportLock",void 0),__decorate$t([attr({attribute:"vertical-inset",mode:"boolean"})],AnchoredRegion.prototype,"verticalInset",void 0),__decorate$t([attr({attribute:"vertical-threshold"})],AnchoredRegion.prototype,"verticalThreshold",void 0),__decorate$t([attr({attribute:"vertical-scaling"})],AnchoredRegion.prototype,"verticalScaling",void 0),__decorate$t([attr({attribute:"fixed-placement",mode:"boolean"})],AnchoredRegion.prototype,"fixedPlacement",void 0),__decorate$t([attr({attribute:"auto-update-mode"})],AnchoredRegion.prototype,"autoUpdateMode",void 0),__decorate$t([observable],AnchoredRegion.prototype,"anchorElement",void 0),__decorate$t([observable],AnchoredRegion.prototype,"viewportElement",void 0),__decorate$t([observable],AnchoredRegion.prototype,"initialLayoutComplete",void 0);class BreadcrumbItem extends Anchor{constructor(){super(...arguments),this.separator=!0}}__decorate$t([observable],BreadcrumbItem.prototype,"separator",void 0),applyMixins(BreadcrumbItem,StartEnd,DelegatesARIALink);class Breadcrumb extends FoundationElement{slottedBreadcrumbItemsChanged(){if(this.$fastController.isConnected){if(void 0===this.slottedBreadcrumbItems||0===this.slottedBreadcrumbItems.length)return;const t=this.slottedBreadcrumbItems[this.slottedBreadcrumbItems.length-1];this.slottedBreadcrumbItems.forEach((o=>{const s=o===t;this.setItemSeparator(o,s),this.setAriaCurrent(o,s)}))}}setItemSeparator(t,o){t instanceof BreadcrumbItem&&(t.separator=!o)}findChildWithHref(t){var o,s;return t.childElementCount>0?t.querySelector("a[href]"):(null===(o=t.shadowRoot)||void 0===o?void 0:o.childElementCount)?null===(s=t.shadowRoot)||void 0===s?void 0:s.querySelector("a[href]"):null}setAriaCurrent(t,o){const s=this.findChildWithHref(t);null===s&&t.hasAttribute("href")&&t instanceof BreadcrumbItem?o?t.setAttribute("aria-current","page"):t.removeAttribute("aria-current"):null!==s&&(o?s.setAttribute("aria-current","page"):s.removeAttribute("aria-current"))}}__decorate$t([observable],Breadcrumb.prototype,"slottedBreadcrumbItems",void 0);const n$="form-associated-proxy",i$="ElementInternals",s$=i$ in window&&"setFormValue"in window[i$].prototype,a$=new WeakMap;function FormAssociated(t){const o=class extends t{constructor(...t){super(...t),this.dirtyValue=!1,this.disabled=!1,this.proxyEventsToBlock=["change","click"],this.proxyInitialized=!1,this.required=!1,this.initialValue=this.initialValue||"",this.elementInternals||(this.formResetCallback=this.formResetCallback.bind(this))}static get formAssociated(){return s$}get validity(){return this.elementInternals?this.elementInternals.validity:this.proxy.validity}get form(){return this.elementInternals?this.elementInternals.form:this.proxy.form}get validationMessage(){return this.elementInternals?this.elementInternals.validationMessage:this.proxy.validationMessage}get willValidate(){return this.elementInternals?this.elementInternals.willValidate:this.proxy.willValidate}get labels(){if(this.elementInternals)return Object.freeze(Array.from(this.elementInternals.labels));if(this.proxy instanceof HTMLElement&&this.proxy.ownerDocument&&this.id){const t=this.proxy.labels,o=Array.from(this.proxy.getRootNode().querySelectorAll(`[for='${this.id}']`)),s=t?o.concat(Array.from(t)):o;return Object.freeze(s)}return DP}valueChanged(t,o){this.dirtyValue=!0,this.proxy instanceof HTMLElement&&(this.proxy.value=this.value),this.currentValue=this.value,this.setFormValue(this.value),this.validate()}currentValueChanged(){this.value=this.currentValue}initialValueChanged(t,o){this.dirtyValue||(this.value=this.initialValue,this.dirtyValue=!1)}disabledChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.disabled=this.disabled),jP.queueUpdate((()=>this.classList.toggle("disabled",this.disabled)))}nameChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.name=this.name)}requiredChanged(t,o){this.proxy instanceof HTMLElement&&(this.proxy.required=this.required),jP.queueUpdate((()=>this.classList.toggle("required",this.required))),this.validate()}get elementInternals(){if(!s$)return null;let t=a$.get(this);return t||(t=this.attachInternals(),a$.set(this,t)),t}connectedCallback(){super.connectedCallback(),this.addEventListener("keypress",this._keypressHandler),this.value||(this.value=this.initialValue,this.dirtyValue=!1),this.elementInternals||(this.attachProxy(),this.form&&this.form.addEventListener("reset",this.formResetCallback))}disconnectedCallback(){this.proxyEventsToBlock.forEach((t=>this.proxy.removeEventListener(t,this.stopPropagation))),!this.elementInternals&&this.form&&this.form.removeEventListener("reset",this.formResetCallback)}checkValidity(){return this.elementInternals?this.elementInternals.checkValidity():this.proxy.checkValidity()}reportValidity(){return this.elementInternals?this.elementInternals.reportValidity():this.proxy.reportValidity()}setValidity(t,o,s){this.elementInternals?this.elementInternals.setValidity(t,o,s):"string"==typeof o&&this.proxy.setCustomValidity(o)}formDisabledCallback(t){this.disabled=t}formResetCallback(){this.value=this.initialValue,this.dirtyValue=!1}attachProxy(){var t;this.proxyInitialized||(this.proxyInitialized=!0,this.proxy.style.display="none",this.proxyEventsToBlock.forEach((t=>this.proxy.addEventListener(t,this.stopPropagation))),this.proxy.disabled=this.disabled,this.proxy.required=this.required,"string"==typeof this.name&&(this.proxy.name=this.name),"string"==typeof this.value&&(this.proxy.value=this.value),this.proxy.setAttribute("slot",n$),this.proxySlot=document.createElement("slot"),this.proxySlot.setAttribute("name",n$)),null===(t=this.shadowRoot)||void 0===t||t.appendChild(this.proxySlot),this.appendChild(this.proxy)}detachProxy(){var t;this.removeChild(this.proxy),null===(t=this.shadowRoot)||void 0===t||t.removeChild(this.proxySlot)}validate(t){this.proxy instanceof HTMLElement&&this.setValidity(this.proxy.validity,this.proxy.validationMessage,t)}setFormValue(t,o){this.elementInternals&&this.elementInternals.setFormValue(t,o||t)}_keypressHandler(t){if(t.key===WR)if(this.form instanceof HTMLFormElement){const t=this.form.querySelector("[type=submit]");null==t||t.click()}}stopPropagation(t){t.stopPropagation()}};return attr({mode:"boolean"})(o.prototype,"disabled"),attr({mode:"fromView",attribute:"value"})(o.prototype,"initialValue"),attr({attribute:"current-value"})(o.prototype,"currentValue"),attr(o.prototype,"name"),attr({mode:"boolean"})(o.prototype,"required"),observable(o.prototype,"value"),o}function CheckableFormAssociated(t){class C extends(FormAssociated(t)){}class D extends C{constructor(...t){super(t),this.dirtyChecked=!1,this.checkedAttribute=!1,this.checked=!1,this.dirtyChecked=!1}checkedAttributeChanged(){this.defaultChecked=this.checkedAttribute}defaultCheckedChanged(){this.dirtyChecked||(this.checked=this.defaultChecked,this.dirtyChecked=!1)}checkedChanged(t,o){this.dirtyChecked||(this.dirtyChecked=!0),this.currentChecked=this.checked,this.updateForm(),this.proxy instanceof HTMLInputElement&&(this.proxy.checked=this.checked),void 0!==t&&this.$emit("change"),this.validate()}currentCheckedChanged(t,o){this.checked=this.currentChecked}updateForm(){const t=this.checked?this.value:null;this.setFormValue(t,t)}connectedCallback(){super.connectedCallback(),this.updateForm()}formResetCallback(){super.formResetCallback(),this.checked=!!this.checkedAttribute,this.dirtyChecked=!1}}return attr({attribute:"checked",mode:"boolean"})(D.prototype,"checkedAttribute"),attr({attribute:"current-checked",converter:XP})(D.prototype,"currentChecked"),observable(D.prototype,"defaultChecked"),observable(D.prototype,"checked"),D}class _Button extends FoundationElement{}class FormAssociatedButton extends(FormAssociated(_Button)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class Button$1 extends FormAssociatedButton{constructor(){super(...arguments),this.handleClick=t=>{var o;this.disabled&&(null===(o=this.defaultSlottedContent)||void 0===o?void 0:o.length)<=1&&t.stopPropagation()},this.handleSubmission=()=>{if(!this.form)return;const t=this.proxy.isConnected;t||this.attachProxy(),"function"==typeof this.form.requestSubmit?this.form.requestSubmit(this.proxy):this.proxy.click(),t||this.detachProxy()},this.handleFormReset=()=>{var t;null===(t=this.form)||void 0===t||t.reset()},this.handleUnsupportedDelegatesFocus=()=>{var t;window.ShadowRoot&&!window.ShadowRoot.prototype.hasOwnProperty("delegatesFocus")&&(null===(t=this.$fastController.definition.shadowOptions)||void 0===t?void 0:t.delegatesFocus)&&(this.focus=()=>{this.control.focus()})}}formactionChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formAction=this.formaction)}formenctypeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formEnctype=this.formenctype)}formmethodChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formMethod=this.formmethod)}formnovalidateChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formNoValidate=this.formnovalidate)}formtargetChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.formTarget=this.formtarget)}typeChanged(t,o){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type),"submit"===o&&this.addEventListener("click",this.handleSubmission),"submit"===t&&this.removeEventListener("click",this.handleSubmission),"reset"===o&&this.addEventListener("click",this.handleFormReset),"reset"===t&&this.removeEventListener("click",this.handleFormReset)}validate(){super.validate(this.control)}connectedCallback(){var t;super.connectedCallback(),this.proxy.setAttribute("type",this.type),this.handleUnsupportedDelegatesFocus();const o=Array.from(null===(t=this.control)||void 0===t?void 0:t.children);o&&o.forEach((t=>{t.addEventListener("click",this.handleClick)}))}disconnectedCallback(){var t;super.disconnectedCallback();const o=Array.from(null===(t=this.control)||void 0===t?void 0:t.children);o&&o.forEach((t=>{t.removeEventListener("click",this.handleClick)}))}}__decorate$t([attr({mode:"boolean"})],Button$1.prototype,"autofocus",void 0),__decorate$t([attr({attribute:"form"})],Button$1.prototype,"formId",void 0),__decorate$t([attr],Button$1.prototype,"formaction",void 0),__decorate$t([attr],Button$1.prototype,"formenctype",void 0),__decorate$t([attr],Button$1.prototype,"formmethod",void 0),__decorate$t([attr({mode:"boolean"})],Button$1.prototype,"formnovalidate",void 0),__decorate$t([attr],Button$1.prototype,"formtarget",void 0),__decorate$t([attr],Button$1.prototype,"type",void 0),__decorate$t([observable],Button$1.prototype,"defaultSlottedContent",void 0);class DelegatesARIAButton{}__decorate$t([attr({attribute:"aria-expanded"})],DelegatesARIAButton.prototype,"ariaExpanded",void 0),__decorate$t([attr({attribute:"aria-pressed"})],DelegatesARIAButton.prototype,"ariaPressed",void 0),applyMixins(DelegatesARIAButton,ARIAGlobalStatesAndProperties),applyMixins(Button$1,StartEnd,DelegatesARIAButton);class DateFormatter{constructor(t){if(this.dayFormat="numeric",this.weekdayFormat="long",this.monthFormat="long",this.yearFormat="numeric",this.date=new Date,t)for(const o in t){const s=t[o];"date"===o?this.date=this.getDateObject(s):this[o]=s}}getDateObject(t){if("string"==typeof t){const o=t.split(/[/-]/);return o.length<3?new Date:new Date(parseInt(o[2],10),parseInt(o[0],10)-1,parseInt(o[1],10))}if("day"in t&&"month"in t&&"year"in t){const{day:o,month:s,year:l}=t;return new Date(l,s-1,o)}return t}getDate(t=this.date,o={weekday:this.weekdayFormat,month:this.monthFormat,day:this.dayFormat,year:this.yearFormat},s=this.locale){const l=this.getDateObject(t);if(!l.getTime())return"";const h=Object.assign({timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},o);return new Intl.DateTimeFormat(s,h).format(l)}getDay(t=this.date.getDate(),o=this.dayFormat,s=this.locale){return this.getDate({month:1,day:t,year:2020},{day:o},s)}getMonth(t=this.date.getMonth()+1,o=this.monthFormat,s=this.locale){return this.getDate({month:t,day:2,year:2020},{month:o},s)}getYear(t=this.date.getFullYear(),o=this.yearFormat,s=this.locale){return this.getDate({month:2,day:2,year:t},{year:o},s)}getWeekday(t=0,o=this.weekdayFormat,s=this.locale){const l=`1-${t+1}-2017`;return this.getDate(l,{weekday:o},s)}getWeekdays(t=this.weekdayFormat,o=this.locale){return Array(7).fill(null).map(((s,l)=>this.getWeekday(l,t,o)))}}class Calendar$1 extends FoundationElement{constructor(){super(...arguments),this.dateFormatter=new DateFormatter,this.readonly=!1,this.locale="en-US",this.month=(new Date).getMonth()+1,this.year=(new Date).getFullYear(),this.dayFormat="numeric",this.weekdayFormat="short",this.monthFormat="long",this.yearFormat="numeric",this.minWeeks=0,this.disabledDates="",this.selectedDates="",this.oneDayInMs=864e5}localeChanged(){this.dateFormatter.locale=this.locale}dayFormatChanged(){this.dateFormatter.dayFormat=this.dayFormat}weekdayFormatChanged(){this.dateFormatter.weekdayFormat=this.weekdayFormat}monthFormatChanged(){this.dateFormatter.monthFormat=this.monthFormat}yearFormatChanged(){this.dateFormatter.yearFormat=this.yearFormat}getMonthInfo(t=this.month,o=this.year){const getFirstDay=t=>new Date(t.getFullYear(),t.getMonth(),1).getDay(),getLength=t=>{const o=new Date(t.getFullYear(),t.getMonth()+1,1);return new Date(o.getTime()-this.oneDayInMs).getDate()},s=new Date(o,t-1),l=new Date(o,t),h=new Date(o,t-2);return{length:getLength(s),month:t,start:getFirstDay(s),year:o,previous:{length:getLength(h),month:h.getMonth()+1,start:getFirstDay(h),year:h.getFullYear()},next:{length:getLength(l),month:l.getMonth()+1,start:getFirstDay(l),year:l.getFullYear()}}}getDays(t=this.getMonthInfo(),o=this.minWeeks){o=o>10?10:o;const{start:s,length:l,previous:h,next:m}=t,_=[];let E=1-s;for(;E<l+1||_.length<o||_[_.length-1].length%7!=0;){const{month:o,year:s}=E<1?h:E>l?m:t,$=E<1?h.length+E:E>l?E-l:E,B=`${o}-${$}-${s}`,q={day:$,month:o,year:s,disabled:this.dateInString(B,this.disabledDates),selected:this.dateInString(B,this.selectedDates)},j=_[_.length-1];0===_.length||j.length%7==0?_.push([q]):j.push(q),E++}return _}dateInString(t,o){const s=o.split(",").map((t=>t.trim()));return t="string"==typeof t?t:`${t.getMonth()+1}-${t.getDate()}-${t.getFullYear()}`,s.some((o=>o===t))}getDayClassNames(t,o){const{day:s,month:l,year:h,disabled:m,selected:_}=t;return["day",o===`${l}-${s}-${h}`&&"today",this.month!==l&&"inactive",m&&"disabled",_&&"selected"].filter(Boolean).join(" ")}getWeekdayText(){const t=this.dateFormatter.getWeekdays().map((t=>({text:t})));if("long"!==this.weekdayFormat){const o=this.dateFormatter.getWeekdays("long");t.forEach(((t,s)=>{t.abbr=o[s]}))}return t}handleDateSelect(t,o){t.preventDefault,this.$emit("dateselected",o)}handleKeydown(t,o){return t.key===WR&&this.handleDateSelect(t,o),!0}}__decorate$t([attr({mode:"boolean"})],Calendar$1.prototype,"readonly",void 0),__decorate$t([attr],Calendar$1.prototype,"locale",void 0),__decorate$t([attr({converter:eR})],Calendar$1.prototype,"month",void 0),__decorate$t([attr({converter:eR})],Calendar$1.prototype,"year",void 0),__decorate$t([attr({attribute:"day-format",mode:"fromView"})],Calendar$1.prototype,"dayFormat",void 0),__decorate$t([attr({attribute:"weekday-format",mode:"fromView"})],Calendar$1.prototype,"weekdayFormat",void 0),__decorate$t([attr({attribute:"month-format",mode:"fromView"})],Calendar$1.prototype,"monthFormat",void 0),__decorate$t([attr({attribute:"year-format",mode:"fromView"})],Calendar$1.prototype,"yearFormat",void 0),__decorate$t([attr({attribute:"min-weeks",converter:eR})],Calendar$1.prototype,"minWeeks",void 0),__decorate$t([attr({attribute:"disabled-dates"})],Calendar$1.prototype,"disabledDates",void 0),__decorate$t([attr({attribute:"selected-dates"})],Calendar$1.prototype,"selectedDates",void 0);const l$="none",c$="default",d$="sticky",u$="default",h$="columnheader",p$="rowheader",f$="default",g$="header",v$="sticky-header";class DataGridRow extends FoundationElement{constructor(){super(...arguments),this.rowType=f$,this.rowData=null,this.columnDefinitions=null,this.isActiveRow=!1,this.cellsRepeatBehavior=null,this.cellsPlaceholder=null,this.focusColumnIndex=0,this.refocusOnLoad=!1,this.updateRowStyle=()=>{this.style.gridTemplateColumns=this.gridTemplateColumns}}gridTemplateColumnsChanged(){this.$fastController.isConnected&&this.updateRowStyle()}rowTypeChanged(){this.$fastController.isConnected&&this.updateItemTemplate()}rowDataChanged(){null!==this.rowData&&this.isActiveRow&&(this.refocusOnLoad=!0)}cellItemTemplateChanged(){this.updateItemTemplate()}headerCellItemTemplateChanged(){this.updateItemTemplate()}connectedCallback(){super.connectedCallback(),null===this.cellsRepeatBehavior&&(this.cellsPlaceholder=document.createComment(""),this.appendChild(this.cellsPlaceholder),this.updateItemTemplate(),this.cellsRepeatBehavior=new RepeatDirective((t=>t.columnDefinitions),(t=>t.activeCellItemTemplate),{positioning:!0}).createBehavior(this.cellsPlaceholder),this.$fastController.addBehaviors([this.cellsRepeatBehavior])),this.addEventListener("cell-focused",this.handleCellFocus),this.addEventListener(BR,this.handleFocusout),this.addEventListener(HR,this.handleKeydown),this.updateRowStyle(),this.refocusOnLoad&&(this.refocusOnLoad=!1,this.cellElements.length>this.focusColumnIndex&&this.cellElements[this.focusColumnIndex].focus())}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("cell-focused",this.handleCellFocus),this.removeEventListener(BR,this.handleFocusout),this.removeEventListener(HR,this.handleKeydown)}handleFocusout(t){this.contains(t.target)||(this.isActiveRow=!1,this.focusColumnIndex=0)}handleCellFocus(t){this.isActiveRow=!0,this.focusColumnIndex=this.cellElements.indexOf(t.target),this.$emit("row-focused",this)}handleKeydown(t){if(t.defaultPrevented)return;let o=0;switch(t.key){case VR:o=Math.max(0,this.focusColumnIndex-1),this.cellElements[o].focus(),t.preventDefault();break;case GR:o=Math.min(this.cellElements.length-1,this.focusColumnIndex+1),this.cellElements[o].focus(),t.preventDefault();break;case YR:t.ctrlKey||(this.cellElements[0].focus(),t.preventDefault());break;case ZR:t.ctrlKey||(this.cellElements[this.cellElements.length-1].focus(),t.preventDefault())}}updateItemTemplate(){this.activeCellItemTemplate=this.rowType===f$&&void 0!==this.cellItemTemplate?this.cellItemTemplate:this.rowType===f$&&void 0===this.cellItemTemplate?this.defaultCellItemTemplate:void 0!==this.headerCellItemTemplate?this.headerCellItemTemplate:this.defaultHeaderCellItemTemplate}}__decorate$t([attr({attribute:"grid-template-columns"})],DataGridRow.prototype,"gridTemplateColumns",void 0),__decorate$t([attr({attribute:"row-type"})],DataGridRow.prototype,"rowType",void 0),__decorate$t([observable],DataGridRow.prototype,"rowData",void 0),__decorate$t([observable],DataGridRow.prototype,"columnDefinitions",void 0),__decorate$t([observable],DataGridRow.prototype,"cellItemTemplate",void 0),__decorate$t([observable],DataGridRow.prototype,"headerCellItemTemplate",void 0),__decorate$t([observable],DataGridRow.prototype,"rowIndex",void 0),__decorate$t([observable],DataGridRow.prototype,"isActiveRow",void 0),__decorate$t([observable],DataGridRow.prototype,"activeCellItemTemplate",void 0),__decorate$t([observable],DataGridRow.prototype,"defaultCellItemTemplate",void 0),__decorate$t([observable],DataGridRow.prototype,"defaultHeaderCellItemTemplate",void 0),__decorate$t([observable],DataGridRow.prototype,"cellElements",void 0);class DataGrid extends FoundationElement{constructor(){super(),this.noTabbing=!1,this.generateHeader=c$,this.rowsData=[],this.columnDefinitions=null,this.focusRowIndex=0,this.focusColumnIndex=0,this.rowsPlaceholder=null,this.generatedHeader=null,this.isUpdatingFocus=!1,this.pendingFocusUpdate=!1,this.rowindexUpdateQueued=!1,this.columnDefinitionsStale=!0,this.generatedGridTemplateColumns="",this.focusOnCell=(t,o,s)=>{if(0===this.rowElements.length)return this.focusRowIndex=0,void(this.focusColumnIndex=0);const l=Math.max(0,Math.min(this.rowElements.length-1,t)),h=this.rowElements[l].querySelectorAll('[role="cell"], [role="gridcell"], [role="columnheader"], [role="rowheader"]'),m=h[Math.max(0,Math.min(h.length-1,o))];s&&this.scrollHeight!==this.clientHeight&&(l<this.focusRowIndex&&this.scrollTop>0||l>this.focusRowIndex&&this.scrollTop<this.scrollHeight-this.clientHeight)&&m.scrollIntoView({block:"center",inline:"center"}),m.focus()},this.onChildListChange=(t,o)=>{t&&t.length&&(t.forEach((t=>{t.addedNodes.forEach((t=>{1===t.nodeType&&"row"===t.getAttribute("role")&&(t.columnDefinitions=this.columnDefinitions)}))})),this.queueRowIndexUpdate())},this.queueRowIndexUpdate=()=>{this.rowindexUpdateQueued||(this.rowindexUpdateQueued=!0,jP.queueUpdate(this.updateRowIndexes))},this.updateRowIndexes=()=>{let t=this.gridTemplateColumns;if(void 0===t){if(""===this.generatedGridTemplateColumns&&this.rowElements.length>0){const t=this.rowElements[0];this.generatedGridTemplateColumns=new Array(t.cellElements.length).fill("1fr").join(" ")}t=this.generatedGridTemplateColumns}this.rowElements.forEach(((o,s)=>{const l=o;l.rowIndex=s,l.gridTemplateColumns=t,this.columnDefinitionsStale&&(l.columnDefinitions=this.columnDefinitions)})),this.rowindexUpdateQueued=!1,this.columnDefinitionsStale=!1}}static generateTemplateColumns(t){let o="";return t.forEach((t=>{o=`${o}${""===o?"":" "}1fr`})),o}noTabbingChanged(){this.$fastController.isConnected&&(this.noTabbing?this.setAttribute("tabIndex","-1"):this.setAttribute("tabIndex",this.contains(document.activeElement)||this===document.activeElement?"-1":"0"))}generateHeaderChanged(){this.$fastController.isConnected&&this.toggleGeneratedHeader()}gridTemplateColumnsChanged(){this.$fastController.isConnected&&this.updateRowIndexes()}rowsDataChanged(){null===this.columnDefinitions&&this.rowsData.length>0&&(this.columnDefinitions=DataGrid.generateColumns(this.rowsData[0])),this.$fastController.isConnected&&this.toggleGeneratedHeader()}columnDefinitionsChanged(){null!==this.columnDefinitions?(this.generatedGridTemplateColumns=DataGrid.generateTemplateColumns(this.columnDefinitions),this.$fastController.isConnected&&(this.columnDefinitionsStale=!0,this.queueRowIndexUpdate())):this.generatedGridTemplateColumns=""}headerCellItemTemplateChanged(){this.$fastController.isConnected&&null!==this.generatedHeader&&(this.generatedHeader.headerCellItemTemplate=this.headerCellItemTemplate)}focusRowIndexChanged(){this.$fastController.isConnected&&this.queueFocusUpdate()}focusColumnIndexChanged(){this.$fastController.isConnected&&this.queueFocusUpdate()}connectedCallback(){super.connectedCallback(),void 0===this.rowItemTemplate&&(this.rowItemTemplate=this.defaultRowItemTemplate),this.rowsPlaceholder=document.createComment(""),this.appendChild(this.rowsPlaceholder),this.toggleGeneratedHeader(),this.rowsRepeatBehavior=new RepeatDirective((t=>t.rowsData),(t=>t.rowItemTemplate),{positioning:!0}).createBehavior(this.rowsPlaceholder),this.$fastController.addBehaviors([this.rowsRepeatBehavior]),this.addEventListener("row-focused",this.handleRowFocus),this.addEventListener(LR,this.handleFocus),this.addEventListener(HR,this.handleKeydown),this.addEventListener(BR,this.handleFocusOut),this.observer=new MutationObserver(this.onChildListChange),this.observer.observe(this,{childList:!0}),this.noTabbing&&this.setAttribute("tabindex","-1"),jP.queueUpdate(this.queueRowIndexUpdate)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("row-focused",this.handleRowFocus),this.removeEventListener(LR,this.handleFocus),this.removeEventListener(HR,this.handleKeydown),this.removeEventListener(BR,this.handleFocusOut),this.observer.disconnect(),this.rowsPlaceholder=null,this.generatedHeader=null}handleRowFocus(t){this.isUpdatingFocus=!0;const o=t.target;this.focusRowIndex=this.rowElements.indexOf(o),this.focusColumnIndex=o.focusColumnIndex,this.setAttribute("tabIndex","-1"),this.isUpdatingFocus=!1}handleFocus(t){this.focusOnCell(this.focusRowIndex,this.focusColumnIndex,!0)}handleFocusOut(t){null!==t.relatedTarget&&this.contains(t.relatedTarget)||this.setAttribute("tabIndex",this.noTabbing?"-1":"0")}handleKeydown(t){if(t.defaultPrevented)return;let o;const s=this.rowElements.length-1,l=this.offsetHeight+this.scrollTop,h=this.rowElements[s];switch(t.key){case KR:t.preventDefault(),this.focusOnCell(this.focusRowIndex-1,this.focusColumnIndex,!0);break;case zR:t.preventDefault(),this.focusOnCell(this.focusRowIndex+1,this.focusColumnIndex,!0);break;case"PageUp":if(t.preventDefault(),0===this.rowElements.length){this.focusOnCell(0,0,!1);break}if(0===this.focusRowIndex)return void this.focusOnCell(0,this.focusColumnIndex,!1);for(o=this.focusRowIndex-1;o>=0;o--){const t=this.rowElements[o];if(t.offsetTop<this.scrollTop){this.scrollTop=t.offsetTop+t.clientHeight-this.clientHeight;break}}this.focusOnCell(o,this.focusColumnIndex,!1);break;case"PageDown":if(t.preventDefault(),0===this.rowElements.length){this.focusOnCell(0,0,!1);break}if(this.focusRowIndex>=s||h.offsetTop+h.offsetHeight<=l)return void this.focusOnCell(s,this.focusColumnIndex,!1);for(o=this.focusRowIndex+1;o<=s;o++){const t=this.rowElements[o];if(t.offsetTop+t.offsetHeight>l){let o=0;this.generateHeader===d$&&null!==this.generatedHeader&&(o=this.generatedHeader.clientHeight),this.scrollTop=t.offsetTop-o;break}}this.focusOnCell(o,this.focusColumnIndex,!1);break;case YR:t.ctrlKey&&(t.preventDefault(),this.focusOnCell(0,0,!0));break;case ZR:t.ctrlKey&&null!==this.columnDefinitions&&(t.preventDefault(),this.focusOnCell(this.rowElements.length-1,this.columnDefinitions.length-1,!0))}}queueFocusUpdate(){this.isUpdatingFocus&&(this.contains(document.activeElement)||this===document.activeElement)||!1===this.pendingFocusUpdate&&(this.pendingFocusUpdate=!0,jP.queueUpdate((()=>this.updateFocus())))}updateFocus(){this.pendingFocusUpdate=!1,this.focusOnCell(this.focusRowIndex,this.focusColumnIndex,!0)}toggleGeneratedHeader(){if(null!==this.generatedHeader&&(this.removeChild(this.generatedHeader),this.generatedHeader=null),this.generateHeader!==l$&&this.rowsData.length>0){const t=document.createElement(this.rowElementTag);return this.generatedHeader=t,this.generatedHeader.columnDefinitions=this.columnDefinitions,this.generatedHeader.gridTemplateColumns=this.gridTemplateColumns,this.generatedHeader.rowType=this.generateHeader===d$?v$:g$,void(null===this.firstChild&&null===this.rowsPlaceholder||this.insertBefore(t,null!==this.firstChild?this.firstChild:this.rowsPlaceholder))}}}DataGrid.generateColumns=t=>Object.getOwnPropertyNames(t).map(((t,o)=>({columnDataKey:t,gridColumn:`${o}`}))),__decorate$t([attr({attribute:"no-tabbing",mode:"boolean"})],DataGrid.prototype,"noTabbing",void 0),__decorate$t([attr({attribute:"generate-header"})],DataGrid.prototype,"generateHeader",void 0),__decorate$t([attr({attribute:"grid-template-columns"})],DataGrid.prototype,"gridTemplateColumns",void 0),__decorate$t([observable],DataGrid.prototype,"rowsData",void 0),__decorate$t([observable],DataGrid.prototype,"columnDefinitions",void 0),__decorate$t([observable],DataGrid.prototype,"rowItemTemplate",void 0),__decorate$t([observable],DataGrid.prototype,"cellItemTemplate",void 0),__decorate$t([observable],DataGrid.prototype,"headerCellItemTemplate",void 0),__decorate$t([observable],DataGrid.prototype,"focusRowIndex",void 0),__decorate$t([observable],DataGrid.prototype,"focusColumnIndex",void 0),__decorate$t([observable],DataGrid.prototype,"defaultRowItemTemplate",void 0),__decorate$t([observable],DataGrid.prototype,"rowElementTag",void 0),__decorate$t([observable],DataGrid.prototype,"rowElements",void 0);const m$=html`
    <template>
        ${t=>null===t.rowData||null===t.columnDefinition||null===t.columnDefinition.columnDataKey?null:t.rowData[t.columnDefinition.columnDataKey]}
    </template>
`,y$=html`
    <template>
        ${t=>null===t.columnDefinition?null:void 0===t.columnDefinition.title?t.columnDefinition.columnDataKey:t.columnDefinition.title}
    </template>
`;class DataGridCell extends FoundationElement{constructor(){super(...arguments),this.cellType=u$,this.rowData=null,this.columnDefinition=null,this.isActiveCell=!1,this.customCellView=null,this.updateCellStyle=()=>{this.style.gridColumn=this.gridColumn}}cellTypeChanged(){this.$fastController.isConnected&&this.updateCellView()}gridColumnChanged(){this.$fastController.isConnected&&this.updateCellStyle()}columnDefinitionChanged(t,o){this.$fastController.isConnected&&this.updateCellView()}connectedCallback(){var t;super.connectedCallback(),this.addEventListener(FR,this.handleFocusin),this.addEventListener(BR,this.handleFocusout),this.addEventListener(HR,this.handleKeydown),this.style.gridColumn=`${void 0===(null===(t=this.columnDefinition)||void 0===t?void 0:t.gridColumn)?0:this.columnDefinition.gridColumn}`,this.updateCellView(),this.updateCellStyle()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener(FR,this.handleFocusin),this.removeEventListener(BR,this.handleFocusout),this.removeEventListener(HR,this.handleKeydown),this.disconnectCellView()}handleFocusin(t){if(!this.isActiveCell){if(this.isActiveCell=!0,this.cellType===h$){if(null!==this.columnDefinition&&!0!==this.columnDefinition.headerCellInternalFocusQueue&&"function"==typeof this.columnDefinition.headerCellFocusTargetCallback){const t=this.columnDefinition.headerCellFocusTargetCallback(this);null!==t&&t.focus()}}else if(null!==this.columnDefinition&&!0!==this.columnDefinition.cellInternalFocusQueue&&"function"==typeof this.columnDefinition.cellFocusTargetCallback){const t=this.columnDefinition.cellFocusTargetCallback(this);null!==t&&t.focus()}this.$emit("cell-focused",this)}}handleFocusout(t){this===document.activeElement||this.contains(document.activeElement)||(this.isActiveCell=!1)}handleKeydown(t){if(!(t.defaultPrevented||null===this.columnDefinition||this.cellType===u$&&!0!==this.columnDefinition.cellInternalFocusQueue||this.cellType===h$&&!0!==this.columnDefinition.headerCellInternalFocusQueue))switch(t.key){case WR:case"F2":if(this.contains(document.activeElement)&&document.activeElement!==this)return;if(this.cellType===h$){if(void 0!==this.columnDefinition.headerCellFocusTargetCallback){const o=this.columnDefinition.headerCellFocusTargetCallback(this);null!==o&&o.focus(),t.preventDefault()}}else if(void 0!==this.columnDefinition.cellFocusTargetCallback){const o=this.columnDefinition.cellFocusTargetCallback(this);null!==o&&o.focus(),t.preventDefault()}break;case QR:this.contains(document.activeElement)&&document.activeElement!==this&&(this.focus(),t.preventDefault())}}updateCellView(){if(this.disconnectCellView(),null!==this.columnDefinition)switch(this.cellType){case h$:void 0!==this.columnDefinition.headerCellTemplate?this.customCellView=this.columnDefinition.headerCellTemplate.render(this,this):this.customCellView=y$.render(this,this);break;case void 0:case p$:case u$:void 0!==this.columnDefinition.cellTemplate?this.customCellView=this.columnDefinition.cellTemplate.render(this,this):this.customCellView=m$.render(this,this)}}disconnectCellView(){null!==this.customCellView&&(this.customCellView.dispose(),this.customCellView=null)}}__decorate$t([attr({attribute:"cell-type"})],DataGridCell.prototype,"cellType",void 0),__decorate$t([attr({attribute:"grid-column"})],DataGridCell.prototype,"gridColumn",void 0),__decorate$t([observable],DataGridCell.prototype,"rowData",void 0),__decorate$t([observable],DataGridCell.prototype,"columnDefinition",void 0);const b$=html`
    <div
        class="title"
        part="title"
        aria-label="${t=>t.dateFormatter.getDate(`${t.month}-2-${t.year}`,{month:"long",year:"numeric"})}"
    >
        <span part="month">
            ${t=>t.dateFormatter.getMonth(t.month)}
        </span>
        <span part="year">${t=>t.dateFormatter.getYear(t.year)}</span>
    </div>
`,calendarRowTemplate=(t,o)=>{const s=t.tagFor(DataGridRow);return html`
        <${s}
            class="week"
            part="week"
            role="row"
            role-type="default"
            grid-template-columns="1fr 1fr 1fr 1fr 1fr 1fr 1fr"
        >
        ${repeat((t=>t),((t,o)=>{const s=t.tagFor(DataGridCell);return html`
        <${s}
            class="${(t,s)=>s.parentContext.parent.getDayClassNames(t,o)}"
            part="day"
            tabindex="-1"
            role="gridcell"
            grid-column="${(t,o)=>o.index+1}"
            @click="${(t,o)=>o.parentContext.parent.handleDateSelect(o.event,t)}"
            @keydown="${(t,o)=>o.parentContext.parent.handleKeydown(o.event,t)}"
            aria-label="${(t,o)=>o.parentContext.parent.dateFormatter.getDate(`${t.month}-${t.day}-${t.year}`,{month:"long",day:"numeric"})}"
        >
            <div
                class="date"
                part="${t=>o===`${t.month}-${t.day}-${t.year}`?"today":"date"}"
            >
                ${(t,o)=>o.parentContext.parent.dateFormatter.getDay(t.day)}
            </div>
            <slot name="${t=>t.month}-${t=>t.day}-${t=>t.year}"></slot>
        </${s}>
    `})(t,o),{positioning:!0})}
        </${s}>
    `},interactiveCalendarGridTemplate=(t,o)=>{const s=t.tagFor(DataGrid),l=t.tagFor(DataGridRow);return html`
    <${s} class="days interact" part="days" generate-header="none">
        <${l}
            class="week-days"
            part="week-days"
            role="row"
            row-type="header"
            grid-template-columns="1fr 1fr 1fr 1fr 1fr 1fr 1fr"
        >
            ${repeat((t=>t.getWeekdayText()),(t=>{const o=t.tagFor(DataGridCell);return html`
        <${o}
            class="week-day"
            part="week-day"
            tabindex="-1"
            grid-column="${(t,o)=>o.index+1}"
            abbr="${t=>t.abbr}"
        >
            ${t=>t.text}
        </${o}>
    `})(t),{positioning:!0})}
        </${l}>
        ${repeat((t=>t.getDays()),calendarRowTemplate(t,o))}
    </${s}>
`};class Card$1 extends FoundationElement{}class _Checkbox extends FoundationElement{}class FormAssociatedCheckbox extends(CheckableFormAssociated(_Checkbox)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class Checkbox extends FormAssociatedCheckbox{constructor(){super(),this.initialValue="on",this.indeterminate=!1,this.keypressHandler=t=>{if(!this.readOnly&&t.key===JR)this.indeterminate&&(this.indeterminate=!1),this.checked=!this.checked},this.clickHandler=t=>{this.disabled||this.readOnly||(this.indeterminate&&(this.indeterminate=!1),this.checked=!this.checked)},this.proxy.setAttribute("type","checkbox")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly)}}function isListboxOption(t){return isHTMLElement(t)&&("option"===t.getAttribute("role")||t instanceof HTMLOptionElement)}__decorate$t([attr({attribute:"readonly",mode:"boolean"})],Checkbox.prototype,"readOnly",void 0),__decorate$t([observable],Checkbox.prototype,"defaultSlottedNodes",void 0),__decorate$t([observable],Checkbox.prototype,"indeterminate",void 0);class ListboxOption extends FoundationElement{constructor(t,o,s,l){super(),this.defaultSelected=!1,this.dirtySelected=!1,this.selected=this.defaultSelected,this.dirtyValue=!1,t&&(this.textContent=t),o&&(this.initialValue=o),s&&(this.defaultSelected=s),l&&(this.selected=l),this.proxy=new Option(`${this.textContent}`,this.initialValue,this.defaultSelected,this.selected),this.proxy.disabled=this.disabled}checkedChanged(t,o){this.ariaChecked="boolean"!=typeof o?null:o?"true":"false"}contentChanged(t,o){this.proxy instanceof HTMLOptionElement&&(this.proxy.textContent=this.textContent),this.$emit("contentchange",null,{bubbles:!0})}defaultSelectedChanged(){this.dirtySelected||(this.selected=this.defaultSelected,this.proxy instanceof HTMLOptionElement&&(this.proxy.selected=this.defaultSelected))}disabledChanged(t,o){this.ariaDisabled=this.disabled?"true":"false",this.proxy instanceof HTMLOptionElement&&(this.proxy.disabled=this.disabled)}selectedAttributeChanged(){this.defaultSelected=this.selectedAttribute,this.proxy instanceof HTMLOptionElement&&(this.proxy.defaultSelected=this.defaultSelected)}selectedChanged(){this.ariaSelected=this.selected?"true":"false",this.dirtySelected||(this.dirtySelected=!0),this.proxy instanceof HTMLOptionElement&&(this.proxy.selected=this.selected)}initialValueChanged(t,o){this.dirtyValue||(this.value=this.initialValue,this.dirtyValue=!1)}get label(){var t;return null!==(t=this.value)&&void 0!==t?t:this.text}get text(){var t,o;return null!==(o=null===(t=this.textContent)||void 0===t?void 0:t.replace(/\s+/g," ").trim())&&void 0!==o?o:""}set value(t){const o=`${null!=t?t:""}`;this._value=o,this.dirtyValue=!0,this.proxy instanceof HTMLOptionElement&&(this.proxy.value=o),zP.notify(this,"value")}get value(){var t;return zP.track(this,"value"),null!==(t=this._value)&&void 0!==t?t:this.text}get form(){return this.proxy?this.proxy.form:null}}__decorate$t([observable],ListboxOption.prototype,"checked",void 0),__decorate$t([observable],ListboxOption.prototype,"content",void 0),__decorate$t([observable],ListboxOption.prototype,"defaultSelected",void 0),__decorate$t([attr({mode:"boolean"})],ListboxOption.prototype,"disabled",void 0),__decorate$t([attr({attribute:"selected",mode:"boolean"})],ListboxOption.prototype,"selectedAttribute",void 0),__decorate$t([observable],ListboxOption.prototype,"selected",void 0),__decorate$t([attr({attribute:"value",mode:"fromView"})],ListboxOption.prototype,"initialValue",void 0);class DelegatesARIAListboxOption{}__decorate$t([observable],DelegatesARIAListboxOption.prototype,"ariaChecked",void 0),__decorate$t([observable],DelegatesARIAListboxOption.prototype,"ariaPosInSet",void 0),__decorate$t([observable],DelegatesARIAListboxOption.prototype,"ariaSelected",void 0),__decorate$t([observable],DelegatesARIAListboxOption.prototype,"ariaSetSize",void 0),applyMixins(DelegatesARIAListboxOption,ARIAGlobalStatesAndProperties),applyMixins(ListboxOption,StartEnd,DelegatesARIAListboxOption);class Listbox$1 extends FoundationElement{constructor(){super(...arguments),this._options=[],this.selectedIndex=-1,this.selectedOptions=[],this.shouldSkipFocus=!1,this.typeaheadBuffer="",this.typeaheadExpired=!0,this.typeaheadTimeout=-1}get firstSelectedOption(){var t;return null!==(t=this.selectedOptions[0])&&void 0!==t?t:null}get hasSelectableOptions(){return this.options.length>0&&!this.options.every((t=>t.disabled))}get length(){var t,o;return null!==(o=null===(t=this.options)||void 0===t?void 0:t.length)&&void 0!==o?o:0}get options(){return zP.track(this,"options"),this._options}set options(t){this._options=t,zP.notify(this,"options")}get typeAheadExpired(){return this.typeaheadExpired}set typeAheadExpired(t){this.typeaheadExpired=t}clickHandler(t){const o=t.target.closest("option,[role=option]");if(o&&!o.disabled)return this.selectedIndex=this.options.indexOf(o),!0}focusAndScrollOptionIntoView(t=this.firstSelectedOption){this.contains(document.activeElement)&&null!==t&&(t.focus(),requestAnimationFrame((()=>{t.scrollIntoView({block:"nearest"})})))}focusinHandler(t){this.shouldSkipFocus||t.target!==t.currentTarget||(this.setSelectedOptions(),this.focusAndScrollOptionIntoView()),this.shouldSkipFocus=!1}getTypeaheadMatches(){const t=this.typeaheadBuffer.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),o=new RegExp(`^${t}`,"gi");return this.options.filter((t=>t.text.trim().match(o)))}getSelectableIndex(t=this.selectedIndex,o){const s=t>o?-1:t<o?1:0,l=t+s;let h=null;switch(s){case-1:h=this.options.reduceRight(((t,o,s)=>!t&&!o.disabled&&s<l?o:t),h);break;case 1:h=this.options.reduce(((t,o,s)=>!t&&!o.disabled&&s>l?o:t),h)}return this.options.indexOf(h)}handleChange(t,o){if("selected"===o)Listbox$1.slottedOptionFilter(t)&&(this.selectedIndex=this.options.indexOf(t)),this.setSelectedOptions()}handleTypeAhead(t){this.typeaheadTimeout&&window.clearTimeout(this.typeaheadTimeout),this.typeaheadTimeout=window.setTimeout((()=>this.typeaheadExpired=!0),Listbox$1.TYPE_AHEAD_TIMEOUT_MS),t.length>1||(this.typeaheadBuffer=`${this.typeaheadExpired?"":this.typeaheadBuffer}${t}`)}keydownHandler(t){if(this.disabled)return!0;this.shouldSkipFocus=!1;const o=t.key;switch(o){case YR:t.shiftKey||(t.preventDefault(),this.selectFirstOption());break;case zR:t.shiftKey||(t.preventDefault(),this.selectNextOption());break;case KR:t.shiftKey||(t.preventDefault(),this.selectPreviousOption());break;case ZR:t.preventDefault(),this.selectLastOption();break;case XR:return this.focusAndScrollOptionIntoView(),!0;case WR:case QR:return!0;case JR:if(this.typeaheadExpired)return!0;default:return 1===o.length&&this.handleTypeAhead(`${o}`),!0}}mousedownHandler(t){return this.shouldSkipFocus=!this.contains(document.activeElement),!0}multipleChanged(t,o){this.ariaMultiSelectable=o?"true":null}selectedIndexChanged(t,o){var s;if(this.hasSelectableOptions){if((null===(s=this.options[this.selectedIndex])||void 0===s?void 0:s.disabled)&&"number"==typeof t){const s=this.getSelectableIndex(t,o),l=s>-1?s:t;return this.selectedIndex=l,void(o===l&&this.selectedIndexChanged(o,l))}this.setSelectedOptions()}else this.selectedIndex=-1}selectedOptionsChanged(t,o){var s;const l=o.filter(Listbox$1.slottedOptionFilter);null===(s=this.options)||void 0===s||s.forEach((t=>{const o=zP.getNotifier(t);o.unsubscribe(this,"selected"),t.selected=l.includes(t),o.subscribe(this,"selected")}))}selectFirstOption(){var t,o;this.disabled||(this.selectedIndex=null!==(o=null===(t=this.options)||void 0===t?void 0:t.findIndex((t=>!t.disabled)))&&void 0!==o?o:-1)}selectLastOption(){this.disabled||(this.selectedIndex=function findLastIndex(t,o){let s=t.length;for(;s--;)if(o(t[s],s,t))return s;return-1}(this.options,(t=>!t.disabled)))}selectNextOption(){!this.disabled&&this.selectedIndex<this.options.length-1&&(this.selectedIndex+=1)}selectPreviousOption(){!this.disabled&&this.selectedIndex>0&&(this.selectedIndex=this.selectedIndex-1)}setDefaultSelectedOption(){var t,o;this.selectedIndex=null!==(o=null===(t=this.options)||void 0===t?void 0:t.findIndex((t=>t.defaultSelected)))&&void 0!==o?o:-1}setSelectedOptions(){var t,o,s;(null===(t=this.options)||void 0===t?void 0:t.length)&&(this.selectedOptions=[this.options[this.selectedIndex]],this.ariaActiveDescendant=null!==(s=null===(o=this.firstSelectedOption)||void 0===o?void 0:o.id)&&void 0!==s?s:"",this.focusAndScrollOptionIntoView())}slottedOptionsChanged(t,o){this.options=o.reduce(((t,o)=>(isListboxOption(o)&&t.push(o),t)),[]);const s=`${this.options.length}`;this.options.forEach(((t,o)=>{t.id||(t.id=uniqueId("option-")),t.ariaPosInSet=`${o+1}`,t.ariaSetSize=s})),this.$fastController.isConnected&&(this.setSelectedOptions(),this.setDefaultSelectedOption())}typeaheadBufferChanged(t,o){if(this.$fastController.isConnected){const t=this.getTypeaheadMatches();if(t.length){const o=this.options.indexOf(t[0]);o>-1&&(this.selectedIndex=o)}this.typeaheadExpired=!1}}}Listbox$1.slottedOptionFilter=t=>isListboxOption(t)&&!t.hidden,Listbox$1.TYPE_AHEAD_TIMEOUT_MS=1e3,__decorate$t([attr({mode:"boolean"})],Listbox$1.prototype,"disabled",void 0),__decorate$t([observable],Listbox$1.prototype,"selectedIndex",void 0),__decorate$t([observable],Listbox$1.prototype,"selectedOptions",void 0),__decorate$t([observable],Listbox$1.prototype,"slottedOptions",void 0),__decorate$t([observable],Listbox$1.prototype,"typeaheadBuffer",void 0);class DelegatesARIAListbox{}__decorate$t([observable],DelegatesARIAListbox.prototype,"ariaActiveDescendant",void 0),__decorate$t([observable],DelegatesARIAListbox.prototype,"ariaDisabled",void 0),__decorate$t([observable],DelegatesARIAListbox.prototype,"ariaExpanded",void 0),__decorate$t([observable],DelegatesARIAListbox.prototype,"ariaMultiSelectable",void 0),applyMixins(DelegatesARIAListbox,ARIAGlobalStatesAndProperties),applyMixins(Listbox$1,DelegatesARIAListbox);const w$="above",C$="below";class _Combobox extends Listbox$1{}class FormAssociatedCombobox extends(FormAssociated(_Combobox)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}const _$="inline",k$="list",x$="both",S$="none";class Combobox$1 extends FormAssociatedCombobox{constructor(){super(...arguments),this._value="",this.filteredOptions=[],this.filter="",this.forcedPosition=!1,this.listboxId=uniqueId("listbox-"),this.maxHeight=0,this.open=!1}formResetCallback(){super.formResetCallback(),this.setDefaultSelectedOption(),this.updateValue()}validate(){super.validate(this.control)}get isAutocompleteInline(){return this.autocomplete===_$||this.isAutocompleteBoth}get isAutocompleteList(){return this.autocomplete===k$||this.isAutocompleteBoth}get isAutocompleteBoth(){return this.autocomplete===x$}openChanged(){if(this.open)return this.ariaControls=this.listboxId,this.ariaExpanded="true",this.setPositioning(),this.focusAndScrollOptionIntoView(),void jP.queueUpdate((()=>this.focus()));this.ariaControls="",this.ariaExpanded="false"}get options(){return zP.track(this,"options"),this.filteredOptions.length?this.filteredOptions:this._options}set options(t){this._options=t,zP.notify(this,"options")}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}positionChanged(t,o){this.positionAttribute=o,this.setPositioning()}get value(){return zP.track(this,"value"),this._value}set value(t){var o,s,l;const h=`${this._value}`;if(this.$fastController.isConnected&&this.options){const h=this.options.findIndex((o=>o.text.toLowerCase()===t.toLowerCase())),m=null===(o=this.options[this.selectedIndex])||void 0===o?void 0:o.text,_=null===(s=this.options[h])||void 0===s?void 0:s.text;this.selectedIndex=m!==_?h:this.selectedIndex,t=(null===(l=this.firstSelectedOption)||void 0===l?void 0:l.text)||t}h!==t&&(this._value=t,super.valueChanged(h,t),zP.notify(this,"value"))}clickHandler(t){if(!this.disabled){if(this.open){const o=t.target.closest("option,[role=option]");if(!o||o.disabled)return;this.selectedOptions=[o],this.control.value=o.text,this.clearSelectionRange(),this.updateValue(!0)}return this.open=!this.open,this.open&&this.control.focus(),!0}}connectedCallback(){super.connectedCallback(),this.forcedPosition=!!this.positionAttribute,this.value&&(this.initialValue=this.value)}disabledChanged(t,o){super.disabledChanged&&super.disabledChanged(t,o),this.ariaDisabled=this.disabled?"true":"false"}filterOptions(){this.autocomplete&&this.autocomplete!==S$||(this.filter="");const t=this.filter.toLowerCase();this.filteredOptions=this._options.filter((t=>t.text.toLowerCase().startsWith(this.filter.toLowerCase()))),this.isAutocompleteList&&(this.filteredOptions.length||t||(this.filteredOptions=this._options),this._options.forEach((t=>{t.hidden=!this.filteredOptions.includes(t)})))}focusAndScrollOptionIntoView(){this.contains(document.activeElement)&&(this.control.focus(),this.firstSelectedOption&&requestAnimationFrame((()=>{var t;null===(t=this.firstSelectedOption)||void 0===t||t.scrollIntoView({block:"nearest"})})))}focusoutHandler(t){if(this.syncValue(),!this.open)return!0;const o=t.relatedTarget;this.isSameNode(o)?this.focus():this.options&&this.options.includes(o)||(this.open=!1)}inputHandler(t){if(this.filter=this.control.value,this.filterOptions(),this.isAutocompleteInline||(this.selectedIndex=this.options.map((t=>t.text)).indexOf(this.control.value)),t.inputType.includes("deleteContent")||!this.filter.length)return!0;this.isAutocompleteList&&!this.open&&(this.open=!0),this.isAutocompleteInline&&(this.filteredOptions.length?(this.selectedOptions=[this.filteredOptions[0]],this.selectedIndex=this.options.indexOf(this.firstSelectedOption),this.setInlineSelection()):this.selectedIndex=-1)}keydownHandler(t){const o=t.key;if(t.ctrlKey||t.shiftKey)return!0;switch(o){case"Enter":this.syncValue(),this.isAutocompleteInline&&(this.filter=this.value),this.open=!1,this.clearSelectionRange();break;case"Escape":if(this.isAutocompleteInline||(this.selectedIndex=-1),this.open){this.open=!1;break}this.value="",this.control.value="",this.filter="",this.filterOptions();break;case"Tab":if(this.setInputToSelection(),!this.open)return!0;t.preventDefault(),this.open=!1;break;case"ArrowUp":case"ArrowDown":if(this.filterOptions(),!this.open){this.open=!0;break}this.filteredOptions.length>0&&super.keydownHandler(t),this.isAutocompleteInline&&this.setInlineSelection();break;default:return!0}}keyupHandler(t){switch(t.key){case"ArrowLeft":case"ArrowRight":case"Backspace":case"Delete":case"Home":case"End":this.filter=this.control.value,this.selectedIndex=-1,this.filterOptions()}}selectedIndexChanged(t,o){if(this.$fastController.isConnected){if((o=limit(-1,this.options.length-1,o))!==this.selectedIndex)return void(this.selectedIndex=o);super.selectedIndexChanged(t,o)}}selectPreviousOption(){!this.disabled&&this.selectedIndex>=0&&(this.selectedIndex=this.selectedIndex-1)}setDefaultSelectedOption(){if(this.$fastController.isConnected&&this.options){const t=this.options.findIndex((t=>null!==t.getAttribute("selected")||t.selected));this.selectedIndex=t,!this.dirtyValue&&this.firstSelectedOption&&(this.value=this.firstSelectedOption.text),this.setSelectedOptions()}}setInputToSelection(){this.firstSelectedOption&&(this.control.value=this.firstSelectedOption.text,this.control.focus())}setInlineSelection(){this.firstSelectedOption&&(this.setInputToSelection(),this.control.setSelectionRange(this.filter.length,this.control.value.length,"backward"))}syncValue(){var t;const o=this.selectedIndex>-1?null===(t=this.firstSelectedOption)||void 0===t?void 0:t.text:this.control.value;this.updateValue(this.value!==o)}setPositioning(){const t=this.getBoundingClientRect(),o=window.innerHeight-t.bottom;this.position=this.forcedPosition?this.positionAttribute:t.top>o?w$:C$,this.positionAttribute=this.forcedPosition?this.positionAttribute:this.position,this.maxHeight=this.position===w$?~~t.top:~~o}selectedOptionsChanged(t,o){this.$fastController.isConnected&&this._options.forEach((t=>{t.selected=o.includes(t)}))}slottedOptionsChanged(t,o){super.slottedOptionsChanged(t,o),this.updateValue()}updateValue(t){var o;this.$fastController.isConnected&&(this.value=(null===(o=this.firstSelectedOption)||void 0===o?void 0:o.text)||this.control.value,this.control.value=this.value),t&&this.$emit("change")}clearSelectionRange(){const t=this.control.value.length;this.control.setSelectionRange(t,t)}}__decorate$t([attr({attribute:"autocomplete",mode:"fromView"})],Combobox$1.prototype,"autocomplete",void 0),__decorate$t([observable],Combobox$1.prototype,"maxHeight",void 0),__decorate$t([attr({attribute:"open",mode:"boolean"})],Combobox$1.prototype,"open",void 0),__decorate$t([attr],Combobox$1.prototype,"placeholder",void 0),__decorate$t([attr({attribute:"position"})],Combobox$1.prototype,"positionAttribute",void 0),__decorate$t([observable],Combobox$1.prototype,"position",void 0);class DelegatesARIACombobox{}__decorate$t([observable],DelegatesARIACombobox.prototype,"ariaAutoComplete",void 0),__decorate$t([observable],DelegatesARIACombobox.prototype,"ariaControls",void 0),applyMixins(DelegatesARIACombobox,DelegatesARIAListbox),applyMixins(Combobox$1,StartEnd,DelegatesARIACombobox);function composedParent(t){const o=t.parentElement;if(o)return o;{const o=t.getRootNode();if(o.host instanceof HTMLElement)return o.host}return null}const T$=document.createElement("div");class QueuedStyleSheetTarget{setProperty(t,o){jP.queueUpdate((()=>this.target.setProperty(t,o)))}removeProperty(t){jP.queueUpdate((()=>this.target.removeProperty(t)))}}class DocumentStyleSheetTarget extends QueuedStyleSheetTarget{constructor(){super();const t=new CSSStyleSheet;this.target=t.cssRules[t.insertRule(":root{}")].style,document.adoptedStyleSheets=[...document.adoptedStyleSheets,t]}}class HeadStyleElementStyleSheetTarget extends QueuedStyleSheetTarget{constructor(){super(),this.style=document.createElement("style"),document.head.appendChild(this.style);const{sheet:t}=this.style;if(t){const o=t.insertRule(":root{}",t.cssRules.length);this.target=t.cssRules[o].style}}}class StyleElementStyleSheetTarget{constructor(t){this.store=new Map,this.target=null;const o=t.$fastController;this.style=document.createElement("style"),o.addStyles(this.style),zP.getNotifier(o).subscribe(this,"isConnected"),this.handleChange(o,"isConnected")}targetChanged(){if(null!==this.target)for(const[t,o]of this.store.entries())this.target.setProperty(t,o)}setProperty(t,o){this.store.set(t,o),jP.queueUpdate((()=>{null!==this.target&&this.target.setProperty(t,o)}))}removeProperty(t){this.store.delete(t),jP.queueUpdate((()=>{null!==this.target&&this.target.removeProperty(t)}))}handleChange(t,o){const{sheet:s}=this.style;if(s){const t=s.insertRule(":host{}",s.cssRules.length);this.target=s.cssRules[t].style}else this.target=null}}__decorate$t([observable],StyleElementStyleSheetTarget.prototype,"target",void 0);class ElementStyleSheetTarget{constructor(t){this.target=t.style}setProperty(t,o){jP.queueUpdate((()=>this.target.setProperty(t,o)))}removeProperty(t){jP.queueUpdate((()=>this.target.removeProperty(t)))}}class RootStyleSheetTarget{setProperty(t,o){RootStyleSheetTarget.properties[t]=o;for(const s of RootStyleSheetTarget.roots.values())I$.getOrCreate(RootStyleSheetTarget.normalizeRoot(s)).setProperty(t,o)}removeProperty(t){delete RootStyleSheetTarget.properties[t];for(const o of RootStyleSheetTarget.roots.values())I$.getOrCreate(RootStyleSheetTarget.normalizeRoot(o)).removeProperty(t)}static registerRoot(t){const{roots:o}=RootStyleSheetTarget;if(!o.has(t)){o.add(t);const s=I$.getOrCreate(this.normalizeRoot(t));for(const t in RootStyleSheetTarget.properties)s.setProperty(t,RootStyleSheetTarget.properties[t])}}static unregisterRoot(t){const{roots:o}=RootStyleSheetTarget;if(o.has(t)){o.delete(t);const s=I$.getOrCreate(RootStyleSheetTarget.normalizeRoot(t));for(const t in RootStyleSheetTarget.properties)s.removeProperty(t)}}static normalizeRoot(t){return t===T$?document:t}}RootStyleSheetTarget.roots=new Set,RootStyleSheetTarget.properties={};const E$=new WeakMap,A$=jP.supportsAdoptedStyleSheets?class ConstructableStyleSheetTarget extends QueuedStyleSheetTarget{constructor(t){super();const o=new CSSStyleSheet;this.target=o.cssRules[o.insertRule(":host{}")].style,t.$fastController.addStyles(ElementStyles.create([o]))}}:StyleElementStyleSheetTarget,I$=Object.freeze({getOrCreate(t){if(E$.has(t))return E$.get(t);let o;return o=t===T$?new RootStyleSheetTarget:t instanceof Document?jP.supportsAdoptedStyleSheets?new DocumentStyleSheetTarget:new HeadStyleElementStyleSheetTarget:function isFastElement(t){return t instanceof sR}(t)?new A$(t):new ElementStyleSheetTarget(t),E$.set(t,o),o}});class DesignTokenImpl extends CSSDirective{constructor(t){super(),this.subscribers=new WeakMap,this._appliedTo=new Set,this.name=t.name,null!==t.cssCustomPropertyName&&(this.cssCustomProperty=`--${t.cssCustomPropertyName}`,this.cssVar=`var(${this.cssCustomProperty})`),this.id=DesignTokenImpl.uniqueId(),DesignTokenImpl.tokensById.set(this.id,this)}get appliedTo(){return[...this._appliedTo]}static from(t){return new DesignTokenImpl({name:"string"==typeof t?t:t.name,cssCustomPropertyName:"string"==typeof t?t:void 0===t.cssCustomPropertyName?t.name:t.cssCustomPropertyName})}static isCSSDesignToken(t){return"string"==typeof t.cssCustomProperty}static isDerivedDesignTokenValue(t){return"function"==typeof t}static getTokenById(t){return DesignTokenImpl.tokensById.get(t)}getOrCreateSubscriberSet(t=this){return this.subscribers.get(t)||this.subscribers.set(t,new Set)&&this.subscribers.get(t)}createCSS(){return this.cssVar||""}getValueFor(t){const o=DesignTokenNode.getOrCreate(t).get(this);if(void 0!==o)return o;throw new Error(`Value could not be retrieved for token named "${this.name}". Ensure the value is set for ${t} or an ancestor of ${t}.`)}setValueFor(t,o){return this._appliedTo.add(t),o instanceof DesignTokenImpl&&(o=this.alias(o)),DesignTokenNode.getOrCreate(t).set(this,o),this}deleteValueFor(t){return this._appliedTo.delete(t),DesignTokenNode.existsFor(t)&&DesignTokenNode.getOrCreate(t).delete(this),this}withDefault(t){return this.setValueFor(T$,t),this}subscribe(t,o){const s=this.getOrCreateSubscriberSet(o);o&&!DesignTokenNode.existsFor(o)&&DesignTokenNode.getOrCreate(o),s.has(t)||s.add(t)}unsubscribe(t,o){const s=this.subscribers.get(o||this);s&&s.has(t)&&s.delete(t)}notify(t){const o=Object.freeze({token:this,target:t});this.subscribers.has(this)&&this.subscribers.get(this).forEach((t=>t.handleChange(o))),this.subscribers.has(t)&&this.subscribers.get(t).forEach((t=>t.handleChange(o)))}alias(t){return o=>t.getValueFor(o)}}DesignTokenImpl.uniqueId=(()=>{let t=0;return()=>(t++,t.toString(16))})(),DesignTokenImpl.tokensById=new Map;class DesignTokenBindingObserver{constructor(t,o,s){this.source=t,this.token=o,this.node=s,this.dependencies=new Set,this.observer=zP.binding(t,this,!1),this.observer.handleChange=this.observer.call,this.handleChange()}disconnect(){this.observer.disconnect()}handleChange(){this.node.store.set(this.token,this.observer.observe(this.node.target,GP))}}class Store{constructor(){this.values=new Map}set(t,o){this.values.get(t)!==o&&(this.values.set(t,o),zP.getNotifier(this).notify(t.id))}get(t){return zP.track(this,t.id),this.values.get(t)}delete(t){this.values.delete(t)}all(){return this.values.entries()}}const P$=new WeakMap,R$=new WeakMap;class DesignTokenNode{constructor(t){this.target=t,this.store=new Store,this.children=[],this.assignedValues=new Map,this.reflecting=new Set,this.bindingObservers=new Map,this.tokenValueChangeHandler={handleChange:(t,o)=>{const s=DesignTokenImpl.getTokenById(o);if(s&&(s.notify(this.target),DesignTokenImpl.isCSSDesignToken(s))){const o=this.parent,l=this.isReflecting(s);if(o){const h=o.get(s),m=t.get(s);h===m||l?h===m&&l&&this.stopReflectToCSS(s):this.reflectToCSS(s)}else l||this.reflectToCSS(s)}}},P$.set(t,this),zP.getNotifier(this.store).subscribe(this.tokenValueChangeHandler),t instanceof sR?t.$fastController.addBehaviors([this]):t.isConnected&&this.bind()}static getOrCreate(t){return P$.get(t)||new DesignTokenNode(t)}static existsFor(t){return P$.has(t)}static findParent(t){if(T$!==t.target){let o=composedParent(t.target);for(;null!==o;){if(P$.has(o))return P$.get(o);o=composedParent(o)}return DesignTokenNode.getOrCreate(T$)}return null}static findClosestAssignedNode(t,o){let s=o;do{if(s.has(t))return s;s=s.parent?s.parent:s.target!==T$?DesignTokenNode.getOrCreate(T$):null}while(null!==s);return null}get parent(){return R$.get(this)||null}has(t){return this.assignedValues.has(t)}get(t){const o=this.store.get(t);if(void 0!==o)return o;const s=this.getRaw(t);return void 0!==s?(this.hydrate(t,s),this.get(t)):void 0}getRaw(t){var o;return this.assignedValues.has(t)?this.assignedValues.get(t):null===(o=DesignTokenNode.findClosestAssignedNode(t,this))||void 0===o?void 0:o.getRaw(t)}set(t,o){DesignTokenImpl.isDerivedDesignTokenValue(this.assignedValues.get(t))&&this.tearDownBindingObserver(t),this.assignedValues.set(t,o),DesignTokenImpl.isDerivedDesignTokenValue(o)?this.setupBindingObserver(t,o):this.store.set(t,o)}delete(t){this.assignedValues.delete(t),this.tearDownBindingObserver(t);const o=this.getRaw(t);o?this.hydrate(t,o):this.store.delete(t)}bind(){const t=DesignTokenNode.findParent(this);t&&t.appendChild(this);for(const t of this.assignedValues.keys())t.notify(this.target)}unbind(){if(this.parent){R$.get(this).removeChild(this)}}appendChild(t){t.parent&&R$.get(t).removeChild(t);const o=this.children.filter((o=>t.contains(o)));R$.set(t,this),this.children.push(t),o.forEach((o=>t.appendChild(o))),zP.getNotifier(this.store).subscribe(t);for(const[o,s]of this.store.all())t.hydrate(o,this.bindingObservers.has(o)?this.getRaw(o):s)}removeChild(t){const o=this.children.indexOf(t);return-1!==o&&this.children.splice(o,1),zP.getNotifier(this.store).unsubscribe(t),t.parent===this&&R$.delete(t)}contains(t){return function composedContains(t,o){let s=o;for(;null!==s;){if(s===t)return!0;s=composedParent(s)}return!1}(this.target,t.target)}reflectToCSS(t){this.isReflecting(t)||(this.reflecting.add(t),DesignTokenNode.cssCustomPropertyReflector.startReflection(t,this.target))}stopReflectToCSS(t){this.isReflecting(t)&&(this.reflecting.delete(t),DesignTokenNode.cssCustomPropertyReflector.stopReflection(t,this.target))}isReflecting(t){return this.reflecting.has(t)}handleChange(t,o){const s=DesignTokenImpl.getTokenById(o);s&&this.hydrate(s,this.getRaw(s))}hydrate(t,o){if(!this.has(t)){const s=this.bindingObservers.get(t);DesignTokenImpl.isDerivedDesignTokenValue(o)?s?s.source!==o&&(this.tearDownBindingObserver(t),this.setupBindingObserver(t,o)):this.setupBindingObserver(t,o):(s&&this.tearDownBindingObserver(t),this.store.set(t,o))}}setupBindingObserver(t,o){const s=new DesignTokenBindingObserver(o,t,this);return this.bindingObservers.set(t,s),s}tearDownBindingObserver(t){return!!this.bindingObservers.has(t)&&(this.bindingObservers.get(t).disconnect(),this.bindingObservers.delete(t),!0)}}DesignTokenNode.cssCustomPropertyReflector=new class CustomPropertyReflector{startReflection(t,o){t.subscribe(this,o),this.handleChange({token:t,target:o})}stopReflection(t,o){t.unsubscribe(this,o),this.remove(t,o)}handleChange(t){const{token:o,target:s}=t;this.add(o,s)}add(t,o){I$.getOrCreate(o).setProperty(t.cssCustomProperty,this.resolveCSSValue(DesignTokenNode.getOrCreate(o).get(t)))}remove(t,o){I$.getOrCreate(o).removeProperty(t.cssCustomProperty)}resolveCSSValue(t){return t&&"function"==typeof t.createCSS?t.createCSS():t}},__decorate$t([observable],DesignTokenNode.prototype,"children",void 0);const $$=Object.freeze({create:function create$2(t){return DesignTokenImpl.from(t)},notifyConnection:t=>!(!t.isConnected||!DesignTokenNode.existsFor(t))&&(DesignTokenNode.getOrCreate(t).bind(),!0),notifyDisconnection:t=>!(t.isConnected||!DesignTokenNode.existsFor(t))&&(DesignTokenNode.getOrCreate(t).unbind(),!0),registerRoot(t=T$){RootStyleSheetTarget.registerRoot(t)},unregisterRoot(t=T$){RootStyleSheetTarget.unregisterRoot(t)}}),M$=Object.freeze({definitionCallbackOnly:null,ignoreDuplicate:Symbol()}),O$=new Map,N$=new Map;let D$=null;const L$=CR.createInterface((t=>t.cachedCallback((t=>(null===D$&&(D$=new DefaultDesignSystem(null,t)),D$))))),F$=Object.freeze({tagFor:t=>N$.get(t),responsibleFor(t){const o=t.$$designSystem$$;if(o)return o;return CR.findResponsibleContainer(t).get(L$)},getOrCreate(t){if(!t)return null===D$&&(D$=CR.getOrCreateDOMContainer().get(L$)),D$;const o=t.$$designSystem$$;if(o)return o;const s=CR.getOrCreateDOMContainer(t);if(s.has(L$,!1))return s.get(L$);{const o=new DefaultDesignSystem(t,s);return s.register(IR.instance(L$,o)),o}}});class DefaultDesignSystem{constructor(t,o){this.owner=t,this.container=o,this.designTokensInitialized=!1,this.prefix="fast",this.shadowRootMode=void 0,this.disambiguate=()=>M$.definitionCallbackOnly,null!==t&&(t.$$designSystem$$=this)}withPrefix(t){return this.prefix=t,this}withShadowRootMode(t){return this.shadowRootMode=t,this}withElementDisambiguation(t){return this.disambiguate=t,this}withDesignTokenRoot(t){return this.designTokenRoot=t,this}register(...t){const o=this.container,s=[],l=this.disambiguate,h=this.shadowRootMode,m={elementPrefix:this.prefix,tryDefineElement(t,m,_){const E=function extractTryDefineElementParams(t,o,s){return"string"==typeof t?{name:t,type:o,callback:s}:t}(t,m,_),{name:$,callback:B,baseClass:q}=E;let{type:j}=E,K=$,W=O$.get(K),X=!0;for(;W;){const t=l(K,j,W);switch(t){case M$.ignoreDuplicate:return;case M$.definitionCallbackOnly:X=!1,W=void 0;break;default:K=t,W=O$.get(K)}}X&&((N$.has(j)||j===FoundationElement)&&(j=class extends j{}),O$.set(K,j),N$.set(j,K),q&&N$.set(q,K)),s.push(new ElementDefinitionEntry(o,K,j,h,B,X))}};this.designTokensInitialized||(this.designTokensInitialized=!0,null!==this.designTokenRoot&&$$.registerRoot(this.designTokenRoot)),o.registerWithContext(m,...t);for(const t of s)t.callback(t),t.willDefine&&null!==t.definition&&t.definition.define();return this}}class ElementDefinitionEntry{constructor(t,o,s,l,h,m){this.container=t,this.name=o,this.type=s,this.shadowRootMode=l,this.callback=h,this.willDefine=m,this.definition=null}definePresentation(t){OR.define(this.name,t,this.container)}defineElement(t){this.definition=new FASTElementDefinition(this.type,Object.assign(Object.assign({},t),{name:this.name}))}tagFor(t){return F$.tagFor(t)}}
/*!
* tabbable 5.3.3
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/
var B$=["input","select","textarea","a[href]","button","[tabindex]:not(slot)","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"].join(","),H$="undefined"==typeof Element,U$=H$?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,q$=!H$&&Element.prototype.getRootNode?function(t){return t.getRootNode()}:function(t){return t.ownerDocument},j$=function isInput(t){return"INPUT"===t.tagName},z$=function isNonTabbableRadio(t){return function isRadio(t){return j$(t)&&"radio"===t.type}(t)&&!function isTabbableRadio(t){if(!t.name)return!0;var o,s=t.form||q$(t),l=function queryRadios(t){return s.querySelectorAll('input[type="radio"][name="'+t+'"]')};if("undefined"!=typeof window&&void 0!==window.CSS&&"function"==typeof window.CSS.escape)o=l(window.CSS.escape(t.name));else try{o=l(t.name)}catch(t){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",t.message),!1}var h=function getCheckedRadio(t,o){for(var s=0;s<t.length;s++)if(t[s].checked&&t[s].form===o)return t[s]}(o,t.form);return!h||h===t}(t)},V$=function isZeroArea(t){var o=t.getBoundingClientRect(),s=o.width,l=o.height;return 0===s&&0===l},G$=function isNodeMatchingSelectorFocusable(t,o){return!(o.disabled||function isHiddenInput(t){return j$(t)&&"hidden"===t.type}(o)||function isHidden(t,o){var s=o.displayCheck,l=o.getShadowRoot;if("hidden"===getComputedStyle(t).visibility)return!0;var h=U$.call(t,"details>summary:first-of-type")?t.parentElement:t;if(U$.call(h,"details:not([open]) *"))return!0;var m=q$(t).host,_=(null==m?void 0:m.ownerDocument.contains(m))||t.ownerDocument.contains(t);if(s&&"full"!==s){if("non-zero-area"===s)return V$(t)}else{if("function"==typeof l){for(var E=t;t;){var $=t.parentElement,B=q$(t);if($&&!$.shadowRoot&&!0===l($))return V$(t);t=t.assignedSlot?t.assignedSlot:$||B===t.ownerDocument?$:B.host}t=E}if(_)return!t.getClientRects().length}return!1}(o,t)||function isDetailsWithSummary(t){return"DETAILS"===t.tagName&&Array.prototype.slice.apply(t.children).some((function(t){return"SUMMARY"===t.tagName}))}(o)||function isDisabledFromFieldset(t){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(t.tagName))for(var o=t.parentElement;o;){if("FIELDSET"===o.tagName&&o.disabled){for(var s=0;s<o.children.length;s++){var l=o.children.item(s);if("LEGEND"===l.tagName)return!!U$.call(o,"fieldset[disabled] *")||!l.contains(t)}return!0}o=o.parentElement}return!1}(o))},K$=function isNodeMatchingSelectorTabbable(t,o){return!(z$(o)||function getTabindex(t,o){return t.tabIndex<0&&(o||/^(AUDIO|VIDEO|DETAILS)$/.test(t.tagName)||t.isContentEditable)&&isNaN(parseInt(t.getAttribute("tabindex"),10))?0:t.tabIndex}(o)<0||!G$(t,o))},W$=function isTabbable(t,o){if(o=o||{},!t)throw new Error("No node provided");return!1!==U$.call(t,B$)&&K$(o,t)};class Dialog extends FoundationElement{constructor(){super(...arguments),this.modal=!0,this.hidden=!1,this.trapFocus=!0,this.trapFocusChanged=()=>{this.$fastController.isConnected&&this.updateTrapFocus()},this.isTrappingFocus=!1,this.handleDocumentKeydown=t=>{if(!t.defaultPrevented&&!this.hidden)switch(t.key){case QR:this.dismiss(),t.preventDefault();break;case XR:this.handleTabKeyDown(t)}},this.handleDocumentFocus=t=>{!t.defaultPrevented&&this.shouldForceFocus(t.target)&&(this.focusFirstElement(),t.preventDefault())},this.handleTabKeyDown=t=>{if(!this.trapFocus||this.hidden)return;const o=this.getTabQueueBounds();return 0!==o.length?1===o.length?(o[0].focus(),void t.preventDefault()):void(t.shiftKey&&t.target===o[0]?(o[o.length-1].focus(),t.preventDefault()):t.shiftKey||t.target!==o[o.length-1]||(o[0].focus(),t.preventDefault())):void 0},this.getTabQueueBounds=()=>Dialog.reduceTabbableItems([],this),this.focusFirstElement=()=>{const t=this.getTabQueueBounds();t.length>0?t[0].focus():this.dialog instanceof HTMLElement&&this.dialog.focus()},this.shouldForceFocus=t=>this.isTrappingFocus&&!this.contains(t),this.shouldTrapFocus=()=>this.trapFocus&&!this.hidden,this.updateTrapFocus=t=>{const o=void 0===t?this.shouldTrapFocus():t;o&&!this.isTrappingFocus?(this.isTrappingFocus=!0,document.addEventListener("focusin",this.handleDocumentFocus),jP.queueUpdate((()=>{this.shouldForceFocus(document.activeElement)&&this.focusFirstElement()}))):!o&&this.isTrappingFocus&&(this.isTrappingFocus=!1,document.removeEventListener("focusin",this.handleDocumentFocus))}}dismiss(){this.$emit("dismiss"),this.$emit("cancel")}show(){this.hidden=!1}hide(){this.hidden=!0,this.$emit("close")}connectedCallback(){super.connectedCallback(),document.addEventListener("keydown",this.handleDocumentKeydown),this.notifier=zP.getNotifier(this),this.notifier.subscribe(this,"hidden"),this.updateTrapFocus()}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("keydown",this.handleDocumentKeydown),this.updateTrapFocus(!1),this.notifier.unsubscribe(this,"hidden")}handleChange(t,o){if("hidden"===o)this.updateTrapFocus()}static reduceTabbableItems(t,o){return"-1"===o.getAttribute("tabindex")?t:W$(o)||Dialog.isFocusableFastElement(o)&&Dialog.hasTabbableShadow(o)?(t.push(o),t):o.childElementCount?t.concat(Array.from(o.children).reduce(Dialog.reduceTabbableItems,[])):t}static isFocusableFastElement(t){var o,s;return!!(null===(s=null===(o=t.$fastController)||void 0===o?void 0:o.definition.shadowOptions)||void 0===s?void 0:s.delegatesFocus)}static hasTabbableShadow(t){var o,s;return Array.from(null!==(s=null===(o=t.shadowRoot)||void 0===o?void 0:o.querySelectorAll("*"))&&void 0!==s?s:[]).some((t=>W$(t)))}}__decorate$t([attr({mode:"boolean"})],Dialog.prototype,"modal",void 0),__decorate$t([attr({mode:"boolean"})],Dialog.prototype,"hidden",void 0),__decorate$t([attr({attribute:"trap-focus",mode:"boolean"})],Dialog.prototype,"trapFocus",void 0),__decorate$t([attr({attribute:"aria-describedby"})],Dialog.prototype,"ariaDescribedby",void 0),__decorate$t([attr({attribute:"aria-labelledby"})],Dialog.prototype,"ariaLabelledby",void 0),__decorate$t([attr({attribute:"aria-label"})],Dialog.prototype,"ariaLabel",void 0);const Q$="separator";class Divider extends FoundationElement{constructor(){super(...arguments),this.role=Q$,this.orientation=NR}}__decorate$t([attr],Divider.prototype,"role",void 0),__decorate$t([attr],Divider.prototype,"orientation",void 0);class ListboxElement extends Listbox$1{constructor(){super(...arguments),this.activeIndex=-1,this.rangeStartIndex=-1}get activeOption(){return this.options[this.activeIndex]}get checkedOptions(){var t;return null===(t=this.options)||void 0===t?void 0:t.filter((t=>t.checked))}get firstSelectedOptionIndex(){return this.options.indexOf(this.firstSelectedOption)}activeIndexChanged(t,o){var s,l;this.ariaActiveDescendant=null!==(l=null===(s=this.options[o])||void 0===s?void 0:s.id)&&void 0!==l?l:"",this.focusAndScrollOptionIntoView()}checkActiveIndex(){if(!this.multiple)return;const t=this.activeOption;t&&(t.checked=!0)}checkFirstOption(t=!1){t?(-1===this.rangeStartIndex&&(this.rangeStartIndex=this.activeIndex+1),this.options.forEach(((t,o)=>{t.checked=inRange(o,this.rangeStartIndex)}))):this.uncheckAllOptions(),this.activeIndex=0,this.checkActiveIndex()}checkLastOption(t=!1){t?(-1===this.rangeStartIndex&&(this.rangeStartIndex=this.activeIndex),this.options.forEach(((t,o)=>{t.checked=inRange(o,this.rangeStartIndex,this.options.length)}))):this.uncheckAllOptions(),this.activeIndex=this.options.length-1,this.checkActiveIndex()}connectedCallback(){super.connectedCallback(),this.addEventListener("focusout",this.focusoutHandler)}disconnectedCallback(){this.removeEventListener("focusout",this.focusoutHandler),super.disconnectedCallback()}checkNextOption(t=!1){t?(-1===this.rangeStartIndex&&(this.rangeStartIndex=this.activeIndex),this.options.forEach(((t,o)=>{t.checked=inRange(o,this.rangeStartIndex,this.activeIndex+1)}))):this.uncheckAllOptions(),this.activeIndex+=this.activeIndex<this.options.length-1?1:0,this.checkActiveIndex()}checkPreviousOption(t=!1){t?(-1===this.rangeStartIndex&&(this.rangeStartIndex=this.activeIndex),1===this.checkedOptions.length&&(this.rangeStartIndex+=1),this.options.forEach(((t,o)=>{t.checked=inRange(o,this.activeIndex,this.rangeStartIndex)}))):this.uncheckAllOptions(),this.activeIndex-=this.activeIndex>0?1:0,this.checkActiveIndex()}clickHandler(t){var o;if(!this.multiple)return super.clickHandler(t);const s=null===(o=t.target)||void 0===o?void 0:o.closest("[role=option]");return s&&!s.disabled?(this.uncheckAllOptions(),this.activeIndex=this.options.indexOf(s),this.checkActiveIndex(),this.toggleSelectedForAllCheckedOptions(),!0):void 0}focusAndScrollOptionIntoView(){super.focusAndScrollOptionIntoView(this.activeOption)}focusinHandler(t){if(!this.multiple)return super.focusinHandler(t);this.shouldSkipFocus||t.target!==t.currentTarget||(this.uncheckAllOptions(),-1===this.activeIndex&&(this.activeIndex=-1!==this.firstSelectedOptionIndex?this.firstSelectedOptionIndex:0),this.checkActiveIndex(),this.setSelectedOptions(),this.focusAndScrollOptionIntoView()),this.shouldSkipFocus=!1}focusoutHandler(t){this.multiple&&this.uncheckAllOptions()}keydownHandler(t){if(!this.multiple)return super.keydownHandler(t);if(this.disabled)return!0;const{key:o,shiftKey:s}=t;switch(this.shouldSkipFocus=!1,o){case YR:return void this.checkFirstOption(s);case zR:return void this.checkNextOption(s);case KR:return void this.checkPreviousOption(s);case ZR:return void this.checkLastOption(s);case XR:return this.focusAndScrollOptionIntoView(),!0;case QR:return this.uncheckAllOptions(),this.checkActiveIndex(),!0;case JR:if(t.preventDefault(),this.typeAheadExpired)return void this.toggleSelectedForAllCheckedOptions();default:return 1===o.length&&this.handleTypeAhead(`${o}`),!0}}mousedownHandler(t){if(t.offsetX>=0&&t.offsetX<=this.scrollWidth)return super.mousedownHandler(t)}multipleChanged(t,o){var s;this.ariaMultiSelectable=o?"true":null,null===(s=this.options)||void 0===s||s.forEach((t=>{t.checked=!o&&void 0})),this.setSelectedOptions()}setSelectedOptions(){this.multiple?this.$fastController.isConnected&&this.options&&(this.selectedOptions=this.options.filter((t=>t.selected)),this.focusAndScrollOptionIntoView()):super.setSelectedOptions()}sizeChanged(t,o){var s;const l=Math.max(0,parseInt(null!==(s=null==o?void 0:o.toFixed())&&void 0!==s?s:"",10));l!==o&&jP.queueUpdate((()=>{this.size=l}))}toggleSelectedForAllCheckedOptions(){const t=this.checkedOptions.filter((t=>!t.disabled)),o=!t.every((t=>t.selected));t.forEach((t=>t.selected=o)),this.selectedIndex=this.options.indexOf(t[t.length-1]),this.setSelectedOptions()}typeaheadBufferChanged(t,o){if(this.multiple){if(this.$fastController.isConnected){const t=this.getTypeaheadMatches(),o=this.options.indexOf(t[0]);o>-1&&(this.activeIndex=o,this.uncheckAllOptions(),this.checkActiveIndex()),this.typeAheadExpired=!1}}else super.typeaheadBufferChanged(t,o)}uncheckAllOptions(t=!1){this.options.forEach((t=>t.checked=!this.multiple&&void 0)),t||(this.rangeStartIndex=-1)}}__decorate$t([observable],ListboxElement.prototype,"activeIndex",void 0),__decorate$t([attr({mode:"boolean"})],ListboxElement.prototype,"multiple",void 0),__decorate$t([attr({converter:eR})],ListboxElement.prototype,"size",void 0);const Y$="menuitem",Z$="menuitemcheckbox",J$="menuitemradio",X$={[Y$]:"menuitem",[Z$]:"menuitemcheckbox",[J$]:"menuitemradio"};class MenuItem extends FoundationElement{constructor(){super(...arguments),this.role=Y$,this.hasSubmenu=!1,this.currentDirection=t$.ltr,this.focusSubmenuOnLoad=!1,this.handleMenuItemKeyDown=t=>{if(t.defaultPrevented)return!1;switch(t.key){case WR:case JR:return this.invoke(),!1;case GR:return this.expandAndFocus(),!1;case VR:if(this.expanded)return this.expanded=!1,this.focus(),!1}return!0},this.handleMenuItemClick=t=>(t.defaultPrevented||this.disabled||this.invoke(),!1),this.submenuLoaded=()=>{this.focusSubmenuOnLoad&&(this.focusSubmenuOnLoad=!1,this.hasSubmenu&&(this.submenu.focus(),this.setAttribute("tabindex","-1")))},this.handleMouseOver=t=>(this.disabled||!this.hasSubmenu||this.expanded||(this.expanded=!0),!1),this.handleMouseOut=t=>(!this.expanded||this.contains(document.activeElement)||(this.expanded=!1),!1),this.expandAndFocus=()=>{this.hasSubmenu&&(this.focusSubmenuOnLoad=!0,this.expanded=!0)},this.invoke=()=>{if(!this.disabled)switch(this.role){case Z$:this.checked=!this.checked;break;case Y$:this.updateSubmenu(),this.hasSubmenu?this.expandAndFocus():this.$emit("change");break;case J$:this.checked||(this.checked=!0)}},this.updateSubmenu=()=>{this.submenu=this.domChildren().find((t=>"menu"===t.getAttribute("role"))),this.hasSubmenu=void 0!==this.submenu}}expandedChanged(t){if(this.$fastController.isConnected){if(void 0===this.submenu)return;!1===this.expanded?this.submenu.collapseExpandedItem():this.currentDirection=getDirection(this),this.$emit("expanded-change",this,{bubbles:!1})}}checkedChanged(t,o){this.$fastController.isConnected&&this.$emit("change")}connectedCallback(){super.connectedCallback(),jP.queueUpdate((()=>{this.updateSubmenu()})),this.startColumnCount||(this.startColumnCount=1),this.observer=new MutationObserver(this.updateSubmenu)}disconnectedCallback(){super.disconnectedCallback(),this.submenu=void 0,void 0!==this.observer&&(this.observer.disconnect(),this.observer=void 0)}domChildren(){return Array.from(this.children).filter((t=>!t.hasAttribute("hidden")))}}__decorate$t([attr({mode:"boolean"})],MenuItem.prototype,"disabled",void 0),__decorate$t([attr({mode:"boolean"})],MenuItem.prototype,"expanded",void 0),__decorate$t([observable],MenuItem.prototype,"startColumnCount",void 0),__decorate$t([attr],MenuItem.prototype,"role",void 0),__decorate$t([attr({mode:"boolean"})],MenuItem.prototype,"checked",void 0),__decorate$t([observable],MenuItem.prototype,"submenuRegion",void 0),__decorate$t([observable],MenuItem.prototype,"hasSubmenu",void 0),__decorate$t([observable],MenuItem.prototype,"currentDirection",void 0),__decorate$t([observable],MenuItem.prototype,"submenu",void 0),applyMixins(MenuItem,StartEnd);class Menu$1 extends FoundationElement{constructor(){super(...arguments),this.expandedItem=null,this.focusIndex=-1,this.isNestedMenu=()=>null!==this.parentElement&&isHTMLElement(this.parentElement)&&"menuitem"===this.parentElement.getAttribute("role"),this.handleFocusOut=t=>{if(!this.contains(t.relatedTarget)&&void 0!==this.menuItems){this.collapseExpandedItem();const t=this.menuItems.findIndex(this.isFocusableElement);this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.menuItems[t].setAttribute("tabindex","0"),this.focusIndex=t}},this.handleItemFocus=t=>{const o=t.target;void 0!==this.menuItems&&o!==this.menuItems[this.focusIndex]&&(this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.focusIndex=this.menuItems.indexOf(o),o.setAttribute("tabindex","0"))},this.handleExpandedChanged=t=>{if(t.defaultPrevented||null===t.target||void 0===this.menuItems||this.menuItems.indexOf(t.target)<0)return;t.preventDefault();const o=t.target;null===this.expandedItem||o!==this.expandedItem||!1!==o.expanded?o.expanded&&(null!==this.expandedItem&&this.expandedItem!==o&&(this.expandedItem.expanded=!1),this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.expandedItem=o,this.focusIndex=this.menuItems.indexOf(o),o.setAttribute("tabindex","0")):this.expandedItem=null},this.removeItemListeners=()=>{void 0!==this.menuItems&&this.menuItems.forEach((t=>{t.removeEventListener("expanded-change",this.handleExpandedChanged),t.removeEventListener("focus",this.handleItemFocus)}))},this.setItems=()=>{const t=this.domChildren();this.removeItemListeners(),this.menuItems=t;const o=this.menuItems.filter(this.isMenuItemElement);o.length&&(this.focusIndex=0);const s=o.reduce(((t,o)=>{const s=function elementIndent(t){const o=t.getAttribute("role"),s=t.querySelector("[slot=start]");return o!==Y$&&null===s||o===Y$&&null!==s?1:o!==Y$&&null!==s?2:0}(o);return t>s?t:s}),0);o.forEach(((t,o)=>{t.setAttribute("tabindex",0===o?"0":"-1"),t.addEventListener("expanded-change",this.handleExpandedChanged),t.addEventListener("focus",this.handleItemFocus),t instanceof MenuItem&&(t.startColumnCount=s)}))},this.changeHandler=t=>{if(void 0===this.menuItems)return;const o=t.target,s=this.menuItems.indexOf(o);if(-1!==s&&"menuitemradio"===o.role&&!0===o.checked){for(let t=s-1;t>=0;--t){const o=this.menuItems[t],s=o.getAttribute("role");if(s===J$&&(o.checked=!1),"separator"===s)break}const t=this.menuItems.length-1;for(let o=s+1;o<=t;++o){const t=this.menuItems[o],s=t.getAttribute("role");if(s===J$&&(t.checked=!1),"separator"===s)break}}},this.isMenuItemElement=t=>isHTMLElement(t)&&Menu$1.focusableElementRoles.hasOwnProperty(t.getAttribute("role")),this.isFocusableElement=t=>this.isMenuItemElement(t)}itemsChanged(t,o){this.$fastController.isConnected&&void 0!==this.menuItems&&this.setItems()}connectedCallback(){super.connectedCallback(),jP.queueUpdate((()=>{this.setItems()})),this.addEventListener("change",this.changeHandler)}disconnectedCallback(){super.disconnectedCallback(),this.removeItemListeners(),this.menuItems=void 0,this.removeEventListener("change",this.changeHandler)}focus(){this.setFocus(0,1)}collapseExpandedItem(){null!==this.expandedItem&&(this.expandedItem.expanded=!1,this.expandedItem=null)}handleMenuKeyDown(t){if(!t.defaultPrevented&&void 0!==this.menuItems)switch(t.key){case zR:return void this.setFocus(this.focusIndex+1,1);case KR:return void this.setFocus(this.focusIndex-1,-1);case ZR:return void this.setFocus(this.menuItems.length-1,-1);case YR:return void this.setFocus(0,1);default:return!0}}domChildren(){return Array.from(this.children).filter((t=>!t.hasAttribute("hidden")))}setFocus(t,o){if(void 0!==this.menuItems)for(;t>=0&&t<this.menuItems.length;){const s=this.menuItems[t];if(this.isFocusableElement(s)){this.focusIndex>-1&&this.menuItems.length>=this.focusIndex-1&&this.menuItems[this.focusIndex].setAttribute("tabindex","-1"),this.focusIndex=t,s.setAttribute("tabindex","0"),s.focus();break}t+=o}}}Menu$1.focusableElementRoles=X$,__decorate$t([observable],Menu$1.prototype,"items",void 0);class _TextField extends FoundationElement{}class FormAssociatedTextField extends(FormAssociated(_TextField)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}const eM="text";class TextField$1 extends FormAssociatedTextField{constructor(){super(...arguments),this.type=eM}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly,this.validate())}autofocusChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.autofocus=this.autofocus,this.validate())}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}typeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.type=this.type,this.validate())}listChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.setAttribute("list",this.list),this.validate())}maxlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.maxLength=this.maxlength,this.validate())}minlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.minLength=this.minlength,this.validate())}patternChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.pattern=this.pattern,this.validate())}sizeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.size=this.size)}spellcheckChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.spellcheck=this.spellcheck)}connectedCallback(){super.connectedCallback(),this.proxy.setAttribute("type",this.type),this.validate(),this.autofocus&&jP.queueUpdate((()=>{this.focus()}))}select(){this.control.select(),this.$emit("select")}handleTextInput(){this.value=this.control.value}handleChange(){this.$emit("change")}validate(){super.validate(this.control)}}__decorate$t([attr({attribute:"readonly",mode:"boolean"})],TextField$1.prototype,"readOnly",void 0),__decorate$t([attr({mode:"boolean"})],TextField$1.prototype,"autofocus",void 0),__decorate$t([attr],TextField$1.prototype,"placeholder",void 0),__decorate$t([attr],TextField$1.prototype,"type",void 0),__decorate$t([attr],TextField$1.prototype,"list",void 0),__decorate$t([attr({converter:eR})],TextField$1.prototype,"maxlength",void 0),__decorate$t([attr({converter:eR})],TextField$1.prototype,"minlength",void 0),__decorate$t([attr],TextField$1.prototype,"pattern",void 0),__decorate$t([attr({converter:eR})],TextField$1.prototype,"size",void 0),__decorate$t([attr({mode:"boolean"})],TextField$1.prototype,"spellcheck",void 0),__decorate$t([observable],TextField$1.prototype,"defaultSlottedNodes",void 0);class DelegatesARIATextbox{}applyMixins(DelegatesARIATextbox,ARIAGlobalStatesAndProperties),applyMixins(TextField$1,StartEnd,DelegatesARIATextbox);class BaseProgress extends FoundationElement{constructor(){super(...arguments),this.percentComplete=0}valueChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}minChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}maxChanged(){this.$fastController.isConnected&&this.updatePercentComplete()}connectedCallback(){super.connectedCallback(),this.updatePercentComplete()}updatePercentComplete(){const t="number"==typeof this.min?this.min:0,o="number"==typeof this.max?this.max:100,s="number"==typeof this.value?this.value:0,l=o-t;this.percentComplete=0===l?0:Math.fround((s-t)/l*100)}}__decorate$t([attr({converter:eR})],BaseProgress.prototype,"value",void 0),__decorate$t([attr({converter:eR})],BaseProgress.prototype,"min",void 0),__decorate$t([attr({converter:eR})],BaseProgress.prototype,"max",void 0),__decorate$t([attr({mode:"boolean"})],BaseProgress.prototype,"paused",void 0),__decorate$t([observable],BaseProgress.prototype,"percentComplete",void 0);class RadioGroup extends FoundationElement{constructor(){super(...arguments),this.orientation=NR,this.radioChangeHandler=t=>{const o=t.target;o.checked&&(this.slottedRadioButtons.forEach((t=>{t!==o&&(t.checked=!1,this.isInsideFoundationToolbar||t.setAttribute("tabindex","-1"))})),this.selectedRadio=o,this.value=o.value,o.setAttribute("tabindex","0"),this.focusedRadio=o),t.stopPropagation()},this.moveToRadioByIndex=(t,o)=>{const s=t[o];this.isInsideToolbar||(s.setAttribute("tabindex","0"),s.readOnly?this.slottedRadioButtons.forEach((t=>{t!==s&&t.setAttribute("tabindex","-1")})):(s.checked=!0,this.selectedRadio=s)),this.focusedRadio=s,s.focus()},this.moveRightOffGroup=()=>{var t;null===(t=this.nextElementSibling)||void 0===t||t.focus()},this.moveLeftOffGroup=()=>{var t;null===(t=this.previousElementSibling)||void 0===t||t.focus()},this.focusOutHandler=t=>{const o=this.slottedRadioButtons,s=t.target,l=null!==s?o.indexOf(s):0,h=this.focusedRadio?o.indexOf(this.focusedRadio):-1;return(0===h&&l===h||h===o.length-1&&h===l)&&(this.selectedRadio?(this.focusedRadio=this.selectedRadio,this.isInsideFoundationToolbar||(this.selectedRadio.setAttribute("tabindex","0"),o.forEach((t=>{t!==this.selectedRadio&&t.setAttribute("tabindex","-1")})))):(this.focusedRadio=o[0],this.focusedRadio.setAttribute("tabindex","0"),o.forEach((t=>{t!==this.focusedRadio&&t.setAttribute("tabindex","-1")})))),!0},this.clickHandler=t=>{const o=t.target;if(o){const t=this.slottedRadioButtons;o.checked||0===t.indexOf(o)?(o.setAttribute("tabindex","0"),this.selectedRadio=o):(o.setAttribute("tabindex","-1"),this.selectedRadio=null),this.focusedRadio=o}t.preventDefault()},this.shouldMoveOffGroupToTheRight=(t,o,s)=>t===o.length&&this.isInsideToolbar&&s===GR,this.shouldMoveOffGroupToTheLeft=(t,o)=>(this.focusedRadio?t.indexOf(this.focusedRadio)-1:0)<0&&this.isInsideToolbar&&o===VR,this.checkFocusedRadio=()=>{null===this.focusedRadio||this.focusedRadio.readOnly||this.focusedRadio.checked||(this.focusedRadio.checked=!0,this.focusedRadio.setAttribute("tabindex","0"),this.focusedRadio.focus(),this.selectedRadio=this.focusedRadio)},this.moveRight=t=>{const o=this.slottedRadioButtons;let s=0;if(s=this.focusedRadio?o.indexOf(this.focusedRadio)+1:1,this.shouldMoveOffGroupToTheRight(s,o,t.key))this.moveRightOffGroup();else for(s===o.length&&(s=0);s<o.length&&o.length>1;){if(!o[s].disabled){this.moveToRadioByIndex(o,s);break}if(this.focusedRadio&&s===o.indexOf(this.focusedRadio))break;if(s+1>=o.length){if(this.isInsideToolbar)break;s=0}else s+=1}},this.moveLeft=t=>{const o=this.slottedRadioButtons;let s=0;if(s=this.focusedRadio?o.indexOf(this.focusedRadio)-1:0,s=s<0?o.length-1:s,this.shouldMoveOffGroupToTheLeft(o,t.key))this.moveLeftOffGroup();else for(;s>=0&&o.length>1;){if(!o[s].disabled){this.moveToRadioByIndex(o,s);break}if(this.focusedRadio&&s===o.indexOf(this.focusedRadio))break;s-1<0?s=o.length-1:s-=1}},this.keydownHandler=t=>{const o=t.key;if(o in e$&&this.isInsideFoundationToolbar)return!0;switch(o){case WR:this.checkFocusedRadio();break;case GR:case zR:this.direction===t$.ltr?this.moveRight(t):this.moveLeft(t);break;case VR:case KR:this.direction===t$.ltr?this.moveLeft(t):this.moveRight(t);break;default:return!0}}}readOnlyChanged(){void 0!==this.slottedRadioButtons&&this.slottedRadioButtons.forEach((t=>{this.readOnly?t.readOnly=!0:t.readOnly=!1}))}disabledChanged(){void 0!==this.slottedRadioButtons&&this.slottedRadioButtons.forEach((t=>{this.disabled?t.disabled=!0:t.disabled=!1}))}nameChanged(){this.slottedRadioButtons&&this.slottedRadioButtons.forEach((t=>{t.setAttribute("name",this.name)}))}valueChanged(){this.slottedRadioButtons&&this.slottedRadioButtons.forEach((t=>{t.value===this.value&&(t.checked=!0,this.selectedRadio=t)})),this.$emit("change")}slottedRadioButtonsChanged(t,o){this.slottedRadioButtons&&this.slottedRadioButtons.length>0&&this.setupRadioButtons()}get parentToolbar(){return this.closest('[role="toolbar"]')}get isInsideToolbar(){var t;return null!==(t=this.parentToolbar)&&void 0!==t&&t}get isInsideFoundationToolbar(){var t;return!!(null===(t=this.parentToolbar)||void 0===t?void 0:t.$fastController)}connectedCallback(){super.connectedCallback(),this.direction=getDirection(this),this.setupRadioButtons()}disconnectedCallback(){this.slottedRadioButtons.forEach((t=>{t.removeEventListener("change",this.radioChangeHandler)}))}setupRadioButtons(){const t=this.slottedRadioButtons.filter((t=>t.hasAttribute("checked"))),o=t?t.length:0;if(o>1){t[o-1].checked=!0}let s=!1;if(this.slottedRadioButtons.forEach((t=>{void 0!==this.name&&t.setAttribute("name",this.name),this.disabled&&(t.disabled=!0),this.readOnly&&(t.readOnly=!0),this.value&&this.value===t.value?(this.selectedRadio=t,this.focusedRadio=t,t.checked=!0,t.setAttribute("tabindex","0"),s=!0):(this.isInsideFoundationToolbar||t.setAttribute("tabindex","-1"),t.checked=!1),t.addEventListener("change",this.radioChangeHandler)})),void 0===this.value&&this.slottedRadioButtons.length>0){const t=this.slottedRadioButtons.filter((t=>t.hasAttribute("checked"))),o=null!==t?t.length:0;if(o>0&&!s){const s=t[o-1];s.checked=!0,this.focusedRadio=s,s.setAttribute("tabindex","0")}else this.slottedRadioButtons[0].setAttribute("tabindex","0"),this.focusedRadio=this.slottedRadioButtons[0]}}}function whitespaceFilter(t,o,s){return t.nodeType!==Node.TEXT_NODE||"string"==typeof t.nodeValue&&!!t.nodeValue.trim().length}__decorate$t([attr({attribute:"readonly",mode:"boolean"})],RadioGroup.prototype,"readOnly",void 0),__decorate$t([attr({attribute:"disabled",mode:"boolean"})],RadioGroup.prototype,"disabled",void 0),__decorate$t([attr],RadioGroup.prototype,"name",void 0),__decorate$t([attr],RadioGroup.prototype,"value",void 0),__decorate$t([attr],RadioGroup.prototype,"orientation",void 0),__decorate$t([observable],RadioGroup.prototype,"childItems",void 0),__decorate$t([observable],RadioGroup.prototype,"slottedRadioButtons",void 0);class _Search extends FoundationElement{}class FormAssociatedSearch extends(FormAssociated(_Search)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class Search$1 extends FormAssociatedSearch{readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly,this.validate())}autofocusChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.autofocus=this.autofocus,this.validate())}placeholderChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.placeholder=this.placeholder)}listChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.setAttribute("list",this.list),this.validate())}maxlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.maxLength=this.maxlength,this.validate())}minlengthChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.minLength=this.minlength,this.validate())}patternChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.pattern=this.pattern,this.validate())}sizeChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.size=this.size)}spellcheckChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.spellcheck=this.spellcheck)}connectedCallback(){super.connectedCallback(),this.validate(),this.autofocus&&jP.queueUpdate((()=>{this.focus()}))}validate(){super.validate(this.control)}handleTextInput(){this.value=this.control.value}handleClearInput(){this.value="",this.control.focus(),this.handleChange()}handleChange(){this.$emit("change")}}__decorate$t([attr({attribute:"readonly",mode:"boolean"})],Search$1.prototype,"readOnly",void 0),__decorate$t([attr({mode:"boolean"})],Search$1.prototype,"autofocus",void 0),__decorate$t([attr],Search$1.prototype,"placeholder",void 0),__decorate$t([attr],Search$1.prototype,"list",void 0),__decorate$t([attr({converter:eR})],Search$1.prototype,"maxlength",void 0),__decorate$t([attr({converter:eR})],Search$1.prototype,"minlength",void 0),__decorate$t([attr],Search$1.prototype,"pattern",void 0),__decorate$t([attr({converter:eR})],Search$1.prototype,"size",void 0),__decorate$t([attr({mode:"boolean"})],Search$1.prototype,"spellcheck",void 0),__decorate$t([observable],Search$1.prototype,"defaultSlottedNodes",void 0);class DelegatesARIASearch{}applyMixins(DelegatesARIASearch,ARIAGlobalStatesAndProperties),applyMixins(Search$1,StartEnd,DelegatesARIASearch);class _Select extends ListboxElement{}class FormAssociatedSelect extends(FormAssociated(_Select)){constructor(){super(...arguments),this.proxy=document.createElement("select")}}class Select$1 extends FormAssociatedSelect{constructor(){super(...arguments),this.open=!1,this.forcedPosition=!1,this.listboxId=uniqueId("listbox-"),this.maxHeight=0}openChanged(t,o){if(this.collapsible){if(this.open)return this.ariaControls=this.listboxId,this.ariaExpanded="true",this.setPositioning(),this.focusAndScrollOptionIntoView(),this.indexWhenOpened=this.selectedIndex,void jP.queueUpdate((()=>this.focus()));this.ariaControls="",this.ariaExpanded="false"}}get collapsible(){return!(this.multiple||"number"==typeof this.size)}get value(){return zP.track(this,"value"),this._value}set value(t){var o,s,l,h,m,_,E;const $=`${this._value}`;if(null===(o=this._options)||void 0===o?void 0:o.length){const o=this._options.findIndex((o=>o.value===t)),$=null!==(l=null===(s=this._options[this.selectedIndex])||void 0===s?void 0:s.value)&&void 0!==l?l:null,B=null!==(m=null===(h=this._options[o])||void 0===h?void 0:h.value)&&void 0!==m?m:null;-1!==o&&$===B||(t="",this.selectedIndex=o),t=null!==(E=null===(_=this.firstSelectedOption)||void 0===_?void 0:_.value)&&void 0!==E?E:t}$!==t&&(this._value=t,super.valueChanged($,t),zP.notify(this,"value"),this.updateDisplayValue())}updateValue(t){var o,s;this.$fastController.isConnected&&(this.value=null!==(s=null===(o=this.firstSelectedOption)||void 0===o?void 0:o.value)&&void 0!==s?s:""),t&&(this.$emit("input"),this.$emit("change",this,{bubbles:!0,composed:void 0}))}selectedIndexChanged(t,o){super.selectedIndexChanged(t,o),this.updateValue()}positionChanged(t,o){this.positionAttribute=o,this.setPositioning()}setPositioning(){const t=this.getBoundingClientRect(),o=window.innerHeight-t.bottom;this.position=this.forcedPosition?this.positionAttribute:t.top>o?w$:C$,this.positionAttribute=this.forcedPosition?this.positionAttribute:this.position,this.maxHeight=this.position===w$?~~t.top:~~o}get displayValue(){var t,o;return zP.track(this,"displayValue"),null!==(o=null===(t=this.firstSelectedOption)||void 0===t?void 0:t.text)&&void 0!==o?o:""}disabledChanged(t,o){super.disabledChanged&&super.disabledChanged(t,o),this.ariaDisabled=this.disabled?"true":"false"}formResetCallback(){this.setProxyOptions(),super.setDefaultSelectedOption(),-1===this.selectedIndex&&(this.selectedIndex=0)}clickHandler(t){if(!this.disabled){if(this.open){const o=t.target.closest("option,[role=option]");if(o&&o.disabled)return}return super.clickHandler(t),this.open=this.collapsible&&!this.open,this.open||this.indexWhenOpened===this.selectedIndex||this.updateValue(!0),!0}}focusoutHandler(t){var o;if(super.focusoutHandler(t),!this.open)return!0;const s=t.relatedTarget;this.isSameNode(s)?this.focus():(null===(o=this.options)||void 0===o?void 0:o.includes(s))||(this.open=!1,this.indexWhenOpened!==this.selectedIndex&&this.updateValue(!0))}handleChange(t,o){super.handleChange(t,o),"value"===o&&this.updateValue()}slottedOptionsChanged(t,o){this.options.forEach((t=>{zP.getNotifier(t).unsubscribe(this,"value")})),super.slottedOptionsChanged(t,o),this.options.forEach((t=>{zP.getNotifier(t).subscribe(this,"value")})),this.setProxyOptions(),this.updateValue()}mousedownHandler(t){var o;return t.offsetX>=0&&t.offsetX<=(null===(o=this.listbox)||void 0===o?void 0:o.scrollWidth)?super.mousedownHandler(t):this.collapsible}multipleChanged(t,o){super.multipleChanged(t,o),this.proxy&&(this.proxy.multiple=o)}selectedOptionsChanged(t,o){var s;super.selectedOptionsChanged(t,o),null===(s=this.options)||void 0===s||s.forEach(((t,o)=>{var s;const l=null===(s=this.proxy)||void 0===s?void 0:s.options.item(o);l&&(l.selected=t.selected)}))}setDefaultSelectedOption(){var t;const o=null!==(t=this.options)&&void 0!==t?t:Array.from(this.children).filter(Listbox$1.slottedOptionFilter),s=null==o?void 0:o.findIndex((t=>t.hasAttribute("selected")||t.selected||t.value===this.value));this.selectedIndex=-1===s?0:s}setProxyOptions(){this.proxy instanceof HTMLSelectElement&&this.options&&(this.proxy.options.length=0,this.options.forEach((t=>{const o=t.proxy||(t instanceof HTMLOptionElement?t.cloneNode():null);o&&this.proxy.options.add(o)})))}keydownHandler(t){super.keydownHandler(t);const o=t.key||t.key.charCodeAt(0);switch(o){case JR:t.preventDefault(),this.collapsible&&this.typeAheadExpired&&(this.open=!this.open);break;case YR:case ZR:t.preventDefault();break;case WR:t.preventDefault(),this.open=!this.open;break;case QR:this.collapsible&&this.open&&(t.preventDefault(),this.open=!1);break;case XR:return this.collapsible&&this.open&&(t.preventDefault(),this.open=!1),!0}return this.open||this.indexWhenOpened===this.selectedIndex||(this.updateValue(!0),this.indexWhenOpened=this.selectedIndex),!(o===zR||o===KR)}connectedCallback(){super.connectedCallback(),this.forcedPosition=!!this.positionAttribute,this.addEventListener("contentchange",this.updateDisplayValue)}disconnectedCallback(){this.removeEventListener("contentchange",this.updateDisplayValue),super.disconnectedCallback()}sizeChanged(t,o){super.sizeChanged(t,o),this.proxy&&(this.proxy.size=o)}updateDisplayValue(){this.collapsible&&zP.notify(this,"displayValue")}}__decorate$t([attr({attribute:"open",mode:"boolean"})],Select$1.prototype,"open",void 0),__decorate$t([function volatile(t,o,s){return Object.assign({},s,{get:function(){return zP.trackVolatile(),s.get.apply(this)}})}],Select$1.prototype,"collapsible",null),__decorate$t([observable],Select$1.prototype,"control",void 0),__decorate$t([attr({attribute:"position"})],Select$1.prototype,"positionAttribute",void 0),__decorate$t([observable],Select$1.prototype,"position",void 0),__decorate$t([observable],Select$1.prototype,"maxHeight",void 0);class DelegatesARIASelect{}__decorate$t([observable],DelegatesARIASelect.prototype,"ariaControls",void 0),applyMixins(DelegatesARIASelect,DelegatesARIAListbox),applyMixins(Select$1,StartEnd,DelegatesARIASelect);class Skeleton extends FoundationElement{constructor(){super(...arguments),this.shape="rect"}}__decorate$t([attr],Skeleton.prototype,"fill",void 0),__decorate$t([attr],Skeleton.prototype,"shape",void 0),__decorate$t([attr],Skeleton.prototype,"pattern",void 0),__decorate$t([attr({mode:"boolean"})],Skeleton.prototype,"shimmer",void 0);class _Switch extends FoundationElement{}class FormAssociatedSwitch extends(CheckableFormAssociated(_Switch)){constructor(){super(...arguments),this.proxy=document.createElement("input")}}class Switch extends FormAssociatedSwitch{constructor(){super(),this.initialValue="on",this.keypressHandler=t=>{if(!this.readOnly)switch(t.key){case WR:case JR:this.checked=!this.checked}},this.clickHandler=t=>{this.disabled||this.readOnly||(this.checked=!this.checked)},this.proxy.setAttribute("type","checkbox")}readOnlyChanged(){this.proxy instanceof HTMLInputElement&&(this.proxy.readOnly=this.readOnly),this.readOnly?this.classList.add("readonly"):this.classList.remove("readonly")}checkedChanged(t,o){super.checkedChanged(t,o),this.checked?this.classList.add("checked"):this.classList.remove("checked")}}__decorate$t([attr({attribute:"readonly",mode:"boolean"})],Switch.prototype,"readOnly",void 0),__decorate$t([observable],Switch.prototype,"defaultSlottedNodes",void 0);class Tab extends FoundationElement{}__decorate$t([attr({mode:"boolean"})],Tab.prototype,"disabled",void 0);const tM="horizontal";class Tabs extends FoundationElement{constructor(){super(...arguments),this.orientation=tM,this.activeindicator=!0,this.showActiveIndicator=!0,this.prevActiveTabIndex=0,this.activeTabIndex=0,this.ticking=!1,this.change=()=>{this.$emit("change",this.activetab)},this.isDisabledElement=t=>"true"===t.getAttribute("aria-disabled"),this.isHiddenElement=t=>t.hasAttribute("hidden"),this.isFocusableElement=t=>!this.isDisabledElement(t)&&!this.isHiddenElement(t),this.setTabs=()=>{const t="gridColumn",o="gridRow",s=this.isHorizontal()?t:o;this.activeTabIndex=this.getActiveIndex(),this.showActiveIndicator=!1,this.tabs.forEach(((l,h)=>{if("tab"===l.slot){const t=this.activeTabIndex===h&&this.isFocusableElement(l);this.activeindicator&&this.isFocusableElement(l)&&(this.showActiveIndicator=!0);const o=this.tabIds[h],s=this.tabpanelIds[h];l.setAttribute("id",o),l.setAttribute("aria-selected",t?"true":"false"),l.setAttribute("aria-controls",s),l.addEventListener("click",this.handleTabClick),l.addEventListener("keydown",this.handleTabKeyDown),l.setAttribute("tabindex",t?"0":"-1"),t&&(this.activetab=l,this.activeid=o)}l.style[t]="",l.style[o]="",l.style[s]=`${h+1}`,this.isHorizontal()?l.classList.remove("vertical"):l.classList.add("vertical")}))},this.setTabPanels=()=>{this.tabpanels.forEach(((t,o)=>{const s=this.tabIds[o],l=this.tabpanelIds[o];t.setAttribute("id",l),t.setAttribute("aria-labelledby",s),this.activeTabIndex!==o?t.setAttribute("hidden",""):t.removeAttribute("hidden")}))},this.handleTabClick=t=>{const o=t.currentTarget;1===o.nodeType&&this.isFocusableElement(o)&&(this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=this.tabs.indexOf(o),this.setComponent())},this.handleTabKeyDown=t=>{if(this.isHorizontal())switch(t.key){case VR:t.preventDefault(),this.adjustBackward(t);break;case GR:t.preventDefault(),this.adjustForward(t)}else switch(t.key){case KR:t.preventDefault(),this.adjustBackward(t);break;case zR:t.preventDefault(),this.adjustForward(t)}switch(t.key){case YR:t.preventDefault(),this.adjust(-this.activeTabIndex);break;case ZR:t.preventDefault(),this.adjust(this.tabs.length-this.activeTabIndex-1)}},this.adjustForward=t=>{const o=this.tabs;let s=0;for(s=this.activetab?o.indexOf(this.activetab)+1:1,s===o.length&&(s=0);s<o.length&&o.length>1;){if(this.isFocusableElement(o[s])){this.moveToTabByIndex(o,s);break}if(this.activetab&&s===o.indexOf(this.activetab))break;s+1>=o.length?s=0:s+=1}},this.adjustBackward=t=>{const o=this.tabs;let s=0;for(s=this.activetab?o.indexOf(this.activetab)-1:0,s=s<0?o.length-1:s;s>=0&&o.length>1;){if(this.isFocusableElement(o[s])){this.moveToTabByIndex(o,s);break}s-1<0?s=o.length-1:s-=1}},this.moveToTabByIndex=(t,o)=>{const s=t[o];this.activetab=s,this.prevActiveTabIndex=this.activeTabIndex,this.activeTabIndex=o,s.focus(),this.setComponent()}}orientationChanged(){this.$fastController.isConnected&&(this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}activeidChanged(t,o){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.prevActiveTabIndex=this.tabs.findIndex((o=>o.id===t)),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}tabsChanged(){this.$fastController.isConnected&&this.tabs.length<=this.tabpanels.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}tabpanelsChanged(){this.$fastController.isConnected&&this.tabpanels.length<=this.tabs.length&&(this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.setTabs(),this.setTabPanels(),this.handleActiveIndicatorPosition())}getActiveIndex(){return void 0!==this.activeid?-1===this.tabIds.indexOf(this.activeid)?0:this.tabIds.indexOf(this.activeid):0}getTabIds(){return this.tabs.map((t=>{var o;return null!==(o=t.getAttribute("id"))&&void 0!==o?o:`tab-${uniqueId()}`}))}getTabPanelIds(){return this.tabpanels.map((t=>{var o;return null!==(o=t.getAttribute("id"))&&void 0!==o?o:`panel-${uniqueId()}`}))}setComponent(){this.activeTabIndex!==this.prevActiveTabIndex&&(this.activeid=this.tabIds[this.activeTabIndex],this.focusTab(),this.change())}isHorizontal(){return this.orientation===tM}handleActiveIndicatorPosition(){this.showActiveIndicator&&this.activeindicator&&this.activeTabIndex!==this.prevActiveTabIndex&&(this.ticking?this.ticking=!1:(this.ticking=!0,this.animateActiveIndicator()))}animateActiveIndicator(){this.ticking=!0;const t=this.isHorizontal()?"gridColumn":"gridRow",o=this.isHorizontal()?"translateX":"translateY",s=this.isHorizontal()?"offsetLeft":"offsetTop",l=this.activeIndicatorRef[s];this.activeIndicatorRef.style[t]=`${this.activeTabIndex+1}`;const h=this.activeIndicatorRef[s];this.activeIndicatorRef.style[t]=`${this.prevActiveTabIndex+1}`;const m=h-l;this.activeIndicatorRef.style.transform=`${o}(${m}px)`,this.activeIndicatorRef.classList.add("activeIndicatorTransition"),this.activeIndicatorRef.addEventListener("transitionend",(()=>{this.ticking=!1,this.activeIndicatorRef.style[t]=`${this.activeTabIndex+1}`,this.activeIndicatorRef.style.transform=`${o}(0px)`,this.activeIndicatorRef.classList.remove("activeIndicatorTransition")}))}adjust(t){const o=this.tabs.filter((t=>this.isFocusableElement(t))),s=o.indexOf(this.activetab),l=limit(0,o.length-1,s+t),h=this.tabs.indexOf(o[l]);h>-1&&this.moveToTabByIndex(this.tabs,h)}focusTab(){this.tabs[this.activeTabIndex].focus()}connectedCallback(){super.connectedCallback(),this.tabIds=this.getTabIds(),this.tabpanelIds=this.getTabPanelIds(),this.activeTabIndex=this.getActiveIndex()}}__decorate$t([attr],Tabs.prototype,"orientation",void 0),__decorate$t([attr],Tabs.prototype,"activeid",void 0),__decorate$t([observable],Tabs.prototype,"tabs",void 0),__decorate$t([observable],Tabs.prototype,"tabpanels",void 0),__decorate$t([attr({mode:"boolean"})],Tabs.prototype,"activeindicator",void 0),__decorate$t([observable],Tabs.prototype,"activeIndicatorRef",void 0),__decorate$t([observable],Tabs.prototype,"showActiveIndicator",void 0),applyMixins(Tabs,StartEnd);const rM="top",oM="right",nM="bottom",iM="left",sM="start",aM="end",lM="top-left",cM="top-right",dM="bottom-left",uM="bottom-right",hM="top-start",pM="top-end",fM="bottom-start",gM="bottom-end";class Tooltip$1 extends FoundationElement{constructor(){super(...arguments),this.anchor="",this.delay=300,this.autoUpdateMode="anchor",this.anchorElement=null,this.viewportElement=null,this.verticalPositioningMode="dynamic",this.horizontalPositioningMode="dynamic",this.horizontalInset="false",this.verticalInset="false",this.horizontalScaling="content",this.verticalScaling="content",this.verticalDefaultPosition=void 0,this.horizontalDefaultPosition=void 0,this.tooltipVisible=!1,this.currentDirection=t$.ltr,this.showDelayTimer=null,this.hideDelayTimer=null,this.isAnchorHoveredFocused=!1,this.isRegionHovered=!1,this.handlePositionChange=t=>{this.classList.toggle("top","start"===this.region.verticalPosition),this.classList.toggle("bottom","end"===this.region.verticalPosition),this.classList.toggle("inset-top","insetStart"===this.region.verticalPosition),this.classList.toggle("inset-bottom","insetEnd"===this.region.verticalPosition),this.classList.toggle("center-vertical","center"===this.region.verticalPosition),this.classList.toggle("left","start"===this.region.horizontalPosition),this.classList.toggle("right","end"===this.region.horizontalPosition),this.classList.toggle("inset-left","insetStart"===this.region.horizontalPosition),this.classList.toggle("inset-right","insetEnd"===this.region.horizontalPosition),this.classList.toggle("center-horizontal","center"===this.region.horizontalPosition)},this.handleRegionMouseOver=t=>{this.isRegionHovered=!0},this.handleRegionMouseOut=t=>{this.isRegionHovered=!1,this.startHideDelayTimer()},this.handleAnchorMouseOver=t=>{this.tooltipVisible?this.isAnchorHoveredFocused=!0:this.startShowDelayTimer()},this.handleAnchorMouseOut=t=>{this.isAnchorHoveredFocused=!1,this.clearShowDelayTimer(),this.startHideDelayTimer()},this.handleAnchorFocusIn=t=>{this.startShowDelayTimer()},this.handleAnchorFocusOut=t=>{this.isAnchorHoveredFocused=!1,this.clearShowDelayTimer(),this.startHideDelayTimer()},this.startHideDelayTimer=()=>{this.clearHideDelayTimer(),this.tooltipVisible&&(this.hideDelayTimer=window.setTimeout((()=>{this.updateTooltipVisibility()}),60))},this.clearHideDelayTimer=()=>{null!==this.hideDelayTimer&&(clearTimeout(this.hideDelayTimer),this.hideDelayTimer=null)},this.startShowDelayTimer=()=>{this.isAnchorHoveredFocused||(this.delay>1?null===this.showDelayTimer&&(this.showDelayTimer=window.setTimeout((()=>{this.startHover()}),this.delay)):this.startHover())},this.startHover=()=>{this.isAnchorHoveredFocused=!0,this.updateTooltipVisibility()},this.clearShowDelayTimer=()=>{null!==this.showDelayTimer&&(clearTimeout(this.showDelayTimer),this.showDelayTimer=null)},this.getAnchor=()=>{const t=this.getRootNode();return t instanceof ShadowRoot?t.getElementById(this.anchor):document.getElementById(this.anchor)},this.handleDocumentKeydown=t=>{if(!t.defaultPrevented&&this.tooltipVisible&&t.key===QR)this.isAnchorHoveredFocused=!1,this.updateTooltipVisibility(),this.$emit("dismiss")},this.updateTooltipVisibility=()=>{if(!1===this.visible)this.hideTooltip();else{if(!0===this.visible)return void this.showTooltip();if(this.isAnchorHoveredFocused||this.isRegionHovered)return void this.showTooltip();this.hideTooltip()}},this.showTooltip=()=>{this.tooltipVisible||(this.currentDirection=getDirection(this),this.tooltipVisible=!0,document.addEventListener("keydown",this.handleDocumentKeydown),jP.queueUpdate(this.setRegionProps))},this.hideTooltip=()=>{this.tooltipVisible&&(this.clearHideDelayTimer(),null!==this.region&&void 0!==this.region&&(this.region.removeEventListener("positionchange",this.handlePositionChange),this.region.viewportElement=null,this.region.anchorElement=null,this.region.removeEventListener("mouseover",this.handleRegionMouseOver),this.region.removeEventListener("mouseout",this.handleRegionMouseOut)),document.removeEventListener("keydown",this.handleDocumentKeydown),this.tooltipVisible=!1)},this.setRegionProps=()=>{this.tooltipVisible&&(this.region.viewportElement=this.viewportElement,this.region.anchorElement=this.anchorElement,this.region.addEventListener("positionchange",this.handlePositionChange),this.region.addEventListener("mouseover",this.handleRegionMouseOver,{passive:!0}),this.region.addEventListener("mouseout",this.handleRegionMouseOut,{passive:!0}))}}visibleChanged(){this.$fastController.isConnected&&(this.updateTooltipVisibility(),this.updateLayout())}anchorChanged(){this.$fastController.isConnected&&(this.anchorElement=this.getAnchor())}positionChanged(){this.$fastController.isConnected&&this.updateLayout()}anchorElementChanged(t){if(this.$fastController.isConnected){if(null!=t&&(t.removeEventListener("mouseover",this.handleAnchorMouseOver),t.removeEventListener("mouseout",this.handleAnchorMouseOut),t.removeEventListener("focusin",this.handleAnchorFocusIn),t.removeEventListener("focusout",this.handleAnchorFocusOut)),null!==this.anchorElement&&void 0!==this.anchorElement){this.anchorElement.addEventListener("mouseover",this.handleAnchorMouseOver,{passive:!0}),this.anchorElement.addEventListener("mouseout",this.handleAnchorMouseOut,{passive:!0}),this.anchorElement.addEventListener("focusin",this.handleAnchorFocusIn,{passive:!0}),this.anchorElement.addEventListener("focusout",this.handleAnchorFocusOut,{passive:!0});const t=this.anchorElement.id;null!==this.anchorElement.parentElement&&this.anchorElement.parentElement.querySelectorAll(":hover").forEach((o=>{o.id===t&&this.startShowDelayTimer()}))}null!==this.region&&void 0!==this.region&&this.tooltipVisible&&(this.region.anchorElement=this.anchorElement),this.updateLayout()}}viewportElementChanged(){null!==this.region&&void 0!==this.region&&(this.region.viewportElement=this.viewportElement),this.updateLayout()}connectedCallback(){super.connectedCallback(),this.anchorElement=this.getAnchor(),this.updateTooltipVisibility()}disconnectedCallback(){this.hideTooltip(),this.clearShowDelayTimer(),this.clearHideDelayTimer(),super.disconnectedCallback()}updateLayout(){switch(this.verticalPositioningMode="locktodefault",this.horizontalPositioningMode="locktodefault",this.position){case rM:case nM:this.verticalDefaultPosition=this.position,this.horizontalDefaultPosition="center";break;case oM:case iM:case sM:case aM:this.verticalDefaultPosition="center",this.horizontalDefaultPosition=this.position;break;case lM:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="left";break;case cM:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="right";break;case dM:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="left";break;case uM:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="right";break;case hM:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="start";break;case pM:this.verticalDefaultPosition="top",this.horizontalDefaultPosition="end";break;case fM:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="start";break;case gM:this.verticalDefaultPosition="bottom",this.horizontalDefaultPosition="end";break;default:this.verticalPositioningMode="dynamic",this.horizontalPositioningMode="dynamic",this.verticalDefaultPosition=void 0,this.horizontalDefaultPosition="center"}}}__decorate$t([attr({mode:"boolean"})],Tooltip$1.prototype,"visible",void 0),__decorate$t([attr],Tooltip$1.prototype,"anchor",void 0),__decorate$t([attr],Tooltip$1.prototype,"delay",void 0),__decorate$t([attr],Tooltip$1.prototype,"position",void 0),__decorate$t([attr({attribute:"auto-update-mode"})],Tooltip$1.prototype,"autoUpdateMode",void 0),__decorate$t([attr({attribute:"horizontal-viewport-lock"})],Tooltip$1.prototype,"horizontalViewportLock",void 0),__decorate$t([attr({attribute:"vertical-viewport-lock"})],Tooltip$1.prototype,"verticalViewportLock",void 0),__decorate$t([observable],Tooltip$1.prototype,"anchorElement",void 0),__decorate$t([observable],Tooltip$1.prototype,"viewportElement",void 0),__decorate$t([observable],Tooltip$1.prototype,"verticalPositioningMode",void 0),__decorate$t([observable],Tooltip$1.prototype,"horizontalPositioningMode",void 0),__decorate$t([observable],Tooltip$1.prototype,"horizontalInset",void 0),__decorate$t([observable],Tooltip$1.prototype,"verticalInset",void 0),__decorate$t([observable],Tooltip$1.prototype,"horizontalScaling",void 0),__decorate$t([observable],Tooltip$1.prototype,"verticalScaling",void 0),__decorate$t([observable],Tooltip$1.prototype,"verticalDefaultPosition",void 0),__decorate$t([observable],Tooltip$1.prototype,"horizontalDefaultPosition",void 0),__decorate$t([observable],Tooltip$1.prototype,"tooltipVisible",void 0),__decorate$t([observable],Tooltip$1.prototype,"currentDirection",void 0);function isTreeItemElement(t){return isHTMLElement(t)&&"treeitem"===t.getAttribute("role")}class TreeItem extends FoundationElement{constructor(){super(...arguments),this.expanded=!1,this.focusable=!1,this.isNestedItem=()=>isTreeItemElement(this.parentElement),this.handleExpandCollapseButtonClick=t=>{this.disabled||t.defaultPrevented||(this.expanded=!this.expanded)},this.handleFocus=t=>{this.setAttribute("tabindex","0")},this.handleBlur=t=>{this.setAttribute("tabindex","-1")}}expandedChanged(){this.$fastController.isConnected&&this.$emit("expanded-change",this)}selectedChanged(){this.$fastController.isConnected&&this.$emit("selected-change",this)}itemsChanged(t,o){this.$fastController.isConnected&&this.items.forEach((t=>{isTreeItemElement(t)&&(t.nested=!0)}))}static focusItem(t){t.focusable=!0,t.focus()}childItemLength(){const t=this.childItems.filter((t=>isTreeItemElement(t)));return t?t.length:0}}__decorate$t([attr({mode:"boolean"})],TreeItem.prototype,"expanded",void 0),__decorate$t([attr({mode:"boolean"})],TreeItem.prototype,"selected",void 0),__decorate$t([attr({mode:"boolean"})],TreeItem.prototype,"disabled",void 0),__decorate$t([observable],TreeItem.prototype,"focusable",void 0),__decorate$t([observable],TreeItem.prototype,"childItems",void 0),__decorate$t([observable],TreeItem.prototype,"items",void 0),__decorate$t([observable],TreeItem.prototype,"nested",void 0),__decorate$t([observable],TreeItem.prototype,"renderCollapsedChildren",void 0),applyMixins(TreeItem,StartEnd);class TreeView extends FoundationElement{constructor(){super(...arguments),this.currentFocused=null,this.handleFocus=t=>{if(!(this.slottedTreeItems.length<1))return t.target===this?(null===this.currentFocused&&(this.currentFocused=this.getValidFocusableItem()),void(null!==this.currentFocused&&TreeItem.focusItem(this.currentFocused))):void(this.contains(t.target)&&(this.setAttribute("tabindex","-1"),this.currentFocused=t.target))},this.handleBlur=t=>{t.target instanceof HTMLElement&&(null===t.relatedTarget||!this.contains(t.relatedTarget))&&this.setAttribute("tabindex","0")},this.handleKeyDown=t=>{if(t.defaultPrevented)return;if(this.slottedTreeItems.length<1)return!0;const o=this.getVisibleNodes();switch(t.key){case YR:return void(o.length&&TreeItem.focusItem(o[0]));case ZR:return void(o.length&&TreeItem.focusItem(o[o.length-1]));case VR:if(t.target&&this.isFocusableElement(t.target)){const o=t.target;o instanceof TreeItem&&o.childItemLength()>0&&o.expanded?o.expanded=!1:o instanceof TreeItem&&o.parentElement instanceof TreeItem&&TreeItem.focusItem(o.parentElement)}return!1;case GR:if(t.target&&this.isFocusableElement(t.target)){const o=t.target;o instanceof TreeItem&&o.childItemLength()>0&&!o.expanded?o.expanded=!0:o instanceof TreeItem&&o.childItemLength()>0&&this.focusNextNode(1,t.target)}return;case zR:return void(t.target&&this.isFocusableElement(t.target)&&this.focusNextNode(1,t.target));case KR:return void(t.target&&this.isFocusableElement(t.target)&&this.focusNextNode(-1,t.target));case WR:return void this.handleClick(t)}return!0},this.handleSelectedChange=t=>{if(t.defaultPrevented)return;if(!(t.target instanceof Element&&isTreeItemElement(t.target)))return!0;const o=t.target;o.selected?(this.currentSelected&&this.currentSelected!==o&&(this.currentSelected.selected=!1),this.currentSelected=o):o.selected||this.currentSelected!==o||(this.currentSelected=null)},this.setItems=()=>{const t=this.treeView.querySelector("[aria-selected='true']");this.currentSelected=t,null!==this.currentFocused&&this.contains(this.currentFocused)||(this.currentFocused=this.getValidFocusableItem()),this.nested=this.checkForNestedItems();this.getVisibleNodes().forEach((t=>{isTreeItemElement(t)&&(t.nested=this.nested)}))},this.isFocusableElement=t=>isTreeItemElement(t),this.isSelectedElement=t=>t.selected}slottedTreeItemsChanged(){this.$fastController.isConnected&&this.setItems()}connectedCallback(){super.connectedCallback(),this.setAttribute("tabindex","0"),jP.queueUpdate((()=>{this.setItems()}))}handleClick(t){if(t.defaultPrevented)return;if(!(t.target instanceof Element&&isTreeItemElement(t.target)))return!0;const o=t.target;o.disabled||(o.selected=!o.selected)}focusNextNode(t,o){const s=this.getVisibleNodes();if(!s)return;const l=s[s.indexOf(o)+t];isHTMLElement(l)&&TreeItem.focusItem(l)}getValidFocusableItem(){const t=this.getVisibleNodes();let o=t.findIndex(this.isSelectedElement);return-1===o&&(o=t.findIndex(this.isFocusableElement)),-1!==o?t[o]:null}checkForNestedItems(){return this.slottedTreeItems.some((t=>isTreeItemElement(t)&&t.querySelector("[role='treeitem']")))}getVisibleNodes(){return function getDisplayedNodes(t,o){if(!t||!o||!isHTMLElement(t))return;return Array.from(t.querySelectorAll(o)).filter((t=>null!==t.offsetParent))}(this,"[role='treeitem']")||[]}}__decorate$t([attr({attribute:"render-collapsed-nodes"})],TreeView.prototype,"renderCollapsedNodes",void 0),__decorate$t([observable],TreeView.prototype,"currentSelected",void 0),__decorate$t([observable],TreeView.prototype,"slottedTreeItems",void 0);class MatchMediaBehavior{constructor(t){this.listenerCache=new WeakMap,this.query=t}bind(t){const{query:o}=this,s=this.constructListener(t);s.bind(o)(),o.addListener(s),this.listenerCache.set(t,s)}unbind(t){const o=this.listenerCache.get(t);o&&(this.query.removeListener(o),this.listenerCache.delete(t))}}class MatchMediaStyleSheetBehavior extends MatchMediaBehavior{constructor(t,o){super(t),this.styles=o}static with(t){return o=>new MatchMediaStyleSheetBehavior(t,o)}constructListener(t){let o=!1;const s=this.styles;return function listener(){const{matches:l}=this;l&&!o?(t.$fastController.addStyles(s),o=l):!l&&o&&(t.$fastController.removeStyles(s),o=l)}}unbind(t){super.unbind(t),t.$fastController.removeStyles(this.styles)}}const vM=MatchMediaStyleSheetBehavior.with(window.matchMedia("(forced-colors)"));MatchMediaStyleSheetBehavior.with(window.matchMedia("(prefers-color-scheme: dark)")),MatchMediaStyleSheetBehavior.with(window.matchMedia("(prefers-color-scheme: light)"));class PropertyStyleSheetBehavior{constructor(t,o,s){this.propertyName=t,this.value=o,this.styles=s}bind(t){zP.getNotifier(t).subscribe(this,this.propertyName),this.handleChange(t,this.propertyName)}unbind(t){zP.getNotifier(t).unsubscribe(this,this.propertyName),t.$fastController.removeStyles(this.styles)}handleChange(t,o){t[o]===this.value?t.$fastController.addStyles(this.styles):t.$fastController.removeStyles(this.styles)}}const mM="not-allowed";function display(t){return`:host([hidden]){display:none}:host{display:${t}}`}const yM=function canUseFocusVisible(){if("boolean"==typeof DR)return DR;if(!function canUseDOM(){return!("undefined"==typeof window||!window.document||!window.document.createElement)}())return DR=!1,DR;const t=document.createElement("style"),o=function getNonce(){const t=document.querySelector('meta[property="csp-nonce"]');return t?t.getAttribute("content"):null}();null!==o&&t.setAttribute("nonce",o),document.head.appendChild(t);try{t.sheet.insertRule("foo:focus-visible {color:inherit}",0),DR=!0}catch(t){DR=!1}finally{document.head.removeChild(t)}return DR}()?"focus-visible":"focus";function clamp(t,o,s){return isNaN(t)||t<=o?o:t>=s?s:t}function normalize(t,o,s){return isNaN(t)||t<=o?0:t>=s?1:t/(s-o)}function denormalize(t,o,s){return isNaN(t)?o:o+t*(s-o)}function lerp(t,o,s){return isNaN(t)||t<=0?o:t>=1?s:o+t*(s-o)}function roundToPrecisionSmall(t,o){const s=Math.pow(10,o);return Math.round(t*s)/s}class ColorHSL{constructor(t,o,s){this.h=t,this.s=o,this.l=s}static fromObject(t){return!t||isNaN(t.h)||isNaN(t.s)||isNaN(t.l)?null:new ColorHSL(t.h,t.s,t.l)}equalValue(t){return this.h===t.h&&this.s===t.s&&this.l===t.l}roundToPrecision(t){return new ColorHSL(roundToPrecisionSmall(this.h,t),roundToPrecisionSmall(this.s,t),roundToPrecisionSmall(this.l,t))}toObject(){return{h:this.h,s:this.s,l:this.l}}}class ColorLAB{constructor(t,o,s){this.l=t,this.a=o,this.b=s}static fromObject(t){return!t||isNaN(t.l)||isNaN(t.a)||isNaN(t.b)?null:new ColorLAB(t.l,t.a,t.b)}equalValue(t){return this.l===t.l&&this.a===t.a&&this.b===t.b}roundToPrecision(t){return new ColorLAB(roundToPrecisionSmall(this.l,t),roundToPrecisionSmall(this.a,t),roundToPrecisionSmall(this.b,t))}toObject(){return{l:this.l,a:this.a,b:this.b}}}ColorLAB.epsilon=216/24389,ColorLAB.kappa=24389/27;class ColorRGBA64{constructor(t,o,s,l){this.r=t,this.g=o,this.b=s,this.a="number"!=typeof l||isNaN(l)?1:l}static fromObject(t){return!t||isNaN(t.r)||isNaN(t.g)||isNaN(t.b)?null:new ColorRGBA64(t.r,t.g,t.b,t.a)}equalValue(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}toStringHexRGB(){return"#"+[this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringHexRGBA(){return this.toStringHexRGB()+this.formatHexValue(this.a)}toStringHexARGB(){return"#"+[this.a,this.r,this.g,this.b].map(this.formatHexValue).join("")}toStringWebRGB(){return`rgb(${Math.round(denormalize(this.r,0,255))},${Math.round(denormalize(this.g,0,255))},${Math.round(denormalize(this.b,0,255))})`}toStringWebRGBA(){return`rgba(${Math.round(denormalize(this.r,0,255))},${Math.round(denormalize(this.g,0,255))},${Math.round(denormalize(this.b,0,255))},${clamp(this.a,0,1)})`}roundToPrecision(t){return new ColorRGBA64(roundToPrecisionSmall(this.r,t),roundToPrecisionSmall(this.g,t),roundToPrecisionSmall(this.b,t),roundToPrecisionSmall(this.a,t))}clamp(){return new ColorRGBA64(clamp(this.r,0,1),clamp(this.g,0,1),clamp(this.b,0,1),clamp(this.a,0,1))}toObject(){return{r:this.r,g:this.g,b:this.b,a:this.a}}formatHexValue(t){return function getHexStringForByte(t){const o=Math.round(clamp(t,0,255)).toString(16);return 1===o.length?"0"+o:o}(denormalize(t,0,255))}}class ColorXYZ{constructor(t,o,s){this.x=t,this.y=o,this.z=s}static fromObject(t){return!t||isNaN(t.x)||isNaN(t.y)||isNaN(t.z)?null:new ColorXYZ(t.x,t.y,t.z)}equalValue(t){return this.x===t.x&&this.y===t.y&&this.z===t.z}roundToPrecision(t){return new ColorXYZ(roundToPrecisionSmall(this.x,t),roundToPrecisionSmall(this.y,t),roundToPrecisionSmall(this.z,t))}toObject(){return{x:this.x,y:this.y,z:this.z}}}function rgbToRelativeLuminance(t){function luminanceHelper(t){return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}return function rgbToLinearLuminance(t){return.2126*t.r+.7152*t.g+.0722*t.b}(new ColorRGBA64(luminanceHelper(t.r),luminanceHelper(t.g),luminanceHelper(t.b),1))}function calcChannelOverlay(t,o,s){return s-o==0?0:(t-o)/(s-o)}function calcRgbOverlay(t,o,s){return(calcChannelOverlay(t.r,o.r,s.r)+calcChannelOverlay(t.g,o.g,s.g)+calcChannelOverlay(t.b,o.b,s.b))/3}function rgbToHSL(t){const o=Math.max(t.r,t.g,t.b),s=Math.min(t.r,t.g,t.b),l=o-s;let h=0;0!==l&&(h=o===t.r?(t.g-t.b)/l%6*60:o===t.g?60*((t.b-t.r)/l+2):60*((t.r-t.g)/l+4)),h<0&&(h+=360);const m=(o+s)/2;let _=0;return 0!==l&&(_=l/(1-Math.abs(2*m-1))),new ColorHSL(h,_,m)}function rgbToLAB(t){return function xyzToLAB(t){function xyzToLABHelper(t){return t>ColorLAB.epsilon?Math.pow(t,1/3):(ColorLAB.kappa*t+16)/116}const o=xyzToLABHelper(t.x/ColorXYZ.whitePoint.x),s=xyzToLABHelper(t.y/ColorXYZ.whitePoint.y),l=xyzToLABHelper(t.z/ColorXYZ.whitePoint.z);return new ColorLAB(116*s-16,500*(o-s),200*(s-l))}(function rgbToXYZ(t){function rgbToXYZHelper(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}const o=rgbToXYZHelper(t.r),s=rgbToXYZHelper(t.g),l=rgbToXYZHelper(t.b);return new ColorXYZ(.4124564*o+.3575761*s+.1804375*l,.2126729*o+.7151522*s+.072175*l,.0193339*o+.119192*s+.9503041*l)}(t))}function labToRGB(t,o=1){return function xyzToRGB(t,o=1){function xyzToRGBHelper(t){return t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055}const s=xyzToRGBHelper(3.2404542*t.x-1.5371385*t.y-.4985314*t.z),l=xyzToRGBHelper(-.969266*t.x+1.8760108*t.y+.041556*t.z),h=xyzToRGBHelper(.0556434*t.x-.2040259*t.y+1.0572252*t.z);return new ColorRGBA64(s,l,h,o)}(function labToXYZ(t){const o=(t.l+16)/116,s=o+t.a/500,l=o-t.b/200,h=Math.pow(s,3),m=Math.pow(o,3),_=Math.pow(l,3);let E=0;E=h>ColorLAB.epsilon?h:(116*s-16)/ColorLAB.kappa;let $=0;$=t.l>ColorLAB.epsilon*ColorLAB.kappa?m:t.l/ColorLAB.kappa;let B=0;return B=_>ColorLAB.epsilon?_:(116*l-16)/ColorLAB.kappa,E=ColorXYZ.whitePoint.x*E,$=ColorXYZ.whitePoint.y*$,B=ColorXYZ.whitePoint.z*B,new ColorXYZ(E,$,B)}(t),o)}var bM,wM;function interpolateRGB(t,o,s){return isNaN(t)||t<=0?o:t>=1?s:new ColorRGBA64(lerp(t,o.r,s.r),lerp(t,o.g,s.g),lerp(t,o.b,s.b),lerp(t,o.a,s.a))}ColorXYZ.whitePoint=new ColorXYZ(.95047,1,1.08883),function(t){t[t.Burn=0]="Burn",t[t.Color=1]="Color",t[t.Darken=2]="Darken",t[t.Dodge=3]="Dodge",t[t.Lighten=4]="Lighten",t[t.Multiply=5]="Multiply",t[t.Overlay=6]="Overlay",t[t.Screen=7]="Screen"}(bM||(bM={})),function(t){t[t.RGB=0]="RGB",t[t.HSL=1]="HSL",t[t.HSV=2]="HSV",t[t.XYZ=3]="XYZ",t[t.LAB=4]="LAB",t[t.LCH=5]="LCH"}(wM||(wM={}));const CM=/^#((?:[0-9a-f]{6}|[0-9a-f]{3}))$/i;function parseColorHexRGB(t){const o=CM.exec(t);if(null===o)return null;let s=o[1];if(3===s.length){const t=s.charAt(0),o=s.charAt(1),l=s.charAt(2);s=t.concat(t,o,o,l,l)}const l=parseInt(s,16);return isNaN(l)?null:new ColorRGBA64(normalize((16711680&l)>>>16,0,255),normalize((65280&l)>>>8,0,255),normalize(255&l,0,255),1)}function contrast(t,o){const s=t.relativeLuminance>o.relativeLuminance?t:o,l=t.relativeLuminance>o.relativeLuminance?o:t;return(s.relativeLuminance+.05)/(l.relativeLuminance+.05)}const _M=Object.freeze({create:(t,o,s)=>new SwatchRGBImpl(t,o,s),from:t=>new SwatchRGBImpl(t.r,t.g,t.b)});class SwatchRGBImpl extends ColorRGBA64{constructor(t,o,s){super(t,o,s,1),this.toColorString=this.toStringHexRGB,this.contrast=contrast.bind(null,this),this.createCSS=this.toColorString,this.relativeLuminance=rgbToRelativeLuminance(this)}static fromObject(t){return new SwatchRGBImpl(t.r,t.g,t.b)}}function binarySearch(t,o,s=0,l=t.length-1){if(l===s)return t[s];const h=Math.floor((l-s)/2)+s;return o(t[h])?binarySearch(t,o,s,h):binarySearch(t,o,h+1,l)}const kM=(-.1+Math.sqrt(.21))/2;function isDark(t){return t.relativeLuminance<=kM}function directionByIsDark(t){return isDark(t)?-1:1}const xM={stepContrast:1.03,stepContrastRamp:.03,preserveSource:!1};const SM=Object.freeze({create:function create$1(t,o,s){return"number"==typeof t?SM.from(_M.create(t,o,s)):SM.from(t)},from:function from(t,o){return function isSwatchRGB(t){const o={r:0,g:0,b:0,toColorString:()=>"",contrast:()=>0,relativeLuminance:0};for(const s in o)if(typeof o[s]!=typeof t[s])return!1;return!0}(t)?PaletteRGBImpl.from(t,o):PaletteRGBImpl.from(_M.create(t.r,t.g,t.b),o)}});class PaletteRGBImpl{constructor(t,o){this.closestIndexCache=new Map,this.source=t,this.swatches=o,this.reversedSwatches=Object.freeze([...this.swatches].reverse()),this.lastIndex=this.swatches.length-1}colorContrast(t,o,s,l){void 0===s&&(s=this.closestIndexOf(t));let h=this.swatches;const m=this.lastIndex;let _=s;void 0===l&&(l=directionByIsDark(t));return-1===l&&(h=this.reversedSwatches,_=m-_),binarySearch(h,(s=>contrast(t,s)>=o),_,m)}get(t){return this.swatches[t]||this.swatches[clamp(t,0,this.lastIndex)]}closestIndexOf(t){if(this.closestIndexCache.has(t.relativeLuminance))return this.closestIndexCache.get(t.relativeLuminance);let o=this.swatches.indexOf(t);if(-1!==o)return this.closestIndexCache.set(t.relativeLuminance,o),o;const s=this.swatches.reduce(((o,s)=>Math.abs(s.relativeLuminance-t.relativeLuminance)<Math.abs(o.relativeLuminance-t.relativeLuminance)?s:o));return o=this.swatches.indexOf(s),this.closestIndexCache.set(t.relativeLuminance,o),o}static saturationBump(t,o){const s=rgbToHSL(t).s,l=rgbToHSL(o);if(l.s<s){return function hslToRGB(t,o=1){const s=(1-Math.abs(2*t.l-1))*t.s,l=s*(1-Math.abs(t.h/60%2-1)),h=t.l-s/2;let m=0,_=0,E=0;return t.h<60?(m=s,_=l,E=0):t.h<120?(m=l,_=s,E=0):t.h<180?(m=0,_=s,E=l):t.h<240?(m=0,_=l,E=s):t.h<300?(m=l,_=0,E=s):t.h<360&&(m=s,_=0,E=l),new ColorRGBA64(m+h,_+h,E+h,o)}(new ColorHSL(l.h,s,l.l))}return o}static ramp(t){const o=t/100;return o>.5?(o-.5)/.5:2*o}static createHighResolutionPalette(t){const o=[],s=rgbToLAB(ColorRGBA64.fromObject(t).roundToPrecision(4)),l=labToRGB(new ColorLAB(0,s.a,s.b)).clamp().roundToPrecision(4),h=labToRGB(new ColorLAB(50,s.a,s.b)).clamp().roundToPrecision(4),m=labToRGB(new ColorLAB(100,s.a,s.b)).clamp().roundToPrecision(4),_=new ColorRGBA64(0,0,0),E=new ColorRGBA64(1,1,1),$=m.equalValue(E)?0:14,B=l.equalValue(_)?0:14;for(let t=100+$;t>=0-B;t-=.5){let s;if(t<0){s=interpolateRGB(t/B+1,_,l)}else if(t<=50)s=interpolateRGB(PaletteRGBImpl.ramp(t),l,h);else if(t<=100)s=interpolateRGB(PaletteRGBImpl.ramp(t),h,m);else{s=interpolateRGB((t-100)/$,m,E)}s=PaletteRGBImpl.saturationBump(h,s).roundToPrecision(4),o.push(_M.from(s))}return new PaletteRGBImpl(t,o)}static adjustEnd(t,o,s,l){const h=-1===l?o.swatches:o.reversedSwatches,refIndex=t=>{const s=o.closestIndexOf(t);return 1===l?o.lastIndex-s:s};1===l&&s.reverse();const m=t(s[s.length-2]);if(roundToPrecisionSmall(contrast(s[s.length-1],s[s.length-2]),2)<m){s.pop();const t=refIndex(o.colorContrast(h[o.lastIndex],m,void 0,l))-refIndex(s[s.length-2]);let _=1;for(let l=s.length-t-1;l<s.length;l++){const t=refIndex(s[l]),m=l===s.length-1?o.lastIndex:t+_;s[l]=h[m],_++}}1===l&&s.reverse()}static createColorPaletteByContrast(t,o){const s=PaletteRGBImpl.createHighResolutionPalette(t),nextContrast=t=>roundToPrecisionSmall(o.stepContrast+o.stepContrast*(1-t.relativeLuminance)*o.stepContrastRamp,2),l=[];let h=o.preserveSource?t:s.swatches[0];l.push(h);do{const t=nextContrast(h);h=s.colorContrast(h,t,void 0,1),l.push(h)}while(h.relativeLuminance>0);if(o.preserveSource){h=t;do{const t=nextContrast(h);h=s.colorContrast(h,t,void 0,-1),l.unshift(h)}while(h.relativeLuminance<1)}return this.adjustEnd(nextContrast,s,l,-1),o.preserveSource&&this.adjustEnd(nextContrast,s,l,1),l}static from(t,o){const s=void 0===o?xM:Object.assign(Object.assign({},xM),o);return new PaletteRGBImpl(t,Object.freeze(PaletteRGBImpl.createColorPaletteByContrast(t,s)))}}const TM=_M.create(1,1,1),EM=_M.create(0,0,0),AM=_M.create(.5,.5,.5),IM=parseColorHexRGB("#0078D4"),PM=_M.create(IM.r,IM.g,IM.b);function foregroundOnAccentSet(t,o,s,l,h){const defaultRule=t=>t.contrast(TM)>=h?TM:EM,m=defaultRule(t),_=defaultRule(o);return{rest:m,hover:_,active:m.relativeLuminance===_.relativeLuminance?m:defaultRule(s),focus:defaultRule(l)}}class GradientSwatchRGB{constructor(t,o,s,l){this.toColorString=()=>this.cssGradient,this.contrast=contrast.bind(null,this),this.createCSS=this.toColorString,this.color=new ColorRGBA64(t,o,s),this.cssGradient=l,this.relativeLuminance=rgbToRelativeLuminance(this.color),this.r=t,this.g=o,this.b=s}static fromObject(t,o){return new GradientSwatchRGB(t.r,t.g,t.b,o)}}const RM=new ColorRGBA64(0,0,0),$M=new ColorRGBA64(1,1,1);function gradientShadowStroke(t,o,s,l,h,m,_,E,$=10,B=!1){const q=t.closestIndexOf(o);function overlayHelper(s){if(B){const l=t.closestIndexOf(o),h=t.get(l),m=s.relativeLuminance<o.relativeLuminance?RM:$M,_=function calculateOverlayColor(t,o,s=null){let l=0,h=s;return null!==h?l=calcRgbOverlay(t,o,h):(h=new ColorRGBA64(0,0,0,1),l=calcRgbOverlay(t,o,h),l<=0&&(h=new ColorRGBA64(1,1,1,1),l=calcRgbOverlay(t,o,h))),l=Math.round(1e3*l)/1e3,new ColorRGBA64(h.r,h.g,h.b,l)}(parseColorHexRGB(s.toColorString()),parseColorHexRGB(h.toColorString()),m).roundToPrecision(2),E=function computeAlphaBlend(t,o){if(o.a>=1)return o;if(o.a<=0)return new ColorRGBA64(t.r,t.g,t.b,1);const s=o.a*o.r+(1-o.a)*t.r,l=o.a*o.g+(1-o.a)*t.g,h=o.a*o.b+(1-o.a)*t.b;return new ColorRGBA64(s,l,h,1)}(parseColorHexRGB(o.toColorString()),_);return _M.from(E)}return s}void 0===E&&(E=directionByIsDark(o));const j=q+E*s,K=j+E*(l-s),W=j+E*(h-s),X=j+E*(m-s),re=-1===E?0:100-$,oe=-1===E?$:100;function gradientHelper(o,s){const l=t.get(o);if(s){const s=t.get(o+E*_),h=-1===E?s:l,m=-1===E?l:s,$=`linear-gradient(${overlayHelper(h).toColorString()} ${re}%, ${overlayHelper(m).toColorString()} ${oe}%)`;return GradientSwatchRGB.fromObject(h,$)}return overlayHelper(l)}return{rest:gradientHelper(j,!0),hover:gradientHelper(K,!0),active:gradientHelper(W,!1),focus:gradientHelper(X,!0)}}function contrastAndDeltaSwatchSet(t,o,s,l,h,m,_,E){null==E&&(E=directionByIsDark(o));const $=t.closestIndexOf(t.colorContrast(o,s));return{rest:t.get($+E*l),hover:t.get($+E*h),active:t.get($+E*m),focus:t.get($+E*_)}}function deltaSwatchSet(t,o,s,l,h,m,_){const E=t.closestIndexOf(o);return null==_&&(_=directionByIsDark(o)),{rest:t.get(E+_*s),hover:t.get(E+_*l),active:t.get(E+_*h),focus:t.get(E+_*m)}}function deltaSwatchSetByLuminance(t,o,s,l,h,m,_=void 0,E,$,B,q,j=void 0){return isDark(o)?deltaSwatchSet(t,o,E,$,B,q,j):deltaSwatchSet(t,o,s,l,h,m,_)}var MM;function neutralLayer1Index(t,o){return t.closestIndexOf(function baseLayerLuminanceSwatch(t){return _M.create(t,t,t)}(o))}function neutralLayer2(t,o,s){return t.get(neutralLayer1Index(t,o)+-1*s)}!function(t){t[t.LightMode=.98]="LightMode",t[t.DarkMode=.15]="DarkMode"}(MM||(MM={}));const{create:OM}=$$;function createNonCss(t){return $$.create({name:t,cssCustomPropertyName:null})}const NM=OM("direction").withDefault(t$.ltr),DM=OM("disabled-opacity").withDefault(.3),LM=OM("base-height-multiplier").withDefault(8);OM("base-horizontal-spacing-multiplier").withDefault(3);const FM=OM("density").withDefault(0),BM=OM("design-unit").withDefault(4),HM=OM("control-corner-radius").withDefault(4),UM=OM("layer-corner-radius").withDefault(8),qM=OM("stroke-width").withDefault(1),jM=OM("focus-stroke-width").withDefault(2),zM=OM("body-font").withDefault('"Segoe UI Variable", "Segoe UI", sans-serif'),VM=OM("font-weight").withDefault(400);function fontVariations(t){return o=>{const s=t.getValueFor(o),l=VM.getValueFor(o);if(s.endsWith("px")){const t=Number.parseFloat(s.replace("px",""));if(t<=12)return`"wght" ${l}, "opsz" 8`;if(t>24)return`"wght" ${l}, "opsz" 36`}return`"wght" ${l}, "opsz" 10.5`}}const GM=OM("type-ramp-base-font-size").withDefault("14px"),KM=OM("type-ramp-base-line-height").withDefault("20px"),WM=OM("type-ramp-base-font-variations").withDefault(fontVariations(GM)),QM=OM("type-ramp-minus-1-font-size").withDefault("12px"),YM=OM("type-ramp-minus-1-line-height").withDefault("16px"),ZM=OM("type-ramp-minus-1-font-variations").withDefault(fontVariations(QM)),JM=OM("type-ramp-minus-2-font-size").withDefault("10px"),XM=OM("type-ramp-minus-2-line-height").withDefault("14px"),eO=OM("type-ramp-minus-2-font-variations").withDefault(fontVariations(JM)),tO=OM("type-ramp-plus-1-font-size").withDefault("16px"),rO=OM("type-ramp-plus-1-line-height").withDefault("22px"),oO=OM("type-ramp-plus-1-font-variations").withDefault(fontVariations(tO)),nO=OM("type-ramp-plus-2-font-size").withDefault("20px"),iO=OM("type-ramp-plus-2-line-height").withDefault("26px"),sO=OM("type-ramp-plus-2-font-variations").withDefault(fontVariations(nO)),aO=OM("type-ramp-plus-3-font-size").withDefault("24px"),lO=OM("type-ramp-plus-3-line-height").withDefault("32px"),cO=OM("type-ramp-plus-3-font-variations").withDefault(fontVariations(aO)),dO=OM("type-ramp-plus-4-font-size").withDefault("28px"),uO=OM("type-ramp-plus-4-line-height").withDefault("36px"),hO=OM("type-ramp-plus-4-font-variations").withDefault(fontVariations(dO)),pO=OM("type-ramp-plus-5-font-size").withDefault("32px"),fO=OM("type-ramp-plus-5-line-height").withDefault("40px"),gO=OM("type-ramp-plus-5-font-variations").withDefault(fontVariations(pO)),vO=OM("type-ramp-plus-6-font-size").withDefault("40px"),mO=OM("type-ramp-plus-6-line-height").withDefault("52px"),yO=OM("type-ramp-plus-6-font-variations").withDefault(fontVariations(vO)),bO=OM("base-layer-luminance").withDefault(MM.LightMode),wO=createNonCss("accent-fill-rest-delta").withDefault(0),CO=createNonCss("accent-fill-hover-delta").withDefault(-2),_O=createNonCss("accent-fill-active-delta").withDefault(-5),kO=createNonCss("accent-fill-focus-delta").withDefault(0),xO=createNonCss("accent-foreground-rest-delta").withDefault(0),SO=createNonCss("accent-foreground-hover-delta").withDefault(3),TO=createNonCss("accent-foreground-active-delta").withDefault(-8),EO=createNonCss("accent-foreground-focus-delta").withDefault(0),AO=createNonCss("neutral-fill-rest-delta").withDefault(-1),IO=createNonCss("neutral-fill-hover-delta").withDefault(1),PO=createNonCss("neutral-fill-active-delta").withDefault(0),RO=createNonCss("neutral-fill-focus-delta").withDefault(0),$O=createNonCss("neutral-fill-input-rest-delta").withDefault(-1),MO=createNonCss("neutral-fill-input-hover-delta").withDefault(1),OO=createNonCss("neutral-fill-input-active-delta").withDefault(0),NO=createNonCss("neutral-fill-input-focus-delta").withDefault(-2),DO=createNonCss("neutral-fill-input-alt-rest-delta").withDefault(2),LO=createNonCss("neutral-fill-input-alt-hover-delta").withDefault(4),FO=createNonCss("neutral-fill-input-alt-active-delta").withDefault(6),BO=createNonCss("neutral-fill-input-alt-focus-delta").withDefault(2),HO=createNonCss("neutral-fill-layer-rest-delta").withDefault(-2),UO=createNonCss("neutral-fill-layer-hover-delta").withDefault(-3),qO=createNonCss("neutral-fill-layer-active-delta").withDefault(-3),jO=createNonCss("neutral-fill-layer-alt-rest-delta").withDefault(-1),zO=createNonCss("neutral-fill-secondary-rest-delta").withDefault(3),VO=createNonCss("neutral-fill-secondary-hover-delta").withDefault(2),GO=createNonCss("neutral-fill-secondary-active-delta").withDefault(1),KO=createNonCss("neutral-fill-secondary-focus-delta").withDefault(3),WO=createNonCss("neutral-fill-stealth-rest-delta").withDefault(0),QO=createNonCss("neutral-fill-stealth-hover-delta").withDefault(3),YO=createNonCss("neutral-fill-stealth-active-delta").withDefault(2),ZO=createNonCss("neutral-fill-stealth-focus-delta").withDefault(0),JO=createNonCss("neutral-fill-strong-rest-delta").withDefault(0),XO=createNonCss("neutral-fill-strong-hover-delta").withDefault(8),eN=createNonCss("neutral-fill-strong-active-delta").withDefault(-5),tN=createNonCss("neutral-fill-strong-focus-delta").withDefault(0),rN=createNonCss("neutral-stroke-rest-delta").withDefault(8),oN=createNonCss("neutral-stroke-hover-delta").withDefault(12),nN=createNonCss("neutral-stroke-active-delta").withDefault(6),iN=createNonCss("neutral-stroke-focus-delta").withDefault(8),sN=createNonCss("neutral-stroke-control-rest-delta").withDefault(3),aN=createNonCss("neutral-stroke-control-hover-delta").withDefault(5),lN=createNonCss("neutral-stroke-control-active-delta").withDefault(5),cN=createNonCss("neutral-stroke-control-focus-delta").withDefault(5),dN=createNonCss("neutral-stroke-divider-rest-delta").withDefault(4),uN=createNonCss("neutral-stroke-layer-rest-delta").withDefault(3),hN=createNonCss("neutral-stroke-layer-hover-delta").withDefault(3),pN=createNonCss("neutral-stroke-layer-active-delta").withDefault(3),fN=createNonCss("neutral-stroke-strong-hover-delta").withDefault(0),gN=createNonCss("neutral-stroke-strong-active-delta").withDefault(0),vN=createNonCss("neutral-stroke-strong-focus-delta").withDefault(0),mN=OM("neutral-base-color").withDefault(AM),yN=createNonCss("neutral-palette").withDefault((t=>SM.from(mN.getValueFor(t)))),bN=OM("accent-base-color").withDefault(PM),wN=createNonCss("accent-palette").withDefault((t=>SM.from(bN.getValueFor(t)))),CN=createNonCss("neutral-layer-card-container-recipe").withDefault({evaluate:t=>neutralLayer2(yN.getValueFor(t),bO.getValueFor(t),HO.getValueFor(t))});OM("neutral-layer-card-container").withDefault((t=>CN.getValueFor(t).evaluate(t)));const _N=createNonCss("neutral-layer-floating-recipe").withDefault({evaluate:t=>function neutralLayerFloating$1(t,o,s){return t.get(neutralLayer1Index(t,o)+s)}(yN.getValueFor(t),bO.getValueFor(t),HO.getValueFor(t))}),kN=OM("neutral-layer-floating").withDefault((t=>_N.getValueFor(t).evaluate(t))),xN=createNonCss("neutral-layer-1-recipe").withDefault({evaluate:t=>function neutralLayer1$1(t,o){return t.get(neutralLayer1Index(t,o))}(yN.getValueFor(t),bO.getValueFor(t))}),SN=OM("neutral-layer-1").withDefault((t=>xN.getValueFor(t).evaluate(t))),TN=createNonCss("neutral-layer-2-recipe").withDefault({evaluate:t=>neutralLayer2(yN.getValueFor(t),bO.getValueFor(t),HO.getValueFor(t))});OM("neutral-layer-2").withDefault((t=>TN.getValueFor(t).evaluate(t)));const EN=createNonCss("neutral-layer-3-recipe").withDefault({evaluate:t=>function neutralLayer3(t,o,s){return t.get(neutralLayer1Index(t,o)+-1*s*2)}(yN.getValueFor(t),bO.getValueFor(t),HO.getValueFor(t))});OM("neutral-layer-3").withDefault((t=>EN.getValueFor(t).evaluate(t)));const AN=createNonCss("neutral-layer-4-recipe").withDefault({evaluate:t=>function neutralLayer4(t,o,s){return t.get(neutralLayer1Index(t,o)+-1*s*3)}(yN.getValueFor(t),bO.getValueFor(t),HO.getValueFor(t))});OM("neutral-layer-4").withDefault((t=>AN.getValueFor(t).evaluate(t)));const IN=OM("fill-color").withDefault((t=>SN.getValueFor(t)));var PN;!function(t){t[t.normal=4.5]="normal",t[t.large=3]="large"}(PN||(PN={}));const RN=createNonCss("accent-fill-recipe").withDefault({evaluate:(t,o)=>function contrastAndDeltaSwatchSetByLuminance(t,o,s,l,h,m,_,E,$,B,q,j,K,W){return isDark(o)?contrastAndDeltaSwatchSet(t,o,$,B,q,j,K,W):contrastAndDeltaSwatchSet(t,o,s,l,h,m,_,E)}(wN.getValueFor(t),o||IN.getValueFor(t),5,wO.getValueFor(t),CO.getValueFor(t),_O.getValueFor(t),kO.getValueFor(t),void 0,8,wO.getValueFor(t),CO.getValueFor(t),_O.getValueFor(t),kO.getValueFor(t),void 0)}),$N=OM("accent-fill-rest").withDefault((t=>RN.getValueFor(t).evaluate(t).rest)),MN=OM("accent-fill-hover").withDefault((t=>RN.getValueFor(t).evaluate(t).hover)),ON=OM("accent-fill-active").withDefault((t=>RN.getValueFor(t).evaluate(t).active)),NN=OM("accent-fill-focus").withDefault((t=>RN.getValueFor(t).evaluate(t).focus)),DN=createNonCss("foreground-on-accent-recipe").withDefault({evaluate:t=>foregroundOnAccentSet($N.getValueFor(t),MN.getValueFor(t),ON.getValueFor(t),NN.getValueFor(t),PN.normal)}),LN=OM("foreground-on-accent-rest").withDefault((t=>DN.getValueFor(t).evaluate(t).rest)),FN=OM("foreground-on-accent-hover").withDefault((t=>DN.getValueFor(t).evaluate(t).hover)),BN=OM("foreground-on-accent-active").withDefault((t=>DN.getValueFor(t).evaluate(t).active)),HN=OM("foreground-on-accent-focus").withDefault((t=>DN.getValueFor(t).evaluate(t).focus)),UN=createNonCss("accent-foreground-recipe").withDefault({evaluate:(t,o)=>contrastAndDeltaSwatchSet(wN.getValueFor(t),o||IN.getValueFor(t),9.5,xO.getValueFor(t),SO.getValueFor(t),TO.getValueFor(t),EO.getValueFor(t))}),qN=OM("accent-foreground-rest").withDefault((t=>UN.getValueFor(t).evaluate(t).rest)),jN=OM("accent-foreground-hover").withDefault((t=>UN.getValueFor(t).evaluate(t).hover)),zN=OM("accent-foreground-active").withDefault((t=>UN.getValueFor(t).evaluate(t).active)),VN=OM("accent-foreground-focus").withDefault((t=>UN.getValueFor(t).evaluate(t).focus)),GN=createNonCss("accent-stroke-control-recipe").withDefault({evaluate:(t,o)=>gradientShadowStroke(yN.getValueFor(t),o||IN.getValueFor(t),-3,-3,-3,-3,10,1,void 0,!0)}),KN=OM("accent-stroke-control-rest").withDefault((t=>GN.getValueFor(t).evaluate(t,$N.getValueFor(t)).rest)),WN=OM("accent-stroke-control-hover").withDefault((t=>GN.getValueFor(t).evaluate(t,MN.getValueFor(t)).hover)),QN=OM("accent-stroke-control-active").withDefault((t=>GN.getValueFor(t).evaluate(t,ON.getValueFor(t)).active)),YN=OM("accent-stroke-control-focus").withDefault((t=>GN.getValueFor(t).evaluate(t,NN.getValueFor(t)).focus)),ZN=createNonCss("neutral-fill-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSetByLuminance(yN.getValueFor(t),o||IN.getValueFor(t),AO.getValueFor(t),IO.getValueFor(t),PO.getValueFor(t),RO.getValueFor(t),void 0,2,3,1,2,void 0)}),JN=OM("neutral-fill-rest").withDefault((t=>ZN.getValueFor(t).evaluate(t).rest)),XN=OM("neutral-fill-hover").withDefault((t=>ZN.getValueFor(t).evaluate(t).hover)),eD=OM("neutral-fill-active").withDefault((t=>ZN.getValueFor(t).evaluate(t).active));OM("neutral-fill-focus").withDefault((t=>ZN.getValueFor(t).evaluate(t).focus));const tD=createNonCss("neutral-fill-input-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSetByLuminance(yN.getValueFor(t),o||IN.getValueFor(t),$O.getValueFor(t),MO.getValueFor(t),OO.getValueFor(t),NO.getValueFor(t),void 0,2,3,1,0,void 0)}),rD=OM("neutral-fill-input-rest").withDefault((t=>tD.getValueFor(t).evaluate(t).rest)),oD=OM("neutral-fill-input-hover").withDefault((t=>tD.getValueFor(t).evaluate(t).hover));OM("neutral-fill-input-active").withDefault((t=>tD.getValueFor(t).evaluate(t).active));const nD=OM("neutral-fill-input-focus").withDefault((t=>tD.getValueFor(t).evaluate(t).focus)),iD=createNonCss("neutral-fill-input-alt-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSetByLuminance(yN.getValueFor(t),o||IN.getValueFor(t),DO.getValueFor(t),LO.getValueFor(t),FO.getValueFor(t),BO.getValueFor(t),1,DO.getValueFor(t),DO.getValueFor(t)-LO.getValueFor(t),DO.getValueFor(t)-FO.getValueFor(t),BO.getValueFor(t),1)}),sD=OM("neutral-fill-input-alt-rest").withDefault((t=>iD.getValueFor(t).evaluate(t).rest)),aD=OM("neutral-fill-input-alt-hover").withDefault((t=>iD.getValueFor(t).evaluate(t).hover)),lD=OM("neutral-fill-input-alt-active").withDefault((t=>iD.getValueFor(t).evaluate(t).active)),cD=OM("neutral-fill-input-alt-focus").withDefault((t=>iD.getValueFor(t).evaluate(t).focus)),dD=createNonCss("neutral-fill-layer-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSet(yN.getValueFor(t),o||IN.getValueFor(t),HO.getValueFor(t),UO.getValueFor(t),qO.getValueFor(t),HO.getValueFor(t),1)});OM("neutral-fill-layer-rest").withDefault((t=>dD.getValueFor(t).evaluate(t).rest)),OM("neutral-fill-layer-hover").withDefault((t=>dD.getValueFor(t).evaluate(t).hover)),OM("neutral-fill-layer-active").withDefault((t=>dD.getValueFor(t).evaluate(t).active));const uD=createNonCss("neutral-fill-layer-alt-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSet(yN.getValueFor(t),o||IN.getValueFor(t),jO.getValueFor(t),jO.getValueFor(t),jO.getValueFor(t),jO.getValueFor(t))});OM("neutral-fill-layer-alt-rest").withDefault((t=>uD.getValueFor(t).evaluate(t).rest));const hD=createNonCss("neutral-fill-secondary-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSet(yN.getValueFor(t),o||IN.getValueFor(t),zO.getValueFor(t),VO.getValueFor(t),GO.getValueFor(t),KO.getValueFor(t))}),pD=OM("neutral-fill-secondary-rest").withDefault((t=>hD.getValueFor(t).evaluate(t).rest)),fD=OM("neutral-fill-secondary-hover").withDefault((t=>hD.getValueFor(t).evaluate(t).hover)),gD=OM("neutral-fill-secondary-active").withDefault((t=>hD.getValueFor(t).evaluate(t).active)),vD=OM("neutral-fill-secondary-focus").withDefault((t=>hD.getValueFor(t).evaluate(t).focus)),mD=createNonCss("neutral-fill-stealth-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSet(yN.getValueFor(t),o||IN.getValueFor(t),WO.getValueFor(t),QO.getValueFor(t),YO.getValueFor(t),ZO.getValueFor(t))}),yD=OM("neutral-fill-stealth-rest").withDefault((t=>mD.getValueFor(t).evaluate(t).rest)),bD=OM("neutral-fill-stealth-hover").withDefault((t=>mD.getValueFor(t).evaluate(t).hover)),wD=OM("neutral-fill-stealth-active").withDefault((t=>mD.getValueFor(t).evaluate(t).active)),CD=OM("neutral-fill-stealth-focus").withDefault((t=>mD.getValueFor(t).evaluate(t).focus)),_D=createNonCss("neutral-fill-strong-recipe").withDefault({evaluate:(t,o)=>contrastAndDeltaSwatchSet(yN.getValueFor(t),o||IN.getValueFor(t),4.5,JO.getValueFor(t),XO.getValueFor(t),eN.getValueFor(t),tN.getValueFor(t))});OM("neutral-fill-strong-rest").withDefault((t=>_D.getValueFor(t).evaluate(t).rest)),OM("neutral-fill-strong-hover").withDefault((t=>_D.getValueFor(t).evaluate(t).hover)),OM("neutral-fill-strong-active").withDefault((t=>_D.getValueFor(t).evaluate(t).active)),OM("neutral-fill-strong-focus").withDefault((t=>_D.getValueFor(t).evaluate(t).focus));const kD=createNonCss("neutral-foreground-recipe").withDefault({evaluate:(t,o)=>contrastAndDeltaSwatchSet(yN.getValueFor(t),o||IN.getValueFor(t),16,0,-19,-30,0)}),xD=OM("neutral-foreground-rest").withDefault((t=>kD.getValueFor(t).evaluate(t).rest)),SD=OM("neutral-foreground-hover").withDefault((t=>kD.getValueFor(t).evaluate(t).hover)),TD=OM("neutral-foreground-active").withDefault((t=>kD.getValueFor(t).evaluate(t).active));OM("neutral-foreground-focus").withDefault((t=>kD.getValueFor(t).evaluate(t).focus));const ED=createNonCss("neutral-foreground-hint-recipe").withDefault({evaluate:(t,o)=>function contrastSwatch(t,o,s){return t.colorContrast(o,s)}(yN.getValueFor(t),o||IN.getValueFor(t),4.5)}),AD=OM("neutral-foreground-hint").withDefault((t=>ED.getValueFor(t).evaluate(t))),ID=createNonCss("neutral-stroke-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSet(yN.getValueFor(t),o||IN.getValueFor(t),rN.getValueFor(t),oN.getValueFor(t),nN.getValueFor(t),iN.getValueFor(t))}),PD=OM("neutral-stroke-rest").withDefault((t=>ID.getValueFor(t).evaluate(t).rest)),RD=OM("neutral-stroke-hover").withDefault((t=>ID.getValueFor(t).evaluate(t).hover)),$D=OM("neutral-stroke-active").withDefault((t=>ID.getValueFor(t).evaluate(t).active));OM("neutral-stroke-focus").withDefault((t=>ID.getValueFor(t).evaluate(t).focus));const MD=createNonCss("neutral-stroke-control-recipe").withDefault({evaluate:(t,o)=>gradientShadowStroke(yN.getValueFor(t),o||IN.getValueFor(t),sN.getValueFor(t),aN.getValueFor(t),lN.getValueFor(t),cN.getValueFor(t),5)}),OD=OM("neutral-stroke-control-rest").withDefault((t=>MD.getValueFor(t).evaluate(t).rest)),ND=OM("neutral-stroke-control-hover").withDefault((t=>MD.getValueFor(t).evaluate(t).hover)),DD=OM("neutral-stroke-control-active").withDefault((t=>MD.getValueFor(t).evaluate(t).active));OM("neutral-stroke-control-focus").withDefault((t=>MD.getValueFor(t).evaluate(t).focus));const LD=createNonCss("neutral-stroke-divider-recipe").withDefault({evaluate:(t,o)=>function deltaSwatch(t,o,s){return t.get(t.closestIndexOf(o)+directionByIsDark(o)*s)}(yN.getValueFor(t),o||IN.getValueFor(t),dN.getValueFor(t))}),FD=OM("neutral-stroke-divider-rest").withDefault((t=>LD.getValueFor(t).evaluate(t))),BD=createNonCss("neutral-stroke-input-recipe").withDefault({evaluate:(t,o)=>function underlineStroke(t,o,s,l,h,m,_,E){const $=t.closestIndexOf(o),B=directionByIsDark(o),q=$+B*s,j=q+B*(l-s),K=q+B*(h-s),W=q+B*(m-s),X=`calc(100% - ${E})`;function gradientHelper(o,s){const l=t.get(o);if(s){const s=t.get(o+B*_),h=`linear-gradient(${l.toColorString()} ${X}, ${s.toColorString()} ${X}, ${s.toColorString()})`;return GradientSwatchRGB.fromObject(l,h)}return l}return{rest:gradientHelper(q,!0),hover:gradientHelper(j,!0),active:gradientHelper(K,!1),focus:gradientHelper(W,!0)}}(yN.getValueFor(t),o||IN.getValueFor(t),sN.getValueFor(t),aN.getValueFor(t),lN.getValueFor(t),cN.getValueFor(t),20,qM.getValueFor(t)+"px")}),HD=OM("neutral-stroke-input-rest").withDefault((t=>BD.getValueFor(t).evaluate(t).rest)),UD=OM("neutral-stroke-input-hover").withDefault((t=>BD.getValueFor(t).evaluate(t).hover));OM("neutral-stroke-input-active").withDefault((t=>BD.getValueFor(t).evaluate(t).active)),OM("neutral-stroke-input-focus").withDefault((t=>BD.getValueFor(t).evaluate(t).focus));const qD=createNonCss("neutral-stroke-layer-recipe").withDefault({evaluate:(t,o)=>deltaSwatchSet(yN.getValueFor(t),o||IN.getValueFor(t),uN.getValueFor(t),hN.getValueFor(t),pN.getValueFor(t),uN.getValueFor(t))}),jD=OM("neutral-stroke-layer-rest").withDefault((t=>qD.getValueFor(t).evaluate(t).rest));OM("neutral-stroke-layer-hover").withDefault((t=>qD.getValueFor(t).evaluate(t).hover)),OM("neutral-stroke-layer-active").withDefault((t=>qD.getValueFor(t).evaluate(t).active));const zD=createNonCss("neutral-stroke-strong-recipe").withDefault({evaluate:(t,o)=>contrastAndDeltaSwatchSet(yN.getValueFor(t),o||IN.getValueFor(t),5.5,0,fN.getValueFor(t),gN.getValueFor(t),vN.getValueFor(t))}),VD=OM("neutral-stroke-strong-rest").withDefault((t=>zD.getValueFor(t).evaluate(t).rest)),GD=OM("neutral-stroke-strong-hover").withDefault((t=>zD.getValueFor(t).evaluate(t).hover)),KD=OM("neutral-stroke-strong-active").withDefault((t=>zD.getValueFor(t).evaluate(t).active));OM("neutral-stroke-strong-focus").withDefault((t=>zD.getValueFor(t).evaluate(t).focus));const WD=createNonCss("focus-stroke-outer-recipe").withDefault({evaluate:t=>function focusStrokeOuter$1(t,o){return isDark(o)?TM:EM}(yN.getValueFor(t),IN.getValueFor(t))}),QD=OM("focus-stroke-outer").withDefault((t=>WD.getValueFor(t).evaluate(t))),YD=createNonCss("focus-stroke-inner-recipe").withDefault({evaluate:t=>function focusStrokeInner$1(t,o,s){return isDark(o)?EM:TM}(wN.getValueFor(t),IN.getValueFor(t),QD.getValueFor(t))}),ZD=OM("focus-stroke-inner").withDefault((t=>YD.getValueFor(t).evaluate(t))),JD=createNonCss("foreground-on-accent-large-recipe").withDefault({evaluate:t=>foregroundOnAccentSet($N.getValueFor(t),MN.getValueFor(t),ON.getValueFor(t),NN.getValueFor(t),PN.large)});OM("foreground-on-accent-rest-large").withDefault((t=>JD.getValueFor(t).evaluate(t).rest)),OM("foreground-on-accent-hover-large").withDefault((t=>JD.getValueFor(t).evaluate(t,MN.getValueFor(t)).hover)),OM("foreground-on-accent-active-large").withDefault((t=>JD.getValueFor(t).evaluate(t,ON.getValueFor(t)).active)),OM("foreground-on-accent-focus-large").withDefault((t=>JD.getValueFor(t).evaluate(t,NN.getValueFor(t)).focus));const XD=OM("neutral-fill-inverse-rest-delta").withDefault(0),eL=OM("neutral-fill-inverse-hover-delta").withDefault(-3),tL=OM("neutral-fill-inverse-active-delta").withDefault(7),rL=OM("neutral-fill-inverse-focus-delta").withDefault(0);const oL=createNonCss("neutral-fill-inverse-recipe").withDefault({evaluate:(t,o)=>function neutralFillInverse(t,o,s,l,h,m){const _=directionByIsDark(o),E=t.closestIndexOf(t.colorContrast(o,14)),$=E+_*Math.abs(s-l);let B,q;return(1===_?s<l:_*s>_*l)?(B=E,q=$):(B=$,q=E),{rest:t.get(B),hover:t.get(q),active:t.get(B+_*h),focus:t.get(B+_*m)}}(yN.getValueFor(t),o||IN.getValueFor(t),XD.getValueFor(t),eL.getValueFor(t),tL.getValueFor(t),rL.getValueFor(t))});OM("neutral-fill-inverse-rest").withDefault((t=>oL.getValueFor(t).evaluate(t).rest)),OM("neutral-fill-inverse-hover").withDefault((t=>oL.getValueFor(t).evaluate(t).hover)),OM("neutral-fill-inverse-active").withDefault((t=>oL.getValueFor(t).evaluate(t).active)),OM("neutral-fill-inverse-focus").withDefault((t=>oL.getValueFor(t).evaluate(t).focus));const nL=cssPartial`
  font-family: ${zM};
  font-size: ${GM};
  line-height: ${KM};
  font-weight: initial;
  font-variation-settings: ${WM};
`;cssPartial`
  font-family: ${zM};
  font-size: ${QM};
  line-height: ${YM};
  font-weight: initial;
  font-variation-settings: ${ZM};
`,cssPartial`
  font-family: ${zM};
  font-size: ${JM};
  line-height: ${XM};
  font-weight: initial;
  font-variation-settings: ${eO};
`,cssPartial`
  font-family: ${zM};
  font-size: ${tO};
  line-height: ${rO};
  font-weight: initial;
  font-variation-settings: ${oO};
`,cssPartial`
  font-family: ${zM};
  font-size: ${nO};
  line-height: ${iO};
  font-weight: initial;
  font-variation-settings: ${sO};
`,cssPartial`
  font-family: ${zM};
  font-size: ${aO};
  line-height: ${lO};
  font-weight: initial;
  font-variation-settings: ${cO};
`,cssPartial`
  font-family: ${zM};
  font-size: ${dO};
  line-height: ${uO};
  font-weight: initial;
  font-variation-settings: ${hO};
`,cssPartial`
  font-family: ${zM};
  font-size: ${pO};
  line-height: ${fO};
  font-weight: initial;
  font-variation-settings: ${gO};
`,cssPartial`
  font-family: ${zM};
  font-size: ${vO};
  line-height: ${mO};
  font-weight: initial;
  font-variation-settings: ${yO};
`;const iL=cssPartial`
  outline: calc(${jM} * 1px) solid ${QD};
  outline-offset: calc(${jM} * -1px);
`,sL=cssPartial`
  outline: calc(${jM} * 1px) solid ${QD};
  outline-offset: calc(${qM} * 1px);
`,aL=cssPartial`(${LM} + ${FM}) * ${BM}`;function __decorate$s(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_}"function"==typeof SuppressedError&&SuppressedError;class DirectionalStyleSheetBehavior{constructor(t,o){this.cache=new WeakMap,this.ltr=t,this.rtl=o}bind(t){this.attach(t)}unbind(t){const o=this.cache.get(t);o&&NM.unsubscribe(o)}attach(t){const o=this.cache.get(t)||new DirectionalStyleSheetBehaviorSubscription(this.ltr,this.rtl,t),s=NM.getValueFor(t);NM.subscribe(o),o.attach(s),this.cache.set(t,o)}}class DirectionalStyleSheetBehaviorSubscription{constructor(t,o,s){this.ltr=t,this.rtl=o,this.source=s,this.attached=null}handleChange({target:t,token:o}){this.attach(o.getValueFor(this.source))}attach(t){this.attached!==this[t]&&(null!==this.attached&&this.source.$fastController.removeStyles(this.attached),this.attached=this[t],null!==this.attached&&this.source.$fastController.addStyles(this.attached))}}const lL=$$.create({name:"elevation-shadow",cssCustomPropertyName:null}).withDefault({evaluate:(t,o,s)=>{let l=.12,h=.14;o>16&&(l=.2,h=.24);return`${`0 0 2px rgba(0, 0, 0, ${l})`}, ${`0 calc(${o} * 0.5px) calc((${o} * 1px)) rgba(0, 0, 0, ${h})`}`}}),cL=$$.create("elevation-shadow-card-rest-size").withDefault(4),dL=$$.create("elevation-shadow-card-hover-size").withDefault(8),uL=$$.create("elevation-shadow-card-active-size").withDefault(0),hL=$$.create("elevation-shadow-card-focus-size").withDefault(8),pL=$$.create("elevation-shadow-card-rest").withDefault((t=>lL.getValueFor(t).evaluate(t,cL.getValueFor(t))));$$.create("elevation-shadow-card-hover").withDefault((t=>lL.getValueFor(t).evaluate(t,dL.getValueFor(t)))),$$.create("elevation-shadow-card-active").withDefault((t=>lL.getValueFor(t).evaluate(t,uL.getValueFor(t)))),$$.create("elevation-shadow-card-focus").withDefault((t=>lL.getValueFor(t).evaluate(t,hL.getValueFor(t))));const fL=$$.create("elevation-shadow-tooltip-size").withDefault(16),gL=$$.create("elevation-shadow-tooltip").withDefault((t=>lL.getValueFor(t).evaluate(t,fL.getValueFor(t)))),vL=$$.create("elevation-shadow-flyout-size").withDefault(32),mL=$$.create("elevation-shadow-flyout").withDefault((t=>lL.getValueFor(t).evaluate(t,vL.getValueFor(t)))),yL=$$.create("elevation-shadow-dialog-size").withDefault(128),bL=$$.create("elevation-shadow-dialog").withDefault((t=>lL.getValueFor(t).evaluate(t,yL.getValueFor(t)))),NeutralButtonStyles=(t,o,s,l="[disabled]")=>css`
    .control {
      background: padding-box linear-gradient(${JN}, ${JN}),
        border-box ${OD};
    }

    :host(${s}:hover) .control {
      background: padding-box linear-gradient(${XN}, ${XN}),
        border-box ${ND};
    }

    :host(${s}:active) .control {
      background: padding-box linear-gradient(${eD}, ${eD}),
        border-box ${DD};
    }

    :host(${l}) .control {
      background: padding-box linear-gradient(${JN}, ${JN}),
        border-box ${PD};
    }
  `.withBehaviors(vM(css`
        .control {
          background: ${o$.ButtonFace};
          border-color: ${o$.ButtonText};
          color: ${o$.ButtonText};
        }

        :host(${s}:hover) .control,
        :host(${s}:active) .control {
          forced-color-adjust: none;
          background: ${o$.HighlightText};
          border-color: ${o$.Highlight};
          color: ${o$.Highlight};
        }

        :host(${l}) .control {
          background: transparent;
          border-color: ${o$.GrayText};
          color: ${o$.GrayText};
        }

        .control:${yM} {
          outline-color: ${o$.CanvasText};
        }

        :host([href]) .control {
          background: transparent;
          border-color: ${o$.LinkText};
          color: ${o$.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: transparent;
          border-color: ${o$.CanvasText};
          color: ${o$.CanvasText};
        }
    `)),StealthButtonStyles=(t,o,s,l="[disabled]")=>css`
    .control {
      background: ${yD};
    }

    :host(${s}:hover) .control {
      background: ${bD};
    }

    :host(${s}:active) .control {
      background: ${wD};
    }

    :host(${l}) .control {
      background: ${yD};
    }
  `.withBehaviors(vM(css`
        .control {
          forced-color-adjust: none;
          background: transparent;
          color: ${o$.ButtonText};
        }

        :host(${s}:hover) .control,
        :host(${s}:active) .control {
          background: transparent;
          border-color: ${o$.ButtonText};
          color: ${o$.ButtonText};
        }

        :host(${l}) .control {
          background: transparent;
          color: ${o$.GrayText};
        }
        
        .control:${yM} {
          outline-color: ${o$.CanvasText};
        }

        :host([href]) .control {
          color: ${o$.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: transparent;
          border-color: ${o$.LinkText};
          color: ${o$.LinkText};
        }
      `)),wL=$$.create("input-placeholder-rest").withDefault((t=>{const o=tD.getValueFor(t);return ED.getValueFor(t).evaluate(t,o.evaluate(t).rest)})),CL=$$.create("input-placeholder-hover").withDefault((t=>{const o=tD.getValueFor(t);return ED.getValueFor(t).evaluate(t,o.evaluate(t).hover)})),_L=$$.create("input-filled-placeholder-rest").withDefault((t=>{const o=hD.getValueFor(t);return ED.getValueFor(t).evaluate(t,o.evaluate(t).rest)})),kL=$$.create("input-filled-placeholder-hover").withDefault((t=>{const o=hD.getValueFor(t);return ED.getValueFor(t).evaluate(t,o.evaluate(t).hover)})),baseInputStyles=(t,o,s)=>css`
  :host {
    ${nL}
    color: ${xD};
    fill: currentcolor;
    user-select: none;
    position: relative;
  }

  ${s} {
    box-sizing: border-box;
    position: relative;
    color: inherit;
    border: calc(${qM} * 1px) solid transparent;
    border-radius: calc(${HM} * 1px);
    height: calc(${aL} * 1px);
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
  }

  .control {
    width: 100%;
    outline: none;
  }

  .label {
    display: block;
    color: ${xD};
    cursor: pointer;
    ${nL}
    margin-bottom: 4px;
  }

  .label__hidden {
    display: none;
    visibility: hidden;
  }

  :host([disabled]) ${s},
  :host([readonly]) ${s},
  :host([disabled]) .label,
  :host([readonly]) .label,
  :host([disabled]) .control,
  :host([readonly]) .control {
    cursor: ${mM};
  }

  :host([disabled]) {
    opacity: ${DM};
  }
`,inputStateStyles=(t,o,s)=>css`
  @media (forced-colors: none) {
    :host(:not([disabled]):active)::after {
      left: 50%;
      width: 40%;
      transform: translateX(-50%);
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }

    :host(:not([disabled]):focus-within)::after {
      left: 0;
      width: 100%;
      transform: none;
    }

    :host(:not([disabled]):active)::after,
    :host(:not([disabled]):focus-within:not(:active))::after {
      content: '';
      position: absolute;
      height: calc(${jM} * 1px);
      bottom: 0;
      border-bottom: calc(${jM} * 1px) solid ${$N};
      border-bottom-left-radius: calc(${HM} * 1px);
      border-bottom-right-radius: calc(${HM} * 1px);
      z-index: 2;
      transition: all 300ms cubic-bezier(0.1, 0.9, 0.2, 1);
    }
  }
`,inputOutlineStyles=(t,o,s,l=":not([disabled]):not(:focus-within)")=>css`
  ${s} {
    background: padding-box linear-gradient(${rD}, ${rD}),
      border-box ${HD};
  }

  :host(${l}:hover) ${s} {
    background: padding-box linear-gradient(${oD}, ${oD}),
      border-box ${UD};
  }

  :host(:not([disabled]):focus-within) ${s} {
    background: padding-box linear-gradient(${nD}, ${nD}),
      border-box ${HD};
  }
  
  :host([disabled]) ${s} {
    background: padding-box linear-gradient(${rD}, ${rD}),
      border-box ${PD};
  }

  .control::placeholder {
    color: ${wL};
  }

  :host(${l}:hover) .control::placeholder {
    color: ${CL};
  }
`,inputFilledStyles=(t,o,s,l=":not([disabled]):not(:focus-within)")=>css`
  ${s} {
    background: ${pD};
  }

  :host(${l}:hover) ${s} {
    background: ${fD};
  }

  :host(:not([disabled]):focus-within) ${s} {
    background: ${vD};
  }

  :host([disabled]) ${s} {
    background: ${pD};
  }

  .control::placeholder {
    color: ${_L};
  }

  :host(${l}:hover) .control::placeholder {
    color: ${kL};
  }
`,inputForcedColorStyles=(t,o,s,l=":not([disabled]):not(:focus-within)")=>css`
  :host {
    color: ${o$.ButtonText};
  }

  ${s} {
    background: ${o$.ButtonFace};
    border-color: ${o$.ButtonText};
  }

  :host(${l}:hover) ${s},
  :host(:not([disabled]):focus-within) ${s} {
    border-color: ${o$.Highlight};
  }

  :host([disabled]) ${s} {
    opacity: 1;
    background: ${o$.ButtonFace};
    border-color: ${o$.GrayText};
  }

  .control::placeholder,
  :host(${l}:hover) .control::placeholder {
    color: ${o$.CanvasText};
  }

  :host(:not([disabled]):focus) ${s} {
    ${iL}
    outline-color: ${o$.Highlight};
  }

  :host([disabled]) {
    opacity: 1;
    color: ${o$.GrayText};
  }

  :host([disabled]) ::placeholder,
  :host([disabled]) ::-webkit-input-placeholder {
    color: ${o$.GrayText};
  }
`;function appearanceBehavior(t,o){return new PropertyStyleSheetBehavior("appearance",t,o)}const xL=Breadcrumb.compose({baseName:"breadcrumb",template:(t,o)=>html`
    <template role="navigation">
        <div role="list" class="list" part="list">
            <slot
                ${slotted({property:"slottedBreadcrumbItems",filter:elements()})}
            ></slot>
        </div>
    </template>
`,styles:(t,o)=>css`
  ${display("inline-block")} :host {
    box-sizing: border-box;
    ${nL};
  }

  .list {
    display: flex;
  }
`}),SL=BreadcrumbItem.compose({baseName:"breadcrumb-item",template:(t,o)=>html`
    <div role="listitem" class="listitem" part="listitem">
        ${when((t=>t.href&&t.href.length>0),html`
                ${((t,o)=>html`
    <a
        class="control"
        part="control"
        download="${t=>t.download}"
        href="${t=>t.href}"
        hreflang="${t=>t.hreflang}"
        ping="${t=>t.ping}"
        referrerpolicy="${t=>t.referrerpolicy}"
        rel="${t=>t.rel}"
        target="${t=>t.target}"
        type="${t=>t.type}"
        aria-atomic="${t=>t.ariaAtomic}"
        aria-busy="${t=>t.ariaBusy}"
        aria-controls="${t=>t.ariaControls}"
        aria-current="${t=>t.ariaCurrent}"
        aria-describedby="${t=>t.ariaDescribedby}"
        aria-details="${t=>t.ariaDetails}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-errormessage="${t=>t.ariaErrormessage}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-flowto="${t=>t.ariaFlowto}"
        aria-haspopup="${t=>t.ariaHaspopup}"
        aria-hidden="${t=>t.ariaHidden}"
        aria-invalid="${t=>t.ariaInvalid}"
        aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
        aria-label="${t=>t.ariaLabel}"
        aria-labelledby="${t=>t.ariaLabelledby}"
        aria-live="${t=>t.ariaLive}"
        aria-owns="${t=>t.ariaOwns}"
        aria-relevant="${t=>t.ariaRelevant}"
        aria-roledescription="${t=>t.ariaRoledescription}"
        ${ref("control")}
    >
        ${startSlotTemplate(0,o)}
        <span class="content" part="content">
            <slot ${slotted("defaultSlottedContent")}></slot>
        </span>
        ${endSlotTemplate(0,o)}
    </a>
`)(0,o)}
            `)}
        ${when((t=>!t.href),html`
                ${startSlotTemplate(0,o)}
                <slot></slot>
                ${endSlotTemplate(0,o)}
            `)}
        ${when((t=>t.separator),html`
                <span class="separator" part="separator" aria-hidden="true">
                    <slot name="separator">${o.separator||""}</slot>
                </span>
            `)}
    </div>
`,styles:(t,o)=>css`
    ${display("inline-flex")} :host {
      background: transparent;
      color: ${xD};
      fill: currentcolor;
      box-sizing: border-box;
      ${nL};
      min-width: calc(${aL} * 1px);
      border-radius: calc(${HM} * 1px);
    }

    .listitem {
      display: flex;
      align-items: center;
      border-radius: inherit;
    }

    .control {
      position: relative;
      align-items: center;
      box-sizing: border-box;
      color: inherit;
      fill: inherit;
      cursor: pointer;
      display: flex;
      outline: none;
      text-decoration: none;
      white-space: nowrap;
      border-radius: inherit;
    }

    .control:hover {
      color: ${SD};
    }

    .control:active {
      color: ${TD};
    }

    .control:${yM} {
      ${sL}
    }

    :host(:not([href])),
    :host([aria-current]) .control {
      color: ${xD};
      fill: currentcolor;
      cursor: default;
    }

    .start {
      display: flex;
      margin-inline-end: 6px;
    }

    .end {
      display: flex;
      margin-inline-start: 6px;
    }

    .separator {
      display: flex;
    }
  `.withBehaviors(vM(css`
        :host(:not([href])),
        .start,
        .end,
        .separator {
          background: ${o$.ButtonFace};
          color: ${o$.ButtonText};
          fill: currentcolor;
        }
        .separator {
          fill: ${o$.ButtonText};
        }
        :host([href]) {
          forced-color-adjust: none;
          background: ${o$.ButtonFace};
          color: ${o$.LinkText};
        }
        :host([href]) .control:hover {
          background: ${o$.LinkText};
          color: ${o$.HighlightText};
          fill: currentcolor;
        }
        .control:${yM} {
          outline-color: ${o$.LinkText};
        }
      `)),shadowOptions:{delegatesFocus:!0},separator:'\n    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n      <path d="M4.65 2.15a.5.5 0 000 .7L7.79 6 4.65 9.15a.5.5 0 10.7.7l3.5-3.5a.5.5 0 000-.7l-3.5-3.5a.5.5 0 00-.7 0z"/>\n    </svg>\n  '}),TL=":not([disabled])",EL="[disabled]";class Button extends Button$1{appearanceChanged(t,o){t!==o&&(this.classList.add(o),this.classList.remove(t))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="neutral")}defaultSlottedContentChanged(){const t=this.defaultSlottedContent.filter((t=>t.nodeType===Node.ELEMENT_NODE));1===t.length&&t[0]instanceof SVGElement?this.control.classList.add("icon-only"):this.control.classList.remove("icon-only")}}__decorate$s([attr],Button.prototype,"appearance",void 0);const AL=Button.compose({baseName:"button",baseClass:Button$1,template:(t,o)=>html`
    <button
        class="control"
        part="control"
        ?autofocus="${t=>t.autofocus}"
        ?disabled="${t=>t.disabled}"
        form="${t=>t.formId}"
        formaction="${t=>t.formaction}"
        formenctype="${t=>t.formenctype}"
        formmethod="${t=>t.formmethod}"
        formnovalidate="${t=>t.formnovalidate}"
        formtarget="${t=>t.formtarget}"
        name="${t=>t.name}"
        type="${t=>t.type}"
        value="${t=>t.value}"
        aria-atomic="${t=>t.ariaAtomic}"
        aria-busy="${t=>t.ariaBusy}"
        aria-controls="${t=>t.ariaControls}"
        aria-current="${t=>t.ariaCurrent}"
        aria-describedby="${t=>t.ariaDescribedby}"
        aria-details="${t=>t.ariaDetails}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-errormessage="${t=>t.ariaErrormessage}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-flowto="${t=>t.ariaFlowto}"
        aria-haspopup="${t=>t.ariaHaspopup}"
        aria-hidden="${t=>t.ariaHidden}"
        aria-invalid="${t=>t.ariaInvalid}"
        aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
        aria-label="${t=>t.ariaLabel}"
        aria-labelledby="${t=>t.ariaLabelledby}"
        aria-live="${t=>t.ariaLive}"
        aria-owns="${t=>t.ariaOwns}"
        aria-pressed="${t=>t.ariaPressed}"
        aria-relevant="${t=>t.ariaRelevant}"
        aria-roledescription="${t=>t.ariaRoledescription}"
        ${ref("control")}
    >
        ${startSlotTemplate(0,o)}
        <span class="content" part="content">
            <slot ${slotted("defaultSlottedContent")}></slot>
        </span>
        ${endSlotTemplate(0,o)}
    </button>
`,styles:(t,o)=>css`
    :host(${TL}) .control {
      cursor: pointer;
    }

    :host(${EL}) .control {
      cursor: ${mM};
    }

    @media (forced-colors: none) {
      :host(${EL}) .control {
        opacity: ${DM};
      }
    }

    ${css`
    ${display("inline-flex")}
    
    :host {
      position: relative;
      box-sizing: border-box;
      ${nL}
      height: calc(${aL} * 1px);
      min-width: calc(${aL} * 1px);
      color: ${xD};
      border-radius: calc(${HM} * 1px);
      fill: currentcolor;
    }

    .control {
      border: calc(${qM} * 1px) solid transparent;
      flex-grow: 1;
      box-sizing: border-box;
      display: inline-flex;
      justify-content: center;
      align-items: center;
      padding: 0 calc((10 + (${BM} * 2 * ${FM})) * 1px);
      white-space: nowrap;
      outline: none;
      text-decoration: none;
      color: inherit;
      border-radius: inherit;
      fill: inherit;
      font-family: inherit;
    }

    .control,
    .end,
    .start {
      font: inherit;
    }

    .control.icon-only {
      padding: 0;
      line-height: 0;
    }

    .control:${yM} {
      ${iL}
    }

    .control::-moz-focus-inner {
      border: 0;
    }

    .content {
      pointer-events: none;
    }

    .start,
    .end {
      display: flex;
      pointer-events: none;
    }

    .start {
      margin-inline-end: 11px;
    }

    .end {
      margin-inline-start: 11px;
    }
  `}
  `.withBehaviors(appearanceBehavior("neutral",NeutralButtonStyles(0,0,TL,EL)),appearanceBehavior("accent",((t,o,s,l="[disabled]")=>css`
    .control {
      background: padding-box linear-gradient(${$N}, ${$N}),
        border-box ${KN};
      color: ${LN};
    }

    :host(${s}:hover) .control {
      background: padding-box linear-gradient(${MN}, ${MN}),
        border-box ${WN};
      color: ${FN};
    }

    :host(${s}:active) .control {
      background: padding-box linear-gradient(${ON}, ${ON}),
        border-box ${QN};
      color: ${BN};
    }

    :host(${l}) .control {
      background: ${$N};
    }

    .control:${yM} {
      box-shadow: 0 0 0 calc(${jM} * 1px) ${ZD} inset !important;
    }
  `.withBehaviors(vM(css`
        .control {
          forced-color-adjust: none;
          background: ${o$.Highlight};
          color: ${o$.HighlightText};
        }

        :host(${s}:hover) .control,
        :host(${s}:active) .control {
          background: ${o$.HighlightText};
          border-color: ${o$.Highlight};
          color: ${o$.Highlight};
        }

        :host(${l}) .control {
          background: transparent;
          border-color: ${o$.GrayText};
          color: ${o$.GrayText};
        }

        .control:${yM} {
          outline-color: ${o$.CanvasText};
          box-shadow: 0 0 0 calc(${jM} * 1px) ${o$.HighlightText} inset !important;
        }

        :host([href]) .control {
          background: ${o$.LinkText};
          color: ${o$.HighlightText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          background: ${o$.ButtonFace};
          border-color: ${o$.LinkText};
          color: ${o$.LinkText};
        }
      `)))(0,0,TL,EL)),appearanceBehavior("lightweight",((t,o,s,l="[disabled]")=>css`
    :host {
      color: ${qN};
    }

    .control {
      background: ${yD};
    }

    :host(${s}:hover) .control {
      background: ${bD};
      color: ${jN};
    }

    :host(${s}:active) .control {
      background: ${wD};
      color: ${zN};
    }

    :host(${l}) .control {
      background: ${yD};
    }
  `.withBehaviors(vM(css`
        :host {
          color: ${o$.ButtonText};
        }

        .control {
          forced-color-adjust: none;
          background: transparent;
        }

        :host(${s}:hover) .control,
        :host(${s}:active) .control {
          background: transparent;
          border-color: ${o$.ButtonText};
          color: ${o$.ButtonText};
        }

        :host(${l}) .control {
          background: transparent;
          color: ${o$.GrayText};
        }

        .control:${yM} {
          outline-color: ${o$.CanvasText};
        }

        :host([href]) .control {
          color: ${o$.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          border-color: ${o$.LinkText};
          color: ${o$.LinkText};
        }
      `)))(0,0,TL,EL)),appearanceBehavior("outline",((t,o,s,l="[disabled]")=>css`
    .control {
      background: transparent !important;
      border-color: ${PD};
    }

    :host(${s}:hover) .control {
      border-color: ${RD};
    }

    :host(${s}:active) .control {
      border-color: ${$D};
    }

    :host(${l}) .control {
      background: transparent !important;
      border-color: ${PD};
    }
  `.withBehaviors(vM(css`
        .control {
          border-color: ${o$.ButtonText};
          color: ${o$.ButtonText};
        }

        :host(${s}:hover) .control,
        :host(${s}:active) .control {
          background: ${o$.HighlightText};
          border-color: ${o$.Highlight};
          color: ${o$.Highlight};
        }

        :host(${l}) .control {
          border-color: ${o$.GrayText};
          color: ${o$.GrayText};
        }

        .control:${yM} {
          outline-color: ${o$.CanvasText};
        }

        :host([href]) .control {
          border-color: ${o$.LinkText};
          color: ${o$.LinkText};
        }

        :host([href]:hover) .control,
        :host([href]:active) .control {
          border-color: ${o$.CanvasText};
          color: ${o$.CanvasText};
        }
      `)))(0,0,TL,EL)),appearanceBehavior("stealth",StealthButtonStyles(0,0,TL,EL))),shadowOptions:{delegatesFocus:!0}}),IL=css`
.day.disabled::before {
  transform: translate(-50%, 0) rotate(45deg);
}
`,PL=css`
.day.disabled::before {
  transform: translate(50%, 0) rotate(-45deg);
}
`;class Calendar extends Calendar$1{constructor(){super(...arguments),this.readonly=!0}}__decorate$s([attr({converter:XP})],Calendar.prototype,"readonly",void 0);const RL=Calendar.compose({baseName:"calendar",template:(t,o)=>{var s;const l=new Date,h=`${l.getMonth()+1}-${l.getDate()}-${l.getFullYear()}`;return html`
        <template>
            ${gR}
            ${o.title instanceof Function?o.title(t,o):null!==(s=o.title)&&void 0!==s?s:""}
            <slot></slot>
            ${when((t=>t.readonly),(t=>html`
        <div class="days" part="days">
            <div class="week-days" part="week-days">
                ${repeat((t=>t.getWeekdayText()),html`
                        <div class="week-day" part="week-day" abbr="${t=>t.abbr}">
                            ${t=>t.text}
                        </div>
                    `)}
            </div>
            ${repeat((t=>t.getDays()),html`
                    <div class="week">
                        ${repeat((t=>t),html`
                                <div
                                    class="${(o,s)=>s.parentContext.parent.getDayClassNames(o,t)}"
                                    part="day"
                                    aria-label="${(t,o)=>o.parentContext.parent.dateFormatter.getDate(`${t.month}-${t.day}-${t.year}`,{month:"long",day:"numeric"})}"
                                >
                                    <div
                                        class="date"
                                        part="${o=>t===`${o.month}-${o.day}-${o.year}`?"today":"date"}"
                                    >
                                        ${(t,o)=>o.parentContext.parent.dateFormatter.getDay(t.day)}
                                    </div>
                                    <slot
                                        name="${t=>t.month}-${t=>t.day}-${t=>t.year}"
                                    ></slot>
                                </div>
                            `)}
                    </div>
                `)}
        </div>
    `)(h),interactiveCalendarGridTemplate(t,h))}
            ${fR}
        </template>
    `},styles:(t,o)=>css`
${display("inline-block")} :host {
  --calendar-cell-size: calc((${LM} + 2 + ${FM}) * ${BM} * 1px);
  --calendar-gap: 2px;
  ${nL}
  color: ${xD};
}

.title {
  padding: calc(${BM} * 2px);
  font-weight: 600;
}

.days {
  text-align: center;
}

.week-days,
.week {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  grid-gap: var(--calendar-gap);
  border: 0;
  padding: 0;
}

.day,
.week-day {
  border: 0;
  width: var(--calendar-cell-size);
  height: var(--calendar-cell-size);
  line-height: var(--calendar-cell-size);
  padding: 0;
  box-sizing: initial;
}

.week-day {
  font-weight: 600;
}

.day {
  border: calc(${qM} * 1px) solid transparent;
  border-radius: calc(${HM} * 1px);
}

.interact .day {
  cursor: pointer;
}

.date {
  height: 100%;
}

.inactive .date,
.inactive.disabled::before {
  color: ${AD};
}

.disabled::before {
  content: '';
  display: inline-block;
  width: calc(var(--calendar-cell-size) * .8);
  height: calc(${qM} * 1px);
  background: currentColor;
  position: absolute;
  margin-top: calc(var(--calendar-cell-size) / 2);
  transform-origin: center;
  z-index: 1;
}

.selected {
  color: ${$N};
  border: 1px solid ${$N};
  background: ${IN};
}

.selected + .selected {
  border-start-start-radius: 0;
  border-end-start-radius: 0;
  border-inline-start-width: 0;
  padding-inline-start: calc(var(--calendar-gap) + (${qM} + ${HM}) * 1px);
  margin-inline-start: calc((${HM} * -1px) - var(--calendar-gap));
}

.today.disabled::before {
  color: ${LN};
}

.today .date {
  color: ${LN};
  background: ${$N};
  border-radius: 50%;
  position: relative;
}
`.withBehaviors(vM(css`
          .day.selected {
              color: ${o$.Highlight};
          }

          .today .date {
              background: ${o$.Highlight};
              color: ${o$.HighlightText};
          }
      `),new DirectionalStyleSheetBehavior(IL,PL)),title:b$});class Card extends Card$1{cardFillColorChanged(t,o){if(o){const t=parseColorHexRGB(o);null!==t&&(this.neutralPaletteSource=o,IN.setValueFor(this,_M.create(t.r,t.g,t.b)))}}neutralPaletteSourceChanged(t,o){if(o){const t=parseColorHexRGB(o),s=_M.create(t.r,t.g,t.b);yN.setValueFor(this,SM.create(s))}}handleChange(t,o){this.cardFillColor||IN.setValueFor(this,(o=>dD.getValueFor(o).evaluate(o,IN.getValueFor(t)).rest))}connectedCallback(){super.connectedCallback();const t=composedParent(this);if(t){const o=zP.getNotifier(t);o.subscribe(this,"fillColor"),o.subscribe(this,"neutralPalette"),this.handleChange(t,"fillColor")}}}__decorate$s([attr({attribute:"card-fill-color",mode:"fromView"})],Card.prototype,"cardFillColor",void 0),__decorate$s([attr({attribute:"neutral-palette-source",mode:"fromView"})],Card.prototype,"neutralPaletteSource",void 0);const $L=Card.compose({baseName:"card",baseClass:Card$1,template:(t,o)=>html`
    <slot></slot>
`,styles:(t,o)=>css`
    ${display("block")} :host {
      display: block;
      contain: content;
      height: var(--card-height, 100%);
      width: var(--card-width, 100%);
      box-sizing: border-box;
      background: ${IN};
      color: ${xD};
      border: calc(${qM} * 1px) solid ${jD};
      border-radius: calc(${UM} * 1px);
      box-shadow: ${pL};
    }

    :host {
      content-visibility: auto;
    }
  `.withBehaviors(vM(css`
        :host {
          background: ${o$.Canvas};
          color: ${o$.CanvasText};
        }
      `))}),ML=Checkbox.compose({baseName:"checkbox",template:(t,o)=>html`
    <template
        role="checkbox"
        aria-checked="${t=>t.checked}"
        aria-required="${t=>t.required}"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        tabindex="${t=>t.disabled?null:0}"
        @keypress="${(t,o)=>t.keypressHandler(o.event)}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        class="${t=>t.readOnly?"readonly":""} ${t=>t.checked?"checked":""} ${t=>t.indeterminate?"indeterminate":""}"
    >
        <div part="control" class="control">
            <slot name="checked-indicator">
                ${o.checkedIndicator||""}
            </slot>
            <slot name="indeterminate-indicator">
                ${o.indeterminateIndicator||""}
            </slot>
        </div>
        <label
            part="label"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${slotted("defaultSlottedNodes")}></slot>
        </label>
    </template>
`,styles:(t,o)=>css`
    ${display("inline-flex")} :host {
      align-items: center;
      outline: none;
      ${""} user-select: none;
    }

    .control {
      position: relative;
      width: calc((${aL} / 2 + ${BM}) * 1px);
      height: calc((${aL} / 2 + ${BM}) * 1px);
      box-sizing: border-box;
      border-radius: calc(${HM} * 1px);
      border: calc(${qM} * 1px) solid ${VD};
      background: ${sD};
      cursor: pointer;
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .label {
      ${nL}
      color: ${xD};
      ${""} padding-inline-start: calc(${BM} * 2px + 2px);
      margin-inline-end: calc(${BM} * 2px + 2px);
      cursor: pointer;
    }

    slot[name='checked-indicator'],
    slot[name='indeterminate-indicator'] {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      fill: ${xD};
      opacity: 0;
      pointer-events: none;
    }

    slot[name='indeterminate-indicator'] {
      position: absolute;
      top: 0;
    }

    :host(.checked) slot[name='checked-indicator'],
    :host(.checked) slot[name='indeterminate-indicator'] {
      fill: ${LN};
    }

    :host(:not(.disabled):hover) .control {
      background: ${aD};
      border-color: ${GD};
    }

    :host(:not(.disabled):active) .control {
      background: ${lD};
      border-color: ${KD};
    }

    :host(:${yM}) .control {
      background: ${cD};
      ${sL}
    }

    :host(.checked) .control {
      background: ${$N};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):hover) .control {
      background: ${MN};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):active) .control {
      background: ${ON};
      border-color: transparent;
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.readonly) .control,
    :host(.disabled) .control {
      cursor: ${mM};
    }

    :host(.checked:not(.indeterminate)) slot[name='checked-indicator'],
    :host(.indeterminate) slot[name='indeterminate-indicator'] {
      opacity: 1;
    }

    :host(.disabled) {
      opacity: ${DM};
    }
  `.withBehaviors(vM(css`
        .control {
          border-color: ${o$.FieldText};
          background: ${o$.Field};
        }
        :host(:not(.disabled):hover) .control,
        :host(:not(.disabled):active) .control {
          border-color: ${o$.Highlight};
          background: ${o$.Field};
        }
        slot[name='checked-indicator'],
        slot[name='indeterminate-indicator'] {
          fill: ${o$.FieldText};
        }
        :host(:${yM}) .control {
          forced-color-adjust: none;
          outline-color: ${o$.FieldText};
          background: ${o$.Field};
          border-color: ${o$.Highlight};
        }
        :host(.checked) .control {
          background: ${o$.Highlight};
          border-color: ${o$.Highlight};
        }
        :host(.checked:not(.disabled):hover) .control,
        :host(.checked:not(.disabled):active) .control {
          background: ${o$.HighlightText};
          border-color: ${o$.Highlight};
        }
        :host(.checked) slot[name='checked-indicator'],
        :host(.checked) slot[name='indeterminate-indicator'] {
          fill: ${o$.HighlightText};
        }
        :host(.checked:hover ) .control slot[name='checked-indicator'],
        :host(.checked:hover ) .control slot[name='indeterminate-indicator'] {
          fill: ${o$.Highlight};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) .control {
          border-color: ${o$.GrayText};
          background: ${o$.Field};
        }
        :host(.disabled) slot[name='checked-indicator'],
        :host(.checked.disabled:hover) .control slot[name='checked-indicator'],
        :host(.disabled) slot[name='indeterminate-indicator'],
        :host(.checked.disabled:hover) .control slot[name='indeterminate-indicator'] {
          fill: ${o$.GrayText};
        }
      `)),checkedIndicator:'\n    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n      <path d="M13.86 3.66a.5.5 0 01-.02.7l-7.93 7.48a.6.6 0 01-.84-.02L2.4 9.1a.5.5 0 01.72-.7l2.4 2.44 7.65-7.2a.5.5 0 01.7.02z"/>\n    </svg>\n  ',indeterminateIndicator:'\n    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n      <path d="M3 8c0-.28.22-.5.5-.5h9a.5.5 0 010 1h-9A.5.5 0 013 8z"/>\n    </svg>\n  '}),OL=".control",NL=":not([disabled]):not([open])",DL="[disabled]",baseSelectStyles=(t,o)=>css`
    ${display("inline-flex")}
    
    :host {
      border-radius: calc(${HM} * 1px);
      box-sizing: border-box;
      color: ${xD};
      fill: currentcolor;
      font-family: ${zM};
      position: relative;
      user-select: none;
      min-width: 250px;
      vertical-align: top;
    }

    .listbox {
      box-shadow: ${mL};
      background: ${IN};
      border-radius: calc(${UM} * 1px);
      box-sizing: border-box;
      display: inline-flex;
      flex-direction: column;
      left: 0;
      max-height: calc(var(--max-height) - (${aL} * 1px));
      padding: calc((${BM} - ${qM} ) * 1px);
      overflow-y: auto;
      position: absolute;
      width: 100%;
      z-index: 1;
      margin: 1px 0;
      border: calc(${qM} * 1px) solid transparent;
    }

    .listbox[hidden] {
      display: none;
    }

    .control {
      border: calc(${qM} * 1px) solid transparent;
      border-radius: calc(${HM} * 1px);
      height: calc(${aL} * 1px);
      align-items: center;
      box-sizing: border-box;
      cursor: pointer;
      display: flex;
      ${nL}
      min-height: 100%;
      padding: 0 calc(${BM} * 2.25px);
      width: 100%;
    }

    :host(:${yM}) {
      ${iL}
    }

    :host([disabled]) .control {
      cursor: ${mM};
      opacity: ${DM};
      user-select: none;
    }

    :host([open][position='above']) .listbox {
      bottom: calc((${aL} + ${BM} * 2) * 1px);
    }

    :host([open][position='below']) .listbox {
      top: calc((${aL} + ${BM} * 2) * 1px);
    }

    .selected-value {
      font-family: inherit;
      flex: 1 1 auto;
      text-align: start;
    }

    .indicator {
      flex: 0 0 auto;
      margin-inline-start: 1em;
    }

    slot[name='listbox'] {
      display: none;
      width: 100%;
    }

    :host([open]) slot[name='listbox'] {
      display: flex;
      position: absolute;
    }

    .start {
      margin-inline-end: 11px;
    }

    .end {
      margin-inline-start: 11px;
    }

    .start,
    .end,
    .indicator,
    ::slotted(svg) {
      display: flex;
    }

    ::slotted([role='option']) {
      flex: 0 0 auto;
    }
  `,LL=".control",FL=":not([disabled]):not([open])";class Combobox extends Combobox$1{appearanceChanged(t,o){t!==o&&(this.classList.add(o),this.classList.remove(t))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline"),this.listbox&&IN.setValueFor(this.listbox,kN)}}__decorate$s([attr({mode:"fromView"})],Combobox.prototype,"appearance",void 0);const BL=Combobox.compose({baseName:"combobox",baseClass:Combobox$1,shadowOptions:{delegatesFocus:!0},template:(t,o)=>html`
    <template
        aria-disabled="${t=>t.ariaDisabled}"
        autocomplete="${t=>t.autocomplete}"
        class="${t=>t.open?"open":""} ${t=>t.disabled?"disabled":""} ${t=>t.position}"
        ?open="${t=>t.open}"
        tabindex="${t=>t.disabled?null:"0"}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusout="${(t,o)=>t.focusoutHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
    >
        <div class="control" part="control">
            ${startSlotTemplate(0,o)}
            <slot name="control">
                <input
                    aria-activedescendant="${t=>t.open?t.ariaActiveDescendant:null}"
                    aria-autocomplete="${t=>t.ariaAutoComplete}"
                    aria-controls="${t=>t.ariaControls}"
                    aria-disabled="${t=>t.ariaDisabled}"
                    aria-expanded="${t=>t.ariaExpanded}"
                    aria-haspopup="listbox"
                    class="selected-value"
                    part="selected-value"
                    placeholder="${t=>t.placeholder}"
                    role="combobox"
                    type="text"
                    ?disabled="${t=>t.disabled}"
                    :value="${t=>t.value}"
                    @input="${(t,o)=>t.inputHandler(o.event)}"
                    @keyup="${(t,o)=>t.keyupHandler(o.event)}"
                    ${ref("control")}
                />
                <div class="indicator" part="indicator" aria-hidden="true">
                    <slot name="indicator">
                        ${o.indicator||""}
                    </slot>
                </div>
            </slot>
            ${endSlotTemplate(0,o)}
        </div>
        <div
            class="listbox"
            id="${t=>t.listboxId}"
            part="listbox"
            role="listbox"
            ?disabled="${t=>t.disabled}"
            ?hidden="${t=>!t.open}"
            ${ref("listbox")}
        >
            <slot
                ${slotted({filter:Listbox$1.slottedOptionFilter,flatten:!0,property:"slottedOptions"})}
            ></slot>
        </div>
    </template>
`,styles:(t,o)=>css`
    ${baseSelectStyles()}

    ${inputStateStyles()}

    :host(:empty) .listbox {
      display: none;
    }

    :host([disabled]) *,
    :host([disabled]) {
      cursor: ${mM};
      user-select: none;
    }

    :host(:active) .selected-value {
      user-select: none;
    }

    .selected-value {
      -webkit-appearance: none;
      background: transparent;
      border: none;
      color: inherit;
      ${nL}
      height: calc(100% - ${qM} * 1px));
      margin: auto 0;
      width: 100%;
      outline: none;
    }
  `.withBehaviors(appearanceBehavior("outline",inputOutlineStyles(0,0,LL,FL)),appearanceBehavior("filled",inputFilledStyles(0,0,LL,FL)),vM(inputForcedColorStyles(0,0,LL,FL))),indicator:'\n    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>\n    </svg>\n  '}),HL=Dialog.compose({baseName:"dialog",template:(t,o)=>html`
    <div class="positioning-region" part="positioning-region">
        ${when((t=>t.modal),html`
                <div
                    class="overlay"
                    part="overlay"
                    role="presentation"
                    @click="${t=>t.dismiss()}"
                ></div>
            `)}
        <div
            role="dialog"
            tabindex="-1"
            class="control"
            part="control"
            aria-modal="${t=>t.modal}"
            aria-describedby="${t=>t.ariaDescribedby}"
            aria-labelledby="${t=>t.ariaLabelledby}"
            aria-label="${t=>t.ariaLabel}"
            ${ref("dialog")}
        >
            <slot></slot>
        </div>
    </div>
`,styles:(t,o)=>css`
  :host([hidden]) {
    display: none;
  }

  :host {
    --dialog-height: 480px;
    --dialog-width: 640px;
    display: block;
  }

  .overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.3);
    touch-action: none;
  }

  .positioning-region {
    display: flex;
    justify-content: center;
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    overflow: auto;
  }

  .control {
    box-shadow: ${bL};
    margin-top: auto;
    margin-bottom: auto;
    border-radius: calc(${UM} * 1px);
    width: var(--dialog-width);
    height: var(--dialog-height);
    background: ${IN};
    z-index: 1;
    border: calc(${qM} * 1px) solid transparent;
  }
`}),UL=Divider.compose({baseName:"divider",template:(t,o)=>html`
    <template role="${t=>t.role}" aria-orientation="${t=>t.orientation}"></template>
`,styles:(t,o)=>css`
    ${display("block")} :host {
      box-sizing: content-box;
      height: 0;
      border: none;
      border-top: calc(${qM} * 1px) solid ${FD};
    }

    :host([orientation="vertical"]) {
      border: none;
      height: 100%;
      margin: 0 calc(${BM} * 1px);
      border-left: calc(${qM} * 1px) solid ${FD};
  }
  `});const qL=class Listbox extends Listbox$1{}.compose({baseName:"listbox",template:(t,o)=>html`
    <template
        aria-activedescendant="${t=>t.ariaActiveDescendant}"
        aria-multiselectable="${t=>t.ariaMultiSelectable}"
        class="listbox"
        role="listbox"
        tabindex="${t=>t.disabled?null:"0"}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusin="${(t,o)=>t.focusinHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        @mousedown="${(t,o)=>t.mousedownHandler(o.event)}"
    >
        <slot
            ${slotted({filter:ListboxElement.slottedOptionFilter,flatten:!0,property:"slottedOptions"})}
        ></slot>
    </template>
`,styles:(t,o)=>css`
    ${display("inline-flex")} :host {
      border: calc(${qM} * 1px) solid ${PD};
      border-radius: calc(${HM} * 1px);
      box-sizing: border-box;
      flex-direction: column;
      padding: calc(${BM} * 1px) 0;
    }

    ::slotted(${t.tagFor(ListboxOption)}) {
      margin: 0 calc(${BM} * 1px);
    }

    :host(:focus-within:not([disabled])) {
      ${iL}
    }
  `}),jL=ListboxOption.compose({baseName:"option",template:(t,o)=>html`
    <template
        aria-checked="${t=>t.ariaChecked}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-posinset="${t=>t.ariaPosInSet}"
        aria-selected="${t=>t.ariaSelected}"
        aria-setsize="${t=>t.ariaSetSize}"
        class="${t=>[t.checked&&"checked",t.selected&&"selected",t.disabled&&"disabled"].filter(Boolean).join(" ")}"
        role="option"
    >
        ${startSlotTemplate(0,o)}
        <span class="content" part="content">
            <slot ${slotted("content")}></slot>
        </span>
        ${endSlotTemplate(0,o)}
    </template>
`,styles:(t,o)=>css`
    ${display("inline-flex")} :host {
      position: relative;
      ${nL}
      background: ${yD};
      border-radius: calc(${HM} * 1px);
      border: calc(${qM} * 1px) solid transparent;
      box-sizing: border-box;
      color: ${xD};
      cursor: pointer;
      fill: currentcolor;
      height: calc(${aL} * 1px);
      overflow: hidden;
      align-items: center;
      padding: 0 calc(((${BM} * 3) - ${qM} - 1) * 1px);
      user-select: none;
      white-space: nowrap;
    }

    :host::before {
      content: '';
      display: block;
      position: absolute;
      left: calc((${jM} - ${qM}) * 1px);
      top: calc((${aL} / 4) - ${jM} * 1px);
      width: 3px;
      height: calc((${aL} / 2) * 1px);
      background: transparent;
      border-radius: calc(${HM} * 1px);
    }

    :host(:not([disabled]):hover) {
      background: ${bD};
    }

    :host(:not([disabled]):active) {
      background: ${wD};
    }

    :host(:not([disabled]):active)::before {
      background: ${$N};
      height: calc(((${aL} / 2) - 6) * 1px);
    }

    :host([aria-selected='true'])::before {
      background: ${$N};
    }

    :host(:${yM}) {
      ${iL}
      background: ${CD};
    }

    :host([aria-selected='true']) {
      background: ${pD};
    }

    :host(:not([disabled])[aria-selected='true']:hover) {
      background: ${fD};
    }

    :host(:not([disabled])[aria-selected='true']:active) {
      background: ${gD};
    }

    :host(:not([disabled]):not([aria-selected='true']):hover) {
      background: ${bD};
    }

    :host(:not([disabled]):not([aria-selected='true']):active) {
      background: ${wD};
    }

    :host([disabled]) {
      cursor: ${mM};
      opacity: ${DM};
    }

    .content {
      grid-column-start: 2;
      justify-self: start;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .start,
    .end,
    ::slotted(svg) {
      display: flex;
    }

    ::slotted([slot='end']) {
      margin-inline-start: 1ch;
    }

    ::slotted([slot='start']) {
      margin-inline-end: 1ch;
    }
  `.withBehaviors(new DirectionalStyleSheetBehavior(null,css`
      :host::before {
        right: calc((${jM} - ${qM}) * 1px);
      }
    `),vM(css`
        :host {
          background: ${o$.ButtonFace};
          border-color: ${o$.ButtonFace};
          color: ${o$.ButtonText};
        }
        :host(:not([disabled]):not([aria-selected="true"]):hover),
        :host(:not([disabled])[aria-selected="true"]:hover),
        :host([aria-selected="true"]) {
          forced-color-adjust: none;
          background: ${o$.Highlight};
          color: ${o$.HighlightText};
        }
        :host(:not([disabled]):active)::before,
        :host([aria-selected='true'])::before {
          background: ${o$.HighlightText};
        }
        :host([disabled]),
        :host([disabled]:not([aria-selected='true']):hover) {
          background: ${o$.Canvas};
          color: ${o$.GrayText};
          fill: currentcolor;
          opacity: 1;
        }
        :host(:${yM}) {
          outline-color: ${o$.CanvasText};
        }
      `))});const zL=class Menu extends Menu$1{connectedCallback(){super.connectedCallback(),IN.setValueFor(this,kN)}}.compose({baseName:"menu",baseClass:Menu$1,template:(t,o)=>html`
    <template
        slot="${t=>t.slot?t.slot:t.isNestedMenu()?"submenu":void 0}"
        role="menu"
        @keydown="${(t,o)=>t.handleMenuKeyDown(o.event)}"
        @focusout="${(t,o)=>t.handleFocusOut(o.event)}"
    >
        <slot ${slotted("items")}></slot>
    </template>
`,styles:(t,o)=>css`
    ${display("block")} :host {
      background: ${kN};
      border: calc(${qM} * 1px) solid transparent;
      border-radius: calc(${UM} * 1px);
      box-shadow: ${mL};
      padding: calc((${BM} - ${qM}) * 1px) 0;
      max-width: 368px;
      min-width: 64px;
    }

    :host([slot='submenu']) {
      width: max-content;
      margin: 0 calc(${BM} * 2px);
    }

    ::slotted(${t.tagFor(MenuItem)}) {
      margin: 0 calc(${BM} * 1px);
    }

    ::slotted(${t.tagFor(Divider)}) {
      margin: calc(${BM} * 1px) 0;
    }

    ::slotted(hr) {
      box-sizing: content-box;
      height: 0;
      margin: calc(${BM} * 1px) 0;
      border: none;
      border-top: calc(${qM} * 1px) solid ${FD};
    }
  `.withBehaviors(vM(css`
        :host([slot='submenu']) {
          background: ${o$.Canvas};
          border-color: ${o$.CanvasText};
        }
      `))}),VL=MenuItem.compose({baseName:"menu-item",template:(t,o)=>html`
    <template
        role="${t=>t.role}"
        aria-haspopup="${t=>t.hasSubmenu?"menu":void 0}"
        aria-checked="${t=>t.role!==Y$?t.checked:void 0}"
        aria-disabled="${t=>t.disabled}"
        aria-expanded="${t=>t.expanded}"
        @keydown="${(t,o)=>t.handleMenuItemKeyDown(o.event)}"
        @click="${(t,o)=>t.handleMenuItemClick(o.event)}"
        @mouseover="${(t,o)=>t.handleMouseOver(o.event)}"
        @mouseout="${(t,o)=>t.handleMouseOut(o.event)}"
        class="${t=>t.disabled?"disabled":""} ${t=>t.expanded?"expanded":""} ${t=>`indent-${t.startColumnCount}`}"
    >
            ${when((t=>t.role===Z$),html`
                    <div part="input-container" class="input-container">
                        <span part="checkbox" class="checkbox">
                            <slot name="checkbox-indicator">
                                ${o.checkboxIndicator||""}
                            </slot>
                        </span>
                    </div>
                `)}
            ${when((t=>t.role===J$),html`
                    <div part="input-container" class="input-container">
                        <span part="radio" class="radio">
                            <slot name="radio-indicator">
                                ${o.radioIndicator||""}
                            </slot>
                        </span>
                    </div>
                `)}
        </div>
        ${startSlotTemplate(0,o)}
        <span class="content" part="content">
            <slot></slot>
        </span>
        ${endSlotTemplate(0,o)}
        ${when((t=>t.hasSubmenu),html`
                <div
                    part="expand-collapse-glyph-container"
                    class="expand-collapse-glyph-container"
                >
                    <span part="expand-collapse" class="expand-collapse">
                        <slot name="expand-collapse-indicator">
                            ${o.expandCollapseGlyph||""}
                        </slot>
                    </span>
                </div>
            `)}
        ${when((t=>t.expanded),html`
                <${t.tagFor(AnchoredRegion)}
                    :anchorElement="${t=>t}"
                    vertical-positioning-mode="dynamic"
                    vertical-default-position="bottom"
                    vertical-inset="true"
                    horizontal-positioning-mode="dynamic"
                    horizontal-default-position="end"
                    class="submenu-region"
                    dir="${t=>t.currentDirection}"
                    @loaded="${t=>t.submenuLoaded()}"
                    ${ref("submenuRegion")}
                    part="submenu-region"
                >
                    <slot name="submenu"></slot>
                </${t.tagFor(AnchoredRegion)}>
            `)}
    </template>
`,styles:(t,o)=>css`
    ${display("grid")} :host {
      contain: layout;
      overflow: visible;
      ${nL}
      box-sizing: border-box;
      height: calc(${aL} * 1px);
      grid-template-columns: minmax(32px, auto) 1fr minmax(32px, auto);
      grid-template-rows: auto;
      justify-items: center;
      align-items: center;
      padding: 0;
      white-space: nowrap;
      color: ${xD};
      fill: currentcolor;
      cursor: pointer;
      border-radius: calc(${HM} * 1px);
      border: calc(${qM} * 1px) solid transparent;
      position: relative;
    }

    :host(.indent-0) {
      grid-template-columns: auto 1fr minmax(32px, auto);
    }

    :host(.indent-0) .content {
      grid-column: 1;
      grid-row: 1;
      margin-inline-start: 10px;
    }

    :host(.indent-0) .expand-collapse-glyph-container {
      grid-column: 5;
      grid-row: 1;
    }

    :host(.indent-2) {
      grid-template-columns: minmax(32px, auto) minmax(32px, auto) 1fr minmax(32px, auto) minmax(32px, auto);
    }

    :host(.indent-2) .content {
      grid-column: 3;
      grid-row: 1;
      margin-inline-start: 10px;
    }

    :host(.indent-2) .expand-collapse-glyph-container {
      grid-column: 5;
      grid-row: 1;
    }

    :host(.indent-2) .start {
      grid-column: 2;
    }

    :host(.indent-2) .end {
      grid-column: 4;
    }

    :host(:${yM}) {
      ${iL}
    }

    :host(:not([disabled]):hover) {
      background: ${bD};
    }

    :host(:not([disabled]):active),
    :host(.expanded) {
      background: ${wD};
      color: ${xD};
      z-index: 2;
    }

    :host([disabled]) {
      cursor: ${mM};
      opacity: ${DM};
    }

    .content {
      grid-column-start: 2;
      justify-self: start;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .start,
    .end {
      display: flex;
      justify-content: center;
    }

    :host(.indent-0[aria-haspopup='menu']) {
      display: grid;
      grid-template-columns: minmax(32px, auto) auto 1fr minmax(32px, auto) minmax(32px, auto);
      align-items: center;
      min-height: 32px;
    }

    :host(.indent-1[aria-haspopup='menu']),
    :host(.indent-1[role='menuitemcheckbox']),
    :host(.indent-1[role='menuitemradio']) {
      display: grid;
      grid-template-columns: minmax(32px, auto) auto 1fr minmax(32px, auto) minmax(32px, auto);
      align-items: center;
      min-height: 32px;
    }

    :host(.indent-2:not([aria-haspopup='menu'])) .end {
      grid-column: 5;
    }

    :host .input-container,
    :host .expand-collapse-glyph-container {
      display: none;
    }

    :host([aria-haspopup='menu']) .expand-collapse-glyph-container,
    :host([role='menuitemcheckbox']) .input-container,
    :host([role='menuitemradio']) .input-container {
      display: grid;
    }

    :host([aria-haspopup='menu']) .content,
    :host([role='menuitemcheckbox']) .content,
    :host([role='menuitemradio']) .content {
      grid-column-start: 3;
    }

    :host([aria-haspopup='menu'].indent-0) .content {
      grid-column-start: 1;
    }

    :host([aria-haspopup='menu']) .end,
    :host([role='menuitemcheckbox']) .end,
    :host([role='menuitemradio']) .end {
      grid-column-start: 4;
    }

    :host .expand-collapse,
    :host .checkbox,
    :host .radio {
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      box-sizing: border-box;
    }

    :host .checkbox-indicator,
    :host .radio-indicator,
    slot[name='checkbox-indicator'],
    slot[name='radio-indicator'] {
      display: none;
    }

    ::slotted([slot='end']:not(svg)) {
      margin-inline-end: 10px;
      color: ${AD};
    }

    :host([aria-checked='true']) .checkbox-indicator,
    :host([aria-checked='true']) slot[name='checkbox-indicator'],
    :host([aria-checked='true']) .radio-indicator,
    :host([aria-checked='true']) slot[name='radio-indicator'] {
      display: flex;
    }
  `.withBehaviors(vM(css`
        :host,
        ::slotted([slot='end']:not(svg)) {
          forced-color-adjust: none;
          color: ${o$.ButtonText};
          fill: currentcolor;
        }
        :host(:not([disabled]):hover) {
          background: ${o$.Highlight};
          color: ${o$.HighlightText};
          fill: currentcolor;
        }
        :host(:hover) .start,
        :host(:hover) .end,
        :host(:hover)::slotted(svg),
        :host(:active) .start,
        :host(:active) .end,
        :host(:active)::slotted(svg),
        :host(:hover) ::slotted([slot='end']:not(svg)),
        :host(:${yM}) ::slotted([slot='end']:not(svg)) {
          color: ${o$.HighlightText};
          fill: currentcolor;
        }
        :host(.expanded) {
          background: ${o$.Highlight};
          color: ${o$.HighlightText};
        }
        :host(:${yM}) {
          background: ${o$.Highlight};
          outline-color: ${o$.ButtonText};
          color: ${o$.HighlightText};
          fill: currentcolor;
        }
        :host([disabled]),
        :host([disabled]:hover),
        :host([disabled]:hover) .start,
        :host([disabled]:hover) .end,
        :host([disabled]:hover)::slotted(svg),
        :host([disabled]:${yM}) {
          background: ${o$.ButtonFace};
          color: ${o$.GrayText};
          fill: currentcolor;
          opacity: 1;
        }
        :host([disabled]:${yM}) {
          outline-color: ${o$.GrayText};
        }
        :host .expanded-toggle,
        :host .checkbox,
        :host .radio {
          border-color: ${o$.ButtonText};
          background: ${o$.HighlightText};
        }
        :host([checked]) .checkbox,
        :host([checked]) .radio {
          background: ${o$.HighlightText};
          border-color: ${o$.HighlightText};
        }
        :host(:hover) .expanded-toggle,
            :host(:hover) .checkbox,
            :host(:hover) .radio,
            :host(:${yM}) .expanded-toggle,
            :host(:${yM}) .checkbox,
            :host(:${yM}) .radio,
            :host([checked]:hover) .checkbox,
            :host([checked]:hover) .radio,
            :host([checked]:${yM}) .checkbox,
            :host([checked]:${yM}) .radio {
          border-color: ${o$.HighlightText};
        }
        :host([aria-checked='true']) {
          background: ${o$.Highlight};
          color: ${o$.HighlightText};
        }
        :host([aria-checked='true']) .checkbox-indicator,
        :host([aria-checked='true']) ::slotted([slot='checkbox-indicator']),
        :host([aria-checked='true']) ::slotted([slot='radio-indicator']) {
          fill: ${o$.Highlight};
        }
        :host([aria-checked='true']) .radio-indicator {
          background: ${o$.Highlight};
        }
      `),new DirectionalStyleSheetBehavior(css`
        .expand-collapse-glyph-container {
          transform: rotate(0deg);
        }
      `,css`
        .expand-collapse-glyph-container {
          transform: rotate(180deg);
        }
      `)),checkboxIndicator:'\n    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n      <path d="M13.86 3.66a.5.5 0 01-.02.7l-7.93 7.48a.6.6 0 01-.84-.02L2.4 9.1a.5.5 0 01.72-.7l2.4 2.44 7.65-7.2a.5.5 0 01.7.02z"/>\n    </svg>\n  ',expandCollapseGlyph:'\n    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n      <path d="M5.65 3.15a.5.5 0 000 .7L9.79 8l-4.14 4.15a.5.5 0 00.7.7l4.5-4.5a.5.5 0 000-.7l-4.5-4.5a.5.5 0 00-.7 0z"/>\n    </svg>\n  ',radioIndicator:'\n    <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n      <circle cx="8" cy="8" r="2"/>\n    </svg>\n  '});const GL=class Progress extends BaseProgress{}.compose({baseName:"progress",template:(t,o)=>html`
    <template
        role="progressbar"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        class="${t=>t.paused?"paused":""}"
    >
        ${when((t=>"number"==typeof t.value),html`
                <div class="progress" part="progress" slot="determinate">
                    <div
                        class="determinate"
                        part="determinate"
                        style="width: ${t=>t.percentComplete}%"
                    ></div>
                </div>
            `,html`
                <div class="progress" part="progress" slot="indeterminate">
                    <slot class="indeterminate" name="indeterminate">
                        ${o.indeterminateIndicator1||""}
                        ${o.indeterminateIndicator2||""}
                    </slot>
                </div>
            `)}
    </template>
`,styles:(t,o)=>css`
    ${display("flex")} :host {
      align-items: center;
      height: calc((${qM} * 3) * 1px);
    }

    .progress {
      background-color: ${VD};
      border-radius: calc(${BM} * 1px);
      width: 100%;
      height: calc(${qM} * 1px);
      display: flex;
      align-items: center;
      position: relative;
    }

    .determinate {
      background-color: ${$N};
      border-radius: calc(${BM} * 1px);
      height: calc((${qM} * 3) * 1px);
      transition: all 0.2s ease-in-out;
      display: flex;
    }

    .indeterminate {
      height: calc((${qM} * 3) * 1px);
      border-radius: calc(${BM} * 1px);
      display: flex;
      width: 100%;
      position: relative;
      overflow: hidden;
    }

    .indeterminate-indicator-1 {
      position: absolute;
      opacity: 0;
      height: 100%;
      background-color: ${$N};
      border-radius: calc(${BM} * 1px);
      animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);
      width: 40%;
      animation: indeterminate-1 2s infinite;
    }

    .indeterminate-indicator-2 {
      position: absolute;
      opacity: 0;
      height: 100%;
      background-color: ${$N};
      border-radius: calc(${BM} * 1px);
      animation-timing-function: cubic-bezier(0.4, 0, 0.6, 1);
      width: 60%;
      animation: indeterminate-2 2s infinite;
    }

    :host(.paused) .indeterminate-indicator-1,
    :host(.paused) .indeterminate-indicator-2 {
      animation: none;
      background-color: ${AD};
      width: 100%;
      opacity: 1;
    }

    :host(.paused) .determinate {
      background-color: ${AD};
    }

    @keyframes indeterminate-1 {
      0% {
        opacity: 1;
        transform: translateX(-100%);
      }
      70% {
        opacity: 1;
        transform: translateX(300%);
      }
      70.01% {
        opacity: 0;
      }
      100% {
        opacity: 0;
        transform: translateX(300%);
      }
    }

    @keyframes indeterminate-2 {
      0% {
        opacity: 0;
        transform: translateX(-150%);
      }
      29.99% {
        opacity: 0;
      }
      30% {
        opacity: 1;
        transform: translateX(-150%);
      }
      100% {
        transform: translateX(166.66%);
        opacity: 1;
      }
    }
  `.withBehaviors(vM(css`
        .indeterminate-indicator-1,
        .indeterminate-indicator-2,
        .determinate,
        .progress {
          background-color: ${o$.ButtonText};
        }
        :host(.paused) .indeterminate-indicator-1,
        :host(.paused) .indeterminate-indicator-2,
        :host(.paused) .determinate {
          background-color: ${o$.GrayText};
        }
      `)),indeterminateIndicator1:'\n    <span class="indeterminate-indicator-1" part="indeterminate-indicator-1"></span>\n  ',indeterminateIndicator2:'\n    <span class="indeterminate-indicator-2" part="indeterminate-indicator-2"></span>\n  '});const KL=class ProgressRing extends BaseProgress{}.compose({baseName:"progress-ring",template:(t,o)=>html`
    <template
        role="progressbar"
        aria-valuenow="${t=>t.value}"
        aria-valuemin="${t=>t.min}"
        aria-valuemax="${t=>t.max}"
        class="${t=>t.paused?"paused":""}"
    >
        ${when((t=>"number"==typeof t.value),html`
                <svg
                    class="progress"
                    part="progress"
                    viewBox="0 0 16 16"
                    slot="determinate"
                >
                    <circle
                        class="background"
                        part="background"
                        cx="8px"
                        cy="8px"
                        r="7px"
                    ></circle>
                    <circle
                        class="determinate"
                        part="determinate"
                        style="stroke-dasharray: ${t=>44*t.percentComplete/100}px ${44}px"
                        cx="8px"
                        cy="8px"
                        r="7px"
                    ></circle>
                </svg>
            `,html`
                <slot name="indeterminate" slot="indeterminate">
                    ${o.indeterminateIndicator||""}
                </slot>
            `)}
    </template>
`,styles:(t,o)=>css`
    ${display("flex")} :host {
      align-items: center;
      height: calc(${aL} * 1px);
      width: calc(${aL} * 1px);
    }

    .progress {
      height: 100%;
      width: 100%;
    }

    .background {
      fill: none;
      stroke-width: 2px;
    }

    .determinate {
      stroke: ${$N};
      fill: none;
      stroke-width: 2px;
      stroke-linecap: round;
      transform-origin: 50% 50%;
      transform: rotate(-90deg);
      transition: all 0.2s ease-in-out;
    }

    .indeterminate-indicator-1 {
      stroke: ${$N};
      fill: none;
      stroke-width: 2px;
      stroke-linecap: round;
      transform-origin: 50% 50%;
      transform: rotate(-90deg);
      transition: all 0.2s ease-in-out;
      animation: spin-infinite 2s linear infinite;
    }

    :host(.paused) .indeterminate-indicator-1 {
      animation: none;
      stroke: ${AD};
    }

    :host(.paused) .determinate {
      stroke: ${AD};
    }

    @keyframes spin-infinite {
      0% {
        stroke-dasharray: 0.01px 43.97px;
        transform: rotate(0deg);
      }
      50% {
        stroke-dasharray: 21.99px 21.99px;
        transform: rotate(450deg);
      }
      100% {
        stroke-dasharray: 0.01px 43.97px;
        transform: rotate(1080deg);
      }
    }
  `.withBehaviors(vM(css`
        .background {
          stroke: ${o$.Field};
        }
        .determinate,
        .indeterminate-indicator-1 {
          stroke: ${o$.ButtonText};
        }
        :host(.paused) .determinate,
        :host(.paused) .indeterminate-indicator-1 {
          stroke: ${o$.GrayText};
        }
      `)),indeterminateIndicator:'\n    <svg class="progress" part="progress" viewBox="0 0 16 16">\n        <circle\n            class="background"\n            part="background"\n            cx="8px"\n            cy="8px"\n            r="7px"\n        ></circle>\n        <circle\n            class="indeterminate-indicator-1"\n            part="indeterminate-indicator-1"\n            cx="8px"\n            cy="8px"\n            r="7px"\n        ></circle>\n    </svg>\n  '}),WL=RadioGroup.compose({baseName:"radio-group",template:(t,o)=>html`
    <template
        role="radiogroup"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        @focusout="${(t,o)=>t.focusOutHandler(o.event)}"
    >
        <slot name="label"></slot>
        <div
            class="positioning-region ${t=>t.orientation===NR?"horizontal":"vertical"}"
            part="positioning-region"
        >
            <slot
                ${slotted({property:"slottedRadioButtons",filter:elements("[role=radio]")})}
            ></slot>
        </div>
    </template>
`,styles:(t,o)=>css`
  ${display("flex")} :host {
    align-items: flex-start;
    flex-direction: column;
  }

  .positioning-region {
    display: flex;
    flex-wrap: wrap;
  }

  :host([orientation='vertical']) .positioning-region {
    flex-direction: column;
  }

  :host([orientation='horizontal']) .positioning-region {
    flex-direction: row;
  }
`}),QL=".root",YL=$$.create("clear-button-hover").withDefault((t=>{const o=mD.getValueFor(t),s=tD.getValueFor(t);return o.evaluate(t,s.evaluate(t).focus).hover})),ZL=$$.create("clear-button-active").withDefault((t=>{const o=mD.getValueFor(t),s=tD.getValueFor(t);return o.evaluate(t,s.evaluate(t).focus).active}));class Search extends Search$1{constructor(){super(...arguments),this.appearance="outline"}}__decorate$s([attr],Search.prototype,"appearance",void 0);const JL=Search.compose({baseName:"search",baseClass:Search$1,template:(t,o)=>html`
  <template
    class="
            ${t=>t.readOnly?"readonly":""}
        "
  >
    <label
      part="label"
      for="control"
      class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
    >
      <slot ${slotted({property:"defaultSlottedNodes",filter:whitespaceFilter})}></slot>
    </label>
    <div class="root" part="root" ${ref("root")}>
      ${startSlotTemplate(0,o)}
      <div class="input-wrapper" part="input-wrapper">
        <input
          class="control"
          part="control"
          id="control"
          @input="${t=>t.handleTextInput()}"
          @change="${t=>t.handleChange()}"
          ?autofocus="${t=>t.autofocus}"
          ?disabled="${t=>t.disabled}"
          list="${t=>t.list}"
          maxlength="${t=>t.maxlength}"
          minlength="${t=>t.minlength}"
          pattern="${t=>t.pattern}"
          placeholder="${t=>t.placeholder}"
          ?readonly="${t=>t.readOnly}"
          ?required="${t=>t.required}"
          size="${t=>t.size}"
          ?spellcheck="${t=>t.spellcheck}"
          :value="${t=>t.value}"
          type="search"
          aria-atomic="${t=>t.ariaAtomic}"
          aria-busy="${t=>t.ariaBusy}"
          aria-controls="${t=>t.ariaControls}"
          aria-current="${t=>t.ariaCurrent}"
          aria-describedby="${t=>t.ariaDescribedby}"
          aria-details="${t=>t.ariaDetails}"
          aria-disabled="${t=>t.ariaDisabled}"
          aria-errormessage="${t=>t.ariaErrormessage}"
          aria-flowto="${t=>t.ariaFlowto}"
          aria-haspopup="${t=>t.ariaHaspopup}"
          aria-hidden="${t=>t.ariaHidden}"
          aria-invalid="${t=>t.ariaInvalid}"
          aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
          aria-label="${t=>t.ariaLabel}"
          aria-labelledby="${t=>t.ariaLabelledby}"
          aria-live="${t=>t.ariaLive}"
          aria-owns="${t=>t.ariaOwns}"
          aria-relevant="${t=>t.ariaRelevant}"
          aria-roledescription="${t=>t.ariaRoledescription}"
          ${ref("control")}
        />
        <slot name="clear-button">
          <button
            class="clear-button ${t=>t.value?"":"clear-button__hidden"}"
            part="clear-button"
            tabindex="-1"
            @click=${t=>t.handleClearInput()}
          >
            <slot name="clear-glyph">
              <svg width="12" height="12" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="m2.09 2.22.06-.07a.5.5 0 0 1 .63-.06l.07.06L6 5.29l3.15-3.14a.5.5 0 1 1 .7.7L6.71 6l3.14 3.15c.18.17.2.44.06.63l-.06.07a.5.5 0 0 1-.63.06l-.07-.06L6 6.71 2.85 9.85a.5.5 0 0 1-.7-.7L5.29 6 2.15 2.85a.5.5 0 0 1-.06-.63l.06-.07-.06.07Z"
                />
              </svg>
            </slot>
          </button>
        </slot>
      </div>
      ${endSlotTemplate(0,o)}
    </div>
  </template>
`,styles:(t,o)=>css`
    ${display("inline-block")}

    ${baseInputStyles(0,0,QL)}

    ${inputStateStyles()}

    .root {
      display: flex;
      flex-direction: row;
    }
    .control {
      -webkit-appearance: none;
      color: inherit;
      background: transparent;
      border: 0;
      height: calc(100% - 4px);
      margin-top: auto;
      margin-bottom: auto;
      padding: 0 calc(${BM} * 2px + 1px);
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
    }
    .clear-button {
      display: inline-flex;
      align-items: center;
      margin: 1px;
      height: calc(100% - 2px);
      opacity: 0;
      background: transparent;
      color: ${xD};
      fill: currentcolor;
      border: none;
      border-radius: calc(${HM} * 1px);
      min-width: calc(${aL} * 1px);
      ${nL}
      outline: none;
      padding: 0 calc((10 + (${BM} * 2 * ${FM})) * 1px);
    }
    .clear-button:hover {
      background: ${YL};
    }
    .clear-button:active {
      background: ${ZL};
    }
    :host(:hover:not([disabled], [readOnly])) .clear-button,
    :host(:active:not([disabled], [readOnly])) .clear-button,
    :host(:focus-within:not([disabled], [readOnly])) .clear-button {
        opacity: 1;
    }
    :host(:hover:not([disabled], [readOnly])) .clear-button__hidden,
    :host(:active:not([disabled], [readOnly])) .clear-button__hidden,
    :host(:focus-within:not([disabled], [readOnly])) .clear-button__hidden {
        opacity: 0;
    }
    .control::-webkit-search-cancel-button {
      -webkit-appearance: none;
    }
    .input-wrapper {
      display: flex;
      position: relative;
      width: 100%;
    }
    .start,
    .end {
      display: flex;
      margin: 1px;
      align-items: center;
    }
    .start {
      display: flex;
      margin-inline-start: 11px;
    }
    ::slotted([slot="end"]) {
      height: 100%
    }
    .clear-button__hidden {
      opacity: 0;
    }
    .end {
        margin-inline-end: 11px;
    }
    ::slotted(${t.tagFor(Button$1)}) {
      margin-inline-end: 1px;
    }
  `.withBehaviors(appearanceBehavior("outline",inputOutlineStyles(0,0,QL)),appearanceBehavior("filled",inputFilledStyles(0,0,QL)),vM(inputForcedColorStyles(0,0,QL))),start:'<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg%22%3E"><path d="M8.5 3a5.5 5.5 0 0 1 4.23 9.02l4.12 4.13a.5.5 0 0 1-.63.76l-.07-.06-4.13-4.12A5.5 5.5 0 1 1 8.5 3Zm0 1a4.5 4.5 0 1 0 0 9 4.5 4.5 0 0 0 0-9Z"/></svg>',shadowOptions:{delegatesFocus:!0}});class Select extends Select$1{appearanceChanged(t,o){t!==o&&(this.classList.add(o),this.classList.remove(t))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline"),this.listbox&&IN.setValueFor(this.listbox,kN)}}__decorate$s([attr({mode:"fromView"})],Select.prototype,"appearance",void 0);const XL=Select.compose({baseName:"select",baseClass:Select$1,template:(t,o)=>html`
    <template
        class="${t=>[t.collapsible&&"collapsible",t.collapsible&&t.open&&"open",t.disabled&&"disabled",t.collapsible&&t.position].filter(Boolean).join(" ")}"
        aria-activedescendant="${t=>t.ariaActiveDescendant}"
        aria-controls="${t=>t.ariaControls}"
        aria-disabled="${t=>t.ariaDisabled}"
        aria-expanded="${t=>t.ariaExpanded}"
        aria-haspopup="${t=>t.collapsible?"listbox":null}"
        aria-multiselectable="${t=>t.ariaMultiSelectable}"
        ?open="${t=>t.open}"
        role="combobox"
        tabindex="${t=>t.disabled?null:"0"}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        @focusin="${(t,o)=>t.focusinHandler(o.event)}"
        @focusout="${(t,o)=>t.focusoutHandler(o.event)}"
        @keydown="${(t,o)=>t.keydownHandler(o.event)}"
        @mousedown="${(t,o)=>t.mousedownHandler(o.event)}"
    >
        ${when((t=>t.collapsible),html`
                <div
                    class="control"
                    part="control"
                    ?disabled="${t=>t.disabled}"
                    ${ref("control")}
                >
                    ${startSlotTemplate(0,o)}
                    <slot name="button-container">
                        <div class="selected-value" part="selected-value">
                            <slot name="selected-value">${t=>t.displayValue}</slot>
                        </div>
                        <div aria-hidden="true" class="indicator" part="indicator">
                            <slot name="indicator">
                                ${o.indicator||""}
                            </slot>
                        </div>
                    </slot>
                    ${endSlotTemplate(0,o)}
                </div>
            `)}
        <div
            class="listbox"
            id="${t=>t.listboxId}"
            part="listbox"
            role="listbox"
            ?disabled="${t=>t.disabled}"
            ?hidden="${t=>!!t.collapsible&&!t.open}"
            ${ref("listbox")}
        >
            <slot
                ${slotted({filter:Listbox$1.slottedOptionFilter,flatten:!0,property:"slottedOptions"})}
            ></slot>
        </div>
    </template>
`,styles:(t,o)=>baseSelectStyles().withBehaviors(appearanceBehavior("outline",NeutralButtonStyles(0,0,NL,DL)),appearanceBehavior("filled",inputFilledStyles(0,0,OL,NL).withBehaviors(vM(inputForcedColorStyles(0,0,OL,NL)))),appearanceBehavior("stealth",StealthButtonStyles(0,0,NL,DL)),vM(css`
    :host([open]) .listbox {
      background: ${o$.ButtonFace};
      border-color: ${o$.CanvasText};
    }
  `)),indicator:'\n    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n      <path d="M2.15 4.65c.2-.2.5-.2.7 0L6 7.79l3.15-3.14a.5.5 0 11.7.7l-3.5 3.5a.5.5 0 01-.7 0l-3.5-3.5a.5.5 0 010-.7z"/>\n    </svg>\n  '}),eF=Skeleton.compose({baseName:"skeleton",template:(t,o)=>html`
    <template
        class="${t=>"circle"===t.shape?"circle":"rect"}"
        pattern="${t=>t.pattern}"
        ?shimmer="${t=>t.shimmer}"
    >
        ${when((t=>!0===t.shimmer),html`
                <span class="shimmer"></span>
            `)}
        <object type="image/svg+xml" data="${t=>t.pattern}" role="presentation">
            <img class="pattern" src="${t=>t.pattern}" />
        </object>
        <slot></slot>
    </template>
`,styles:(t,o)=>css`
    ${display("block")} :host {
      --skeleton-fill-default: ${pD};
      overflow: hidden;
      width: 100%;
      position: relative;
      background-color: var(--skeleton-fill, var(--skeleton-fill-default));
      --skeleton-animation-gradient-default: linear-gradient(
        270deg,
        var(--skeleton-fill, var(--skeleton-fill-default)) 0%,
        ${fD} 51%,
        var(--skeleton-fill, var(--skeleton-fill-default)) 100%
      );
      --skeleton-animation-timing-default: ease-in-out;
    }

    :host(.rect) {
      border-radius: calc(${HM} * 1px);
    }

    :host(.circle) {
      border-radius: 100%;
      overflow: hidden;
    }

    object {
      position: absolute;
      width: 100%;
      height: auto;
      z-index: 2;
    }

    object img {
      width: 100%;
      height: auto;
    }

    ${display("block")} span.shimmer {
      position: absolute;
      width: 100%;
      height: 100%;
      background-image: var(--skeleton-animation-gradient, var(--skeleton-animation-gradient-default));
      background-size: 0px 0px / 90% 100%;
      background-repeat: no-repeat;
      background-color: var(--skeleton-animation-fill, ${pD});
      animation: shimmer 2s infinite;
      animation-timing-function: var(--skeleton-animation-timing, var(--skeleton-timing-default));
      animation-direction: normal;
      z-index: 1;
    }

    ::slotted(svg) {
      z-index: 2;
    }

    ::slotted(.pattern) {
      width: 100%;
      height: 100%;
    }

    @keyframes shimmer {
      0% {
        transform: translateX(-100%);
      }
      100% {
        transform: translateX(100%);
      }
    }
  `.withBehaviors(vM(css`
        :host{
          background-color: ${o$.CanvasText};
        }
      `))}),tF=Switch.compose({baseName:"switch",template:(t,o)=>html`
    <template
        role="switch"
        aria-checked="${t=>t.checked}"
        aria-disabled="${t=>t.disabled}"
        aria-readonly="${t=>t.readOnly}"
        tabindex="${t=>t.disabled?null:0}"
        @keypress="${(t,o)=>t.keypressHandler(o.event)}"
        @click="${(t,o)=>t.clickHandler(o.event)}"
        class="${t=>t.checked?"checked":""}"
    >
        <label
            part="label"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot ${slotted("defaultSlottedNodes")}></slot>
        </label>
        <div part="switch" class="switch">
            <slot name="switch">${o.switch||""}</slot>
        </div>
        <span class="status-message" part="status-message">
            <span class="checked-message" part="checked-message">
                <slot name="checked-message"></slot>
            </span>
            <span class="unchecked-message" part="unchecked-message">
                <slot name="unchecked-message"></slot>
            </span>
        </span>
    </template>
`,styles:(t,o)=>css`
    :host([hidden]) {
      display: none;
    }

    ${display("inline-flex")} :host {
      align-items: center;
      outline: none;
      font-family: ${zM};
      ${""} user-select: none;
    }

    :host(.disabled) {
      opacity: ${DM};
    }

    :host(.disabled) .label,
    :host(.readonly) .label,
    :host(.disabled) .switch,
    :host(.readonly) .switch,
    :host(.disabled) .status-message,
    :host(.readonly) .status-message {
      cursor: ${mM};
    }

    .switch {
      position: relative;
      box-sizing: border-box;
      width: calc(((${aL} / 2) + ${BM}) * 2px);
      height: calc(((${aL} / 2) + ${BM}) * 1px);
      background: ${sD};
      border-radius: calc(${aL} * 1px);
      border: calc(${qM} * 1px) solid ${VD};
      cursor: pointer;
    }

    :host(:not(.disabled):hover) .switch {
      background: ${aD};
      border-color: ${GD};
    }

    :host(:not(.disabled):active) .switch {
      background: ${lD};
      border-color: ${KD};
    }

    :host(:${yM}) .switch {
      ${sL}
      background: ${cD};
    }

    :host(.checked) .switch {
      background: ${$N};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):hover) .switch {
      background: ${MN};
      border-color: transparent;
    }

    :host(.checked:not(.disabled):active) .switch {
      background: ${ON};
      border-color: transparent;
    }

    slot[name='switch'] {
      position: absolute;
      display: flex;
      border: 1px solid transparent; /* Spacing included in the transform reference box */
      fill: ${xD};
      transition: all 0.2s ease-in-out;
    }

    .status-message {
      color: ${xD};
      cursor: pointer;
      ${nL}
    }

    .label__hidden {
      display: none;
      visibility: hidden;
    }

    .label {
      color: ${xD};
      ${nL}
      margin-inline-end: calc(${BM} * 2px + 2px);
      cursor: pointer;
    }

    ::slotted([slot="checked-message"]),
    ::slotted([slot="unchecked-message"]) {
        margin-inline-start: calc(${BM} * 2px + 2px);
    }

    :host(.checked) .switch {
      background: ${$N};
    }

    :host(.checked) .switch slot[name='switch'] {
      fill: ${LN};
      filter: drop-shadow(0px 1px 1px rgba(0, 0, 0, 0.15));
    }

    :host(.checked:not(.disabled)) .switch:hover {
      background: ${MN};
    }

    :host(.checked:not(.disabled)) .switch:hover slot[name='switch'] {
      fill: ${FN};
    }

    :host(.checked:not(.disabled)) .switch:active {
      background: ${ON};
    }

    :host(.checked:not(.disabled)) .switch:active slot[name='switch'] {
      fill: ${BN};
    }

    .unchecked-message {
      display: block;
    }

    .checked-message {
      display: none;
    }

    :host(.checked) .unchecked-message {
      display: none;
    }

    :host(.checked) .checked-message {
      display: block;
    }
  `.withBehaviors(new DirectionalStyleSheetBehavior(css`
        slot[name='switch'] {
          left: 0;
        }

        :host(.checked) slot[name='switch'] {
          left: 100%;
          transform: translateX(-100%);
        }
      `,css`
        slot[name='switch'] {
          right: 0;
        }

        :host(.checked) slot[name='switch'] {
          right: 100%;
          transform: translateX(100%);
        }
      `),vM(css`
        :host(:not(.disabled)) .switch slot[name='switch'] {
          forced-color-adjust: none;
          fill: ${o$.FieldText};
        }
        .switch {
          background: ${o$.Field};
          border-color: ${o$.FieldText};
        }
        :host(.checked) .switch {
          background: ${o$.Highlight};
          border-color: ${o$.Highlight};
        }
        :host(:not(.disabled):hover) .switch ,
        :host(:not(.disabled):active) .switch,
        :host(.checked:not(.disabled):hover) .switch {
          background: ${o$.HighlightText};
          border-color: ${o$.Highlight};
        }
        :host(.checked:not(.disabled)) .switch slot[name="switch"] {
          fill: ${o$.HighlightText};
        }
        :host(.checked:not(.disabled):hover) .switch slot[name='switch'] {
          fill: ${o$.Highlight};
        }
        :host(:${yM}) .switch {
          forced-color-adjust: none;
          background: ${o$.Field}; 
          border-color: ${o$.Highlight};
          outline-color: ${o$.FieldText};
        }
        :host(.disabled) {
          opacity: 1;
        }
        :host(.disabled) slot[name='switch'] {
          forced-color-adjust: none;
          fill: ${o$.GrayText};
        }
        :host(.disabled) .switch {
          background: ${o$.Field};
          border-color: ${o$.GrayText};
        }
        .status-message,
        .label {
          color: ${o$.FieldText};
        }
      `)),switch:'\n    <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n      <rect x="2" y="2" width="12" height="12" rx="6"/>\n    </svg>\n  '}),rF=Tab.compose({baseName:"tab",template:(t,o)=>html`
    <template slot="tab" role="tab" aria-disabled="${t=>t.disabled}">
        <slot></slot>
    </template>
`,styles:(t,o)=>css`
      ${display("inline-flex")} :host {
        box-sizing: border-box;
        ${nL}
        height: calc((${aL} + (${BM} * 2)) * 1px);
        padding: 0 calc((6 + (${BM} * 2 * ${FM})) * 1px);
        color: ${xD};
        border-radius: calc(${HM} * 1px);
        border: calc(${qM} * 1px) solid transparent;
        align-items: center;
        justify-content: center;
        grid-row: 1 / 3;
        cursor: pointer;
      }

      :host([aria-selected='true']) {
        z-index: 2;
      }

      :host(:hover),
      :host(:active) {
        color: ${xD};
      }

      :host(:${yM}) {
        ${iL}
      }

      :host(.vertical) {
        justify-content: start;
        grid-column: 1 / 3;
      }

      :host(.vertical[aria-selected='true']) {
        z-index: 2;
      }

      :host(.vertical:hover),
      :host(.vertical:active) {
        color: ${xD};
      }

      :host(.vertical:hover[aria-selected='true']) {
      }
    `.withBehaviors(vM(css`
          :host {
            forced-color-adjust: none;
            border-color: transparent;
            color: ${o$.ButtonText};
            fill: currentcolor;
          }
          :host(:hover),
          :host(.vertical:hover),
          :host([aria-selected='true']:hover) {
            background: transparent;
            color: ${o$.Highlight};
            fill: currentcolor;
          }
          :host([aria-selected='true']) {
            background: transparent;
            color: ${o$.Highlight};
            fill: currentcolor;
          }
          :host(:${yM}) {
            background: transparent;
            outline-color: ${o$.ButtonText};
          }
        `))}),oF=class TabPanel extends FoundationElement{}.compose({baseName:"tab-panel",template:(t,o)=>html`
    <template slot="tabpanel" role="tabpanel">
        <slot></slot>
    </template>
`,styles:(t,o)=>css`
  ${display("block")} :host {
    box-sizing: border-box;
    ${nL}
    padding: 0 calc((6 + (${BM} * 2 * ${FM})) * 1px);
  }
`}),nF=Tabs.compose({baseName:"tabs",template:(t,o)=>html`
    <template class="${t=>t.orientation}">
        ${startSlotTemplate(0,o)}
        <div class="tablist" part="tablist" role="tablist">
            <slot class="tab" name="tab" part="tab" ${slotted("tabs")}></slot>

            ${when((t=>t.showActiveIndicator),html`
                    <div
                        ${ref("activeIndicatorRef")}
                        class="activeIndicator"
                        part="activeIndicator"
                    ></div>
                `)}
        </div>
        ${endSlotTemplate(0,o)}
        <div class="tabpanel" part="tabpanel">
            <slot name="tabpanel" ${slotted("tabpanels")}></slot>
        </div>
    </template>
`,styles:(t,o)=>css`
      ${display("grid")} :host {
        box-sizing: border-box;
        ${nL}
        color: ${xD};
        grid-template-columns: auto 1fr auto;
        grid-template-rows: auto 1fr;
      }

      .tablist {
        display: grid;
        grid-template-rows: calc(${aL} * 1px); auto;
        grid-template-columns: auto;
        position: relative;
        width: max-content;
        align-self: end;
      }

      .start,
      .end {
        align-self: center;
      }

      .activeIndicator {
        grid-row: 2;
        grid-column: 1;
        width: 20px;
        height: 3px;
        border-radius: calc(${HM} * 1px);
        justify-self: center;
        background: ${$N};
      }

      .activeIndicatorTransition {
        transition: transform 0.2s ease-in-out;
      }

      .tabpanel {
        grid-row: 2;
        grid-column-start: 1;
        grid-column-end: 4;
        position: relative;
      }

      :host(.vertical) {
        grid-template-rows: auto 1fr auto;
        grid-template-columns: auto 1fr;
      }

      :host(.vertical) .tablist {
        grid-row-start: 2;
        grid-row-end: 2;
        display: grid;
        grid-template-rows: auto;
        grid-template-columns: auto 1fr;
        position: relative;
        width: max-content;
        justify-self: end;
        align-self: flex-start;
        width: 100%;
      }

      :host(.vertical) .tabpanel {
        grid-column: 2;
        grid-row-start: 1;
        grid-row-end: 4;
      }

      :host(.vertical) .end {
        grid-row: 3;
      }

      :host(.vertical) .activeIndicator {
        grid-column: 1;
        grid-row: 1;
        width: 3px;
        height: 20px;
        margin-inline-start: calc(${jM} * 1px);
        border-radius: calc(${HM} * 1px);
        align-self: center;
        background: ${$N};
      }

      :host(.vertical) .activeIndicatorTransition {
        transition: transform 0.2s linear;
      }
    `.withBehaviors(vM(css`
        .activeIndicator,
        :host(.vertical) .activeIndicator {
          background: ${o$.Highlight};
        }
      `))}),iF=".root";class TextField extends TextField$1{appearanceChanged(t,o){t!==o&&(this.classList.add(o),this.classList.remove(t))}connectedCallback(){super.connectedCallback(),this.appearance||(this.appearance="outline")}}__decorate$s([attr],TextField.prototype,"appearance",void 0);const sF=TextField.compose({baseName:"text-field",baseClass:TextField$1,template:(t,o)=>html`
    <template
        class="
            ${t=>t.readOnly?"readonly":""}
        "
    >
        <label
            part="label"
            for="control"
            class="${t=>t.defaultSlottedNodes&&t.defaultSlottedNodes.length?"label":"label label__hidden"}"
        >
            <slot
                ${slotted({property:"defaultSlottedNodes",filter:whitespaceFilter})}
            ></slot>
        </label>
        <div class="root" part="root">
            ${startSlotTemplate(0,o)}
            <input
                class="control"
                part="control"
                id="control"
                @input="${t=>t.handleTextInput()}"
                @change="${t=>t.handleChange()}"
                ?autofocus="${t=>t.autofocus}"
                ?disabled="${t=>t.disabled}"
                list="${t=>t.list}"
                maxlength="${t=>t.maxlength}"
                minlength="${t=>t.minlength}"
                pattern="${t=>t.pattern}"
                placeholder="${t=>t.placeholder}"
                ?readonly="${t=>t.readOnly}"
                ?required="${t=>t.required}"
                size="${t=>t.size}"
                ?spellcheck="${t=>t.spellcheck}"
                :value="${t=>t.value}"
                type="${t=>t.type}"
                aria-atomic="${t=>t.ariaAtomic}"
                aria-busy="${t=>t.ariaBusy}"
                aria-controls="${t=>t.ariaControls}"
                aria-current="${t=>t.ariaCurrent}"
                aria-describedby="${t=>t.ariaDescribedby}"
                aria-details="${t=>t.ariaDetails}"
                aria-disabled="${t=>t.ariaDisabled}"
                aria-errormessage="${t=>t.ariaErrormessage}"
                aria-flowto="${t=>t.ariaFlowto}"
                aria-haspopup="${t=>t.ariaHaspopup}"
                aria-hidden="${t=>t.ariaHidden}"
                aria-invalid="${t=>t.ariaInvalid}"
                aria-keyshortcuts="${t=>t.ariaKeyshortcuts}"
                aria-label="${t=>t.ariaLabel}"
                aria-labelledby="${t=>t.ariaLabelledby}"
                aria-live="${t=>t.ariaLive}"
                aria-owns="${t=>t.ariaOwns}"
                aria-relevant="${t=>t.ariaRelevant}"
                aria-roledescription="${t=>t.ariaRoledescription}"
                ${ref("control")}
            />
            ${endSlotTemplate(0,o)}
        </div>
    </template>
`,styles:(t,o)=>css`
    ${display("inline-block")}

    ${baseInputStyles(0,0,iF)}

    ${inputStateStyles()}

    .root {
      display: flex;
      flex-direction: row;
    }

    .control {
      -webkit-appearance: none;
      color: inherit;
      background: transparent;
      border: 0;
      height: calc(100% - 4px);
      margin-top: auto;
      margin-bottom: auto;
      padding: 0 calc(${BM} * 2px + 1px);
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
    }

    .start,
    .end {
      display: flex;
      margin: auto;
    }

    .start {
      display: flex;
      margin-inline-start: 11px;
    }

    .end {
      display: flex;
      margin-inline-end: 11px;
    }
  `.withBehaviors(appearanceBehavior("outline",inputOutlineStyles(0,0,iF)),appearanceBehavior("filled",inputFilledStyles(0,0,iF)),vM(inputForcedColorStyles(0,0,iF))),shadowOptions:{delegatesFocus:!0}});const aF=class Tooltip extends Tooltip$1{connectedCallback(){super.connectedCallback(),IN.setValueFor(this,kN)}}.compose({baseName:"tooltip",baseClass:Tooltip$1,template:(t,o)=>html`
        ${when((t=>t.tooltipVisible),html`
            <${t.tagFor(AnchoredRegion)}
                fixed-placement="true"
                auto-update-mode="${t=>t.autoUpdateMode}"
                vertical-positioning-mode="${t=>t.verticalPositioningMode}"
                vertical-default-position="${t=>t.verticalDefaultPosition}"
                vertical-inset="${t=>t.verticalInset}"
                vertical-scaling="${t=>t.verticalScaling}"
                horizontal-positioning-mode="${t=>t.horizontalPositioningMode}"
                horizontal-default-position="${t=>t.horizontalDefaultPosition}"
                horizontal-scaling="${t=>t.horizontalScaling}"
                horizontal-inset="${t=>t.horizontalInset}"
                vertical-viewport-lock="${t=>t.horizontalViewportLock}"
                horizontal-viewport-lock="${t=>t.verticalViewportLock}"
                dir="${t=>t.currentDirection}"
                ${ref("region")}
            >
                <div class="tooltip" part="tooltip" role="tooltip">
                    <slot></slot>
                </div>
            </${t.tagFor(AnchoredRegion)}>
        `)}
    `,styles:(t,o)=>css`
    :host {
      position: relative;
      contain: layout;
      overflow: visible;
      height: 0;
      width: 0;
      z-index: 10000;
    }

    .tooltip {
      box-sizing: border-box;
      border-radius: calc(${HM} * 1px);
      border: calc(${qM} * 1px) solid ${jD};
      background: ${IN};
      color: ${xD};
      padding: 4px 12px;
      height: fit-content;
      width: fit-content;
      ${nL}
      white-space: nowrap;
      box-shadow: ${gL};
    }

    ${t.tagFor(AnchoredRegion)} {
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: visible;
      flex-direction: row;
    }

    ${t.tagFor(AnchoredRegion)}.right,
    ${t.tagFor(AnchoredRegion)}.left {
      flex-direction: column;
    }

    ${t.tagFor(AnchoredRegion)}.top .tooltip::after,
    ${t.tagFor(AnchoredRegion)}.bottom .tooltip::after,
    ${t.tagFor(AnchoredRegion)}.left .tooltip::after,
    ${t.tagFor(AnchoredRegion)}.right .tooltip::after {
      content: '';
      width: 12px;
      height: 12px;
      background: ${IN};
      border-top: calc(${qM} * 1px) solid ${jD};
      border-left: calc(${qM} * 1px) solid ${jD};
      position: absolute;
    }

    ${t.tagFor(AnchoredRegion)}.top .tooltip::after {
      transform: translateX(-50%) rotate(225deg);
      bottom: 5px;
      left: 50%;
    }

    ${t.tagFor(AnchoredRegion)}.top .tooltip {
      margin-bottom: 12px;
    }

    ${t.tagFor(AnchoredRegion)}.bottom .tooltip::after {
      transform: translateX(-50%) rotate(45deg);
      top: 5px;
      left: 50%;
    }

    ${t.tagFor(AnchoredRegion)}.bottom .tooltip {
      margin-top: 12px;
    }

    ${t.tagFor(AnchoredRegion)}.left .tooltip::after {
      transform: translateY(-50%) rotate(135deg);
      top: 50%;
      right: 5px;
    }

    ${t.tagFor(AnchoredRegion)}.left .tooltip {
      margin-right: 12px;
    }

    ${t.tagFor(AnchoredRegion)}.right .tooltip::after {
      transform: translateY(-50%) rotate(-45deg);
      top: 50%;
      left: 5px;
    }

    ${t.tagFor(AnchoredRegion)}.right .tooltip {
      margin-left: 12px;
    }
  `.withBehaviors(vM(css`
        :host([disabled]) {
          opacity: 1;
        }
        ${t.tagFor(AnchoredRegion)}.top .tooltip::after,
        ${t.tagFor(AnchoredRegion)}.bottom .tooltip::after,
        ${t.tagFor(AnchoredRegion)}.left .tooltip::after,
        ${t.tagFor(AnchoredRegion)}.right .tooltip::after {
          content: '';
          width: unset;
          height: unset;
        }
      `))}),lF=TreeView.compose({baseName:"tree-view",template:(t,o)=>html`
    <template
        role="tree"
        ${ref("treeView")}
        @keydown="${(t,o)=>t.handleKeyDown(o.event)}"
        @focusin="${(t,o)=>t.handleFocus(o.event)}"
        @focusout="${(t,o)=>t.handleBlur(o.event)}"
        @click="${(t,o)=>t.handleClick(o.event)}"
        @selected-change="${(t,o)=>t.handleSelectedChange(o.event)}"
    >
        <slot ${slotted("slottedTreeItems")}></slot>
    </template>
`,styles:(t,o)=>css`
  :host([hidden]) {
    display: none;
  }

  ${display("flex")} :host {
    flex-direction: column;
    align-items: stretch;
    min-width: fit-content;
    font-size: 0;
  }
`}),cF=css`
  .expand-collapse-button svg {
    transform: rotate(0deg);
  }
  :host(.nested) .expand-collapse-button {
    left: var(--expand-collapse-button-nested-width, calc(${aL} * -1px));
  }
  :host([selected])::after {
    left: calc(${jM} * 1px);
  }
  :host([expanded]) > .positioning-region .expand-collapse-button svg {
    transform: rotate(90deg);
  }
`,dF=css`
  .expand-collapse-button svg {
    transform: rotate(180deg);
  }
  :host(.nested) .expand-collapse-button {
    right: var(--expand-collapse-button-nested-width, calc(${aL} * -1px));
  }
  :host([selected])::after {
    right: calc(${jM} * 1px);
  }
  :host([expanded]) > .positioning-region .expand-collapse-button svg {
    transform: rotate(90deg);
  }
`,uF=cssPartial`((${LM} / 2) * ${BM}) + ((${BM} * ${FM}) / 2)`,hF=$$.create("tree-item-expand-collapse-hover").withDefault((t=>{const o=mD.getValueFor(t);return o.evaluate(t,o.evaluate(t).hover).hover})),pF=$$.create("tree-item-expand-collapse-selected-hover").withDefault((t=>{const o=hD.getValueFor(t);return mD.getValueFor(t).evaluate(t,o.evaluate(t).rest).hover})),fF=TreeItem.compose({baseName:"tree-item",template:(t,o)=>html`
    <template
        role="treeitem"
        slot="${t=>t.isNestedItem()?"item":void 0}"
        tabindex="-1"
        class="${t=>t.expanded?"expanded":""} ${t=>t.selected?"selected":""} ${t=>t.nested?"nested":""}
            ${t=>t.disabled?"disabled":""}"
        aria-expanded="${t=>t.childItems&&t.childItemLength()>0?t.expanded:void 0}"
        aria-selected="${t=>t.selected}"
        aria-disabled="${t=>t.disabled}"
        @focusin="${(t,o)=>t.handleFocus(o.event)}"
        @focusout="${(t,o)=>t.handleBlur(o.event)}"
        ${function children(t){return"string"==typeof t&&(t={property:t}),new AttachedBehaviorHTMLDirective("fast-children",ChildrenBehavior,t)}({property:"childItems",filter:elements()})}
    >
        <div class="positioning-region" part="positioning-region">
            <div class="content-region" part="content-region">
                ${when((t=>t.childItems&&t.childItemLength()>0),html`
                        <div
                            aria-hidden="true"
                            class="expand-collapse-button"
                            part="expand-collapse-button"
                            @click="${(t,o)=>t.handleExpandCollapseButtonClick(o.event)}"
                            ${ref("expandCollapseButton")}
                        >
                            <slot name="expand-collapse-glyph">
                                ${o.expandCollapseGlyph||""}
                            </slot>
                        </div>
                    `)}
                ${startSlotTemplate(0,o)}
                <slot></slot>
                ${endSlotTemplate(0,o)}
            </div>
        </div>
        ${when((t=>t.childItems&&t.childItemLength()>0&&(t.expanded||t.renderCollapsedChildren)),html`
                <div role="group" class="items" part="items">
                    <slot name="item" ${slotted("items")}></slot>
                </div>
            `)}
    </template>
`,styles:(t,o)=>css`
    ${display("block")} :host {
      contain: content;
      position: relative;
      outline: none;
      color: ${xD};
      fill: currentcolor;
      cursor: pointer;
      font-family: ${zM};
      --expand-collapse-button-size: calc(${aL} * 1px);
      --tree-item-nested-width: 0;
    }

    .positioning-region {
      display: flex;
      position: relative;
      box-sizing: border-box;
      background: ${yD};
      border: calc(${qM} * 1px) solid transparent;
      border-radius: calc(${HM} * 1px);
      height: calc((${aL} + 1) * 1px);
    }

    :host(:${yM}) .positioning-region {
      ${iL}
    }

    .positioning-region::before {
      content: '';
      display: block;
      width: var(--tree-item-nested-width);
      flex-shrink: 0;
    }

    :host(:not([disabled])) .positioning-region:hover {
      background: ${bD};
    }

    :host(:not([disabled])) .positioning-region:active {
      background: ${wD};
    }

    .content-region {
      display: inline-flex;
      align-items: center;
      white-space: nowrap;
      width: 100%;
      height: calc(${aL} * 1px);
      margin-inline-start: calc(${BM} * 2px + 8px);
      ${nL}
    }

    .items {
      display: none;
      ${""} font-size: calc(1em + (${BM} + 16) * 1px);
    }

    .expand-collapse-button {
      background: none;
      border: none;
      border-radius: calc(${HM} * 1px);
      ${""} width: calc((${uF} + (${BM} * 2)) * 1px);
      height: calc((${uF} + (${BM} * 2)) * 1px);
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      margin: 0 6px;
    }

    .expand-collapse-button svg {
      transition: transform 0.1s linear;
      pointer-events: none;
    }

    .start,
    .end {
      display: flex;
    }

    .start {
      ${""} margin-inline-end: calc(${BM} * 2px + 2px);
    }

    .end {
      ${""} margin-inline-start: calc(${BM} * 2px + 2px);
    }

    :host(.expanded) > .items {
      display: block;
    }

    :host([disabled]) {
      opacity: ${DM};
      cursor: ${mM};
    }

    :host(.nested) .content-region {
      position: relative;
      margin-inline-start: var(--expand-collapse-button-size);
    }

    :host(.nested) .expand-collapse-button {
      position: absolute;
    }

    :host(.nested) .expand-collapse-button:hover {
      background: ${hF};
    }

    :host(:not([disabled])[selected]) .positioning-region {
      background: ${pD};
    }

    :host(:not([disabled])[selected]) .expand-collapse-button:hover {
      background: ${pF};
    }

    :host([selected])::after {
      content: '';
      display: block;
      position: absolute;
      top: calc((${aL} / 4) * 1px);
      width: 3px;
      height: calc((${aL} / 2) * 1px);
      ${""} background: ${$N};
      border-radius: calc(${HM} * 1px);
    }

    ::slotted(fluent-tree-item) {
      --tree-item-nested-width: 1em;
      --expand-collapse-button-nested-width: calc(${aL} * -1px);
    }
  `.withBehaviors(new DirectionalStyleSheetBehavior(cF,dF),vM(css`
        :host {
          color: ${o$.ButtonText};
        }
        .positioning-region {
          border-color: ${o$.ButtonFace};
          background: ${o$.ButtonFace};
        }
        :host(:not([disabled])) .positioning-region:hover,
        :host(:not([disabled])) .positioning-region:active,
        :host(:not([disabled])[selected]) .positioning-region {
          background: ${o$.Highlight};
        }
        :host .positioning-region:hover .content-region,
        :host([selected]) .positioning-region .content-region {
          forced-color-adjust: none;
          color: ${o$.HighlightText};
        }
        :host([disabled][selected]) .positioning-region .content-region {
          color: ${o$.GrayText};
        }
        :host([selected])::after {
          background: ${o$.HighlightText};
        }
        :host(:${yM}) .positioning-region {
          forced-color-adjust: none;
          outline-color: ${o$.ButtonFace};
        }
        :host([disabled]),
        :host([disabled]) .content-region,
        :host([disabled]) .positioning-region:hover .content-region {
          opacity: 1;
          color: ${o$.GrayText};
        }
        :host(.nested) .expand-collapse-button:hover,
        :host(:not([disabled])[selected]) .expand-collapse-button:hover {
          background: ${o$.ButtonFace};
          fill: ${o$.ButtonText};
        }
      `)),expandCollapseGlyph:'\n    <svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n      <path d="M4.65 2.15a.5.5 0 000 .7L7.79 6 4.65 9.15a.5.5 0 10.7.7l3.5-3.5a.5.5 0 000-.7l-3.5-3.5a.5.5 0 00-.7 0z"/>\n    </svg>\n  '});const gF=function provideFluentDesignSystem(t){return F$.getOrCreate(t).withPrefix("fluent")}(),registerFluentComponents=(...t)=>{if(null==t?void 0:t.length)for(const o of t)gF.register(o())};var __decorate$r=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$q=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$q=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents($L),exports.MgtAgenda=class MgtAgenda extends MgtTemplatedComponent{constructor(){super(...arguments),this._days=3,this.onResize=()=>{this._isNarrow=this.offsetWidth<600}}static get styles(){return AP}get date(){return this._date}set date(t){this._date!==t&&(this._date=t,this.reloadState())}get groupId(){return this._groupId}set groupId(t){this._groupId!==t&&(this._groupId=t,this.reloadState())}get days(){return this._days}set days(t){this._days!==t&&(this._days=t,this.reloadState())}get eventQuery(){return this._eventQuery}set eventQuery(t){this._eventQuery!==t&&(this._eventQuery=t,this.reloadState())}get preferredTimezone(){return this._preferredTimezone}set preferredTimezone(t){this._preferredTimezone!==t&&(this._preferredTimezone=t,this.reloadState())}static get requiredScopes(){return[...new Set(["calendars.read",...exports.MgtPeople.requiredScopes])]}connectedCallback(){this._isNarrow=this.offsetWidth<600,super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){if(!this.events&&this.isLoadingState)return this.renderLoading();if(!this.events||0===this.events.length)return this.renderNoData();const t=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events,o=this.renderTemplate("default",{events:t});if(o)return o;const s={agenda:!0,grouped:this.groupByDay};return AI`
      <div dir=${this.direction} class="${iP(s)}">
        ${this.groupByDay?this.renderGroups(t):this.renderEvents(t)}
        ${this.isLoadingState?this.renderLoading():AI``}
      </div>
    `}reload(){return __awaiter$q(this,void 0,void 0,(function*(){this.events=yield this.loadEvents()}))}renderLoading(){return this.renderTemplate("loading",null)||AI`
        <fluent-card class="event event-loading">
          <div class="event-time-container">
            <div class="event-time-loading loading-element"></div>
          </div>
          <div class="event-details-container">
            <div class="event-subject-loading loading-element"></div>
            <div class="event-location-container">
              <div class="event-location-icon-loading loading-element"></div>
              <div class="event-location-loading loading-element"></div>
            </div>
            <div class="event-location-container">
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
            </div>
          </div>
        </fluent-card>`}clearState(){this.events=null}renderNoData(){return this.renderTemplate("no-data",null)||AI``}renderEvent(t){this._isNarrow=this.offsetWidth<600;const o={narrow:this._isNarrow};return AI`
      <fluent-card class="${iP(Object.assign({event:!0},o))}">
        <div class="${iP(Object.assign({"event-time-container":!0},o))}">
          <div class="event-time" aria-label="${this.getEventTimeString(t)}">${this.getEventTimeString(t)}</div>
        </div>
        <div class="${iP(Object.assign({"event-details-container":!0},o))}">
          ${this.renderTitle(t)} ${this.renderLocation(t)} ${this.renderAttendees(t)}
        </div>
        <div class="event-other-container">${this.renderOther(t)}</div>
      </fluent-card>
    `}renderHeader(t){return this.renderTemplate("header",{header:t},"header-"+t)||AI`
        <div class="header" aria-label="${t}">${t}</div>
      `}renderTitle(t){return AI`
      <div
        aria-label=${t.subject}
        class="${iP({"event-subject":!0,narrow:this._isNarrow})}"
      >
        ${t.subject}
      </div>`}renderLocation(t){return t.location.displayName?AI`
      <div class="event-location-container">
        <div class="event-location-icon">${getSvg(yP.OfficeLocation)}</div>
        <div class="event-location" aria-label="${t.location.displayName}">${t.location.displayName}</div>
      </div>
    `:null}renderAttendees(t){return t.attendees.length?mgtHtml`
      <mgt-people
        show-max="5"
        show-presence
        class="event-attendees"
        .peopleQueries=${t.attendees.map((t=>t.emailAddress.address))}
      ></mgt-people>
    `:null}renderOther(t){return this.hasTemplate("event-other")?AI`
          ${this.renderTemplate("event-other",{event:t},t.id+"-other")}
        `:null}renderGroups(t){const o={};return t.forEach((t=>{var s;let l=null===(s=null==t?void 0:t.start)||void 0===s?void 0:s.dateTime;"UTC"===t.end.timeZone&&(l+="Z");const h=this.getDateHeaderFromDateTimeString(l);o[h]=o[h]||[],o[h].push(t)})),AI`
      ${Object.keys(o).map((t=>AI`
            <div class="group">${this.renderHeader(t)} ${this.renderEvents(o[t])}</div>
          `))}
    `}renderEvents(t){return AI`
        ${t.map((t=>AI`
              <div
                class="event-container"
                tabindex="0"
                @focus=${()=>this.eventClicked(t)}>
                ${this.renderTemplate("event",{event:t},t.id)||this.renderEvent(t)}
              </div>`))}`}loadState(){return __awaiter$q(this,void 0,void 0,(function*(){if(this.events)return;const t=yield this.loadEvents();(null==t?void 0:t.length)>0&&(this.events=t)}))}reloadState(){return __awaiter$q(this,void 0,void 0,(function*(){this.events=null,yield this.requestStateUpdate(!0)}))}eventClicked(t){this.fireCustomEvent("eventClick",t)}getEventTimeString(t){if(t.isAllDay)return"ALL DAY";let o=t.start.dateTime;"UTC"===t.start.timeZone&&(o+="Z");let s=t.end.dateTime;"UTC"===t.end.timeZone&&(s+="Z");return`${this.prettyPrintTimeFromDateTime(new Date(o))} - ${this.prettyPrintTimeFromDateTime(new Date(s))}`}loadEvents(){return __awaiter$q(this,void 0,void 0,(function*(){const t=Providers.globalProvider;let o=[];if((null==t?void 0:t.state)===exports.ProviderState.SignedIn){const s=t.graph.forComponent(this);if(this.eventQuery)try{const t=this.eventQuery.split("|");let l,h;t.length>1?(h=t[0].trim(),l=t[1].trim()):h=this.eventQuery;const m=yield getEventsQueryPageIterator(s,h,l);if(null==m?void 0:m.value)for(o=m.value;m.hasNext;)yield m.next(),o=m.value}catch(t){}else{const t=this.date?new Date(this.date):new Date,l=new Date(t.getTime());l.setDate(t.getDate()+this.days);try{const h=yield((t,o,s,l)=>__awaiter$s(void 0,void 0,void 0,(function*(){const h=`startdatetime=${o.toISOString()}`,m=`enddatetime=${s.toISOString()}`;let _;return _=l?`groups/${l}/calendar`:"me",_+=`/calendarview?${h}&${m}`,getEventsQueryPageIterator(t,_)})))
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */(s,t,l,this.groupId);if(null==h?void 0:h.value)for(o=h.value;h.hasNext;)yield h.next(),o=h.value}catch(t){}}}return o}))}prettyPrintTimeFromDateTime(t){return t.toLocaleTimeString(navigator.language,{timeStyle:"short",timeZone:this.preferredTimezone})}getDateHeaderFromDateTimeString(t){return new Date(t).toLocaleDateString(navigator.language,{dateStyle:"full",timeZone:this.preferredTimezone})}},__decorate$r([n$1({attribute:"date",type:String}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"date",null),__decorate$r([n$1({attribute:"group-id",type:String}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"groupId",null),__decorate$r([n$1({attribute:"days",type:Number}),__metadata$q("design:type",Number),__metadata$q("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"days",null),__decorate$r([n$1({attribute:"event-query",type:String}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"eventQuery",null),__decorate$r([n$1({attribute:"events",type:Array}),__metadata$q("design:type",Array)],exports.MgtAgenda.prototype,"events",void 0),__decorate$r([n$1({attribute:"show-max",type:Number}),__metadata$q("design:type",Number)],exports.MgtAgenda.prototype,"showMax",void 0),__decorate$r([n$1({attribute:"group-by-day",type:Boolean}),__metadata$q("design:type",Boolean)],exports.MgtAgenda.prototype,"groupByDay",void 0),__decorate$r([n$1({attribute:"preferred-timezone",type:String}),__metadata$q("design:type",String),__metadata$q("design:paramtypes",[Object])],exports.MgtAgenda.prototype,"preferredTimezone",null),__decorate$r([n$1({attribute:!1}),__metadata$q("design:type",Boolean)],exports.MgtAgenda.prototype,"_isNarrow",void 0),exports.MgtAgenda=__decorate$r([customElement("agenda")],exports.MgtAgenda);const vF=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{font-size:var(--default-font-size);font-weight:var(--default-font-weight,400);border:var(--file-border,1px solid transparent);border-radius:var(--file-border-radius,4px);background-color:var(--file-background-color)}:host .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(--file-background-color);padding:var(--file-padding,0);margin:var(--file-margin,0)}:host .item:hover{background-color:var(--file-background-color-hover,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px);cursor:pointer;--secondary-text-color:var(--secondary-text-hover-color)}:host .item:focus,:host .item:focus-visible{background-color:var(--file-background-color-focus,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px)}:host .item__file-type-icon{height:var(--file-type-icon-height,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img{height:var(--file-type-icon-height,28px)}:host .item__details{padding-inline-start:var(--file-padding-inline-start,14px)}:host .item__details .line1{font-size:var(--default-font-size);font-weight:var(--file-line1-font-weight,var(--default-font-weight,400));text-transform:var(--file-line1-text-transform,initial);line-height:20px;color:var(--file-line1-color,var(--neutral-foreground-rest))}:host .item__details .line2{color:var(--file-line2-color,var(--secondary-text-color));font-size:var(--file-line2-font-size,var(--last-modified-font-size,12px));font-weight:var(--file-line2-font-weight,var(--default-font-weight,400));text-transform:var(--file-line2-text-transform,initial);line-height:16px}:host .item__details .line3{color:var(--file-line3-color,var(--secondary-text-color));font-size:var(--file-line3-font-size,var(--size-font-size,12px));font-weight:var(--file-line3-font-weight,var(--default-font-weight,400));text-transform:var(--file-line3-text-transform,initial);line-height:16px}[dir=rtl] .item{direction:rtl}[dir=rtl] .item__details{direction:rtl}
`];var __awaiter$p=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const clearFilesCache=()=>__awaiter$p(void 0,void 0,void 0,(function*(){const t=CacheService.getCache(fP,fP.stores.fileLists);yield t.clearStore()})),getFileInvalidationTime=()=>CacheService.config.files.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsFilesCacheEnabled=()=>CacheService.config.files.isEnabled&&CacheService.config.isEnabled,getIsFileListsCacheEnabled=()=>CacheService.config.fileLists.isEnabled&&CacheService.config.isEnabled,getDriveItemByQuery=(t,o,s=pP.stores.fileQueries,l="files.read")=>__awaiter$p(void 0,void 0,void 0,(function*(){const h=CacheService.getCache(pP,s),m=yield getFileFromCache(h,o);if(m)return m;let _;try{_=yield t.api(o).middlewareOptions(prepScopes(l)).get(),getIsFilesCacheEnabled()&&(yield h.putValue(o,{file:JSON.stringify(_)}))}catch(t){}return _||null})),getIterator=(t,o,s,l,h)=>__awaiter$p(void 0,void 0,void 0,(function*(){let m;const _=CacheService.getCache(fP,s),E=yield getFileListFromCache(_,s,`${o}:${h}`);if(E)return m=getFilesPageIteratorFromCache(t,E.files,E.nextLink),m;let $;try{if($=t.api(o).middlewareOptions(prepScopes(...l)),h&&$.top(h),m=yield getFilesPageIteratorFromRequest(t,$),getIsFileListsCacheEnabled()){const t=m.nextLink;yield _.putValue(o,{files:m.value.map((t=>JSON.stringify(t))),nextLink:t})}}catch(t){}return m||null})),getDriveItemsByInsights=(t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){if(!o)return[];const l=o.value,h=t.createBatch(),m=[];for(const t of l){const o=t.resourceReference.id;""!==o&&h.get(o,o,s)}try{const t=yield h.executeAll();for(const o of l){const s=t.get(o.resourceReference.id);(null==s?void 0:s.content)&&m.push(s.content)}return m}catch(o){try{return Promise.all(l.filter((t=>Boolean(t.resourceReference.id))).map((o=>__awaiter$p(void 0,void 0,void 0,(function*(){return yield t.api(o.resourceReference.id).middlewareOptions(prepScopes(...s)).get()})))))}catch(t){return[]}}})),getFilesPageIteratorFromRequest=(t,o)=>__awaiter$p(void 0,void 0,void 0,(function*(){return GraphPageIterator.create(t,o)})),getFilesPageIteratorFromCache=(t,o,s)=>GraphPageIterator.createFromValue(t,o.map((t=>JSON.parse(t))),s),getFileFromCache=(t,o)=>__awaiter$p(void 0,void 0,void 0,(function*(){if(getIsFilesCacheEnabled()){const s=yield t.getValue(o);if(s&&getFileInvalidationTime()>Date.now()-s.timeCached)return JSON.parse(s.file)}return null})),getFileListFromCache=(t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){if(t||(t=CacheService.getCache(fP,o)),getIsFileListsCacheEnabled()){const o=yield t.getValue(s);if(o&&(CacheService.config.fileLists.invalidationPeriod||CacheService.config.defaultInvalidationPeriod)>Date.now()-o.timeCached)return o}return null})),fetchNextAndCacheForFilesPageIterator=t=>__awaiter$p(void 0,void 0,void 0,(function*(){const o=t.nextLink;if(t.hasNext&&(yield t.next()),getIsFileListsCacheEnabled()){const s=CacheService.getCache(fP,fP.stores.fileLists),l=/(graph.microsoft.com\/(v1.0|beta))(.*?)(?=\?)/gi.exec(o)[3];yield s.putValue(l,{files:t.value.map((t=>JSON.stringify(t))),nextLink:o})}})),sendFileChunk=(t,o,s,l,h)=>__awaiter$p(void 0,void 0,void 0,(function*(){try{const m="files.readwrite",_={"Content-Length":s,"Content-Range":l};let E;try{E=yield t.client.api(o).middlewareOptions(prepScopes(m)).headers(_).put(h)}catch(t){}return E||null}catch(t){return null}})),mF={PowerPoint:"pptx",Word:"docx",Excel:"xlsx",Pdf:"pdf",OneNote:"onetoc",OneNotePage:"one",InfoPath:"xsn",Visio:"vstx",Publisher:"pub",Project:"mpp",Access:"accdb",Mail:"email",Csv:"csv",Archive:"archive",Xps:"vector",Audio:"audio",Video:"video",Image:"photo",Web:"html",Text:"txt",Xml:"xml",Story:"genericfile",ExternalContent:"genericfile",Folder:"folder",Spsite:"spo",Other:"genericfile"},yF="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201008.001/assets/item-types",bF={modifiedSubtitle:"Modified",sizeSubtitle:"Size"};var __decorate$q=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$p=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$o=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};exports.MgtFile=class MgtFile extends MgtTemplatedComponent{static get styles(){return vF}get strings(){return bF}get fileQuery(){return this._fileQuery}set fileQuery(t){t!==this._fileQuery&&(this._fileQuery=t,this.requestStateUpdate())}get siteId(){return this._siteId}set siteId(t){t!==this._siteId&&(this._siteId=t,this.requestStateUpdate())}get driveId(){return this._driveId}set driveId(t){t!==this._driveId&&(this._driveId=t,this.requestStateUpdate())}get groupId(){return this._groupId}set groupId(t){t!==this._groupId&&(this._groupId=t,this.requestStateUpdate())}get listId(){return this._listId}set listId(t){t!==this._listId&&(this._listId=t,this.requestStateUpdate())}get userId(){return this._userId}set userId(t){t!==this._userId&&(this._userId=t,this.requestStateUpdate())}get itemId(){return this._itemId}set itemId(t){t!==this._itemId&&(this._itemId=t,this.requestStateUpdate())}get itemPath(){return this._itemPath}set itemPath(t){t!==this._itemPath&&(this._itemPath=t,this.requestStateUpdate())}get insightType(){return this._insightType}set insightType(t){t!==this._insightType&&(this._insightType=t,this.requestStateUpdate())}get insightId(){return this._insightId}set insightId(t){t!==this._insightId&&(this._insightId=t,this.requestStateUpdate())}get fileDetails(){return this._fileDetails}set fileDetails(t){t!==this._fileDetails&&(this._fileDetails=t,this.requestStateUpdate())}get fileIcon(){return this._fileIcon}set fileIcon(t){t!==this._fileIcon&&(this._fileIcon=t,this.requestStateUpdate())}static get requiredScopes(){return[...new Set(["files.read","files.read.all","sites.read.all"])]}constructor(){super(),this.line1Property="name",this.line2Property="lastModifiedDateTime",this.line3Property="size",this.view=exports.ViewType.threelines}render(){if(!this.driveItem&&this.isLoadingState)return this.renderLoading();if(!this.driveItem)return this.renderNoData();const t=this.driveItem;let o;if(o=this.renderTemplate("default",{file:t}),!o){const s=this.renderDetails(t),l=this.renderFileTypeIcon();o=AI`
        <div class="item">
          ${l} ${s}
        </div>`}return o}renderLoading(){return this.renderTemplate("loading",null)||AI``}renderNoData(){return this.renderTemplate("no-data",null)||AI``}renderFileTypeIcon(){if(!this.fileIcon&&!this.driveItem.name)return AI``;let t;if(this.fileIcon)t=this.fileIcon;else{const o=/(?:\.([^.]+))?$/;t=((t,o,s)=>{const l=Object.keys(mF).find((o=>mF[o]===t));return l?`${yF}/${o.toString()}/${t}.${s}`:"jpg"===t||"png"===t?(t="photo",`${yF}/${o.toString()}/${t}.${s}`):null})(void 0===this.driveItem.package&&void 0===this.driveItem.folder?o.exec(this.driveItem.name)[1]?o.exec(this.driveItem.name)[1].toLowerCase():this.driveItem.size?"null":"folder":void 0!==this.driveItem.package&&"oneNote"===this.driveItem.package.type?"onetoc":"folder",48,"svg")}return AI`
      <div class="item__file-type-icon">
        ${t?AI`
              <img src=${t} alt="File icon" />
            `:AI`
              ${getSvg(yP.File)}
            `}
      </div>
    `}renderDetails(t){if(!t||this.view===exports.ViewType.image)return AI``;const o=[];if(this.view>exports.ViewType.image){const s=this.getTextFromProperty(t,this.line1Property);s&&o.push(AI`
          <div class="line1" aria-label="${s}">${s}</div>
        `)}if(this.view>exports.ViewType.oneline){const s=this.getTextFromProperty(t,this.line2Property);s&&o.push(AI`
          <div class="line2" aria-label="${s}">${s}</div>
        `)}if(this.view>exports.ViewType.twolines){const s=this.getTextFromProperty(t,this.line3Property);s&&o.push(AI`
          <div class="line3" aria-label="${s}">${s}</div>
        `)}return AI`
      <div class="item__details">
        ${o}
      </div>
    `}loadState(){return __awaiter$o(this,void 0,void 0,(function*(){if(this.fileDetails)return void(this.driveItem=this.fileDetails);const t=Providers.globalProvider;if(!t||t.state===exports.ProviderState.Loading)return;if(t.state===exports.ProviderState.SignedOut)return void(this.driveItem=null);const o=t.graph.forComponent(this);let s;const l=!(this.driveId||this.siteId||this.groupId||this.listId||this.userId);this.driveId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.listId&&!this.siteId&&!this.itemId||this.insightType&&!this.insightId||this.userId&&!this.itemId&&!this.itemPath&&!this.insightType&&!this.insightId?s=null:this.fileQuery?s=yield getDriveItemByQuery(o,this.fileQuery):this.itemId&&l?s=yield((t,o)=>__awaiter$p(void 0,void 0,void 0,(function*(){return getDriveItemByQuery(t,`/me/drive/items/${o}`,pP.stores.userFiles)})))(o,this.itemId):this.itemPath&&l?s=yield((t,o)=>__awaiter$p(void 0,void 0,void 0,(function*(){return getDriveItemByQuery(t,`/me/drive/root:/${o}`,pP.stores.userFiles)})))(o,this.itemPath):this.userId?this.itemId?s=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){return getDriveItemByQuery(t,`/users/${o}/drive/items/${s}`,pP.stores.userFiles)})))(o,this.userId,this.itemId):this.itemPath?s=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){return getDriveItemByQuery(t,`/users/${o}/drive/root:/${s}`,pP.stores.userFiles)})))(o,this.userId,this.itemPath):this.insightType&&this.insightId&&(s=yield((t,o,s,l)=>__awaiter$p(void 0,void 0,void 0,(function*(){return getDriveItemByQuery(t,`/users/${o}/insights/${s}/${l}/resource`,pP.stores.insightFiles,"sites.read.all")})))(o,this.userId,this.insightType,this.insightId)):this.driveId?this.itemId?s=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){return getDriveItemByQuery(t,`/drives/${o}/items/${s}`,pP.stores.driveFiles)})))(o,this.driveId,this.itemId):this.itemPath&&(s=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){return getDriveItemByQuery(t,`/drives/${o}/root:/${s}`,pP.stores.driveFiles)})))(o,this.driveId,this.itemPath)):this.siteId&&!this.listId?this.itemId?s=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){return getDriveItemByQuery(t,`/sites/${o}/drive/items/${s}`,pP.stores.siteFiles)})))(o,this.siteId,this.itemId):this.itemPath&&(s=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){return getDriveItemByQuery(t,`/sites/${o}/drive/root:/${s}`,pP.stores.siteFiles)})))(o,this.siteId,this.itemPath)):this.listId?s=yield((t,o,s,l)=>__awaiter$p(void 0,void 0,void 0,(function*(){return getDriveItemByQuery(t,`/sites/${o}/lists/${s}/items/${l}/driveItem`,pP.stores.siteFiles)})))(o,this.siteId,this.listId,this.itemId):this.groupId?this.itemId?s=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){return getDriveItemByQuery(t,`/groups/${o}/drive/items/${s}`,pP.stores.groupFiles)})))(o,this.groupId,this.itemId):this.itemPath&&(s=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){return getDriveItemByQuery(t,`/groups/${o}/drive/root:/${s}`,pP.stores.groupFiles)})))(o,this.groupId,this.itemPath)):this.insightType&&!this.userId&&(s=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){return getDriveItemByQuery(t,`/me/insights/${o}/${s}/resource`,pP.stores.insightFiles,"sites.read.all")})))(o,this.insightType,this.insightId)),this.driveItem=s}))}getTextFromProperty(t,o){if(!o||0===o.length)return null;const s=o.trim().split(",");let l,h=0;for(;!l&&h<s.length;){const o=s[h].trim();switch(o){case"size":{let o="0";t.size&&(o=formatBytes(t.size)),l=`${this.strings.sizeSubtitle}: ${o}`;break}case"lastModifiedDateTime":{let o,s;if(t.lastModifiedDateTime){const l=new Date(t.lastModifiedDateTime);o=getRelativeDisplayDate(l),s=`${this.strings.modifiedSubtitle} ${o}`}else s="";l=s;break}default:l=t[o]}h++}return l}},__decorate$q([n$1({attribute:"file-query"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"fileQuery",null),__decorate$q([n$1({attribute:"site-id"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"siteId",null),__decorate$q([n$1({attribute:"drive-id"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"driveId",null),__decorate$q([n$1({attribute:"group-id"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"groupId",null),__decorate$q([n$1({attribute:"list-id"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"listId",null),__decorate$q([n$1({attribute:"user-id"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"userId",null),__decorate$q([n$1({attribute:"item-id"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"itemId",null),__decorate$q([n$1({attribute:"item-path"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"itemPath",null),__decorate$q([n$1({attribute:"insight-type"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"insightType",null),__decorate$q([n$1({attribute:"insight-id"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"insightId",null),__decorate$q([n$1({type:Object}),__metadata$p("design:type",Object),__metadata$p("design:paramtypes",[Object])],exports.MgtFile.prototype,"fileDetails",null),__decorate$q([n$1({attribute:"file-icon"}),__metadata$p("design:type",String),__metadata$p("design:paramtypes",[String])],exports.MgtFile.prototype,"fileIcon",null),__decorate$q([n$1({type:Object}),__metadata$p("design:type",Object)],exports.MgtFile.prototype,"driveItem",void 0),__decorate$q([n$1({attribute:"line1-property"}),__metadata$p("design:type",String)],exports.MgtFile.prototype,"line1Property",void 0),__decorate$q([n$1({attribute:"line2-property"}),__metadata$p("design:type",String)],exports.MgtFile.prototype,"line2Property",void 0),__decorate$q([n$1({attribute:"line3-property"}),__metadata$p("design:type",String)],exports.MgtFile.prototype,"line3Property",void 0),__decorate$q([n$1({attribute:"view",converter:t=>t&&0!==t.length?(t=t.toLowerCase(),void 0===exports.ViewType[t]?exports.ViewType.threelines:exports.ViewType[t]):exports.ViewType.threelines}),__metadata$p("design:type",Number)],exports.MgtFile.prototype,"view",void 0),exports.MgtFile=__decorate$q([customElement("file"),__metadata$p("design:paramtypes",[])],exports.MgtFile);const wF=[i$3`
:host .file-upload-area-button{width:auto;display:flex;align-items:end;justify-content:end;margin-inline-end:36px;margin-top:30px}:host fluent-button .upload-icon path{fill:var(--file-upload-button-text-color,var(--foreground-on-accent-rest))}:host fluent-button.file-upload-button::part(control){border:var(--file-upload-button-border,none);background:var(--file-upload-button-background-color,var(--accent-fill-rest))}:host fluent-button.file-upload-button::part(control):hover{background:var(--file-upload-button-background-color-hover,var(--accent-fill-hover))}:host fluent-button.file-upload-button .upload-text{color:var(--file-upload-button-text-color,var(--foreground-on-accent-rest));font-weight:400;line-height:20px}:host input{display:none}:host fluent-progress.file-upload-bar{width:180px;margin-top:10px}:host fluent-dialog::part(overlay){opacity:.5}:host fluent-dialog::part(control){--dialog-width:$file-upload-dialog-width;--dialog-height:$file-upload-dialog-height;padding:var(--file-upload-dialog-padding,24px);border:var(--file-upload-dialog-border,1px solid var(--neutral-fill-rest))}:host fluent-dialog .file-upload-dialog-ok{background:var(--file-upload-dialog-keep-both-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-keep-both-button-border,none);color:var(--file-upload-dialog-keep-both-button-text-color,var(--foreground-on-accent-rest))}:host fluent-dialog .file-upload-dialog-ok:hover{background:var(--file-upload-dialog-keep-both-button-background-color-hover,var(--accent-fill-hover))}:host fluent-dialog .file-upload-dialog-cancel{background:var(--file-upload-dialog-replace-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-replace-button-border,1px solid var(--neutral-foreground-rest));color:var(--file-upload-dialog-replace-button-text-color,var(--neutral-foreground-rest))}:host fluent-dialog .file-upload-dialog-cancel:hover{background:var(--file-upload-dialog-replace-button-background-color-hover,var(--accent-fill-hover))}:host fluent-checkbox{margin-top:12px}:host fluent-checkbox .file-upload-dialog-check{color:var(--file-upload-dialog-text-color,--foreground-on-accent-rest)}:host .file-upload-table{display:flex}:host .file-upload-table.upload{display:flex}:host .file-upload-table .file-upload-cell{padding:1px 0 1px 1px;display:table-cell;vertical-align:middle;position:relative}:host .file-upload-table .file-upload-cell.percent-indicator{padding-inline-start:10px}:host .file-upload-table .file-upload-cell .description{opacity:.5;position:relative}:host .file-upload-table .file-upload-cell .file-upload-filename{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host .file-upload-table .file-upload-cell .file-upload-status{position:absolute;left:28px}:host .file-upload-table .file-upload-cell .file-upload-cancel{cursor:pointer;margin-inline-start:20px}:host .file-upload-table .file-upload-cell .file-upload-name{width:auto}:host .file-upload-table .file-upload-cell .cancel-icon{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .mgt-file-item{--file-background-color:transparent;--file-padding:0 12px;--file-padding-inline-start:24px}:host .file-upload-template{clear:both}:host .file-upload-template .file-upload-folder-tab{padding-inline-start:20px}:host .file-upload-dialog{display:none}:host .file-upload-dialog .file-upload-dialog-content{background-color:var(--file-upload-dialog-background-color,var(--accent-fill-rest));color:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .file-upload-dialog .file-upload-dialog-content-text{margin-bottom:36px}:host .file-upload-dialog .file-upload-dialog-title{margin-top:0}:host .file-upload-dialog .file-upload-dialog-editor{display:flex;align-items:end;justify-content:end;gap:5px}:host .file-upload-dialog .file-upload-dialog-close{float:right;cursor:pointer}:host .file-upload-dialog .file-upload-dialog-close svg{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest));padding-right:5px}:host .file-upload-dialog.visible{display:block}:host fluent-checkbox.file-upload-dialog-check.hide{display:none}:host .file-upload-dialog-success{cursor:pointer;opacity:.5}:host #file-upload-border{display:none}:host #file-upload-border.visible{border:var(--file-upload-border-drag,1px dashed #0078d4);background-color:var(--file-upload-background-color-drag,rgba(0,120,212,.1));position:absolute;inset:0;z-index:1;display:inline-block}[dir=rtl] :host .file-upload-status{left:0;right:28px}
`],CF={failUploadFile:"File upload fail.",cancelUploadFile:"File cancel.",buttonUploadFile:"Upload Files",maximumFilesTitle:"Maximum files",maximumFiles:"Sorry, the maximum number of files you can upload at once is {MaxNumber}. Do you want to upload the first {MaxNumber} files or reselect?",maximumFileSizeTitle:"Maximum files size",maximumFileSize:'Sorry, the maximum file size to upload is {FileSize}. The file "{FileName}" has ',fileTypeTitle:"File type",fileType:'Sorry, the format of following file "{FileName}" cannot be uploaded.',checkAgain:"Don't show again",checkApplyAll:"Apply to all",buttonOk:"OK",buttonCancel:"Cancel",buttonUpload:"Upload",buttonKeep:"Keep both",buttonReplace:"Replace",buttonReselect:"Reselect",fileReplaceTitle:"Replace file",fileReplace:'Do you want to replace the file "{FileName}" or keep both files?',uploadButtonLabel:"File upload button"};var __decorate$p=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$o=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$n=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(GL,AL,ML,HL);const isFileSystemDirectoryEntry=t=>t.isDirectory,isFutureDataTransferItem=t=>"getAsEntry"in t&&"function"==typeof t.getAsEntry;let _F=class MgtFileUpload extends MgtBaseComponent{static get styles(){return wF}get strings(){return CF}static get requiredScopes(){return[...new Set(["files.readwrite","files.readwrite.all","sites.readwrite.all"])]}get _dropEffect(){return"copy"}constructor(){super(),this._dragCounter=0,this._maxChunkSize=4194304,this._dialogTitle="",this._dialogContent="",this._dialogPrimaryButton="",this._dialogSecondaryButton="",this._dialogCheckBox="",this._applyAll=!1,this._applyAllConflictBehavior=null,this._maximumFileSize=!1,this._excludedFileType=!1,this.onFileUploadChange=t=>{const o=t.target;!t||o.files.length<1||this.readUploadedFiles(o.files,(()=>o.value=null))},this.onFileUploadClick=()=>{this.renderRoot.querySelector("#file-upload-input").click()},this.handleonDragOver=t=>{t.preventDefault(),t.stopPropagation(),t.dataTransfer.items&&t.dataTransfer.items.length>0&&(t.dataTransfer.dropEffect=t.dataTransfer.dropEffect=this._dropEffect)},this.handleonDragEnter=t=>{if(t.preventDefault(),t.stopPropagation(),this._dragCounter++,t.dataTransfer.items&&t.dataTransfer.items.length>0){t.dataTransfer.dropEffect=this._dropEffect;this.renderRoot.querySelector("#file-upload-border").classList.add("visible")}},this.handleonDragLeave=t=>{if(t.preventDefault(),t.stopPropagation(),this._dragCounter--,0===this._dragCounter){this.renderRoot.querySelector("#file-upload-border").classList.remove("visible")}},this.handleonDrop=t=>{var o;t.preventDefault(),t.stopPropagation();const done=()=>{t.dataTransfer.clearData()};this.renderRoot.querySelector("#file-upload-border").classList.remove("visible"),(null===(o=t.dataTransfer)||void 0===o?void 0:o.items)&&this.readUploadedFiles(t.dataTransfer.items,done),this._dragCounter=0},this.filesToUpload=[]}render(){if(null!==this.parentElement){const t=this.parentElement;t.addEventListener("dragenter",this.handleonDragEnter),t.addEventListener("dragleave",this.handleonDragLeave),t.addEventListener("dragover",this.handleonDragOver),t.addEventListener("drop",this.handleonDrop)}return AI`
        <div id="file-upload-dialog" class="file-upload-dialog">
          <!-- Modal content -->
          <fluent-dialog modal="true" class="file-upload-dialog-content">
            <span
              class="file-upload-dialog-close"
              id="file-upload-dialog-close">
                ${getSvg(yP.Cancel)}
            </span>
            <div class="file-upload-dialog-content-text">
              <h2 class="file-upload-dialog-title">${this._dialogTitle}</h2>
              <div>${this._dialogContent}</div>
                <fluent-checkbox
                  id="file-upload-dialog-check"
                  class="file-upload-dialog-check">
                    ${this._dialogCheckBox}
                </fluent-checkbox>
            </div>
            <div class="file-upload-dialog-editor">
              <fluent-button
                appearance="accent"
                class="file-upload-dialog-ok">
                ${this._dialogPrimaryButton}
              </fluent-button>
              <fluent-button
                appearance="outline"
                class="file-upload-dialog-cancel">
                ${this._dialogSecondaryButton}
              </fluent-button>
            </div>
          </fluent-dialog>
        </div>
        <div id="file-upload-border"></div>
        <div class="file-upload-area-button">
          <input
            id="file-upload-input"
            title="${this.strings.uploadButtonLabel}"
            tabindex="-1"
            aria-label="file upload input"
            type="file"
            multiple
            @change="${this.onFileUploadChange}"
          />
          <fluent-button
            appearance="accent"
            class="file-upload-button"
            @click=${this.onFileUploadClick}
            label=${this.strings.uploadButtonLabel}>
              <span slot="start">${getSvg(yP.Upload)}</span>
              <span class="upload-text">${this.strings.buttonUploadFile}</span>
          </fluent-button>
        </div>
        <div class="file-upload-template">
          ${this.renderFolderTemplate(this.filesToUpload)}
        </div>
       `}renderFolderTemplate(t){const o=[];if(t.length>0){const s=t.map((t=>-1===o.indexOf(t.fullPath.substring(0,t.fullPath.lastIndexOf("/")))?t.fullPath.endsWith("/")?AI`${this.renderFileTemplate(t,"")}`:(o.push(t.fullPath.substring(0,t.fullPath.lastIndexOf("/"))),mgtHtml`
            <div class='file-upload-table'>
              <div class='file-upload-cell'>
                <mgt-file
                  .fileDetails=${{name:t.fullPath.substring(1,t.fullPath.lastIndexOf("/")),folder:"Folder"}}
                  .view=${exports.ViewType.oneline}
                  class="mgt-file-item">
                </mgt-file>
              </div>
            </div>
            ${this.renderFileTemplate(t,"file-upload-folder-tab")}`):AI`${this.renderFileTemplate(t,"file-upload-folder-tab")}`));return AI`${s}`}return AI``}renderFileTemplate(t,o){const s=iP({"file-upload-table":!0,upload:t.completed}),l=o+("lastModifiedDateTime"===t.fieldUploadResponse?" file-upload-dialog-success":""),h=iP({description:"description"===t.fieldUploadResponse}),m=t.completed?AI``:this.renderFileUploadTemplate(t);return mgtHtml`
        <div class="${s}">
          <div class="${l}">
            <div class='file-upload-cell'>
              <div class="${h}">
                <div class="file-upload-status">
                  ${t.iconStatus}
                </div>
                <mgt-file
                  .fileDetails=${t.driveItem}
                  .view=${t.view}
                  .line2Property=${t.fieldUploadResponse}
                  part="upload"
                  class="mgt-file-item">
                </mgt-file>
              </div>
            </div>
              ${m}
            </div>
          </div>
        </div>`}renderFileUploadTemplate(t){const o=iP({"file-upload-table":!0,upload:t.completed});return AI`
    <div class='file-upload-cell'>
      <div class='file-upload-table file-upload-name'>
        <div class='file-upload-cell'>
          <div
            title="${t.file.name}"
            class='file-upload-filename'>
            ${t.file.name}
          </div>
        </div>
      </div>
      <div class='file-upload-table'>
        <div class='file-upload-cell'>
          <div class="${o}">
            <fluent-progress class="file-upload-bar" value="${t.percent}"></fluent-progress>
            <div class='file-upload-cell percent-indicator'>
              <span>${t.percent}%</span>
              <span
                class="file-upload-cancel"
                @click=${()=>this.deleteFileUploadSession(t)}>
                ${getSvg(yP.Cancel)}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
    `}deleteFileUploadSession(t){return __awaiter$n(this,void 0,void 0,(function*(){try{void 0!==t.uploadUrl?(yield(o=this.fileUploadList.graph,s=t.uploadUrl,__awaiter$p(void 0,void 0,void 0,(function*(){try{yield o.client.api(s).middlewareOptions(prepScopes("files.readwrite")).delete()}catch(t){return null}}))),t.uploadUrl=void 0,t.completed=!0,this.setUploadFail(t,CF.cancelUploadFile)):(t.uploadUrl=void 0,t.completed=!0,this.setUploadFail(t,CF.cancelUploadFile))}catch(o){t.uploadUrl=void 0,t.completed=!0,this.setUploadFail(t,CF.cancelUploadFile)}var o,s}))}readUploadedFiles(t,o){return __awaiter$n(this,void 0,void 0,(function*(){const s=yield this.getFilesFromUploadArea(t);yield this.getSelectedFiles(s),o()}))}getSelectedFiles(t){return __awaiter$n(this,void 0,void 0,(function*(){let o=[];const s=[];this._applyAll=!1,this._applyAllConflictBehavior=null,this._maximumFileSize=!1,this._excludedFileType=!1,this.filesToUpload.forEach((t=>{t.completed?s.push(t):o.push(t)}));for(const s of t){const t=""===s.fullPath?"/"+s.name:s.fullPath;if(0===o.filter((o=>o.fullPath===t)).length){let l=!0;if(void 0!==this.fileUploadList.maxFileSize&&l&&s.size>1024*this.fileUploadList.maxFileSize&&(l=!1,!1===this._maximumFileSize)){const o=yield this.getFileUploadStatus(s,t,"MaxFileSize",this.fileUploadList);null!==o&&1===o[0]&&(this._maximumFileSize=!0)}if(void 0!==this.fileUploadList.excludedFileExtensions&&this.fileUploadList.excludedFileExtensions.length>0&&l&&this.fileUploadList.excludedFileExtensions.filter((t=>s.name.toLowerCase().indexOf(t.toLowerCase())>-1)).length>0&&(l=!1,!1===this._excludedFileType)){const o=yield this.getFileUploadStatus(s,t,"ExcludedFileType",this.fileUploadList);null!==o&&1===o[0]&&(this._excludedFileType=!0)}if(l){const l=yield this.getFileUploadStatus(s,t,"Upload",this.fileUploadList);let h=!1;null!==l&&(-1===l[0]?h=!0:(this._applyAll=Boolean(l[0]),this._applyAllConflictBehavior=l[1]?1:0)),o.push({file:s,driveItem:{name:s.name},fullPath:t,conflictBehavior:null!==l?l[1]?1:0:null,iconStatus:null,percent:1,view:exports.ViewType.image,completed:h,maxSize:this._maxChunkSize,minSize:0})}}}o=o.sort(((t,o)=>t.fullPath.substring(0,t.fullPath.lastIndexOf("/")).localeCompare(o.fullPath.substring(0,o.fullPath.lastIndexOf("/"))))),o.forEach((t=>{if(0!==s.filter((o=>o.fullPath===t.fullPath)).length){const o=s.findIndex((o=>o.fullPath===t.fullPath));s.splice(o,1)}})),o.push(...s),this.filesToUpload=o;const l=this.filesToUpload.map((t=>this.sendFileItemGraph(t)));yield Promise.all(l)}))}getFileUploadStatus(t,o,s,l){const h=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return __awaiter$n(this,void 0,void 0,(function*(){const m=this.renderRoot.querySelector("#file-upload-dialog");switch(s){case"Upload":return null!==(yield(_=this.fileUploadList.graph,E=`${this.getGrapQuery(o)}?$select=id`,__awaiter$p(void 0,void 0,void 0,(function*(){try{return(yield _.api(E).middlewareOptions(prepScopes("files.read")).get())||null}catch(t){}return null}))))?!0===this._applyAll?[this._applyAll,this._applyAllConflictBehavior]:(m.classList.add("visible"),this._dialogTitle=CF.fileReplaceTitle,this._dialogContent=CF.fileReplace.replace("{FileName}",t.name),this._dialogCheckBox=CF.checkApplyAll,this._dialogPrimaryButton=CF.buttonReplace,this._dialogSecondaryButton=CF.buttonKeep,yield h.requestStateUpdate.call(this,!0),new Promise((t=>{const o=this.renderRoot.querySelector(".file-upload-dialog-close"),s=this.renderRoot.querySelector(".file-upload-dialog-ok"),l=this.renderRoot.querySelector(".file-upload-dialog-cancel"),h=this.renderRoot.querySelector("#file-upload-dialog-check");h.checked=!1,h.classList.remove("hide");const onOkDialogClick=()=>{m.classList.remove("visible"),t([h.checked?1:0,1])},onCancelDialogClick=()=>{m.classList.remove("visible"),t([h.checked?1:0,0])},onCloseDialogClick=()=>{m.classList.remove("visible"),t([-1])};s.removeEventListener("click",onOkDialogClick),l.removeEventListener("click",onCancelDialogClick),o.removeEventListener("click",onCloseDialogClick),s.addEventListener("click",onOkDialogClick),l.addEventListener("click",onCancelDialogClick),o.addEventListener("click",onCloseDialogClick)}))):null;case"ExcludedFileType":return m.classList.add("visible"),this._dialogTitle=CF.fileTypeTitle,this._dialogContent=CF.fileType.replace("{FileName}",t.name)+" ("+l.excludedFileExtensions.join(",")+")",this._dialogCheckBox=CF.checkAgain,this._dialogPrimaryButton=CF.buttonOk,this._dialogSecondaryButton=CF.buttonCancel,yield h.requestStateUpdate.call(this,!0),new Promise((t=>{const o=this.renderRoot.querySelector(".file-upload-dialog-ok"),s=this.renderRoot.querySelector(".file-upload-dialog-cancel"),l=this.renderRoot.querySelector(".file-upload-dialog-close"),h=this.renderRoot.querySelector("#file-upload-dialog-check");h.checked=!1,h.classList.remove("hide");const onOkDialogClick=()=>{m.classList.remove("visible"),t([h.checked?1:0])},onCancelDialogClick=()=>{m.classList.remove("visible"),t([0])};o.removeEventListener("click",onOkDialogClick),s.removeEventListener("click",onCancelDialogClick),l.removeEventListener("click",onCancelDialogClick),o.addEventListener("click",onOkDialogClick),s.addEventListener("click",onCancelDialogClick),l.addEventListener("click",onCancelDialogClick)}));case"MaxFileSize":return m.classList.add("visible"),this._dialogTitle=CF.maximumFileSizeTitle,this._dialogContent=CF.maximumFileSize.replace("{FileSize}",formatBytes(1024*l.maxFileSize)).replace("{FileName}",t.name)+formatBytes(t.size)+".",this._dialogCheckBox=CF.checkAgain,this._dialogPrimaryButton=CF.buttonOk,this._dialogSecondaryButton=CF.buttonCancel,yield h.requestStateUpdate.call(this,!0),new Promise((t=>{const o=this.renderRoot.querySelector(".file-upload-dialog-ok"),s=this.renderRoot.querySelector(".file-upload-dialog-cancel"),l=this.renderRoot.querySelector(".file-upload-dialog-close"),h=this.renderRoot.querySelector("#file-upload-dialog-check");h.checked=!1,h.classList.remove("hide");const onOkDialogClick=()=>{m.classList.remove("visible"),t([h.checked?1:0])},onCancelDialogClick=()=>{m.classList.remove("visible"),t([0])};o.removeEventListener("click",onOkDialogClick),s.removeEventListener("click",onCancelDialogClick),l.removeEventListener("click",onCancelDialogClick),o.addEventListener("click",onOkDialogClick),s.addEventListener("click",onCancelDialogClick),l.addEventListener("click",onCancelDialogClick)}))}var _,E}))}getGrapQuery(t){let o="";return this.fileUploadList.itemPath&&this.fileUploadList.itemPath.length>0&&(o=this.fileUploadList.itemPath.startsWith("/")?this.fileUploadList.itemPath:"/"+this.fileUploadList.itemPath),this.fileUploadList.userId&&this.fileUploadList.itemId?`/users/${this.fileUploadList.userId}/drive/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.userId&&this.fileUploadList.itemPath?`/users/${this.fileUploadList.userId}/drive/root:${o}${t}`:this.fileUploadList.groupId&&this.fileUploadList.itemId?`/groups/${this.fileUploadList.groupId}/drive/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.groupId&&this.fileUploadList.itemPath?`/groups/${this.fileUploadList.groupId}/drive/root:${o}${t}`:this.fileUploadList.driveId&&this.fileUploadList.itemId?`/drives/${this.fileUploadList.driveId}/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.driveId&&this.fileUploadList.itemPath?`/drives/${this.fileUploadList.driveId}/root:${o}${t}`:this.fileUploadList.siteId&&this.fileUploadList.itemId?`/sites/${this.fileUploadList.siteId}/drive/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.siteId&&this.fileUploadList.itemPath?`/sites/${this.fileUploadList.siteId}/drive/root:${o}${t}`:this.fileUploadList.itemId?`/me/drive/items/${this.fileUploadList.itemId}:${t}`:this.fileUploadList.itemPath?`/me/drive/root:${o}${t}`:`/me/drive/root:${t}`}sendFileItemGraph(t){return __awaiter$n(this,void 0,void 0,(function*(){const o=this.fileUploadList.graph;let s="";if(t.file.size<this._maxChunkSize)try{t.completed||(null!==t.conflictBehavior&&1!==t.conflictBehavior||(s=`${this.getGrapQuery(t.fullPath)}:/content`),0===t.conflictBehavior&&(s=`${this.getGrapQuery(t.fullPath)}:/content?@microsoft.graph.conflictBehavior=rename`),t.driveItem=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){try{const l="files.readwrite";let h;try{h=yield t.client.api(o).middlewareOptions(prepScopes(l)).put(s)}catch(t){}return h||null}catch(t){return null}})))(o,s,t.file),null!==t.driveItem?this.setUploadSuccess(t):(t.driveItem={name:t.file.name},this.setUploadFail(t,CF.failUploadFile)))}catch(o){this.setUploadFail(t,CF.failUploadFile)}else if(!t.completed&&void 0===t.uploadUrl){const s=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){try{const l="files.readwrite",h={item:{"@microsoft.graph.conflictBehavior":0===s||null===s?"rename":"replace"}};let m;try{m=yield t.api(o).middlewareOptions(prepScopes(l)).post(JSON.stringify(h))}catch(t){}return m||null}catch(t){return null}})))(o,`${this.getGrapQuery(t.fullPath)}:/createUploadSession`,t.conflictBehavior);try{if(null!==s){t.uploadUrl=s.uploadUrl;const l=yield this.sendSessionUrlGraph(o,t);null!==l?(t.driveItem=l,this.setUploadSuccess(t)):this.setUploadFail(t,CF.failUploadFile)}else this.setUploadFail(t,CF.failUploadFile)}catch(t){}}}))}sendSessionUrlGraph(t,o){const s=Object.create(null,{requestStateUpdate:{get:()=>super.requestStateUpdate}});return __awaiter$n(this,void 0,void 0,(function*(){for(;o.file.size>o.minSize;){void 0===o.mimeStreamString&&(o.mimeStreamString=yield this.readFileContent(o.file));const h=new Blob([o.mimeStreamString.slice(o.minSize,o.maxSize)]);if(o.percent=Math.round(o.maxSize/o.file.size*100),yield s.requestStateUpdate.call(this,!0),void 0===o.uploadUrl)return null;{const s=yield sendFileChunk(t,o.uploadUrl,""+(o.maxSize-o.minSize),`bytes ${o.minSize}-${o.maxSize-1}/${o.file.size}`,h);if(null===s)return null;if(l=s,Array.isArray(l.nextExpectedRanges))o.minSize=parseInt(s.nextExpectedRanges[0].split("-")[0],10),o.maxSize=o.minSize+this._maxChunkSize,o.maxSize>o.file.size&&(o.maxSize=o.file.size);else if(void 0!==s.id)return s}}var l}))}setUploadSuccess(t){t.percent=100,super.requestStateUpdate(!0),setTimeout((()=>{t.iconStatus=getSvg(yP.Success),t.view=exports.ViewType.twolines,t.fieldUploadResponse="lastModifiedDateTime",t.completed=!0,super.requestStateUpdate(!0),clearFilesCache()}),500)}setUploadFail(t,o){setTimeout((()=>{t.iconStatus=getSvg(yP.Fail),t.view=exports.ViewType.twolines,t.driveItem.description=o,t.fieldUploadResponse="description",t.completed=!0,super.requestStateUpdate(!0)}),500)}readFileContent(t){return new Promise(((o,s)=>{const l=new FileReader;l.onloadend=()=>{o(l.result)},l.onerror=t=>{s(t)},l.readAsArrayBuffer(t)}))}getFilesFromUploadArea(t){return __awaiter$n(this,void 0,void 0,(function*(){const o=[];let s;const l=[];for(const m of t)if("getAsFile"in(h=m)&&"function"==typeof h.getAsFile||"webkitGetAsEntry"in h&&"function"==typeof h.webkitGetAsEntry)if(isFutureDataTransferItem(m))if(s=m.getAsEntry(),isFileSystemDirectoryEntry(s))o.push(s);else{const t=m.getAsFile();t&&(this.writeFilePath(t,""),l.push(t))}else if(m.webkitGetAsEntry)if(s=m.webkitGetAsEntry(),isFileSystemDirectoryEntry(s))o.push(s);else{const t=m.getAsFile();t&&(this.writeFilePath(t,""),l.push(t))}else{const t=m.getAsFile();t&&(this.writeFilePath(t,""),l.push(t))}else this.writeFilePath(m,""),l.push(m);var h;if(o.length>0){const t=yield this.getFolderFiles(o);l.push(...t)}return l}))}getFolderFiles(t){return new Promise((o=>{let s=0;const l=[];t.forEach((t=>{readEntry(t,"")}));const readEntry=(t,h)=>{isFileSystemDirectoryEntry(t)?readReaderContent(t.createReader()):(t=>t.isFile)(t)&&(s++,t.file((t=>{s--,this.writeFilePath(t,h),l.push(t),0===s&&o(l)})))},readReaderContent=t=>{s++,t.readEntries((t=>{s--;for(const o of t)readEntry(o,o.fullPath);0===s&&o(l)}))}}))}writeFilePath(t,o){t.fullPath=o}};__decorate$p([n$1({type:Object}),__metadata$o("design:type",Array)],_F.prototype,"filesToUpload",void 0),__decorate$p([n$1({type:Object}),__metadata$o("design:type",Object)],_F.prototype,"fileUploadList",void 0),_F=__decorate$p([customElement("file-upload"),__metadata$o("design:paramtypes",[])],_F);const kF=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{font-size:var(--default-font-size)}:host .title{font-size:14px;font-weight:600;padding:20px 0 12px;line-height:19px}:host .file-list-wrapper{background-color:var(--file-list-background-color,var(--neutral-layer-floating));border:var(--file-list-border,none);position:relative;display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .title{font-size:14px;font-weight:600;margin:0 20px -15px}:host .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item{cursor:pointer;border-radius:var(--file-border-radius)}:host .file-list-wrapper .file-list .file-item:focus,:host .file-list-wrapper .file-list .file-item:focus-within{--file-background-color:var(--file-background-color-focus, var(--neutral-layer-2))}:host .file-list-wrapper .file-list .file-item.selected{--file-background-color:var(--file-background-color-active, var(--neutral-layer-3))}:host .file-list-wrapper .file-list .file-item .mgt-file-item{--file-padding:10px 20px 10px 20px;--file-padding-inline-start:24px;--file-border-radius:2px;--file-background-color:var(--file-item-background-color, var(--neutral-layer-1))}:host .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,0);border-radius:0 0 var(--show-more-button-border-bottom-right-radius,var(--file-list-border-radius,8px)) var(--show-more-button-border-bottom-left-radius,var(--file-list-border-radius,8px));background-color:var(--show-more-button-background-color,var(--neutral-stroke-divider-rest))}:host .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color-hover,var(--neutral-fill-input-alt-active))}:host .file-list-wrapper .show-more-text{font-size:var(--show-more-button-font-size,12px)}
`],xF={showMoreSubtitle:"Show more items",filesSectionTitle:"Files",sharedTextSubtitle:"Shared"};var __decorate$o=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$n=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$m=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(KL),exports.MgtFileList=class MgtFileList extends MgtTemplatedComponent{static get styles(){return kF}get strings(){return xF}get fileListQuery(){return this._fileListQuery}set fileListQuery(t){t!==this._fileListQuery&&(this._fileListQuery=t,this.requestStateUpdate(!0))}get displayName(){return this.strings.filesSectionTitle}get cardTitle(){return this.strings.filesSectionTitle}renderIcon(){return getSvg(yP.Files)}get fileQueries(){return this._fileQueries}set fileQueries(t){arraysAreEqual(this._fileQueries,t)||(this._fileQueries=t,this.requestStateUpdate(!0))}get siteId(){return this._siteId}set siteId(t){t!==this._siteId&&(this._siteId=t,this.requestStateUpdate(!0))}get driveId(){return this._driveId}set driveId(t){t!==this._driveId&&(this._driveId=t,this.requestStateUpdate(!0))}get groupId(){return this._groupId}set groupId(t){t!==this._groupId&&(this._groupId=t,this.requestStateUpdate(!0))}get itemId(){return this._itemId}set itemId(t){t!==this._itemId&&(this._itemId=t,this.requestStateUpdate(!0))}get itemPath(){return this._itemPath}set itemPath(t){t!==this._itemPath&&(this._itemPath=t,this.requestStateUpdate(!0))}get userId(){return this._userId}set userId(t){t!==this._userId&&(this._userId=t,this.requestStateUpdate(!0))}get insightType(){return this._insightType}set insightType(t){t!==this._insightType&&(this._insightType=t,this.requestStateUpdate(!0))}get fileExtensions(){return this._fileExtensions}set fileExtensions(t){arraysAreEqual(this._fileExtensions,t)||(this._fileExtensions=t,this.requestStateUpdate(!0))}get pageSize(){return this._pageSize}set pageSize(t){t!==this._pageSize&&(this._pageSize=t,this.requestStateUpdate(!0))}get maxFileSize(){return this._maxFileSize}set maxFileSize(t){t!==this._maxFileSize&&(this._maxFileSize=t,this.requestStateUpdate(!0))}get maxUploadFile(){return this._maxUploadFile}set maxUploadFile(t){t!==this._maxUploadFile&&(this._maxUploadFile=t,this.requestStateUpdate(!0))}get excludedFileExtensions(){return this._excludedFileExtensions}set excludedFileExtensions(t){arraysAreEqual(this._excludedFileExtensions,t)||(this._excludedFileExtensions=t,this.requestStateUpdate(!0))}static get requiredScopes(){return[...new Set([...exports.MgtFile.requiredScopes])]}constructor(){super(),this._isCompact=!1,this.disableOpenOnClick=!1,this._focusedItemIndex=-1,this.onFocusFirstItem=()=>this._focusedItemIndex=0,this.onFileListKeyDown=t=>{const o=this.renderRoot.querySelector(".file-list");let s;if(null==o?void 0:o.children.length){if("ArrowUp"!==t.code&&"ArrowDown"!==t.code||("ArrowUp"===t.code&&(-1===this._focusedItemIndex&&(this._focusedItemIndex=o.children.length),this._focusedItemIndex=(this._focusedItemIndex-1+o.children.length)%o.children.length),"ArrowDown"===t.code&&(this._focusedItemIndex=(this._focusedItemIndex+1)%o.children.length),s=o.children[this._focusedItemIndex],this.updateItemBackgroundColor(o,s,"focused")),"Enter"===t.code||"Space"===t.code){s=o.children[this._focusedItemIndex];const l=s.children[0];t.preventDefault(),this.fireCustomEvent("itemClick",l.fileDetails),this.handleFileClick(l.fileDetails),this.updateItemBackgroundColor(o,s,"selected")}"Tab"===t.code&&(s=o.children[this._focusedItemIndex])}},this.pageSize=10,this.itemView=exports.ViewType.twolines,this.maxUploadFile=10,this.enableFileUpload=!1,this._preloadedFiles=[]}requestStateUpdate(t){return this.clearState(),super.requestStateUpdate(t)}clearState(){super.clearState(),this.files=null}asCompactView(){return this._isCompact=!0,this}asFullView(){return this._isCompact=!1,this}render(){return!this.files&&this.isLoadingState?this.renderLoading():this.files&&0!==this.files.length?this._isCompact?this.renderCompactView():this.renderFullView():this.renderNoData()}renderCompactView(){const t=this.files.slice(0,3);return this.renderFiles(t)}renderFullView(){return this.renderTemplate("default",{files:this.files})||this.renderFiles(this.files)}renderLoading(){return this.renderTemplate("loading",null)||AI``}renderNoData(){return this.renderTemplate("no-data",null)||(!0===this.enableFileUpload&&void 0!==Providers.globalProvider?AI`
            <div class="file-list-wrapper" dir=${this.direction}>
              ${this.renderFileUpload()}
            </div>`:AI``)}renderFiles(t){return AI`
      <div id="file-list-wrapper" class="file-list-wrapper" dir=${this.direction}>
        ${this.enableFileUpload?this.renderFileUpload():null}
        <ul
          id="file-list"
          class="file-list"
        >
          <li
            tabindex="0"
            class="file-item"
            @keydown="${this.onFileListKeyDown}"
            @focus="${this.onFocusFirstItem}"
            @click=${o=>this.handleItemSelect(t[0],o)}>
            ${this.renderFile(t[0])}
          </li>
          ${RP(t.slice(1),(t=>t.id),(t=>AI`
              <li
                class="file-item"
                @keydown="${this.onFileListKeyDown}"
                @click=${o=>this.handleItemSelect(t,o)}>
                ${this.renderFile(t)}
              </li>
            `))}
        </ul>
        ${this.hideMoreFilesButton||!this.pageIterator||!this.pageIterator.hasNext&&!this._preloadedFiles.length||this._isCompact?null:this.renderMoreFileButton()}
      </div>
    `}renderFile(t){const o=this.itemView;return this.renderTemplate("file",{file:t},t.id)||mgtHtml`
        <mgt-file class="mgt-file-item" .fileDetails=${t} .view=${o}></mgt-file>
      `}renderMoreFileButton(){return this._isLoadingMore?AI`
        <fluent-progress-ring role="progressbar" viewBox="0 0 8 8" class="progress-ring"></fluent-progress-ring>
      `:AI`
        <fluent-button
          appearance="stealth"
          id="show-more"
          class="show-more"
          @click=${()=>this.renderNextPage()}
        >
          <span class="show-more-text">${this.strings.showMoreSubtitle}</span>
        </fluent-button>`}renderFileUpload(){const t={graph:Providers.globalProvider.graph.forComponent(this),driveId:this.driveId,excludedFileExtensions:this.excludedFileExtensions,groupId:this.groupId,itemId:this.itemId,itemPath:this.itemPath,userId:this.userId,siteId:this.siteId,maxFileSize:this.maxFileSize,maxUploadFile:this.maxUploadFile};return mgtHtml`
        <mgt-file-upload .fileUploadList=${t} ></mgt-file-upload>
      `}loadState(){var t;return __awaiter$m(this,void 0,void 0,(function*(){const o=Providers.globalProvider;if(!o||o.state===exports.ProviderState.Loading)return;if(o.state===exports.ProviderState.SignedOut)return void(this.files=null);const s=o.graph.forComponent(this);let l,h;const m=!(this.driveId||this.siteId||this.groupId||this.userId);if((this.driveId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.userId&&!this.insightType&&!this.itemId&&!this.itemPath)&&(this.files=null),!this.files){let o;if(this.fileListQuery?h=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){const l=fP.stores.fileLists;return getIterator(t,o,l,["files.read","sites.read.all"],s)})))(s,this.fileListQuery,this.pageSize):this.fileQueries?l=yield((t,o)=>__awaiter$p(void 0,void 0,void 0,(function*(){if(!o||0===o.length)return[];const s=t.createBatch(),l=[],h=["files.read"];let m,_;getIsFilesCacheEnabled()&&(m=CacheService.getCache(pP,pP.stores.fileQueries));for(const t of o)getIsFilesCacheEnabled()&&(_=yield m.getValue(t)),getIsFilesCacheEnabled()&&_&&getFileInvalidationTime()>Date.now()-_.timeCached?l.push(JSON.parse(_.file)):""!==t&&s.get(t,t,h);try{const t=yield s.executeAll();for(const s of o){const o=t.get(s);(null==o?void 0:o.content)&&(l.push(o.content),getIsFilesCacheEnabled()&&(yield m.putValue(s,{file:JSON.stringify(o.content)})))}return l}catch(s){try{return Promise.all(o.filter((t=>t&&""!==t)).map((o=>__awaiter$p(void 0,void 0,void 0,(function*(){const s=yield getDriveItemByQuery(t,o);if(s)return getIsFilesCacheEnabled()&&(yield m.putValue(o,{file:JSON.stringify(s)})),s})))))}catch(t){return[]}}})))(s,this.fileQueries):m?this.itemId?h=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){const l=`/me/drive/items/${o}/children`,h=fP.stores.fileLists;return getIterator(t,l,h,["files.read"],s)})))(s,this.itemId,this.pageSize):this.itemPath?h=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){const l=`/me/drive/root:/${o}:/children`,h=fP.stores.fileLists;return getIterator(t,l,h,["files.read"],s)})))(s,this.itemPath,this.pageSize):this.insightType?l=yield((t,o)=>__awaiter$p(void 0,void 0,void 0,(function*(){const s=`/me/insights/${o}`,l=fP.stores.insightfileLists,h=CacheService.getCache(fP,l),m=yield getFileListFromCache(h,l,s);if(m)return m.files.map((t=>JSON.parse(t)));const _=["sites.read.all"];let E;try{E=yield t.api(s).filter("resourceReference/type eq 'microsoft.graph.driveItem'").middlewareOptions(prepScopes(..._)).get()}catch(t){}const $=yield getDriveItemsByInsights(t,E,_);return getIsFileListsCacheEnabled()&&(yield h.putValue(s,{files:$.map((t=>JSON.stringify(t)))})),$||null})))(s,this.insightType):h=yield((t,o)=>__awaiter$p(void 0,void 0,void 0,(function*(){const s=fP.stores.fileLists;return getIterator(t,"/me/drive/root/children",s,["files.read"],o)})))(s,this.pageSize):this.driveId?this.itemId?h=yield((t,o,s,l)=>__awaiter$p(void 0,void 0,void 0,(function*(){const h=`/drives/${o}/items/${s}/children`,m=fP.stores.fileLists;return getIterator(t,h,m,["files.read"],l)})))(s,this.driveId,this.itemId,this.pageSize):this.itemPath&&(h=yield((t,o,s,l)=>__awaiter$p(void 0,void 0,void 0,(function*(){const h=`/drives/${o}/root:/${s}:/children`,m=fP.stores.fileLists;return getIterator(t,h,m,["files.read"],l)})))(s,this.driveId,this.itemPath,this.pageSize)):this.groupId?this.itemId?h=yield((t,o,s,l)=>__awaiter$p(void 0,void 0,void 0,(function*(){const h=`/groups/${o}/drive/items/${s}/children`,m=fP.stores.fileLists;return getIterator(t,h,m,["files.read"],l)})))(s,this.groupId,this.itemId,this.pageSize):this.itemPath&&(h=yield((t,o,s,l)=>__awaiter$p(void 0,void 0,void 0,(function*(){const h=`/groups/${o}/drive/root:/${s}:/children`,m=fP.stores.fileLists;return getIterator(t,h,m,["files.read"],l)})))(s,this.groupId,this.itemPath,this.pageSize)):this.siteId?this.itemId?h=yield((t,o,s,l)=>__awaiter$p(void 0,void 0,void 0,(function*(){const h=`/sites/${o}/drive/items/${s}/children`,m=fP.stores.fileLists;return getIterator(t,h,m,["files.read"],l)})))(s,this.siteId,this.itemId,this.pageSize):this.itemPath&&(h=yield((t,o,s,l)=>__awaiter$p(void 0,void 0,void 0,(function*(){const h=`/sites/${o}/drive/root:/${s}:/children`,m=fP.stores.fileLists;return getIterator(t,h,m,["files.read"],l)})))(s,this.siteId,this.itemPath,this.pageSize)):this.userId&&(this.itemId?h=yield((t,o,s,l)=>__awaiter$p(void 0,void 0,void 0,(function*(){const h=`/users/${o}/drive/items/${s}/children`,m=fP.stores.fileLists;return getIterator(t,h,m,["files.read"],l)})))(s,this.userId,this.itemId,this.pageSize):this.itemPath?h=yield((t,o,s,l)=>__awaiter$p(void 0,void 0,void 0,(function*(){const h=`/users/${o}/drive/root:/${s}:/children`,m=fP.stores.fileLists;return getIterator(t,h,m,["files.read"],l)})))(s,this.userId,this.itemPath,this.pageSize):this.insightType&&(l=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){let l,h;"shared"===s?(l="/me/insights/shared",h=`((lastshared/sharedby/id eq '${o}') and (resourceReference/type eq 'microsoft.graph.driveItem'))`):(l=`/users/${o}/insights/${s}`,h="resourceReference/type eq 'microsoft.graph.driveItem'");const m=`${l}?$filter=${h}`,_=fP.stores.insightfileLists,E=CacheService.getCache(fP,_),$=yield getFileListFromCache(E,_,m);if($)return $.files.map((t=>JSON.parse(t)));const B=["sites.read.all"];let q;try{q=yield t.api(l).filter(h).middlewareOptions(prepScopes(...B)).get()}catch(t){}const j=yield getDriveItemsByInsights(t,q,B);return getIsFileListsCacheEnabled()&&(yield E.putValue(l,{files:j.map((t=>JSON.stringify(t)))})),j||null})))(s,this.userId,this.insightType))),h&&(this.pageIterator=h,this._preloadedFiles=[...this.pageIterator.value],l=this._preloadedFiles.length>=this.pageSize?this._preloadedFiles.splice(0,this.pageSize):this._preloadedFiles.splice(0,this._preloadedFiles.length)),this.fileExtensions&&null!==this.fileExtensions){if(null===(t=this.pageIterator)||void 0===t?void 0:t.value){for(;this.pageIterator.hasNext;)yield fetchNextAndCacheForFilesPageIterator(this.pageIterator);l=this.pageIterator.value,this._preloadedFiles=[]}o=l.filter((t=>{for(const o of this.fileExtensions)if(o===this.getFileExtension(t.name))return t}))}(null==o?void 0:o.length)>=0?(this.files=o,this.pageSize&&(l=this.files.splice(0,this.pageSize),this.files=l)):this.files=l}}))}handleItemSelect(t,o){if(this.handleFileClick(t),this.fireCustomEvent("itemClick",t),o){const t=this.renderRoot.querySelector(".file-list"),s=Array.from(t.children),l=o.target.closest("li"),h=s.indexOf(l);this._focusedItemIndex=h;const m=t.children[this._focusedItemIndex];this.updateItemBackgroundColor(t,m,"selected")}}renderNextPage(){return __awaiter$m(this,void 0,void 0,(function*(){if(this._preloadedFiles.length>0)this.files=[...this.files,...this._preloadedFiles.splice(0,Math.min(this.pageSize,this._preloadedFiles.length))];else if(this.pageIterator.hasNext){this._isLoadingMore=!0;const t=this.renderRoot.querySelector("#file-list-wrapper");(null==t?void 0:t.animate)&&t.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),yield fetchNextAndCacheForFilesPageIterator(this.pageIterator),this._isLoadingMore=!1,this.files=this.pageIterator.value}this.requestUpdate()}))}handleFileClick(t){(null==t?void 0:t.webUrl)&&!this.disableOpenOnClick&&window.open(t.webUrl,"_blank","noreferrer")}getFileExtension(t){return/(?:\.([^.]+))?$/.exec(t)[1]||""}updateItemBackgroundColor(t,o,s){for(const o of t.children)o.classList.remove(s),o.removeAttribute("tabindex");o&&(o.classList.add(s),o.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),o.setAttribute("tabindex","0"),o.focus());for(const o of t.children)o.classList.remove("selected")}reload(t=!1){t&&clearFilesCache(),this.requestStateUpdate(!0)}},__decorate$o([t$1(),__metadata$n("design:type",Object)],exports.MgtFileList.prototype,"_isCompact",void 0),__decorate$o([n$1({attribute:"file-list-query"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"fileListQuery",null),__decorate$o([n$1({attribute:"file-queries",converter:(t,o)=>t?t.split(",").map((t=>t.trim())):null}),__metadata$n("design:type",Array),__metadata$n("design:paramtypes",[Array])],exports.MgtFileList.prototype,"fileQueries",null),__decorate$o([n$1({type:Object}),__metadata$n("design:type",Array)],exports.MgtFileList.prototype,"files",void 0),__decorate$o([n$1({attribute:"site-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"siteId",null),__decorate$o([n$1({attribute:"drive-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"driveId",null),__decorate$o([n$1({attribute:"group-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"groupId",null),__decorate$o([n$1({attribute:"item-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"itemId",null),__decorate$o([n$1({attribute:"item-path"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"itemPath",null),__decorate$o([n$1({attribute:"user-id"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"userId",null),__decorate$o([n$1({attribute:"insight-type"}),__metadata$n("design:type",String),__metadata$n("design:paramtypes",[String])],exports.MgtFileList.prototype,"insightType",null),__decorate$o([n$1({attribute:"item-view",converter:t=>t&&0!==t.length?(t=t.toLowerCase(),void 0===exports.ViewType[t]?exports.ViewType.threelines:exports.ViewType[t]):exports.ViewType.threelines}),__metadata$n("design:type",Number)],exports.MgtFileList.prototype,"itemView",void 0),__decorate$o([n$1({attribute:"file-extensions",converter:(t,o)=>t.split(",").map((t=>t.trim()))}),__metadata$n("design:type",Array),__metadata$n("design:paramtypes",[Array])],exports.MgtFileList.prototype,"fileExtensions",null),__decorate$o([n$1({attribute:"page-size",type:Number}),__metadata$n("design:type",Number),__metadata$n("design:paramtypes",[Number])],exports.MgtFileList.prototype,"pageSize",null),__decorate$o([n$1({attribute:"disable-open-on-click",type:Boolean}),__metadata$n("design:type",Object)],exports.MgtFileList.prototype,"disableOpenOnClick",void 0),__decorate$o([n$1({attribute:"hide-more-files-button",type:Boolean}),__metadata$n("design:type",Boolean)],exports.MgtFileList.prototype,"hideMoreFilesButton",void 0),__decorate$o([n$1({attribute:"max-file-size",type:Number}),__metadata$n("design:type",Number),__metadata$n("design:paramtypes",[Number])],exports.MgtFileList.prototype,"maxFileSize",null),__decorate$o([n$1({attribute:"enable-file-upload",type:Boolean}),__metadata$n("design:type",Boolean)],exports.MgtFileList.prototype,"enableFileUpload",void 0),__decorate$o([n$1({attribute:"max-upload-file",type:Number}),__metadata$n("design:type",Number),__metadata$n("design:paramtypes",[Number])],exports.MgtFileList.prototype,"maxUploadFile",null),__decorate$o([n$1({attribute:"excluded-file-extensions",converter:(t,o)=>t.split(",").map((t=>t.trim()))}),__metadata$n("design:type",Array),__metadata$n("design:paramtypes",[Array])],exports.MgtFileList.prototype,"excludedFileExtensions",null),__decorate$o([t$1(),__metadata$n("design:type",Boolean)],exports.MgtFileList.prototype,"_isLoadingMore",void 0),exports.MgtFileList=__decorate$o([customElement("file-list"),__metadata$n("design:paramtypes",[])],exports.MgtFileList);const SF={comboboxPlaceholder:"Select an item"},TF=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{--max-height:var(--picker-max-height, 380px);font-family:var(--default-font-family)}:host .picker{background-color:var(--picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--picker-text-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--picker-text-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}
`];var __decorate$n=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$m=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$l=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(BL,jL),exports.MgtPicker=class MgtPicker extends MgtTemplatedComponent{get strings(){return SF}static get styles(){return TF}constructor(){super(),this.version="v1.0",this.maxPages=3,this.scopes=[],this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.handleComboboxKeydown=t=>{let o,s;const l=t.key,h=t.target.querySelector(".selected");h&&(o=h.getAttribute("value")),"Enter"===l&&o&&(s=this.response.filter((t=>t.id===o)).pop(),this.fireCustomEvent("selectionChanged",s,!0,!1,!0))},this.placeholder=this.strings.comboboxPlaceholder,this.entityType=null,this.keyName=null,this.isRefreshing=!1}refresh(t=!1){this.isRefreshing=!0,t&&this.clearState(),this.requestStateUpdate(t)}clearState(){this.response=null,this.error=null}render(){var t;if(this.isLoadingState&&!this.response)return this.renderTemplate("loading",null);if(this.hasTemplate("error")){const t=this.error?this.error:null;return this.renderTemplate("error",{error:t},"error")}return this.hasTemplate("no-data")?this.renderTemplate("no-data",null):(null===(t=this.response)||void 0===t?void 0:t.length)>0?this.renderPicker():this.renderGet()}renderPicker(){return mgtHtml`
      <fluent-combobox
        @keydown=${this.handleComboboxKeydown}
        current-value=${l$1(this.selectedValue)}
        part="picker"
        class="picker"
        id="combobox"
        autocomplete="list"
        placeholder=${this.placeholder}>
          ${this.response.map((t=>AI`
            <fluent-option value=${t.id} @click=${o=>this.handleClick(o,t)}> ${t[this.keyName]} </fluent-option>`))}
      </fluent-combobox>
     `}renderGet(){return mgtHtml`
      <mgt-get
        class="mgt-get"
        resource=${this.resource}
        version=${this.version}
        .scopes=${this.scopes}
        max-pages=${this.maxPages}
        ?cache-enabled=${this.cacheEnabled}
        ?cache-invalidation-period=${this.cacheInvalidationPeriod}>
      </mgt-get>`}loadState(){return __awaiter$l(this,void 0,void 0,(function*(){if(!this.response){const t=this.renderRoot.querySelector(".mgt-get");t?t.addEventListener("dataChange",(t=>this.handleDataChange(t))):console.error("ð¦: mgt-picker component requires a child mgt-get component. Something has gone horribly wrong.")}this.isRefreshing=!1,yield Promise.resolve()}))}handleDataChange(t){const o=t.detail.response.value,s=t.detail.error?t.detail.error:null;this.response=o,this.error=s}handleClick(t,o){this.fireCustomEvent("selectionChanged",o,!0,!1,!0)}},__decorate$n([n$1({attribute:"resource",type:String}),__metadata$m("design:type",String)],exports.MgtPicker.prototype,"resource",void 0),__decorate$n([n$1({attribute:"version",type:String}),__metadata$m("design:type",Object)],exports.MgtPicker.prototype,"version",void 0),__decorate$n([n$1({attribute:"max-pages",type:Number}),__metadata$m("design:type",Object)],exports.MgtPicker.prototype,"maxPages",void 0),__decorate$n([n$1({attribute:"placeholder",type:String}),__metadata$m("design:type",String)],exports.MgtPicker.prototype,"placeholder",void 0),__decorate$n([n$1({attribute:"key-name",type:String}),__metadata$m("design:type",String)],exports.MgtPicker.prototype,"keyName",void 0),__decorate$n([n$1({attribute:"entity-type",type:String}),__metadata$m("design:type",String)],exports.MgtPicker.prototype,"entityType",void 0),__decorate$n([n$1({attribute:"scopes",converter:t=>t?t.toLowerCase().split(","):null}),__metadata$m("design:type",Array)],exports.MgtPicker.prototype,"scopes",void 0),__decorate$n([n$1({attribute:"cache-enabled",type:Boolean}),__metadata$m("design:type",Object)],exports.MgtPicker.prototype,"cacheEnabled",void 0),__decorate$n([n$1({attribute:"cache-invalidation-period",type:Number}),__metadata$m("design:type",Object)],exports.MgtPicker.prototype,"cacheInvalidationPeriod",void 0),__decorate$n([n$1({attribute:"selected-value",type:String}),__metadata$m("design:type",String)],exports.MgtPicker.prototype,"selectedValue",void 0),__decorate$n([t$1(),__metadata$m("design:type",Array)],exports.MgtPicker.prototype,"response",void 0),exports.MgtPicker=__decorate$n([customElement("picker"),__metadata$m("design:paramtypes",[])],exports.MgtPicker);const EF={termsetIdRequired:"The termsetId property or termset-id attribute is required",noTermsFound:"No terms found",comboboxPlaceholder:"Select a term",loadingMessage:"Loading..."},AF=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{--max-height:var(--taxonomy-picker-list-max-height, 380px)}:host .picker{background-color:var(--taxonomy-picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--taxonomy-picker-placeholder-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--taxonomy-picker-placeholder-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}
`];var __decorate$m=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$l=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$k=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(BL,jL),exports.MgtTaxonomyPicker=class MgtTaxonomyPicker extends MgtTemplatedComponent{get strings(){return EF}static get styles(){return AF}get defaultSelectedTermId(){return this._defaultSelectedTermId}set defaultSelectedTermId(t){t!==this._defaultSelectedTermId&&(this._defaultSelectedTermId=t,this.requestStateUpdate(!0))}get selectedTerm(){return this._selectedTerm}set selectedTerm(t){this._selectedTerm=t}constructor(){super(),this.version="beta",this.position="below",this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.placeholder=this.strings.comboboxPlaceholder,this.isRefreshing=!1,this.noTerms=!1}refresh(t=!1){this.isRefreshing=!0,t&&this.clearState(),this.requestStateUpdate(t)}clearState(){this.terms=null,this.error=null,this.noTerms=!1}render(){var t;return this.isLoadingState&&!this.terms?this.renderLoading():this.error?this.renderError():this.noTerms?this.renderNoData():(null===(t=this.terms)||void 0===t?void 0:t.length)>0?this.renderTaxonomyPicker():this.renderGet()}renderLoading(){return this.renderTemplate("loading",null,"loading")||mgtHtml`
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `}renderError(){return this.renderTemplate("error",null,"error")||AI`
              <span>
                ${this.error}
            </span>
          `}renderNoData(){return this.renderTemplate("no-data",null)||AI`
            <span>
              ${this.strings.noTermsFound}
            </span>
          `}renderTaxonomyPicker(){return mgtHtml`
      <fluent-combobox class="taxonomy-picker" autocomplete="both" placeholder=${this.placeholder} position=${this.position} ?disabled=${this.disabled}>
        ${this.terms.map((t=>this.renderTaxonomyPickerItem(t)))}
      </fluent-combobox>
     `}renderTaxonomyPickerItem(t){const o=this.defaultSelectedTermId&&this.defaultSelectedTermId===t.id;return AI`
        <fluent-option value=${t.id} ?selected=${o} @click=${o=>this.handleClick(o,t)}> ${this.renderTemplate("term",{term:t},t.id)||t.labels[0].name} </fluent-option>
        `}renderGet(){if(!this.termsetId)return AI`
            <span>
                ${this.strings.termsetIdRequired}
            </span>
            `;let t=`/termStore/sets/${this.termsetId}/children`;return this.termId&&(t=`/termStore/sets/${this.termsetId}/terms/${this.termId}/children`),this.siteId&&(t=`/sites/${this.siteId}${t}`),t+="?$select=id,labels,descriptions,properties",mgtHtml`
      <mgt-get
        class="mgt-get"
        resource=${t}
        version=${this.version}
        scopes=${["TermStore.Read.All"]}
        ?cache-enabled=${this.cacheEnabled}
        ?cache-invalidation-period=${this.cacheInvalidationPeriod}>
      </mgt-get>`}loadState(){return __awaiter$k(this,void 0,void 0,(function*(){if(!this.terms){this.renderRoot.querySelector(".mgt-get").addEventListener("dataChange",(t=>this.handleDataChange(t)))}this.isRefreshing=!1,yield Promise.resolve()}))}handleDataChange(t){const o=t.detail.error?t.detail.error:null;if(o)return void(this.error=o);this.locale&&(this.locale=this.locale.toLowerCase());const s=t.detail.response.value.map((t=>{const o=t.labels;if(o&&o.length>0&&this.locale){const s=o.find((t=>t.languageTag.toLowerCase()===this.locale));s&&(t.labels=[s,...o.filter((t=>t.languageTag.toLowerCase()!==this.locale))])}return t}));this.terms=s,0===s.length&&(this.noTerms=!0)}handleClick(t,o){this.selectedTerm=o,this.fireCustomEvent("selectionChanged",o)}},__decorate$m([n$1({attribute:"term-set-id",type:String}),__metadata$l("design:type",String)],exports.MgtTaxonomyPicker.prototype,"termsetId",void 0),__decorate$m([n$1({attribute:"term-id",type:String}),__metadata$l("design:type",String)],exports.MgtTaxonomyPicker.prototype,"termId",void 0),__decorate$m([n$1({attribute:"site-id",type:String}),__metadata$l("design:type",String)],exports.MgtTaxonomyPicker.prototype,"siteId",void 0),__decorate$m([n$1({attribute:"locale",type:String}),__metadata$l("design:type",String)],exports.MgtTaxonomyPicker.prototype,"locale",void 0),__decorate$m([n$1({attribute:"version",type:String}),__metadata$l("design:type",Object)],exports.MgtTaxonomyPicker.prototype,"version",void 0),__decorate$m([n$1({attribute:"placeholder",type:String}),__metadata$l("design:type",String)],exports.MgtTaxonomyPicker.prototype,"placeholder",void 0),__decorate$m([n$1({attribute:"position",type:String,converter:t=>"above"===t?"above":"below"}),__metadata$l("design:type",String)],exports.MgtTaxonomyPicker.prototype,"position",void 0),__decorate$m([n$1({attribute:"default-selected-term-id",type:String}),__metadata$l("design:type",String),__metadata$l("design:paramtypes",[String])],exports.MgtTaxonomyPicker.prototype,"defaultSelectedTermId",null),__decorate$m([n$1({attribute:"selected-term",type:Object}),__metadata$l("design:type",Object),__metadata$l("design:paramtypes",[Object])],exports.MgtTaxonomyPicker.prototype,"selectedTerm",null),__decorate$m([n$1({attribute:"disabled",type:Boolean}),__metadata$l("design:type",Boolean)],exports.MgtTaxonomyPicker.prototype,"disabled",void 0),__decorate$m([n$1({attribute:"cache-enabled",type:Boolean}),__metadata$l("design:type",Object)],exports.MgtTaxonomyPicker.prototype,"cacheEnabled",void 0),__decorate$m([n$1({attribute:"cache-invalidation-period",type:Number}),__metadata$l("design:type",Object)],exports.MgtTaxonomyPicker.prototype,"cacheInvalidationPeriod",void 0),__decorate$m([t$1(),__metadata$l("design:type",Array)],exports.MgtTaxonomyPicker.prototype,"terms",void 0),__decorate$m([t$1(),__metadata$l("design:type",Boolean)],exports.MgtTaxonomyPicker.prototype,"noTerms",void 0),exports.MgtTaxonomyPicker=__decorate$m([customElement("taxonomy-picker"),__metadata$l("design:paramtypes",[])],exports.MgtTaxonomyPicker);var __decorate$l=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$k=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$j=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const isCollectionResponse=t=>Array.isArray(null==t?void 0:t.value);exports.ResponseType=void 0,function(t){t.json="json",t.image="image"}(exports.ResponseType||(exports.ResponseType={}));const getIsResponseCacheEnabled=()=>CacheService.config.response.isEnabled&&CacheService.config.isEnabled;exports.MgtGet=class MgtGet extends MgtTemplatedComponent{constructor(){super(...arguments),this.scopes=[],this.version="v1.0",this.type=exports.ResponseType.json,this.maxPages=3,this.pollingRate=0,this.cacheEnabled=!1,this.cacheInvalidationPeriod=0,this.isPolling=!1,this.isRefreshing=!1}attributeChangedCallback(t,o,s){super.attributeChangedCallback(t,o,s),this.requestStateUpdate()}refresh(t=!1){this.isRefreshing=!0,t&&this.clearState(),this.requestStateUpdate(t)}clearState(){this.response=null}render(){if(this.isLoadingState&&!this.response)return this.renderTemplate("loading",null);if(this.error)return this.renderTemplate("error",this.error);if(this.hasTemplate("value")&&isCollectionResponse(this.response)){let t;if(isCollectionResponse(this.response)){let o=null;this.isLoadingState&&!this.isPolling&&(o=this.renderTemplate("loading",null)),t=AI`
          ${this.response.value.map((t=>this.renderTemplate("value",t,t.id)))} ${o}
        `}else t=this.renderTemplate("value",this.response);if(this.hasTemplate("default")){const o=this.renderTemplate("default",this.response);return this.templates.value.templateOrder>this.templates.default.templateOrder?AI`
            ${o}${t}
          `:AI`
            ${t}${o}
          `}return t}return this.response?this.renderTemplate("default",this.response)||AI``:this.hasTemplate("no-data")?this.renderTemplate("no-data",null):AI``}loadState(){var t,o,s;return __awaiter$j(this,void 0,void 0,(function*(){const l=Providers.globalProvider;if(this.error=null,l&&l.state===exports.ProviderState.SignedIn){if(this.resource){try{let h;const m=`${this.version}${this.resource}`;let _=null;if(this.shouldRetrieveCache()){h=CacheService.getCache(uP,uP.stores.responses);const t=getIsResponseCacheEnabled()?yield h.getValue(m):null;t&&(this.cacheInvalidationPeriod||CacheService.config.response.invalidationPeriod||CacheService.config.defaultInvalidationPeriod)>Date.now()-t.timeCached&&(_=JSON.parse(t.response))}if(!_){let E=this.resource,$=!1;(null===(t=this.response)||void 0===t?void 0:t["@odata.deltaLink"])?(E=this.response["@odata.deltaLink"],$=!0):$=new URL(E,"https://graph.microsoft.com").pathname.endsWith("delta");const B=l.graph.forComponent(this);let q=B.api(E).version(this.version);if((null===(o=this.scopes)||void 0===o?void 0:o.length)&&(q=q.middlewareOptions(prepScopes(...this.scopes))),this.type===exports.ResponseType.json){if(_=yield q.get(),$&&isCollectionResponse(this.response)&&isCollectionResponse(_)){const t=_.value;_.value=this.response.value.concat(t)}if(this.isPolling||equals(this.response,_)||(this.response=_),isCollectionResponse(_)&&_["@odata.nextLink"]){let t=1,o=_;for(;(t<this.maxPages||this.maxPages<=0||$&&this.pollingRate)&&(null==o?void 0:o["@odata.nextLink"]);){t++;const l=o["@odata.nextLink"].split(this.version)[1];o=yield B.client.api(l).version(this.version).get(),(null===(s=null==o?void 0:o.value)||void 0===s?void 0:s.length)&&(o.value=_.value.concat(o.value),_=o,this.isPolling||(this.response=_))}}}else{if(-1===this.resource.indexOf("/photo/$value")&&-1===this.resource.indexOf("/thumbnails/"))throw new Error("Only /photo/$value and /thumbnails/ endpoints support the image type");let t;if(this.resource.indexOf("/photo/$value")>-1){const o=this.resource.replace("/photo/$value",""),s=yield getPhotoForResource(B,o,this.scopes);s&&(t=s.photo)}else if(this.resource.indexOf("/thumbnails/")>-1){const o=yield((t,o,s)=>__awaiter$p(void 0,void 0,void 0,(function*(){try{const l=yield t.api(o).responseType(qA.RAW).middlewareOptions(prepScopes(...s)).get();if(404===l.status)return{eTag:null,thumbnail:null};if(!l.ok)return null;return{eTag:l.headers.get("eTag"),thumbnail:yield blobToBase64(yield l.blob())}}catch(t){return null}})))(B,this.resource,this.scopes);o&&(t=o.thumbnail)}t&&(_={image:t})}this.shouldUpdateCache()&&_&&(h=CacheService.getCache(uP,uP.stores.responses),yield h.putValue(m,{response:JSON.stringify(_)}))}equals(this.response,_)||(this.response=_)}catch(t){this.error=t}this.response&&(this.error=null,this.pollingRate&&setTimeout((()=>{this.isPolling=!0,this.loadState().finally((()=>{this.isPolling=!1}))}),this.pollingRate))}else this.response=null;this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error})}}))}shouldRetrieveCache(){return getIsResponseCacheEnabled()&&this.cacheEnabled&&!(this.isRefreshing||this.isPolling)}shouldUpdateCache(){return getIsResponseCacheEnabled()&&this.cacheEnabled}},__decorate$l([n$1({attribute:"resource",reflect:!0,type:String}),__metadata$k("design:type",String)],exports.MgtGet.prototype,"resource",void 0),__decorate$l([n$1({attribute:"scopes",converter:(t,o)=>t?t.toLowerCase().split(","):null,reflect:!0}),__metadata$k("design:type",Array)],exports.MgtGet.prototype,"scopes",void 0),__decorate$l([n$1({attribute:"version",reflect:!0,type:String}),__metadata$k("design:type",Object)],exports.MgtGet.prototype,"version",void 0),__decorate$l([n$1({attribute:"type",reflect:!0,type:exports.ResponseType}),__metadata$k("design:type",String)],exports.MgtGet.prototype,"type",void 0),__decorate$l([n$1({attribute:"max-pages",reflect:!0,type:Number}),__metadata$k("design:type",Object)],exports.MgtGet.prototype,"maxPages",void 0),__decorate$l([n$1({attribute:"polling-rate",reflect:!0,type:Number}),__metadata$k("design:type",Object)],exports.MgtGet.prototype,"pollingRate",void 0),__decorate$l([n$1({attribute:"cache-enabled",reflect:!0,type:Boolean}),__metadata$k("design:type",Object)],exports.MgtGet.prototype,"cacheEnabled",void 0),__decorate$l([n$1({attribute:"cache-invalidation-period",type:Number}),__metadata$k("design:type",Object)],exports.MgtGet.prototype,"cacheInvalidationPeriod",void 0),__decorate$l([n$1({attribute:!1}),__metadata$k("design:type",Object)],exports.MgtGet.prototype,"response",void 0),__decorate$l([n$1({attribute:!1}),__metadata$k("design:type",Object)],exports.MgtGet.prototype,"error",void 0),exports.MgtGet=__decorate$l([customElement("get")],exports.MgtGet);const IF=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .signed-in-person{--person-background-color:$signed-in-background-color;padding:var(--login-button-padding,10px 16px)}:host .account{padding:0;margin:7px 0}:host fluent-button.signed-in{height:auto;min-width:auto}:host fluent-button.signed-in::part(control){width:100%;height:100%;padding:var(--login-button-padding,0);background:var(--login-signed-in-background,transparent);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-button.signed-in::part(control):focus-within,:host fluent-button.signed-in::part(control):hover{background:var(--login-signed-in-hover-background,var(--neutral-fill-stealth-hover));--secondary-text-color:var(--secondary-text-hover-color)}:host fluent-button.signed-out::part(control){color:var(--login-signed-out-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-signed-out-button-background,padding-box linear-gradient(var(--neutral-fill-rest),var(--neutral-fill-rest)),border-box var(--neutral-stroke-control-rest))}:host fluent-button.signed-out::part(control):focus-within,:host fluent-button.signed-out::part(control):hover{background:var(--login-signed-out-button-hover-background,var(--neutral-fill-stealth-hover))}:host fluent-button.small::part(control):hover{background:0 0}:host fluent-button:focus-visible{outline-style:var(--focus-ring-style,auto)}:host fluent-card{--fill-color:var(--login-popup-background-color, var(--neutral-layer-1));padding:var(--login-popup-padding,16px)}:host .login-root .small .signed-in-person{padding:0;background:0 0}:host .login-root .small .signed-in-person:focus-within,:host .login-root .small .signed-in-person:hover{background:0 0}:host .login-root .account-list{padding:calc(var(--design-unit) * 1px) 0;margin:0}:host .login-root .account-item{height:auto;min-width:auto;margin-top:4px;background:var(--login-popup-background-color,var(--neutral-layer-1));list-style-type:none;cursor:pointer}:host .login-root .account-item:hover{background:var(--login-account-item-hover-bg-color,var(--neutral-fill-stealth-hover));--person-background-color:$login-account-item-hover-bg-color}:host .login-root .flyout .flyout-command{color:var(--login-flyout-command-text-color,var(--accent-foreground-rest))}:host .login-root .flyout .popup-content .commands{display:flex;align-items:flex-end;justify-content:flex-end}:host .login-root .flyout .popup-content .commands fluent-button::part(control){color:var(--login-command-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-command-button-background-color,var(--neutral-fill-stealth-rest));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-root .flyout .popup-content .commands fluent-button::part(control):hover{background:var(--login-command-button-hover-background-color,var(--neutral-fill-stealth-hover))}:host .login-root .flyout .popup-content .content .main-profile{margin-bottom:56px;margin-top:27px}:host .login-root .flyout .popup-content .add-account{padding-top:16px}:host .login-root .flyout .popup-content .add-account fluent-button::part(control){color:var(--login-add-account-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-add-account-button-background-color,var(--neutral-fill-stealth-rest));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-root .flyout .popup-content .add-account fluent-button::part(control):hover{background:var(--login-add-account-button-hover-background-color,var(--neutral-fill-stealth-hover))}
`],PF={signInLinkSubtitle:"Sign In",signOutLinkSubtitle:"Sign Out",signInWithADifferentAccount:"Sign in with a different account"};var __decorate$k=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$j=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$i=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(qL,KL,AL,$L),exports.MgtLogin=class MgtLogin extends MgtTemplatedComponent{static get styles(){return IF}get strings(){return PF}get flyout(){return this.renderRoot.querySelector(".flyout")}static get requiredScopes(){return[...new Set(["user.read",...exports.MgtPerson.requiredScopes])]}get _userDetailsKey(){return"-userDetails"}constructor(){super(),this.showPresence=!1,this.loginView="full",this._arrowKeyLocation=-1,this.logout=()=>__awaiter$i(this,void 0,void 0,(function*(){if(!this.fireCustomEvent("logoutInitiated"))return;const t=Providers.globalProvider;(null==t?void 0:t.isMultiAccountSupportedAndEnabled)&&localStorage.removeItem(t.getActiveAccount().id+this._userDetailsKey),(null==t?void 0:t.logout)&&(yield t.logout(),this.userDetails=null,t.isMultiAccountSupportedAndEnabled&&localStorage.removeItem(t.getActiveAccount().id+this._userDetailsKey),this.hideFlyout(),this.fireCustomEvent("logoutCompleted"))})),this.flyoutOpened=()=>{this._isFlyoutOpen=!0},this.flyoutClosed=()=>{this._isFlyoutOpen=!1},this.onUserKeyDown=t=>{if(!this.flyout.isOpen)return;const o=this.renderRoot.querySelector(".popup-content"),s=o.querySelectorAll("ul, fluent-button"),l=o.querySelector("#signout-button")||s[0],h=o.querySelector("#signin-different-account-button")||s[s.length-1];if("Tab"===t.key&&t.shiftKey&&l===t.target&&(t.preventDefault(),null==h||h.focus()),"Tab"!==t.key||t.shiftKey||h!==t.target||(t.preventDefault(),null==l||l.focus()),"Escape"===t.key){const t=this.renderRoot.querySelector("#login-button");null==t||t.focus()}const m=this.renderRoot.querySelector("fluent-card");t.shiftKey&&"Tab"===t.key&&t.target===m&&this.hideFlyout()},this.handleAccountListKeyDown=t=>{const o=this.renderRoot.querySelector("ul.account-list");let s;const l=null==o?void 0:o.children;for(const t of l){const o=t;o.setAttribute("tabindex","-1"),o.blur()}const h=o.childElementCount,m=t.key;if("ArrowDown"===m)this._arrowKeyLocation=(this._arrowKeyLocation+1+h)%h;else if("ArrowUp"===m)this._arrowKeyLocation=(this._arrowKeyLocation-1+h)%h;else if("Tab"===m||"Escape"===m)return this._arrowKeyLocation=-1,o.blur(),void("Escape"===m&&(t.preventDefault(),t.stopPropagation()));this._arrowKeyLocation>-1&&(s=l[this._arrowKeyLocation],s.setAttribute("tabindex","1"),s.focus())},this.onClick=()=>{this.userDetails&&this._isFlyoutOpen?this.hideFlyout():this.userDetails?this.showFlyout():this.login()},this._isFlyoutOpen=!1}connectedCallback(){super.connectedCallback(),this.addEventListener("click",(t=>t.stopPropagation()))}login(){return __awaiter$i(this,void 0,void 0,(function*(){const t=Providers.globalProvider;(t.isMultiAccountSupportedAndEnabled||!this.userDetails&&this.fireCustomEvent("loginInitiated"))&&(null==t?void 0:t.login)&&(yield t.login(),t.state===exports.ProviderState.SignedIn?this.fireCustomEvent("loginCompleted"):this.fireCustomEvent("loginFailed"))}))}render(){return AI`
      <div class="login-root">
        ${this.renderButton()}
        ${this.renderFlyout()}
      </div>
    `}loadState(){return __awaiter$i(this,void 0,void 0,(function*(){const t=Providers.globalProvider;t&&!this.userDetails&&(t.state===exports.ProviderState.SignedIn?(this.userDetails=yield getUserWithPhoto(t.graph.forComponent(this)),this.userDetails.personImage&&(this._image=this.userDetails.personImage),t.isMultiAccountSupportedAndEnabled&&localStorage.setItem(Providers.globalProvider.getActiveAccount().id+this._userDetailsKey,JSON.stringify(this.userDetails)),this.fireCustomEvent("loginCompleted")):this.userDetails=null)}))}renderButton(){var t;const o=(null===(t=Providers.globalProvider)||void 0===t?void 0:t.state)===exports.ProviderState.SignedIn,s=iP({"signed-in":o&&Boolean(this.userDetails),"signed-out":!o,small:"avatar"===this.loginView}),l=o?"stealth":"neutral",h=o&&this.userDetails,m=h?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent(),_=h?this._isFlyoutOpen:void 0;return AI`
      <fluent-button
        id="login-button"
        aria-expanded="${l$1(_)}"
        appearance=${l}
        aria-label="${l$1(o?void 0:this.strings.signInLinkSubtitle)}"
        ?disabled=${this.isLoadingState}
        @click=${this.onClick}
        class=${s}>
          ${m}
      </fluent-button>`}renderFlyout(){return mgtHtml`
      <mgt-flyout
        class="flyout"
        light-dismiss
        @opened=${this.flyoutOpened}
        @closed=${this.flyoutClosed}>
        <fluent-card 
          slot="flyout" 
          tabindex="0" 
          class="flyout-card"
          @keydown=${this.onUserKeyDown}
          >
          ${this.renderFlyoutContent()}
        </fluent-card>
      </mgt-flyout>`}renderFlyoutContent(){if(this.userDetails)return AI`
       <div class="popup">
         <div class="popup-content">
           <div class="commands">
             ${this.renderFlyoutCommands()}
           </div>
           <div class="content">
             <div class="main-profile">
               ${this.renderFlyoutPersonDetails(this.userDetails,this._image)}
             </div>
             ${this.renderAccounts()}
           </div>
           ${this.renderAddAccountContent()}
         </div>
       </div>
     `}get hasMultipleAccounts(){var t,o,s,l;return(null===(t=Providers.globalProvider)||void 0===t?void 0:t.isMultiAccountSupportedAndEnabled)&&(null===(l=null===(s=null===(o=Providers.globalProvider)||void 0===o?void 0:o.getAllAccounts)||void 0===s?void 0:s.call(o))||void 0===l?void 0:l.length)>1}get usesVerticalPersonCard(){return"full"===this.loginView||this.hasMultipleAccounts}renderFlyoutPersonDetails(t,o){return this.renderTemplate("flyout-person-details",{personDetails:t,personImage:o})||mgtHtml`
        <mgt-person
          .personDetails=${t}
          .personImage=${o}
          .view=${exports.ViewType.twolines}
          .line2Property=${"email"}
          ?vertical-layout=${this.usesVerticalPersonCard}
          class="person">
        </mgt-person>`}renderFlyoutCommands(){return this.renderTemplate("flyout-commands",{handleSignOut:()=>this.logout()})||AI`
        <fluent-button
          id="signout-button"
          appearance="stealth"
          size="medium"
          class="flyout-command"
          @click=${this.logout}
          aria-label=${this.strings.signOutLinkSubtitle}>
            ${this.strings.signOutLinkSubtitle}
        </fluent-button>`}renderButtonContent(){return this.userDetails?this.renderSignedInButtonContent(this.userDetails,this._image):this.renderSignedOutButtonContent()}renderAddAccountContent(){if(Providers.globalProvider.isMultiAccountSupportedAndEnabled)return AI`
        <div class="add-account">
          <fluent-button
            id="signin-different-account-button"
            appearance="stealth"
            aria-label="${this.strings.signInWithADifferentAccount}"
            @click=${()=>{this.login()}}>
            <span slot="start"><i>${getSvg(yP.SelectAccount,"currentColor")}</i></span>
            ${this.strings.signInWithADifferentAccount}
          </fluent-button>
        </div>`}parsePersonDisplayConfiguration(){const t={view:exports.ViewType.twolines,avatarSize:"small"};switch(this.loginView){case"avatar":t.view=exports.ViewType.image,t.avatarSize="small";break;case"compact":t.view=exports.ViewType.oneline,t.avatarSize="small";break;default:t.view=exports.ViewType.twolines,t.avatarSize="auto"}return t}renderSignedInButtonContent(t,o){const s=this.renderTemplate("signed-in-button-content",{personDetails:t,personImage:o}),l=this.parsePersonDisplayConfiguration();return s||mgtHtml`
        <mgt-person
          .personDetails=${this.userDetails}
          .personImage=${this._image}
          .view=${l.view}
          .showPresence=${this.showPresence}
          .avatarSize=${l.avatarSize}
          line2-property="email"
          class="signed-in-person"
        ></mgt-person>`}renderAccounts(){if(Providers.globalProvider.state===exports.ProviderState.SignedIn&&Providers.globalProvider.isMultiAccountSupportedAndEnabled){const t=Providers.globalProvider,o=t.getAllAccounts();if((null==o?void 0:o.length)>1)return AI`
          <div id="accounts">
            <ul
              tabindex="0"
              class="account-list"
              part="account-list"
              aria-label="${this.ariaLabel}"
              @keydown=${this.handleAccountListKeyDown}
            >
              ${o.filter((o=>o.id!==t.getActiveAccount().id)).map((t=>{const o=localStorage.getItem(t.id+this._userDetailsKey);return mgtHtml`
                    <li
                      tabindex="-1"
                      part="account-item"
                      class="account-item"
                      @click=${()=>this.setActiveAccount(t)}
                      @keyup=${o=>{"Enter"===o.key&&this.setActiveAccount(t)}}
                    >
                      <mgt-person
                        .personDetails=${o?JSON.parse(o):null}
                        .fallbackDetails=${{displayName:t.name,mail:t.mail}}
                        .view=${exports.PersonViewType.twolines}
                        class="account"
                      ></mgt-person>
                    </li>`}))}
            </ul>
          </div>
       `}}setActiveAccount(t){Providers.globalProvider.setActiveAccount(t)}clearState(){this.userDetails=null,this._image=null}renderSignedOutButtonContent(){return this.renderTemplate("signed-out-button-content",null)||AI`
        <span>${this.strings.signInLinkSubtitle}</span>`}showFlyout(){const t=this.flyout;t&&t.open()}hideFlyout(){const t=this.flyout;t&&t.close()}},__decorate$k([n$1({attribute:"user-details",type:Object}),__metadata$j("design:type",Object)],exports.MgtLogin.prototype,"userDetails",void 0),__decorate$k([n$1({attribute:"show-presence",type:Boolean}),__metadata$j("design:type",Object)],exports.MgtLogin.prototype,"showPresence",void 0),__decorate$k([n$1({attribute:"login-view",type:String}),__metadata$j("design:type",String)],exports.MgtLogin.prototype,"loginView",void 0),__decorate$k([t$1(),__metadata$j("design:type",Boolean)],exports.MgtLogin.prototype,"_isFlyoutOpen",void 0),__decorate$k([t$1(),__metadata$j("design:type",Object)],exports.MgtLogin.prototype,"_arrowKeyLocation",void 0),exports.MgtLogin=__decorate$k([customElement("login"),__metadata$j("design:paramtypes",[])],exports.MgtLogin);var RF,__awaiter$h=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};exports.GroupType=void 0,(RF=exports.GroupType||(exports.GroupType={}))[RF.any=0]="any",RF[RF.unified=1]="unified",RF[RF.security=2]="security",RF[RF.mailenabledsecurity=4]="mailenabledsecurity",RF[RF.distribution=8]="distribution";const getGroupsInvalidationTime=()=>CacheService.config.groups.invalidationPeriod||CacheService.config.defaultInvalidationPeriod,getIsGroupsCacheEnabled=()=>CacheService.config.groups.isEnabled&&CacheService.config.isEnabled,findGroups=(t,o,s=10,l=exports.GroupType.any,h="")=>__awaiter$h(void 0,void 0,void 0,(function*(){const m="Group.Read.All";let _;const E=`${o||"*"}*${l}*${h}:${s}`;if(getIsGroupsCacheEnabled()){_=CacheService.getCache(dP,dP.stores.groupsQuery);const t=yield _.getValue(E);if(t&&getGroupsInvalidationTime()>Date.now()-t.timeCached&&t.top>=s)return t.groups.map((t=>JSON.parse(t))).slice(0,s+1)}let $,B="";const q=[];if(""!==o&&(B=`(startswith(displayName,'${o}') or startswith(mailNickname,'${o}') or startswith(mail,'${o}'))`),h&&(B+=`${o?" and ":""}${h}`),l!==exports.GroupType.any){const o=t.createBatch(),h=[];exports.GroupType.unified===(l&exports.GroupType.unified)&&h.push("groupTypes/any(c:c+eq+'Unified')"),exports.GroupType.security===(l&exports.GroupType.security)&&h.push("(mailEnabled eq false and securityEnabled eq true)"),exports.GroupType.mailenabledsecurity===(l&exports.GroupType.mailenabledsecurity)&&h.push("(mailEnabled eq true and securityEnabled eq true)"),exports.GroupType.distribution===(l&exports.GroupType.distribution)&&h.push("(mailEnabled eq true and securityEnabled eq false)"),B=B?`${B} and `:"";for(const t of h)o.get(t,`/groups?$filter=${B+t}`,["Group.Read.All"]);try{$=yield o.executeAll();for(const t of h)if($.get(t).content.value)for(const o of $.get(t).content.value){q.find((t=>t.id===o.id))||q.push(o)}}catch(o){try{const o=[];for(const l of h)o.push(t.api("groups").filter(`${B} and ${l}`).top(s).count(!0).header("ConsistencyLevel","eventual").middlewareOptions(prepScopes(m)).get());return(yield Promise.all(o)).map((t=>t.value)).reduce(((t,o)=>t.concat(o)),[])}catch(t){return[]}}}else if(0===q.length){const o=yield t.api("groups").filter(B).top(s).count(!0).header("ConsistencyLevel","eventual").middlewareOptions(prepScopes(m)).get();return getIsGroupsCacheEnabled()&&o&&(yield _.putValue(E,{groups:o.value.map((t=>JSON.stringify(t))),top:s})),o?o.value:null}return q})),getGroup=(t,o,s)=>__awaiter$h(void 0,void 0,void 0,(function*(){let l;if(getIsGroupsCacheEnabled()){l=CacheService.getCache(dP,dP.stores.groups);const t=yield l.getValue(o);if(t&&getGroupsInvalidationTime()>Date.now()-t.timeCached){const o=t.group?JSON.parse(t.group):null,l=s&&o?s.filter((t=>!Object.keys(o).includes(t))):null;if(!l||l.length<=1)return o}}let h=`/groups/${o}`;s&&(h=h+"?$select="+s.toString());const m=yield t.api(h).middlewareOptions(prepScopes("Group.Read.All")).get();return getIsGroupsCacheEnabled()&&(yield l.putValue(o,{group:JSON.stringify(m)})),m})),getGroupsForGroupIds=(t,o,s="")=>__awaiter$h(void 0,void 0,void 0,(function*(){if(!o||0===o.length)return[];const l=t.createBatch(),h={},m=[];let _;getIsGroupsCacheEnabled()&&(_=CacheService.getCache(dP,dP.stores.groups));for(const t of o){let o;if(h[t]=null,getIsGroupsCacheEnabled()&&(o=yield _.getValue(t)),o&&getGroupsInvalidationTime()>Date.now()-o.timeCached)h[t]=o.group?JSON.parse(o.group):null;else if(""!==t){let o=`/groups/${t}`;s&&(o=`${o}?$filters=${s}`),l.get(t,o,["Group.Read.All"]),m.push(t)}}try{const t=yield l.executeAll();for(const s of o){const o=t.get(s);(null==o?void 0:o.content)&&(h[s]=o.content,getIsGroupsCacheEnabled()&&(yield _.putValue(s,{group:JSON.stringify(o.content)})))}return Promise.all(Object.values(h))}catch(s){try{return o.filter((t=>m.includes(t))).forEach((o=>{h[o]=getGroup(t,o)})),getIsGroupsCacheEnabled()&&(yield Promise.all(o.filter((t=>m.includes(t))).map((t=>__awaiter$h(void 0,void 0,void 0,(function*(){return yield _.putValue(t,{group:JSON.stringify(yield h[t])})})))))),Promise.all(Object.values(h))}catch(t){return[]}}})),$F=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}
`];var __decorate$j=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_};let MF=class MgtSpinner extends MgtBaseComponent{static get styles(){return $F}render(){return AI`<fluent-progress-ring title="spinner"></fluent-progress-ring>`}};MF=__decorate$j([customElement("spinner")],MF);const OF=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{--person-details-wrapper-width:0;width:auto}:host fluent-text-field{width:100%}:host fluent-text-field::part(root){display:flex;flex-wrap:wrap;height:auto;background:padding-box linear-gradient(var(--people-picker-input-background,var(--neutral-fill-input-rest)),var(--people-picker-input-background,var(--neutral-fill-input-rest))),border-box var(--people-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--people-picker-input-hover-background,var(--neutral-fill-input-hover)),var(--people-picker-input-hover-background,var(--neutral-fill-input-hover))),border-box var(--people-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--people-picker-input-focus-background,var(--neutral-fill-input-focus)),var(--people-picker-input-focus-background,var(--neutral-fill-input-focus))),border-box var(--people-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(start){margin:unset}:host fluent-text-field::part(control){width:min-content;height:calc((var(--base-height-multiplier) + var(--density)) * var(--design-unit) * 1px);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-text-field::part(control)::placeholder{color:var(--people-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--people-picker-input-placeholder-hover-text-color,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--people-picker-input-placeholder-focus-text-color,var(--input-placeholder-filled))}:host fluent-text-field .search-icon{display:flex;padding-top:10px;padding-inline-start:10px}:host fluent-text-field .search-icon svg path{fill:var(--people-picker-search-icon-color,currentColor)}:host .selected-list{display:flex;flex-wrap:wrap;column-gap:5px;padding:unset;margin:0 5px}:host .selected-list-item{display:flex;column-gap:5px;border-radius:100px;margin-top:3px;background-color:var(--people-picker-selected-option-background-color,var(--person-background-color,var(--neutral-layer-3)))}:host .selected-list-item.highlighted{background-color:var(--people-picker-selected-option-highlight-background-color,var(--accent-fill-rest))}:host .selected-list-item-close-icon{display:flex;justify-content:center;align-items:center;padding-inline-end:8px;cursor:pointer}:host .selected-list-item-close-icon svg path{fill:var(--people-picker-remove-selected-close-icon-color,currentColor)}:host .selected-list-item-person{width:max-content}:host fluent-card{margin-top:4px;background-color:var(--people-picker-dropdown-background-color,var(--neutral-layer-card-container))}:host .searched-people-list{list-style:none;padding:4px;margin:auto}:host .searched-people-list-result{padding:4px;border-radius:4px;background:var(--people-picker-dropdown-result-background-color,var(--person-background-color,transparent))}:host .searched-people-list-result:hover{background:var(--people-picker-dropdown-result-hover-background-color,var(--person-background-color,var(--neutral-fill-rest)))}:host .searched-people-list-result:focus,:host .searched-people-list-result:focus-within{background:var(--people-picker-dropdown-result-focus-background-color,var(--person-background-color,var(--neutral-fill-rest)))}:host .message-parent{display:flex;place-content:center;flex-direction:row;padding:10px 15px;column-gap:5px}:host .message-parent .loading-text,:host .message-parent .search-error-text{font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;color:var(--people-picker-no-results-text-color,var(--neutral-foreground-hint))}
`],NF={inputPlaceholderText:"Search for a name",maxSelectionsPlaceHolder:"Max contacts added",maxSelectionsAriaLabel:"Maximum contact selections reached",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading...",selected:"selected",removeSelectedUser:"Remove ",selectContact:"select a contact",suggestionsTitle:"Suggested contacts"};var __decorate$i=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$i=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$g=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(sF,$L),exports.MgtPeoplePicker=class MgtPeoplePicker extends MgtTemplatedComponent{static get styles(){return OF}get strings(){return NF}get flyout(){return this.renderRoot.querySelector(".flyout")}get input(){return this.renderRoot.querySelector("fluent-text-field")}get groupId(){return this._groupId}set groupId(t){this._groupId!==t&&(this._groupId=t,this.requestStateUpdate(!0))}get groupIds(){return this._groupIds}set groupIds(t){arraysAreEqual(this._groupIds,t)||(this._groupIds=t,this.requestStateUpdate(!0))}get type(){return this._type}set type(t){this._type!==t&&(this._type=t,this.requestStateUpdate(!0))}get groupType(){return this._groupType}set groupType(t){this._groupType!==t&&(this._groupType=t,this.requestStateUpdate(!0))}get userType(){return this._userType}set userType(t){this._userType!==t&&(this._userType=t,this.requestStateUpdate(!0))}get transitiveSearch(){return this._transitiveSearch}set transitiveSearch(t){this.transitiveSearch!==t&&(this._transitiveSearch=t,this.requestStateUpdate(!0))}get people(){return this._people}set people(t){arraysAreEqual(this._people,t)||(this._people=t,this.requestStateUpdate(!0))}get showMax(){return this._showMax}set showMax(t){t!==this._showMax&&(this._showMax=t,this.requestStateUpdate(!0))}get selectedPeople(){return this._selectedPeople}set selectedPeople(t){t||(t=[]),arraysAreEqual(this._selectedPeople,t)||(this._selectedPeople=t,this.requestUpdate())}get defaultSelectedUserIds(){return this._defaultSelectedUserIds}set defaultSelectedUserIds(t){arraysAreEqual(this._defaultSelectedUserIds,t)||(this._defaultSelectedUserIds=t,this.requestStateUpdate(!0))}get defaultSelectedGroupIds(){return this._defaultSelectedGroupIds}set defaultSelectedGroupIds(t){arraysAreEqual(this._defaultSelectedGroupIds,t)||(this._defaultSelectedGroupIds=t,this.requestStateUpdate(!0))}get userIds(){return this._userIds}set userIds(t){arraysAreEqual(this._userIds,t)||(this._userIds=t,this.requestStateUpdate(!0))}get userFilters(){return this._userFilters}set userFilters(t){this._userFilters=t,this.requestStateUpdate(!0)}get peopleFilters(){return this._peopleFilters}set peopleFilters(t){this._peopleFilters=t,this.requestStateUpdate(!0)}get groupFilters(){return this._groupFilters}set groupFilters(t){this._groupFilters=t,this.requestStateUpdate(!0)}static get requiredScopes(){return[...new Set(["user.read.all","people.read","group.read.all","user.readbasic.all",...exports.MgtPerson.requiredScopes])]}constructor(){super(),this._type=exports.PersonType.person,this._groupType=exports.GroupType.any,this._userType=exports.UserType.any,this._selectedPeople=[],this._arrowSelectionCount=-1,this.defaultSelectedUsers=[],this.defaultSelectedGroups=[],this._highlightedUsers=[],this._currentHighlightedUserPos=0,this._isFocused=!1,this._setAnyEmail=!1,this.handleInputClick=()=>{this.flyout.isOpen||this.handleUserSearch()},this.gainedFocus=()=>{this.clearHighlighted(),this._isFocused=!0,this.loadState(),this.showFlyout()},this.lostFocus=()=>{this._isFocused=!1,this.input&&this.input.setAttribute("aria-activedescendant","");const t=this.renderRoot.querySelector(".people-list");if(t)for(const o of t.children)o.classList.remove("focused"),o.setAttribute("aria-selected","false");this.requestUpdate()},this.onUserKeyUp=t=>{const o=t.key,s=t.getModifierState("Control")||t.getModifierState("Meta"),l=s&&"v"===o,h=["ArrowDown","ArrowRight","ArrowUp","ArrowLeft"].includes(o);return!l&&s||h?((s||["ArrowLeft","ArrowRight"].includes(o))&&this.hideFlyout(),void("ArrowDown"===o&&!this.flyout.isOpen&&this._isFocused&&this.handleUserSearch())):["Tab","Enter","Shift"].includes(o)?void 0:"Escape"===o?(this.clearInput(),this._foundPeople=[],void(this._arrowSelectionCount=-1)):"Backspace"===o&&0===this.userInput.length&&this.selectedPeople.length>0?(this.clearHighlighted(),this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-1),this.loadState(),this.hideFlyout(),void this.fireCustomEvent("selectionChanged",this.selectedPeople)):void([";",","].includes(o)&&this.allowAnyEmail&&(this._setAnyEmail=!0,t.preventDefault(),t.stopPropagation()))},this.onUserInput=t=>{const o=t.target;if(this.userInput=o.value,this.userInput){isValidEmail(this.userInput)&&this.allowAnyEmail?this._setAnyEmail&&this.handleAnyEmail():this.handleUserSearch(),this._setAnyEmail=!1}},this.onUserKeyDown=t=>{const o=t.key,s=this.renderRoot.querySelector(".selected-list"),l=t.getModifierState("Control")||t.getModifierState("Meta");if(l&&s){const t=s.querySelectorAll("mgt-person.selected-list-item-person");if(this.hideFlyout(),l&&"ArrowLeft"===o)this._currentHighlightedUserPos=(this._currentHighlightedUserPos-1+t.length)%t.length,this._currentHighlightedUserPos>=0&&!Number.isNaN(this._currentHighlightedUserPos)?this._highlightedUsers.push(t[this._currentHighlightedUserPos]):this._currentHighlightedUserPos=0;else if(l&&"ArrowRight"===o){const t=this._highlightedUsers.pop();if(t){const o=t.parentElement;o&&(this.clearHighlighted(o),this._currentHighlightedUserPos++)}}else l&&"a"===o&&(this._highlightedUsers=[],t.forEach((t=>this._highlightedUsers.push(t))));this._highlightedUsers&&this.highlightSelectedPeople(this._highlightedUsers)}else if(this.clearHighlighted(),this.flyout.isOpen){if("ArrowUp"!==o&&"ArrowDown"!==o||(this.handleArrowSelection(t),t.preventDefault()),"Enter"===o)if(!t.shiftKey&&this._foundPeople){t.preventDefault(),t.stopPropagation();const o=this._foundPeople[this._arrowSelectionCount];if(o){this.addPerson(o),this.hideFlyout(),this.input.value="";const t=this.input.shadowRoot.querySelector("input");this.hasMaxSelections&&t&&t.setAttribute("disabled","true")}}else this.allowAnyEmail?this.handleAnyEmail():this.showFlyout();"Escape"===o&&t.stopPropagation(),"Tab"===o&&this.hideFlyout(),[";",","].includes(o)&&this.allowAnyEmail&&(t.preventDefault(),t.stopPropagation(),this.userInput=this.input.value,this.handleAnyEmail())}},this.handleCut=()=>{this.writeHighlightedText().then((()=>{this.removeHighlightedOnCut()}),(()=>{}))},this.handleCopy=()=>{this.writeHighlightedText()},this.handlePaste=()=>{navigator.clipboard.readText().then((t=>{if(t)try{const o=JSON.parse(t);if(o&&o.length>0)for(const t of o)this.addPerson(t)}catch(o){if(o instanceof SyntaxError){const o=[",",";"];let s;try{for(const l of o)if(s=t.split(l),s.length>1){this.hideFlyout(),this.selectUsersById(s);break}}catch(t){}}}}),(t=>{}))},this.clearState(),this._showLoading=!0,this.showMax=6,this.disableImages=!1,this.disabled=!1,this.allowAnyEmail=!1,this.addEventListener("copy",this.handleCopy),this.addEventListener("cut",this.handleCut),this.addEventListener("paste",this.handlePaste)}get hasMaxSelections(){return"single"===this.selectionMode&&this.selectedPeople.length>=1}focus(t){this.input&&(this.input.focus(t),this.input.select())}selectUsersById(t){var o;return __awaiter$g(this,void 0,void 0,(function*(){const s=Providers.globalProvider,l=Providers.globalProvider.graph;if(s&&s.state===exports.ProviderState.SignedIn)for(const s in t){const h=t[s];try{const t=yield getUser(l,h,EP);this.addPerson(t)}catch(t){if(isGraphError(t)&&(null===(o=t.message)||void 0===o?void 0:o.includes("does not exist"))&&this.allowAnyEmail&&isValidEmail(h)){const t={mail:h,displayName:h};this.addPerson(t)}}}}))}selectGroupsById(t){return __awaiter$g(this,void 0,void 0,(function*(){const o=Providers.globalProvider,s=Providers.globalProvider.graph;if(o&&o.state===exports.ProviderState.SignedIn)for(const o in t)try{const l=yield getGroup(s,t[o]);this.addPerson(l)}catch(t){}}))}render(){const t=this.renderTemplate("default",{people:this._foundPeople});if(t)return t;const o=this.renderSelectedPeople(this.selectedPeople),s=this.renderInput(o),l=this.renderFlyout(s);return AI`
      <div>
        ${l}
      </div>
    `}clearState(){this.selectedPeople=[],this.userInput="",this._highlightedUsers=[],this._currentHighlightedUserPos=0}requestStateUpdate(t){return t&&(this._groupPeople=null,this._foundPeople=null,this.selectedPeople=[],this.defaultPeople=null),super.requestStateUpdate(t)}renderInput(t){var o,s,l;const h=this.disabled?"":this.placeholder||this.strings.inputPlaceholderText,m=this.hasMaxSelections?this.strings.maxSelectionsAriaLabel:"",_=AI`<span class="search-icon">${getSvg(yP.Search)}</span>`,E=(null===(o=this.selectedPeople)||void 0===o?void 0:o.length)>0?t:_;return AI`
      <fluent-text-field
        autocomplete="off"
        appearance="outline"
        slot="anchor"
        id="people-picker-input"
        role="combobox"
        placeholder=${this.hasMaxSelections?this.strings.maxSelectionsPlaceHolder:h}
        aria-label=${this.ariaLabel||m||h||this.strings.selectContact}
        aria-expanded=${null!==(l=null===(s=this.flyout)||void 0===s?void 0:s.isOpen)&&void 0!==l&&l}
        @click="${this.hasMaxSelections?void 0:this.handleInputClick}"
        @focus="${this.hasMaxSelections?void 0:this.gainedFocus}"
        @keydown="${this.hasMaxSelections?void 0:this.onUserKeyDown}"
        @input="${this.hasMaxSelections?void 0:this.onUserInput}"
        @blur="${this.lostFocus}"
        ?disabled=${this.disabled}
      >
        <span slot="start">${E}</span>
      </fluent-text-field>
    `}renderSelectedPeople(t){return(null==t?void 0:t.length)?AI`
       <ul
        id="selected-list"
        aria-label="${this.strings.selected}"
        class="selected-list">
          ${RP(t,(t=>null==t?void 0:t.id),(t=>{var o;return AI`
            <li class="selected-list-item">
              ${this.renderTemplate("selected-person",{person:t},`selected-${(null==t?void 0:t.id)?t.id:t.displayName}`)||this.renderSelectedPerson(t)}

              <div
                role="button"
                tabindex="0"
                class="selected-list-item-close-icon"
                aria-label="${this.strings.removeSelectedUser}${null!==(o=null==t?void 0:t.displayName)&&void 0!==o?o:""}"
                @click="${o=>this.removePerson(t,o)}"
                @keydown="${o=>this.handleRemovePersonKeyDown(t,o)}">
                  ${getSvg(yP.Close)}
              </div>
          </li>`}))}
      </ul>`:AI``}renderFlyout(t){return mgtHtml`
       <mgt-flyout light-dismiss class="flyout">
         ${t}
         <fluent-card
          tabindex="0"
          slot="flyout"
          class="flyout-root"
          @wheel=${t=>this.handleSectionScroll(t)}
          @keydown=${t=>this.onUserKeyDown(t)}
          class="custom">
           ${this.renderFlyoutContent()}
         </fluent-card>
       </mgt-flyout>
     `}renderFlyoutContent(){if(this.isLoadingState||this._showLoading)return this.renderLoading();const t=this._foundPeople;return t&&0!==t.length&&0!==this.showMax?this.renderSearchResults(t):this.renderNoData()}renderLoading(){return this.renderTemplate("loading",null)||mgtHtml`
         <div class="message-parent">
           <mgt-spinner></mgt-spinner>
           <div aria-label="${this.strings.loadingMessage}" class="loading-text">
             ${this.strings.loadingMessage}
           </div>
         </div>
       `}renderNoData(){if(this._isFocused)return this.renderTemplate("error",null)||this.renderTemplate("no-data",null)||AI`
         <div class="message-parent">
           <div aria-label=${this.strings.noResultsFound} class="search-error-text">
             ${this.strings.noResultsFound}
           </div>
         </div>
       `}renderSearchResults(t){const o=t.filter((t=>t.id));return AI`
      <ul
        id="suggestions-list"
        class="searched-people-list"
        role="listbox"
        aria-live="polite"
        title=${this.strings.suggestionsTitle}
      >
         ${RP(o,(t=>t.id),(t=>AI`
            <li
              id="${t.id}"
              class="searched-people-list-result"
              role="option"
              @click="${()=>this.handleSuggestionClick(t)}">
                ${this.renderPersonResult(t)}
            </li>
          `))}
       </ul>
     `}renderPersonResult(t){return this.renderTemplate("person",{person:t},t.id)||mgtHtml`
         <mgt-person
          class="person"
          show-presence
          view="twoLines"
          line2-property="jobTitle,mail"
          .personDetails=${t}
          .fetchImage=${!this.disableImages}>
          .personCardInteraction=${exports.PersonCardInteraction.none}
        </mgt-person>`}renderSelectedPerson(t){return mgtHtml`
       <mgt-person
         tabindex="-1"
         class="selected-list-item-person"
         .personDetails=${t}
         .fetchImage=${!this.disableImages}
         .view=${exports.ViewType.oneline}
         .personCardInteraction=${exports.PersonCardInteraction.none}>
        </mgt-person>
     `}loadState(){var t,o,s,l;return __awaiter$g(this,void 0,void 0,(function*(){let h=this.people;const m=this.userInput.toLowerCase(),_=Providers.globalProvider;if(h){if(m){const t=h.filter((t=>null==t?void 0:t.displayName.toLowerCase().includes(m)));h=t}this._showLoading=!1}else if(!h&&_&&_.state===exports.ProviderState.SignedIn){const E=_.graph.forComponent(this);if(!m.length){if(this.defaultPeople)h=this.defaultPeople;else{if(this.groupId||this.groupIds){if(null===this._groupPeople)if(this.groupId)try{this.type===exports.PersonType.group?this._groupPeople=yield findGroupMembers(E,null,this.groupId,this.showMax,this.type,this.transitiveSearch):this._groupPeople=yield findGroupMembers(E,null,this.groupId,this.showMax,this.type,this.transitiveSearch,this.userFilters,this.peopleFilters)}catch(t){this._groupPeople=[]}else if(this.groupIds)if(this.type===exports.PersonType.group)try{this._groupPeople=yield getGroupsForGroupIds(E,this.groupIds,this.groupFilters)}catch(t){this._groupPeople=[]}else try{const t=yield findUsersFromGroupIds(E,"",this.groupIds,this.showMax,this.type,this.transitiveSearch,this.userFilters);this._groupPeople=t}catch(t){this._groupPeople=[]}h=this._groupPeople||[]}else if(this.type===exports.PersonType.person||this.type===exports.PersonType.any)if(this.userIds)h=yield getUsersForUserIds(E,this.userIds,"",this.userFilters);else{const t=this.userType===exports.UserType.user||this.userType===exports.UserType.contact;h=this._userFilters&&t?yield((t,o="",s=10)=>__awaiter$x(void 0,void 0,void 0,(function*(){let l;const h=`${""===o?"*":o}:${s}`,m={maxResults:s,results:null};if(getIsUsersCacheEnabled()){l=CacheService.getCache(aP,aP.stores.userFilters);const t=yield l.getValue(h);if(t&&getUserInvalidationTime()>Date.now()-t.timeCached)return t.results.map((t=>JSON.parse(t)))}const _=t.api("/users").top(s);o&&_.filter(o);try{const t=yield _.middlewareOptions(prepScopes("user.read")).get();return getIsUsersCacheEnabled()&&t&&(m.results=t.value.map((t=>JSON.stringify(t))),yield l.putValue(o,m)),t.value}catch(t){}})))(E,this._userFilters,this.showMax):yield getPeople(E,this.userType,this._peopleFilters,this.showMax)}else if(this.type===exports.PersonType.group)if(this.groupIds)try{h=yield this.getGroupsForGroupIds(E,h)}catch(t){}else{let t=(yield findGroups(E,"",this.showMax,this.groupType,this._groupFilters))||[];t.length>0&&t[0].value&&(t=t[0].value),h=t}this.defaultPeople=h}this._isFocused&&(this._showLoading=!1)}if(!((null===(t=this.defaultSelectedUserIds)||void 0===t?void 0:t.length)>0||(null===(o=this.defaultSelectedGroupIds)||void 0===o?void 0:o.length)>0)||this.selectedPeople.length||this.defaultSelectedUsers.length||this.defaultSelectedGroups.length||(this.defaultSelectedUsers=yield getUsersForUserIds(E,this.defaultSelectedUserIds,"",this.userFilters),this.defaultSelectedGroups=yield getGroupsForGroupIds(E,this.defaultSelectedGroupIds,this.peopleFilters),this.defaultSelectedGroups=this.defaultSelectedGroups.filter((t=>null!==t)),this.defaultSelectedUsers=this.defaultSelectedUsers.filter((t=>null!==t)),this.selectedPeople=[...this.defaultSelectedUsers,...this.defaultSelectedGroups],this.requestUpdate(),this.fireCustomEvent("selectionChanged",this.selectedPeople)),m)if(h=[],this.groupId)h=(yield findGroupMembers(E,m,this.groupId,this.showMax,this.type,this.transitiveSearch,this.userFilters,this.peopleFilters))||[];else{if(this.type===exports.PersonType.person||this.type===exports.PersonType.any){try{if(this.userType===exports.UserType.contact||this.userType===exports.UserType.user)h=(null===(s=this.userIds)||void 0===s?void 0:s.length)?yield getUsersForUserIds(E,this.userIds,m,this._userFilters):yield findUsers(E,m,this.showMax,this._userFilters);else if(this.groupIds)try{h=yield findUsersFromGroupIds(E,m,this.groupIds,this.showMax,this.type,this.transitiveSearch,this.userFilters)}catch(t){}else h=(null===(l=this.userIds)||void 0===l?void 0:l.length)?yield getUsersForUserIds(E,this.userIds,m,this._userFilters):(yield findPeople(E,m,this.showMax,this.userType,this._peopleFilters))||[]}catch(t){}if(h&&h.length<this.showMax&&this.userType!==exports.UserType.contact&&this.type!==exports.PersonType.person)try{const t=(yield findUsers(E,m,this.showMax,this._userFilters))||[],o=new Set(h.map((t=>t.id)));for(const s of t)o.has(s.id)||h.push(s)}catch(t){}}if((this.type===exports.PersonType.group||this.type===exports.PersonType.any)&&h.length<this.showMax)if(this.groupIds)try{h=yield((t,o,s,l=10,h=exports.GroupType.any,m="")=>__awaiter$h(void 0,void 0,void 0,(function*(){const _=[],E=yield findGroups(t,o,l,h,m);if(E)for(const t of E)t.id&&s.includes(t.id)&&_.push(t);return _})))(E,m,this.groupIds,this.showMax,this.groupType,this.userFilters)}catch(t){}else{let t=[];try{t=(yield findGroups(E,m,this.showMax,this.groupType,this._groupFilters))||[],h=h.concat(t)}catch(t){}}}}this._foundPeople=this.filterPeople(h)}))}getGroupsForGroupIds(t,o){return __awaiter$g(this,void 0,void 0,(function*(){const s=yield getGroupsForGroupIds(t,this.groupIds,this.groupFilters);for(const t of s)o=o.concat(t);return o=o.filter((t=>t))}))}hideFlyout(){const t=this.flyout;t&&t.close(),this.input&&this.input.setAttribute("aria-activedescendant",""),this._arrowSelectionCount=-1}showFlyout(){const t=this.flyout;t&&t.open(),this._arrowSelectionCount=-1}removePerson(t,o){o.stopPropagation();const s=this.selectedPeople.filter((o=>!t.id&&o.displayName?o.displayName!==t.displayName:o.id!==t.id)),l=this.input.shadowRoot.querySelector("input");this.hasMaxSelections&&l&&l.removeAttribute("disabled"),this.selectedPeople=s,this.loadState(),this.fireCustomEvent("selectionChanged",this.selectedPeople),null==l||l.focus()}handleRemovePersonKeyDown(t,o){"Enter"===o.key&&this.removePerson(t,o)}addPerson(t){if(t){setTimeout((()=>{this.clearInput()}),50);const o=this.selectedPeople.filter((o=>!t.id&&o.displayName?o.displayName===t.displayName:o.id===t.id));0===o.length&&(this.selectedPeople=[...this.selectedPeople,t],this.fireCustomEvent("selectionChanged",this.selectedPeople),this.loadState(),this._foundPeople=[],this._arrowSelectionCount=-1)}}clearInput(){this.clearHighlighted(),"single"!==this.selectionMode&&(this.input.value=""),this.userInput=""}handleAnyEmail(){if(this._showLoading=!1,this._arrowSelectionCount=-1,isValidEmail(this.userInput)){const t={mail:this.userInput,displayName:this.userInput};this.addPerson(t)}this.hideFlyout(),this.input&&(this.input.focus(),this._isFocused=!0)}handleSuggestionClick(t){this.addPerson(t);const o=this.input.shadowRoot.querySelector("input");this.hasMaxSelections&&o&&(o.setAttribute("disabled","true"),this.input.value=o.value=""),this.hideFlyout()}handleUserSearch(){this._debouncedSearch||(this._debouncedSearch=debounce((()=>__awaiter$g(this,void 0,void 0,(function*(){const t=setTimeout((()=>{this._showLoading=!0}),50);yield this.loadState(),clearTimeout(t),this._showLoading=!1,this._arrowSelectionCount=-1,this.showFlyout()}))),400)),this._debouncedSearch()}writeHighlightedText(){return __awaiter$g(this,void 0,void 0,(function*(){const t=[];for(const o of this._highlightedUsers){const{id:s,displayName:l,mail:h,userPrincipalName:m,scoredEmailAddresses:_}=o._personDetails;let E;E=_&&_.length>0?_.pop().address:m||h,t.push({id:s,displayName:l,email:E})}let o="";t.length>0&&(o=JSON.stringify(t)),yield navigator.clipboard.writeText(o)}))}removeHighlightedOnCut(){this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-this._highlightedUsers.length),this._highlightedUsers=[],this._currentHighlightedUserPos=0,this.loadState(),this.hideFlyout(),this.fireCustomEvent("selectionChanged",this.selectedPeople)}highlightSelectedPeople(t){for(const o of t){(null==o?void 0:o.parentElement).classList.add("highlighted")}}clearHighlighted(t){if(t)t.classList.remove("highlighted");else{for(const t of this._highlightedUsers){const o=t.parentElement;o&&o.classList.remove("highlighted")}this._highlightedUsers=[],this._currentHighlightedUserPos=0}}handleArrowSelection(t){var o,s;const l=this.renderRoot.querySelector(".searched-people-list");if(null===(o=null==l?void 0:l.children)||void 0===o?void 0:o.length){t&&("ArrowUp"===t.key&&(-1===this._arrowSelectionCount?this._arrowSelectionCount=0:this._arrowSelectionCount=(this._arrowSelectionCount-1+l.children.length)%l.children.length),"ArrowDown"===t.key&&(-1===this._arrowSelectionCount?this._arrowSelectionCount=0:this._arrowSelectionCount=(this._arrowSelectionCount+1+l.children.length)%l.children.length));for(const t of null!==(s=null==l?void 0:l.children)&&void 0!==s?s:[]){const o=t;o.setAttribute("aria-selected","false"),o.blur(),o.removeAttribute("tabindex")}const o=l.children[this._arrowSelectionCount];o&&(o.setAttribute("tabindex","0"),o.focus(),o.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"}),o.setAttribute("aria-selected","true"),this.input.setAttribute("aria-activedescendant",null==o?void 0:o.id))}}filterPeople(t){const o=[];if(t&&t.length>0){t=t.filter((t=>t));const s=this.selectedPeople.map((t=>t.id?t.id:t.displayName)),l=t.filter((t=>(null==t?void 0:t.id)?-1===s.indexOf(t.id):-1===s.indexOf(null==t?void 0:t.displayName))),h=new Set;for(const t of l){const o=JSON.stringify(t);h.add(o)}h.forEach((t=>{const s=JSON.parse(t);o.push(s)}))}return o}handleSectionScroll(t){const o=this.renderRoot.querySelector(".flyout-root");o&&(t.deltaY<0&&0===o.scrollTop||t.deltaY>0&&o.clientHeight+o.scrollTop>=o.scrollHeight-1||t.stopPropagation())}},__decorate$i([n$1({attribute:"group-id",converter:t=>t.trim()}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"groupId",null),__decorate$i([n$1({attribute:"group-ids",converter:t=>t.split(",").map((t=>t.trim()))}),__metadata$i("design:type",Array),__metadata$i("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"groupIds",null),__decorate$i([n$1({attribute:"type",converter:t=>(t=t.toLowerCase())&&0!==t.length?void 0===exports.PersonType[t]?exports.PersonType.any:exports.PersonType[t]:exports.PersonType.any}),__metadata$i("design:type",Object),__metadata$i("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"type",null),__decorate$i([n$1({attribute:"group-type",converter:t=>{if(!t||0===t.length)return exports.GroupType.any;const o=t.split(","),s=[];for(let t of o)t=t.trim(),void 0!==exports.GroupType[t]&&s.push(exports.GroupType[t]);if(0===s.length)return exports.GroupType.any;const l=s.reduce(((t,o)=>t|o));return l}}),__metadata$i("design:type",Number),__metadata$i("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"groupType",null),__decorate$i([n$1({attribute:"user-type",converter:t=>(t=t.toLowerCase())&&void 0!==exports.UserType[t]?exports.UserType[t]:exports.UserType.any}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"userType",null),__decorate$i([n$1({attribute:"transitive-search",type:Boolean}),__metadata$i("design:type",Boolean),__metadata$i("design:paramtypes",[Boolean])],exports.MgtPeoplePicker.prototype,"transitiveSearch",null),__decorate$i([n$1({attribute:"people",type:Object}),__metadata$i("design:type",Array),__metadata$i("design:paramtypes",[Array])],exports.MgtPeoplePicker.prototype,"people",null),__decorate$i([n$1({attribute:"show-max",type:Number}),__metadata$i("design:type",Number),__metadata$i("design:paramtypes",[Number])],exports.MgtPeoplePicker.prototype,"showMax",null),__decorate$i([n$1({attribute:"disable-images",type:Boolean}),__metadata$i("design:type",Boolean)],exports.MgtPeoplePicker.prototype,"disableImages",void 0),__decorate$i([n$1({attribute:"selected-people",type:Array}),__metadata$i("design:type",Array),__metadata$i("design:paramtypes",[Array])],exports.MgtPeoplePicker.prototype,"selectedPeople",null),__decorate$i([n$1({attribute:"default-selected-user-ids",converter:t=>t.split(",").map((t=>t.trim())),type:String}),__metadata$i("design:type",Array),__metadata$i("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"defaultSelectedUserIds",null),__decorate$i([n$1({attribute:"default-selected-group-ids",converter:t=>t.split(",").map((t=>t.trim())),type:String}),__metadata$i("design:type",Array),__metadata$i("design:paramtypes",[Object])],exports.MgtPeoplePicker.prototype,"defaultSelectedGroupIds",null),__decorate$i([n$1({attribute:"placeholder",type:String}),__metadata$i("design:type",String)],exports.MgtPeoplePicker.prototype,"placeholder",void 0),__decorate$i([n$1({attribute:"disabled",type:Boolean}),__metadata$i("design:type",Boolean)],exports.MgtPeoplePicker.prototype,"disabled",void 0),__decorate$i([n$1({attribute:"allow-any-email",type:Boolean}),__metadata$i("design:type",Boolean)],exports.MgtPeoplePicker.prototype,"allowAnyEmail",void 0),__decorate$i([n$1({attribute:"selection-mode",type:String}),__metadata$i("design:type",String)],exports.MgtPeoplePicker.prototype,"selectionMode",void 0),__decorate$i([n$1({attribute:"user-ids",converter:t=>t.split(",").map((t=>t.trim())),type:String}),__metadata$i("design:type",Array),__metadata$i("design:paramtypes",[Array])],exports.MgtPeoplePicker.prototype,"userIds",null),__decorate$i([n$1({attribute:"user-filters"}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[String])],exports.MgtPeoplePicker.prototype,"userFilters",null),__decorate$i([n$1({attribute:"people-filters"}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[String])],exports.MgtPeoplePicker.prototype,"peopleFilters",null),__decorate$i([n$1({attribute:"group-filters"}),__metadata$i("design:type",String),__metadata$i("design:paramtypes",[String])],exports.MgtPeoplePicker.prototype,"groupFilters",null),__decorate$i([n$1({attribute:"aria-label",type:String}),__metadata$i("design:type",String)],exports.MgtPeoplePicker.prototype,"ariaLabel",void 0),__decorate$i([t$1(),__metadata$i("design:type",Boolean)],exports.MgtPeoplePicker.prototype,"_showLoading",void 0),__decorate$i([t$1(),__metadata$i("design:type",Object)],exports.MgtPeoplePicker.prototype,"_arrowSelectionCount",void 0),__decorate$i([t$1(),__metadata$i("design:type",Array)],exports.MgtPeoplePicker.prototype,"_highlightedUsers",void 0),__decorate$i([t$1(),__metadata$i("design:type",Object)],exports.MgtPeoplePicker.prototype,"_isFocused",void 0),__decorate$i([t$1(),__metadata$i("design:type",Object)],exports.MgtPeoplePicker.prototype,"_setAnyEmail",void 0),__decorate$i([t$1(),__metadata$i("design:type",Array)],exports.MgtPeoplePicker.prototype,"_foundPeople",void 0),exports.MgtPeoplePicker=__decorate$i([customElement("people-picker"),__metadata$i("design:paramtypes",[])],exports.MgtPeoplePicker);var __awaiter$f=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const DF="businessPhones,companyName,department,displayName,givenName,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName,id,accountEnabled",LF="directReports",FF="files",BF="messages",HF="people",UF="person",buildOrgStructureRequest=(t,o)=>{const s=`manager($levels=max;$select=${DF})`;t.get(UF,`users/${o}?$expand=${s}&$select=${DF}&$count=true`,["user.read.all"],{ConsistencyLevel:"eventual"}),t.get(LF,`users/${o}/directReports?$select=${DF}`)},buildWorksWithRequest=(t,o)=>{t.get(HF,`users/${o}/people?$filter=personType/class eq 'Person'`,["People.Read.All"])},buildMessagesWithUserRequest=(t,o)=>{t.get(BF,`me/messages?$search="from:${o}"`,["Mail.ReadBasic"])},buildFilesRequest=(t,o)=>{let s;s=o?`me/insights/shared?$filter=lastshared/sharedby/address eq '${o}'`:"me/insights/used",t.get(FF,s,["Sites.Read.All"])},getProfile=(t,o)=>__awaiter$f(void 0,void 0,void 0,(function*(){return yield t.api(`/users/${o}/profile`).version("beta").get()})),qF=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{box-shadow:var(--person-card-box-shadow,var(--elevation-shadow-card-rest));width:var(--mgt-flyout-set-width,375px);overflow:hidden;user-select:none;border-radius:8px;background-color:var(--person-card-background-color,var(--neutral-layer-floating));--file-list-background-color:transparent;--file-list-box-shadow:none;--file-item-background-color:transparent}:host .small{max-height:100vh;overflow-y:auto;overflow-x:hidden}:host .nav{height:0;position:relative;z-index:100}:host .nav__back{padding-top:18px;padding-inline-start:12px;height:32px;width:32px}:host .nav__back svg{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .nav__back:hover{cursor:pointer}:host .nav__back:hover svg{fill:var(--person-card-nav-back-arrow-hover-color,var(--neutral-foreground-rest))}:host .close-card-container{position:relative;z-index:100}:host .close-card-container .close-button{position:absolute;right:10px;margin-top:9px;z-index:1;border:1px solid transparent}:host .close-card-container .close-button svg path{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .close-card-container .close-button:hover svg path{fill:var(--person-card-close-button-hover-color,var(--neutral-foreground-rest))}:host .person-details-container{display:flex;flex-direction:column;padding-inline-start:22px;padding-block:36px;border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest))}:host .person-details-container .person-image{--person-avatar-top-spacing:var(--person-card-avatar-top-spacing, 15px);--person-details-left-spacing:var(--person-card-details-left-spacing, 15px);--person-details-bottom-spacing:var(--person-card-details-bottom-spacing, 0);--person-background-color:var(--person-card-background-color, var(--neutral-layer-floating));--person-line1-font-size:var(--person-card-line1-font-size, 20px);--person-line1-font-weight:var(--person-card-line1-font-weight, 600);--person-line1-text-line-height:var(--person-card-line1-line-height, 28px);--person-line1-text-color:var(--person-card-line1-text-color, var(--neutral-foreground-rest));--person-line2-font-size:var(--person-card-line2-font-size, 14px);--person-line2-font-weight:var(--person-card-line2-font-weight, 400);--person-line2-text-line-height:var(--person-card-line2-line-height, 20px);--person-line2-text-color:var(--person-card-line2-text-color, var(--neutral-foreground-hint));--person-line3-font-size:var(--person-card-line3-font-size, 14px);--person-line3-font-weight:var(--person-card-line3-font-weight, 400);--person-line3-text-line-height:var(--person-card-line3-line-height, 19px);--person-line3-text-color:var(--person-card-line3-text-color, var(--neutral-foreground-hint));--person-avatar-size:var(--person-card-avatar-size, 75px);--person-presence-wrapper-bottom:-15px}:host .person-details-container .base-icons{display:flex;align-items:center;margin-inline-start:var(--person-card-base-icons-left-spacing,calc(var(--person-card-avatar-size,75px) + var(--person-card-details-left-spacing,15px) - 8px));z-index:1}:host .person-details-container .base-icons .icon{display:flex;align-items:center;font-size:13px;white-space:nowrap}:host .person-details-container .base-icons .icon:not(:last-child){margin-inline-end:28px}:host .person-details-container .base-icons .icon svg .filled{display:none}:host .person-details-container .base-icons .icon svg .regular{display:block}:host .person-details-container .base-icons .icon svg path{fill:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .person-details-container .base-icons .icon:active svg .filled,:host .person-details-container .base-icons .icon:hover svg .filled{display:block}:host .person-details-container .base-icons .icon:active svg .regular,:host .person-details-container .base-icons .icon:hover svg .regular{display:none}:host .person-details-container .base-icons .icon:active svg path,:host .person-details-container .base-icons .icon:hover svg path{fill:var(--person-card-icon-hover-color,var(--accent-foreground-hover))}:host .expanded-details-container{display:flex;flex-direction:column;position:relative}:host .expanded-details-container .expanded-details-button{display:flex;justify-content:center;height:32px}:host .expanded-details-container .expanded-details-button svg path{stroke:var(--person-card-icon-color,var(--accent-foreground-rest))}:host .expanded-details-container .expanded-details-button:hover{cursor:pointer;background-color:var(--person-card-expanded-background-color-hover,var(--neutral-fill-hover))}:host .expanded-details-container .sections .section{padding:20px 0;display:flex;flex-direction:column;position:relative}:host .expanded-details-container .sections .section:not(:last-child)::after{position:absolute;content:"";width:90%;transform:translateX(-50%);border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest));left:50%;bottom:0}:host .expanded-details-container .sections .section__header{display:flex;flex-direction:row;padding:0 20px}:host .expanded-details-container .sections .section__title{flex-grow:1;color:var(--person-card-line1-text-color,var(--neutral-foreground-rest));font-size:14px;font-weight:600;line-height:19px}:host .expanded-details-container .sections .section__show-more{font-size:12px;font-weight:600;align-self:center;vertical-align:top;--base-height-multiplier:6}:host .expanded-details-container .sections .section__show-more:hover{background-color:var(--person-card-fluent-background-color-hover,var(--neutral-fill-hover))}:host .expanded-details-container .sections .section__content{margin-top:14px}:host .expanded-details-container .sections .section .additional-details{padding:0 20px}:host .expanded-details-container .divider{z-index:100;position:relative;width:375px;margin:0;border-style:none;border-bottom:1px solid var(--person-card-border-color,var(--neutral-stroke-rest))}:host .expanded-details-container .section-nav{height:35px}:host .expanded-details-container .section-nav fluent-tabs{grid-template-columns:minmax(1px,.1fr)}:host .expanded-details-container .section-nav fluent-tabs.horizontal::part(activeIndicator){width:10px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel{max-height:360px;min-height:360px;overflow-y:auto;overflow-x:hidden;padding:0;scrollbar-width:thin}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .inserted{padding:20px 0;max-width:var(--mgt-flyout-set-width,375px);min-width:var(--mgt-flyout-set-width,360px);--file-list-box-shadow:none;--file-list-padding:0}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .inserted .title{font-size:14px;font-weight:600;color:var(--title-color-subtitle,var(--neutral-foreground-rest,#1a1a1a));margin:0 20px 20px;line-height:19px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel .overview-panel{max-width:var(--mgt-flyout-set-width,375px)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-button{height:1px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-track{border-radius:10px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab-panel::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .expanded-details-container .section-nav fluent-tabs fluent-tab{padding-bottom:1px!important;border:1px solid transparent!important}:host .expanded-details-container .section-nav fluent-tabs fluent-tab:focus-visible{border:1px solid #2b2b2b!important}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon{cursor:pointer;box-sizing:border-box;width:53px;height:36px;display:flex;align-items:center;justify-content:center}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon svg{fill:var(--person-card-fluent-background-color,transparent)}:host .expanded-details-container .section-nav fluent-tabs fluent-tab.section-nav__icon:hover{background:var(--person-card-fluent-background-color-hover,var(--neutral-fill-hover));border-radius:4px;z-index:0;position:relative}:host .expanded-details-container .section-host{min-height:360px;overflow-y:auto;overflow-x:hidden}:host .expanded-details-container .section-host::-webkit-scrollbar{height:4em;width:4px;border-radius:11px}:host .expanded-details-container .section-host::-webkit-scrollbar-button{background:#fff}:host .expanded-details-container .section-host::-webkit-scrollbar-track{background:#fff;border-radius:10px}:host .expanded-details-container .section-host::-webkit-scrollbar-track-piece{background:#fff}:host .expanded-details-container .section-host::-webkit-scrollbar-thumb{background:grey;border-radius:10px;height:4px}:host .expanded-details-container .section-host.small{overflow-y:hidden}:host .loading{margin:40px 20px;display:flex;justify-content:center;height:360px}:host .message-section{border-bottom:1px solid var(--person-card-chat-input-border-color,var(--neutral-foreground-hint));display:flex}:host .message-section fluent-text-field{margin:10px 10px 10px 16px;--neutral-fill-input-rest:$person-card-background-color;--neutral-fill-input-hover:$person-card-chat-input-hover-color;--neutral-fill-input-focus:$person-card-chat-input-focus-color;width:300px;margin-inline-start:16px;border-radius:4px;border:1px solid var(--person-card-chat-input-border-color,var(--neutral-foreground-hint))}:host .message-section .send-message-icon{max-width:15px;margin-top:10px}:host .message-section svg{height:17px;width:16px;fill:var(--person-card-chat-input-border-color,var(--neutral-foreground-hint))}:host .message-section svg:hover{filter:brightness(.5)}:host .message-section svg:disabled{filter:none}:host .person-root.large,:host .person-root.threelines{--person-avatar-size-3-lines:75px}:host fluent-button.close-button.lightweight::part(control),:host fluent-button.expanded-details-button::part(control),:host fluent-button.section__show-more.lightweight::part(control){background:var(--person-card-fluent-background-color,transparent)}:host fluent-button.icon::part(control),:host fluent-button.nav__back::part(control){border:none;padding:0;background:0 0}:host fluent-button.icon::part(control) :hover,:host fluent-button.nav__back::part(control) :hover{background:0 0}[dir=rtl] .base-icons{right:91px}[dir=rtl] .nav__back{width:20px!important;transform:scaleX(-1);filter:fliph;filter:FlipH}[dir=rtl] .close-card-container .close-button{right:auto;left:10px}[dir=rtl] .message-section svg{transform:scale(-1,1)}@media (forced-colors:active) and (prefers-color-scheme:dark){.root{border:1px solid #fff;border-radius:inherit}.root svg,.root svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root{border:1px solid #000;border-radius:inherit}.root svg,.root svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.expanded-details-container>svg,.expanded-details-container>svg>path,svg,svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`];var __decorate$h=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$h=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};class BasePersonCardSection extends MgtTemplatedComponent{get personDetails(){return this._personDetails}set personDetails(t){this._personDetails!==t&&(this._personDetails=t,this.requestStateUpdate())}get isCompact(){return this._isCompact}constructor(){super(),this._isCompact=!1,this._personDetails=null}asCompactView(){return this._isCompact=!0,this.requestUpdate(),this}asFullView(){return this._isCompact=!1,this.requestUpdate(),this}clearState(){this._isCompact=!1,this._personDetails=null}render(){return this.isCompact?this.renderCompactView():this.renderFullView()}renderLoading(){return mgtHtml`
      <div class="loading">
        <mgt-spinner></mgt-spinner>
      </div>
    `}renderNoData(){return AI`
      <div class="no-data">No data</div>
    `}navigateCard(t){var o;let s=this.parentNode;for(;s;){s=s.parentNode;const t=s;if((null===(o=null==t?void 0:t.host)||void 0===o?void 0:o.tagName)===`${YA.prefix}-PERSON-CARD`.toUpperCase()){s=t.host;break}}s.navigate(t)}}__decorate$h([n$1({attribute:"person-details",type:Object}),__metadata$h("design:type",Object),__metadata$h("design:paramtypes",[Object])],BasePersonCardSection.prototype,"personDetails",null);const jF=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none}:host .root .part{display:grid;grid-template-columns:auto 1fr auto}:host .root .part .part__icon{display:flex;min-width:20px;width:20px;height:20px;align-items:center;justify-content:center;margin-left:20px;margin-top:10px;line-height:20px}:host .root .part .part__icon svg{fill:var(--contact-copy-icon-color,var(--neutral-foreground-hint))}:host .root .part .part__details{margin:10px 14px;overflow:hidden}:host .root .part .part__details .part__title{font-size:12px;color:var(--contact-title-color,var(--neutral-foreground-hint));line-height:16px}:host .root .part .part__details .part__value{grid-column:2;color:var(--contact-value-color,var(--neutral-foreground-rest));font-size:14px;font-weight:400;line-height:19px}:host .root .part .part__details .part__value .part__link{color:var(--contact-link-color,var(--accent-foreground-rest));font-size:14px;cursor:pointer;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100%;display:inline-block}:host .root .part .part__details .part__value .part__link:hover{color:var(--contact-link-hover-color,var(--accent-foreground-hover))}:host .root .part .part__copy{width:32px;height:100%;background-color:var(--contact-background-color,transparent);visibility:hidden;display:flex;align-items:center;justify-content:flex-start}:host .root .part .part__copy svg{fill:var(--contact-copy-icon-color,var(--neutral-foreground-hint));cursor:pointer}:host .root .part:hover .part__copy{visibility:visible}:host .root.compact{padding:0}:host .root.compact .part{height:30px;align-items:center}:host .root.compact .part__details{margin:0}:host .root.compact .part__title{display:none}:host .root.compact .part__icon{margin-top:0;margin-right:6px;margin-bottom:2px}[dir=rtl] .part__link.phone{text-align:right;direction:ltr}[dir=rtl] .part__icon{margin:10px 20px 0 0!important}[dir=rtl].compact .part__icon{margin-left:6px!important;margin-top:0!important}@media (forced-colors:active) and (prefers-color-scheme:dark){.root svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){.root svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}.root svg path,.root svg rect{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`],zF={contactSectionTitle:"Contact",emailTitle:"Email",chatTitle:"Teams",businessPhoneTitle:"Business Phone",cellPhoneTitle:"Mobile Phone",departmentTitle:"Department",titleTitle:"Title",officeLocationTitle:"Office Location",copyToClipboardButton:"Copy to clipboard"};var __decorate$g=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$g=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtContact=class MgtContact extends BasePersonCardSection{static get styles(){return jF}get strings(){return zF}get hasData(){if(!this._contactParts)return!1;const t=Object.values(this._contactParts).filter((t=>!!t.value));return!!t.length}constructor(t){var o;super(),this._contactParts={email:{icon:getSvg(yP.Email),onClick:()=>this.sendEmail(getEmailFromGraphEntity(this._person)),showCompact:!0,title:this.strings.emailTitle},chat:{icon:getSvg(yP.Chat),onClick:()=>{var t;return this.sendChat(null===(t=this._person)||void 0===t?void 0:t.userPrincipalName)},showCompact:!1,title:this.strings.chatTitle},businessPhone:{icon:getSvg(yP.Phone),onClick:()=>{var t,o;return this.sendCall((null===(o=null===(t=this._person)||void 0===t?void 0:t.businessPhones)||void 0===o?void 0:o.length)>0?this._person.businessPhones[0]:null)},showCompact:!0,title:this.strings.businessPhoneTitle},cellPhone:{icon:getSvg(yP.CellPhone),onClick:()=>{var t;return this.sendCall(null===(t=this._person)||void 0===t?void 0:t.mobilePhone)},showCompact:!0,title:this.strings.cellPhoneTitle},department:{icon:getSvg(yP.Department),showCompact:!1,title:this.strings.departmentTitle},title:{icon:getSvg(yP.Person),showCompact:!1,title:this.strings.titleTitle},officeLocation:{icon:getSvg(yP.OfficeLocation),showCompact:!0,title:this.strings.officeLocationTitle}},this.sendCall=t=>{this.sendLink("tel:",t)},this._person=t,this._contactParts.email.value=getEmailFromGraphEntity(this._person),this._contactParts.chat.value=this._person.userPrincipalName,this._contactParts.cellPhone.value=this._person.mobilePhone,this._contactParts.department.value=this._person.department,this._contactParts.title.value=this._person.jobTitle,this._contactParts.officeLocation.value=this._person.officeLocation,(null===(o=this._person.businessPhones)||void 0===o?void 0:o.length)&&(this._contactParts.businessPhone.value=this._person.businessPhones[0])}get displayName(){return this.strings.contactSectionTitle}get cardTitle(){return this.strings.contactSectionTitle}renderIcon(){return getSvg(yP.Contact)}clearState(){super.clearState();for(const t of Object.keys(this._contactParts))this._contactParts[t].value=null}renderCompactView(){if(!this.hasData)return null;const t=Object.values(this._contactParts).filter((t=>!!t.value));let o=Object.values(t).filter((t=>!!t.value&&t.showCompact));(null==o?void 0:o.length)||(o=Object.values(t).slice(0,2));const s=AI`
      ${o.map((t=>this.renderContactPart(t)))}
    `;return AI`
      <div class="root compact" dir=${this.direction}>
        ${s}
      </div>
    `}renderFullView(){let t;if(this.hasData){const o=Object.values(this._contactParts).filter((t=>!!t.value));t=AI`
        ${o.map((t=>this.renderContactPart(t)))}
      `}return AI`
      <div class="root" dir=${this.direction}>
        ${t}
      </div>
    `}renderContactPart(t){let o=!1;"Mobile Phone"!==t.title&&"Business Phone"!==t.title||(o=!0);const s={part__link:!0,phone:o},l=t.onClick?AI`
          <span class=${iP(s)} @click=${o=>t.onClick(o)}>${t.value}</span>
        `:AI`
          ${t.value}
        `;return AI`
      <div class="part" role="button" @click=${o=>this.handlePartClick(o,t.value)} tabindex="0">
        <div class="part__icon" aria-label=${t.title} title=${t.title}>${t.icon}</div>
        <div class="part__details">
          <div class="part__title">${t.title}</div>
          <div class="part__value" title=${t.title}>${l}</div>
        </div>
        <div
          class="part__copy"
          aria-label=${this.strings.copyToClipboardButton}
          title=${this.strings.copyToClipboardButton}
        >
          ${getSvg(yP.Copy)}
        </div>
      </div>
    `}handlePartClick(t,o){o&&navigator.clipboard.writeText(o)}sendLink(t,o){o?window.open(`${t}${o}`,"_blank","noreferrer"):console.error(`ð¦: Target resource for ${t} link was not provided: resource: ${o}`)}sendChat(t){if(!t)return void console.error("ð¦: Can't send chat when upn is not provided");const o=`https://teams.microsoft.com/l/chat/0/0?users=${t}`,openWindow=()=>window.open(o,"_blank","noreferrer");TeamsHelper.isAvailable?TeamsHelper.executeDeepLink(o,(t=>{t||openWindow()})):openWindow()}sendEmail(t){this.sendLink("mailto:",t)}},exports.MgtContact=__decorate$g([customElement("contact"),__metadata$g("design:paramtypes",[Object])],exports.MgtContact);const VF=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none}:host .root.compact{padding:0}:host .root .message{padding:8px 20px;display:flex;align-items:center;justify-content:space-between}:host .root .message:hover{background-color:var(--message-hover-color,var(--neutral-fill-hover));cursor:pointer}:host .root .message:last-child{margin-bottom:unset}:host .root .message .message__detail{min-width:0;line-height:normal}:host .root .message .message__detail .message__subject{color:var(--message-subject-color,var(--neutral-foreground-color));font-size:var(--message-subject-font-size,14px);font-weight:var(--message-subject-font-weight,600);line-height:var(--message-subject-line-height,20px)}:host .root .message .message__detail .message__from{font-size:var(--message-subject-font-size,12px);color:var(--message-from-color,var(--neutral-foreground-color));line-height:var(--message-subject-line-height,16px);font-weight:var(--message-subject-font-weight,400)}:host .root .message .message__detail .message__message{font-size:var(--message-subject-font-size,12px);color:var(--message-color,var(--neutral-foreground-hint));line-height:var(--message-subject-line-height,16px);font-weight:var(--message-subject-font-weight,400)}:host .root .message .message__detail>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .root .message .message__date{margin-top:8px;font-size:12px;color:var(--message-date,var(--neutral-foreground-hint));margin-left:10px;white-space:nowrap}
`],GF={emailsSectionTitle:"Emails"};var __decorate$f=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$f=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtMessages=class MgtMessages extends BasePersonCardSection{static get styles(){return VF}get strings(){return GF}constructor(t){super(),this._messages=t}get displayName(){return this.strings.emailsSectionTitle}get cardTitle(){return this.strings.emailsSectionTitle}clearState(){super.clearState(),this._messages=[]}renderIcon(){return getSvg(yP.Messages)}renderCompactView(){var t;let o;if(this.isLoadingState)o=this.renderLoading();else if(null===(t=this._messages)||void 0===t?void 0:t.length){const t=this._messages?this._messages.slice(0,3).map((t=>this.renderMessage(t))):[];o=AI`
         ${t}
       `}else o=this.renderNoData();return AI`
       <div class="root compact">
         ${o}
       </div>
     `}renderFullView(){var t;let o;return o=this.isLoadingState?this.renderLoading():(null===(t=this._messages)||void 0===t?void 0:t.length)?AI`
         ${this._messages.slice(0,5).map((t=>this.renderMessage(t)))}
       `:this.renderNoData(),AI`
       <div class="root">
         ${o}
       </div>
     `}renderMessage(t){return AI`
       <div class="message" @click=${()=>this.handleMessageClick(t)}>
         <div class="message__detail">
           <div class="message__subject">${t.subject}</div>
           <div class="message__from">${t.from.emailAddress.name}</div>
           <div class="message__message">${t.bodyPreview}</div>
         </div>
         <div class="message__date">${getRelativeDisplayDate(new Date(t.receivedDateTime))}</div>
       </div>
     `}handleMessageClick(t){window.open(t.webLink,"_blank","noreferrer")}},exports.MgtMessages=__decorate$f([customElement("messages"),__metadata$f("design:paramtypes",[Array])],exports.MgtMessages);const KF=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none}:host .root.compact{padding:0}:host .root.compact .coworker .coworker__image{height:40px;width:40px;border-radius:40px;--avatar-size:40px;--avatar-size-s:40px;margin-right:12px}:host .root.compact .coworker .coworker__name{font-size:14px}:host .root.compact .coworker .coworker__title{font-size:12px}:host .root .subtitle{color:var(--organization-sub-title-color,var(--neutral-foreground-hint));font-size:14px;margin:0 20px 8px}:host .root .divider{display:flex;background:var(--organization-coworker-border-color,var(--neutral-stroke-rest));height:1px;margin:26px 20px 18px}:host .root .org-member{height:74px;box-sizing:border-box;border-radius:2px;padding:12px;display:flex;align-items:center;margin-left:20px;margin-right:20px}:host .root .org-member.org-member--target{background-color:var(--organization-active-org-member-target-background-color,var(--neutral-fill-active));border:1px solid var(--organization-active-org-member-border-color,var(--accent-foreground-rest))}:host .root .org-member:not(.org-member--target){border:1px solid var(--organization-coworker-border-color,var(--neutral-stroke-rest))}:host .root .org-member:not(.org-member--target):hover{cursor:pointer;background-color:var(--organization-hover-color,var(--neutral-fill-hover))}:host .root .org-member .org-member__person{flex-grow:1}:host .root .org-member .org-member__details{flex-grow:1}:host .root .org-member .org-member__details .org-member__name{font-size:16px;color:var(--organization-title-color,var(--neutral-foreground-rest));font-weight:600}:host .root .org-member .org-member__details .org-member__department,:host .root .org-member .org-member__details .org-member__title{font-weight:14px;color:var(--organization-sub-title-color,var(--neutral-foreground-hint))}:host .root .org-member__separator:not(:last-child){border:1px solid var(--organization-coworker-border-color,var(--neutral-stroke-rest));box-sizing:border-box;width:0;margin:0 50%;height:14px}:host .root .coworker{display:flex;align-items:center;padding:10px 20px}:host .root .coworker:hover{cursor:pointer;background-color:var(--organization-coworker-hover-color,var(--neutral-fill-hover))}:host .root .coworker .coworker__person{height:46px;border-radius:46px;margin-right:8px}:host .root .direct-report__compact{padding:12px 20px}:host .root .direct-report__compact .direct-report{cursor:pointer;width:38px;margin-right:4px;display:inline;--avatar-size:38px}[dir=rtl] .org-member .org-member__more{transform:scaleX(-1);filter:fliph;filter:FlipH}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg,:host svg>path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}
`],WF={reportsToSectionTitle:"Reports to",directReportsSectionTitle:"Direct reports",organizationSectionTitle:"Organization",youWorkWithSubSectionTitle:"You work with",userWorksWithSubSectionTitle:"works with"};var __decorate$e=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$e=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtOrganization=class MgtOrganization extends BasePersonCardSection{static get styles(){return KF}get strings(){return WF}constructor(t,o){super(),this._state=t,this._me=o}clearState(){super.clearState(),this._state=null,this._me=null}get displayName(){const{person:t,directReports:o}=this._state;return!t.manager&&(null==o?void 0:o.length)?`${this.strings.directReportsSectionTitle} (${o.length})`:this.strings.reportsToSectionTitle}get cardTitle(){return this.strings.organizationSectionTitle}renderIcon(){return getSvg(yP.Organization)}renderCompactView(){var t;let o;if(!(null===(t=this._state)||void 0===t?void 0:t.person))return null;const{person:s,directReports:l}=this._state;return s?(s.manager?o=this.renderCoworker(s.manager):(null==l?void 0:l.length)&&(o=this.renderCompactDirectReports()),AI`
        <div class="root compact">
          ${o}
        </div>
      `):null}renderFullView(){var t;let o;if(!(null===(t=this._state)||void 0===t?void 0:t.person))return null;const{person:s,directReports:l,people:h}=this._state;if(!(s||l||h))return null;{const t=this.renderManagers(),s=this.renderCurrentUser(),l=this.renderDirectReports(),h=this.renderCoworkers();o=AI`
          ${t} ${s} ${l} ${h}
        `}return AI`
       <div class="root" dir=${this.direction}>
         ${o}
       </div>
     `}renderManager(t){return mgtHtml`
      <div
        class="org-member"
        @keydown=${o=>{"Enter"!==o.code&&" "!==o.code||this.navigateCard(t)}}
        @click=${()=>this.navigateCard(t)}
      >
        <div class="org-member__person">
          <mgt-person
            .personDetails=${t}
            .fetchImage=${!0}
            .view=${exports.ViewType.twolines}
            .showPresence=${!0}
          ></mgt-person>
        </div>
        <div tabindex="0" class="org-member__more">
          ${getSvg(yP.ExpandRight)}
        </div>
      </div>
      <div class="org-member__separator"></div>
     `}renderManagers(){const{person:t}=this._state;if(!(null==t?void 0:t.manager))return null;const o=[];let s=t;for(;s.manager;)o.push(s.manager),s=s.manager;return o.length?o.reverse().map((t=>this.renderManager(t))):null}renderDirectReports(){const{directReports:t}=this._state;return(null==t?void 0:t.length)?AI`
      <div class="org-member__separator"></div>
      <div>
        ${t.map((t=>mgtHtml`
            <div
              class="org-member org-member--direct-report"
              @keydown=${o=>{"Enter"!==o.code&&" "!==o.code||this.navigateCard(t)}}
              @click=${()=>this.navigateCard(t)}
            >
              <div class="org-member__person">
                <mgt-person
                  .personDetails=${t}
                  .fetchImage=${!0}
                  .showPresence=${!0}
                  .view=${exports.ViewType.twolines}
                ></mgt-person>
              </div>
              <div tabindex="0" class="org-member__more">
                ${getSvg(yP.ExpandRight)}
              </div>
            </div>
            <div class="org-member__separator"></div>
          `))}
      </div>
     `:null}renderCompactDirectReports(){const{directReports:t}=this._state;return AI`
      <div class="direct-report__compact">
        ${t.slice(0,6).map((t=>mgtHtml`
            <div
              class="direct-report"
              @keydown=${o=>{"Enter"!==o.code&&" "!==o.code||this.navigateCard(t)}}
              @click=${()=>this.navigateCard(t)}
            >
              <mgt-person
                .personDetails=${t}
                .fetchImage=${!0}
                .showPresence=${!0}
                .view=${exports.ViewType.twolines}
              ></mgt-person>
            </div>
          `))}
      </div>
    `}renderCurrentUser(){const{person:t}=this._state;return mgtHtml`
       <div class="org-member org-member--target">
         <div class="org-member__person">
           <mgt-person
             .personDetails=${t}
             .fetchImage=${!0}
             .showPresence=${!0}
             .view=${exports.ViewType.twolines}
           ></mgt-person>
         </div>
       </div>
     `}renderCoworker(t){return mgtHtml`
      <div
        class="coworker"
        @keydown=${o=>{"Enter"!==o.code&&" "!==o.code||this.navigateCard(t)}}
        @click=${()=>this.navigateCard(t)}
      >
        <div class="coworker__person">
          <mgt-person
            .personDetails=${t}
            .fetchImage=${!0}
            .showPresence=${!0}
            .view=${exports.ViewType.twolines}
          ></mgt-person>
        </div>
      </div>
    `}renderCoworkers(){const{people:t}=this._state;if(!(null==t?void 0:t.length))return null;const o=this._me.id===this._state.person.id?this.strings.youWorkWithSubSectionTitle:`${this._state.person.givenName} ${this.strings.userWorksWithSubSectionTitle}`;return AI`
       <div class="divider"></div>
       <div class="subtitle" tabindex="0">${o}</div>
       <div>
         ${t.slice(0,6).map((t=>this.renderCoworker(t)))}
       </div>
     `}},exports.MgtOrganization=__decorate$e([customElement("organization"),__metadata$e("design:paramtypes",[Object,Object])],exports.MgtOrganization);const QF=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .loading,:host .no-data{margin:0 20px;display:flex;justify-content:center}:host .no-data{font-style:normal;font-weight:600;font-size:14px;color:var(--font-color,#323130);line-height:19px}:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative;user-select:none;background-color:var(--profile-background-color,--neutral-layer-1)}:host .root{padding:20px 0}:host .root.compact{padding:0}:host .root .title{font-size:14px;font-weight:600;color:var(--profile-title-color,var(--neutral-foreground-rest));margin:0 20px 12px}:host .root section{margin-bottom:24px;padding:0 20px}:host .root section:last-child{margin:0}:host .root section .section__title{font-size:14px;color:var(--profile-section-title-color,var(--neutral-foreground-hint))}:host .root section .section__content{display:flex;flex-direction:column;margin-top:10px}:host .root .token-list{display:flex;flex-flow:row wrap;margin-top:-10px}:host .root .token-list .token-list__item{text-overflow:ellipsis;white-space:nowrap;display:inline-block;overflow:hidden;font-size:14px;align-items:center;background:var(--profile-token-item-background-color,var(--neutral-fill-secondary-rest));border-radius:2px;max-height:28px;padding:4px 8px;margin-right:10px;margin-top:10px;color:var(--profile-token-item-color,var(--neutral-foreground-rest))}:host .root .token-list .token-list__item:last-child{margin-right:initial}:host .root .token-list .token-list__item.overflow{display:none}:host .root .token-list .token-list__item.token-list__item--show-overflow{cursor:pointer;user-select:unset;background:0 0;color:var(--profile-token-overflow-color,var(--accent-foreground-rest))}:host .root .data-list__item{margin-bottom:20px}:host .root .data-list__item:last-child{margin-bottom:initial}:host .root .data-list__item .data-list__item__header{display:flex;justify-content:space-between;align-items:center}:host .root .data-list__item .data-list__item__content{font-size:12px;line-height:16px;color:var(--profile-section-title-color,var(--neutral-foreground-hint));margin-top:4px}:host .root .data-list__item .data-list__item__title{font-size:14px;line-height:16px;color:var(--profile-title-color,var(--neutral-foreground-rest))}:host .root .data-list__item .data-list__item__date-range{color:var(--profile-section-title-color,var(--neutral-foreground-hint));font-size:10px;line-height:12px}:host .root .language__proficiency{opacity:.77}:host .root .work-position .work-position__company{color:#023b8f}:host .root .work-position .work-position__location{font-size:10px;color:var(--profile-section-title-color,var(--neutral-foreground-hint));line-height:16px}:host .root .educational-activity .educational-activity__degree{font-size:12px;line-height:14px;color:var(--profile-section-title-color,var(--neutral-foreground-hint))}:host .root .birthday{display:flex;align-items:center;margin-top:-6px}:host .root .birthday .birthday__icon{margin-right:8px}:host .root .birthday .birthday__date{font-size:12px;color:var(--profile-title-color,var(--neutral-foreground-rest))}[dir=rtl] .token-list__item{margin-right:0!important}
`],YF={SkillsAndExperienceSectionTitle:"Skills & Experience",AboutCompactSectionTitle:"About",SkillsSubSectionTitle:"Skills",LanguagesSubSectionTitle:"Languages",WorkExperienceSubSectionTitle:"Work Experience",EducationSubSectionTitle:"Education",professionalInterestsSubSectionTitle:"Professional Interests",personalInterestsSubSectionTitle:"Personal Interests",birthdaySubSectionTitle:"Birthday",currentYearSubtitle:"Current",socialMediaSubSectionTitle:"Social Media"};var __decorate$d=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$d=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtProfile=class MgtProfile extends BasePersonCardSection{static get styles(){return QF}get strings(){return YF}get displayName(){return this.strings.SkillsAndExperienceSectionTitle}get cardTitle(){return this.strings.AboutCompactSectionTitle}get hasData(){var t,o;if(!this.profile)return!1;const{languages:s,skills:l,positions:h,educationalActivities:m}=this.profile;return[this._birthdayAnniversary,null===(t=this._personalInterests)||void 0===t?void 0:t.length,null===(o=this._professionalInterests)||void 0===o?void 0:o.length,null==s?void 0:s.length,null==l?void 0:l.length,null==h?void 0:h.length,null==m?void 0:m.length].filter((t=>!!t)).length>0}get profile(){return this._profile}set profile(t){t!==this._profile&&(this._profile=t,this._birthdayAnniversary=(null==t?void 0:t.anniversaries)?t.anniversaries.find(this.isBirthdayAnniversary):null,this._personalInterests=(null==t?void 0:t.interests)?t.interests.filter(this.isPersonalInterest):null,this._professionalInterests=(null==t?void 0:t.interests)?t.interests.filter(this.isProfessionalInterest):null)}constructor(t){super(),this.isPersonalInterest=t=>{var o;return null===(o=t.categories)||void 0===o?void 0:o.includes("personal")},this.isProfessionalInterest=t=>{var o;return null===(o=t.categories)||void 0===o?void 0:o.includes("professional")},this.isBirthdayAnniversary=t=>"birthday"===t.type,this.profile=t}renderIcon(){return getSvg(yP.Profile)}clearState(){super.clearState(),this.profile=null}renderCompactView(){return AI`
       <div class="root compact" dir=${this.direction}>
         ${this.renderSubSections().slice(0,2)}
       </div>
     `}renderFullView(){return this.initPostRenderOperations(),AI`
       <div class="root" dir=${this.direction}>
         ${this.renderSubSections()}
       </div>
     `}renderSubSections(){return[this.renderSkills(),this.renderBirthday(),this.renderLanguages(),this.renderWorkExperience(),this.renderEducation(),this.renderProfessionalInterests(),this.renderPersonalInterests()].filter((t=>!!t))}renderLanguages(){var t;const{languages:o}=this._profile;if(!(null==o?void 0:o.length))return null;const s=[];for(const l of o){let o=null;(null===(t=l.proficiency)||void 0===t?void 0:t.length)&&(o=AI`
           <span class="language__proficiency" tabindex="0">
             &nbsp;(${l.proficiency})
           </span>
         `),s.push(AI`
         <div class="token-list__item language">
           <span class="language__title" tabindex="0">${l.displayName}</span>
           ${o}
         </div>
       `)}const l=s.length?this.strings.LanguagesSubSectionTitle:"";return AI`
       <section>
         <div class="section__title" tabindex="0">${l}</div>
         <div class="section__content">
           <div class="token-list">
             ${s}
           </div>
         </div>
       </section>
     `}renderSkills(){const{skills:t}=this._profile;if(!(null==t?void 0:t.length))return null;const o=[];for(const s of t)o.push(AI`
         <div class="token-list__item skill" tabindex="0">
           ${s.displayName}
         </div>
       `);const s=o.length?this.strings.SkillsSubSectionTitle:"";return AI`
       <section>
         <div class="section__title" tabindex="0">${s}</div>
         <div class="section__content">
           <div class="token-list">
             ${o}
           </div>
         </div>
       </section>
     `}renderWorkExperience(){var t,o,s,l,h;const{positions:m}=this._profile;if(!(null==m?void 0:m.length))return null;const _=[];for(const m of this._profile.positions)(m.detail.description||""!==m.detail.jobTitle)&&_.push(AI`
           <div class="data-list__item work-position">
             <div class="data-list__item__header">
               <div class="data-list__item__title" tabindex="0">${null===(t=m.detail)||void 0===t?void 0:t.jobTitle}</div>
               <div class="data-list__item__date-range" tabindex="0">
                 ${this.getDisplayDateRange(m.detail)}
               </div>
             </div>
             <div class="data-list__item__content">
               <div class="work-position__company" tabindex="0">
                 ${null===(s=null===(o=null==m?void 0:m.detail)||void 0===o?void 0:o.company)||void 0===s?void 0:s.displayName}
               </div>
               <div class="work-position__location" tabindex="0">
                 ${this.displayLocation(null===(h=null===(l=null==m?void 0:m.detail)||void 0===l?void 0:l.company)||void 0===h?void 0:h.address)}
               </div>
             </div>
           </div>
         `);const E=_.length?this.strings.WorkExperienceSubSectionTitle:"";return AI`
       <section>
         <div class="section__title" tabindex="0">${E}</div>
         <div class="section__content">
           <div class="data-list">
             ${_}
           </div>
         </div>
       </section>
     `}renderEducation(){const{educationalActivities:t}=this._profile;if(!(null==t?void 0:t.length))return null;const o=[];for(const s of t)o.push(AI`
         <div class="data-list__item educational-activity">
           <div class="data-list__item__header">
             <div class="data-list__item__title" tabindex="0">${s.institution.displayName}</div>
             <div class="data-list__item__date-range" tabindex="0">
               ${this.getDisplayDateRange(s)}
             </div>
           </div>
           ${s.program.displayName?AI`<div class="data-list__item__content">
                  <div class="educational-activity__degree" tabindex="0">
                  ${s.program.displayName}
                </div>`:PI}
         </div>
       `);const s=o.length?this.strings.EducationSubSectionTitle:"";return AI`
       <section>
         <div class="section__title" tabindex="0">${s}</div>
         <div class="section__content">
           <div class="data-list">
             ${o}
           </div>
         </div>
       </section>
     `}renderProfessionalInterests(){var t;if(!(null===(t=this._professionalInterests)||void 0===t?void 0:t.length))return null;const o=[];for(const t of this._professionalInterests)o.push(AI`
         <div class="token-list__item interest interest--professional" tabindex="0">
           ${t.displayName}
         </div>
       `);const s=o.length?this.strings.professionalInterestsSubSectionTitle:"";return AI`
       <section>
         <div class="section__title" tabindex="0">${s}</div>
         <div class="section__content">
           <div class="token-list">
             ${o}
           </div>
         </div>
       </section>
     `}renderPersonalInterests(){var t;if(!(null===(t=this._personalInterests)||void 0===t?void 0:t.length))return null;const o=[];for(const t of this._personalInterests)o.push(AI`
         <div class="token-list__item interest interest--personal" tabindex="0">
           ${t.displayName}
         </div>
       `);const s=o.length?this.strings.personalInterestsSubSectionTitle:"";return AI`
       <section>
         <div class="section__title" tabindex="0">${s}</div>
         <div class="section__content">
           <div class="token-list">
             ${o}
           </div>
         </div>
       </section>
     `}renderBirthday(){var t;return(null===(t=this._birthdayAnniversary)||void 0===t?void 0:t.date)?AI`
       <section>
         <div class="section__title" tabindex="0">Birthday</div>
         <div class="section__content">
           <div class="birthday">
             <div class="birthday__icon">
               ${getSvg(yP.Birthday)}
             </div>
             <div class="birthday__date" tabindex="0">
               ${this.getDisplayDate(new Date(this._birthdayAnniversary.date))}
             </div>
           </div>
         </div>
       </section>
     `:null}getDisplayDate(t){return t.toLocaleString("default",{day:"numeric",month:"long"})}getDisplayDateRange(t){if(!t.startMonthYear)return PI;const o=new Date(t.startMonthYear).getFullYear();if(0===o||1===o)return PI;return`${o} â ${t.endMonthYear?new Date(t.endMonthYear).getFullYear():this.strings.currentYearSubtitle}`}displayLocation(t){return(null==t?void 0:t.city)?t.state?`${t.city}, ${t.state}`:t.city:PI}initPostRenderOperations(){setTimeout((()=>{try{this.shadowRoot.querySelectorAll("section").forEach((t=>{this.handleTokenOverflow(t)}))}catch(t){}}),0)}handleTokenOverflow(t){const o=t.querySelectorAll(".token-list");if(null==o?void 0:o.length)for(const t of Array.from(o)){const o=t.querySelectorAll(".token-list__item");if(!(null==o?void 0:o.length))continue;let s=null,l=o[0].getBoundingClientRect();const h=t.getBoundingClientRect(),m=2*l.height+h.top;for(let t=0;t<o.length-1;t++)if(l=o[t].getBoundingClientRect(),l.top>m){s=Array.from(o).slice(t,o.length);break}if(s){s.forEach((t=>t.classList.add("overflow")));const o=document.createElement("div");o.classList.add("token-list__item"),o.classList.add("token-list__item--show-overflow"),o.tabIndex=0,o.innerText=`+ ${s.length} more`;const revealOverflow=()=>{o.remove(),s.forEach((t=>t.classList.remove("overflow")))};o.addEventListener("click",(()=>{revealOverflow()})),o.addEventListener("keydown",(t=>{"Enter"===t.code&&revealOverflow()})),t.appendChild(o)}}}},exports.MgtProfile=__decorate$d([customElement("profile"),__metadata$d("design:paramtypes",[Object])],exports.MgtProfile);const ZF={showMoreSectionButton:"Show more",endOfCard:"End of the card",quickMessage:"Send a quick message",expandDetailsLabel:"Expand details",sendMessageLabel:"Send message",emailButtonLabel:"Email",callButtonLabel:"Call",chatButtonLabel:"Chat",closeCardLabel:"Close card",videoButtonLabel:"Video",goBackLabel:"Go Back"};var JF,__decorate$c=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$c=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$e=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents($L,nF,rF,oF,AL,sF),exports.MgtPersonCard=JF=class MgtPersonCard extends MgtTemplatedComponent{static get styles(){return qF}get strings(){return ZF}static get requiredScopes(){return JF.getScopes()}static getScopes(){const t=[];return this.config.sections.files&&t.push("Sites.Read.All"),this.config.sections.mailMessages&&(t.push("Mail.Read"),t.push("Mail.ReadBasic")),this.config.sections.organization&&(t.push("User.Read.All"),"boolean"!=typeof this.config.sections.organization&&this.config.sections.organization.showWorksWith&&t.push("People.Read.All")),this.config.sections.profile&&t.push("User.Read.All"),this.config.useContactApis&&t.push("Contacts.Read"),t.indexOf("User.Read.All")<0&&(t.push("User.ReadBasic.All"),t.push("User.Read")),t.indexOf("People.Read.All")<0&&t.push("People.Read"),t.push("Chat.Create","Chat.ReadWrite"),[...new Set(t)]}static get config(){return this._config}get personDetails(){return this._personDetails}set personDetails(t){this._personDetails!==t&&(this._personDetails=t,this.personImage=this.getImage(),this.requestStateUpdate())}get userId(){return this._userId}set userId(t){t!==this._userId&&(this._userId=t,this.personDetails=null,this._cardState=null,this.requestStateUpdate())}get internalPersonDetails(){var t;return(null===(t=this._cardState)||void 0===t?void 0:t.person)||this.personDetails}constructor(){super(),this.isSending=!1,this.goBack=()=>{var t;if(!(null===(t=this._history)||void 0===t?void 0:t.length))return;const o=this._history.pop();this._currentSection=null;const s=this.renderRoot.querySelector("fluent-tab");s&&s.click(),this._cardState=o.state,this._personDetails=o.state.person,this.personImage=o.personImage,this.loadSections()},this.handleEndOfCard=t=>{if(t&&"Tab"===t.code){const t=this.renderRoot.querySelector("#end-of-container");if(t){t.blur();const o=this.renderRoot.querySelector("mgt-person");o&&o.focus()}}},this.closeCard=()=>{this.updateCurrentSection(null),this.isExpanded=!1},this.sendQuickMessage=()=>__awaiter$e(this,void 0,void 0,(function*(){const t=this._chatInput.trim();if(!(null==t?void 0:t.length))return;const o=this.personDetails,s=this._me.userPrincipalName;this.isSending=!0;const l=yield((t,o,s)=>__awaiter$f(void 0,void 0,void 0,(function*(){const l={chatType:"oneonOne",members:[{"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:["owner"],"user@odata.bind":`https://graph.microsoft.com/v1.0/users('${s}')`},{"@odata.type":"#microsoft.graph.aadUserConversationMember",roles:["owner"],"user@odata.bind":`https://graph.microsoft.com/v1.0/users('${o}')`}]};return yield t.api("/chats").header("Cache-Control","no-store").middlewareOptions(prepScopes("Chat.Create","Chat.ReadWrite")).post(l)})))(this._graph,o.userPrincipalName,s),h={body:{content:t}};yield((t,o,s)=>__awaiter$f(void 0,void 0,void 0,(function*(){return yield t.api(`/chats/${o}/messages`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Chat.ReadWrite","ChatMessage.Send")).post(s)})))(this._graph,l.id,h),this.isSending=!1,this.clearInputData()})),this.emailUser=()=>{const t=this.internalPersonDetails;if(t){const o=getEmailFromGraphEntity(t);o&&window.open("mailto:"+o,"_blank","noreferrer")}},this.callUser=()=>{var t,o;const s=this.personDetails,l=this.personDetails;if(null===(t=null==s?void 0:s.businessPhones)||void 0===t?void 0:t.length){const t=s.businessPhones[0];t&&window.open("tel:"+t,"_blank","noreferrer")}else if(null===(o=null==l?void 0:l.phones)||void 0===o?void 0:o.length){const t=this.getPersonBusinessPhones(l)[0];t&&window.open("tel:"+t,"_blank","noreferrer")}},this.chatUser=(t=null)=>{const o=this.personDetails;if(null==o?void 0:o.userPrincipalName){let s=`https://teams.microsoft.com/l/chat/0/0?users=${o.userPrincipalName}`;(null==t?void 0:t.length)&&(s+=`&message=${t}`);const openWindow=()=>window.open(s,"_blank","noreferrer");TeamsHelper.isAvailable?TeamsHelper.executeDeepLink(s,(t=>{t||openWindow()})):openWindow()}},this.videoCallUser=()=>{const t=this.personDetails;if(null==t?void 0:t.userPrincipalName){const o=`https://teams.microsoft.com/l/call/0/0?users=${t.userPrincipalName}&withVideo=true`,openWindow=()=>window.open(o,"_blank");TeamsHelper.isAvailable?TeamsHelper.executeDeepLink(o,(t=>{t||openWindow()})):openWindow()}},this.showExpandedDetails=()=>{const t=this.renderRoot.querySelector(".root");(null==t?void 0:t.animate)&&t.animate([{height:"auto",transformOrigin:"top left"},{height:"auto",transformOrigin:"top left"}],{duration:1e3,easing:"ease-in-out",fill:"both"}),this.isExpanded=!0,this.fireCustomEvent("expanded",null,!0)},this.sendQuickMessageOnEnter=t=>{"Enter"===t.code&&this.sendQuickMessage()},this.handleGoBack=t=>{"Enter"===t.code&&this.goBack()},this._chatInput="",this._currentSection=null,this._history=[],this.sections=[],this._graph=null}attributeChangedCallback(t,o,s){if(super.attributeChangedCallback(t,o,s),o!==s&&"person-query"===t)this.personDetails=null,this._cardState=null,this.requestStateUpdate()}navigate(t){this._history.push({personDetails:this.personDetails,personImage:this.getImage(),state:this._cardState}),this._personDetails=t,this._cardState=null,this.personImage=null,this._currentSection=null,this.sections=[],this._chatInput="",this.requestStateUpdate()}clearHistory(){var t;if(this._currentSection=null,!(null===(t=this._history)||void 0===t?void 0:t.length))return;const o=this._history[0];this._history=[],this._cardState=o.state,this._personDetails=o.personDetails,this.personImage=o.personImage,this.loadSections()}render(){var t;if(!this.internalPersonDetails)return this.renderNoData();const o=this.internalPersonDetails,s=this.getImage();if(this.hasTemplate("default"))return this.renderTemplate("default",{person:this.internalPersonDetails,personImage:s});let l;l=this.strings.closeCardLabel;const h=this.isExpanded?AI`
           <div class="close-card-container">
             <fluent-button 
              appearance="lightweight" 
              class="close-button" 
              aria-label=${l}
              @click=${this.closeCard} >
               ${getSvg(yP.Close)}
             </fluent-button>
           </div>
         `:null;l=this.strings.goBackLabel;const m=(null===(t=this._history)||void 0===t?void 0:t.length)?AI`
            <div class="nav">
              <fluent-button 
                appearance="lightweight"
                class="nav__back" 
                aria-label=${l} 
                @keydown=${this.handleGoBack}
                @click=${this.goBack}>${getSvg(yP.Back)}
               </fluent-button>
            </div>
          `:null;let _=this.renderTemplate("person-details",{person:this.internalPersonDetails,personImage:s});if(!_){const t=this.renderPerson(),s=this.renderContactIcons(o);_=AI`
         ${t} ${s}
       `}const E=this.isExpanded?this.renderExpandedDetails():this.renderExpandedDetailsButton();this._windowHeight=window.innerHeight&&document.documentElement.clientHeight?Math.min(window.innerHeight,document.documentElement.clientHeight):window.innerHeight||document.documentElement.clientHeight,this._windowHeight<250&&(this._smallView=!0);const $=this.lockTabNavigation?AI`<div @keydown=${this.handleEndOfCard} aria-label=${this.strings.endOfCard} tabindex="0" id="end-of-container"></div>`:AI``;return AI`
      <div class="root" dir=${this.direction}>
        <div class=${iP({small:this._smallView})}>
          ${m}
          ${h}
          <div class="person-details-container">${_}</div>
          <div class="expanded-details-container">${E}</div>
          ${$}
        </div>
      </div>
     `}renderNoData(){return this.renderTemplate("no-data",null)||AI``}renderPerson(){return mgtHtml`
      <mgt-person
        tabindex="0"
        class="person-image"
        .personDetails=${this.internalPersonDetails}
        .personImage=${this.getImage()}
        .personPresence=${this.personPresence}
        .showPresence=${this.showPresence}
        .view=${exports.ViewType.threelines}
      ></mgt-person>
    `}renderPersonSubtitle(t){if(t=t||this.internalPersonDetails,isUser(t)&&t.department)return AI`
       <div class="department">${t.department}</div>
     `}renderContactIcons(t){const o=t=t||this.internalPersonDetails;let s,l,h;getEmailFromGraphEntity(t)&&(s=`${this.strings.emailButtonLabel} ${t.displayName}`,l=AI`
        <fluent-button class="icon"
          aria-label=${s}
          @click=${this.emailUser}>
          ${getSvg(yP.SmallEmail)}
        </fluent-button>
      `),(null==o?void 0:o.userPrincipalName)&&(s=`${this.strings.chatButtonLabel} ${t.displayName}`,h=AI`
        <fluent-button class="icon"
          aria-label=${s}
          @click=${this.chatUser}>
          ${getSvg(yP.SmallChat)}
        </fluent-button>
       `),s=`${this.strings.videoButtonLabel} ${t.displayName}`;const m=AI`
      <fluent-button class="icon"
        aria-label=${s}
        @click=${this.videoCallUser}>
        ${getSvg(yP.Video)}
      </fluent-button>
    `;let _;return o.userPrincipalName&&(s=`${this.strings.callButtonLabel} ${t.displayName}`,_=AI`
         <fluent-button class="icon"
          aria-label=${s}
          @click=${this.callUser}>
          ${getSvg(yP.Call)}
        </fluent-button>
       `),AI`
       <div class="base-icons">
         ${l} ${h} ${m} ${_}
       </div>
     `}renderExpandedDetailsButton(){return AI`
      <fluent-button
        aria-label=${this.strings.expandDetailsLabel}
        class="expanded-details-button"
        @click=${this.showExpandedDetails}
      >
        ${getSvg(yP.ExpandDown)}
      </fluent-button>
     `}renderExpandedDetails(){if(!this._cardState&&this._isStateLoading)return mgtHtml`
         <div class="loading">
           <mgt-spinner></mgt-spinner>
         </div>
       `;Providers.globalProvider.state===exports.ProviderState.SignedOut&&this.loadSections();const t=this.renderSectionNavigation();return AI`
      <div class="section-nav">
        ${t}
      </div>
      <hr class="divider"/>
      <div
        class="section-host ${this._smallView?"small":""} ${this._smallView?"small":""}"
        @wheel=${t=>this.handleSectionScroll(t)}
        tabindex=0
      ></div>
    `}renderSectionNavigation(){if(!this.sections||this.sections.length<2&&!this.hasTemplate("additional-details"))return;const t=this._currentSection?this.sections.indexOf(this._currentSection):-1,o=this.sections.map(((o,s)=>{const l=o.tagName.toLowerCase(),h=iP({active:s===t,"section-nav__icon":!0});return AI`
        <fluent-tab
          id="${l}-Tab"
          class=${h}
          slot="tab"
          @keyup="${()=>this.updateCurrentSection(o)}"
          @click=${()=>this.updateCurrentSection(o)}
        >
          ${o.renderIcon()}
        </fluent-tab>
      `})),s=this.sections.map((t=>AI`
        <fluent-tab-panel slot="tabpanel">
          <div class="inserted">
            <div class="title">${t.cardTitle}</div>
            ${this._currentSection?t.asFullView():null}
          </div>
        </fluent-tab-panel>
      `)),l=iP({active:-1===t,"section-nav__icon":!0,overviewTab:!0});return AI`
      <fluent-tabs
        orientation="horizontal"
        activeindicator
        @wheel=${t=>this.handleSectionScroll(t)}
      >
        <fluent-tab
          class="${l}"
          slot="tab"
          @keyup="${()=>this.updateCurrentSection(null)}"
          @click=${()=>this.updateCurrentSection(null)}
        >
          <div>${getSvg(yP.Overview)}</div>
        </fluent-tab>
        ${o}
        <fluent-tab-panel slot="tabpanel" >
          <div class="overview-panel">${this._currentSection?null:this.renderOverviewSection()}</div>
        </fluent-tab-panel>
        ${s}
      </fluent-tabs>
    `}renderOverviewSection(){const t=this.sections.map((t=>AI`
        <div class="section">
          <div class="section__header">
            <div class="section__title" tabindex=0>${t.displayName}</div>
              <fluent-button
                appearance="lightweight"
                class="section__show-more"
                @click=${()=>this.updateCurrentSection(t)}
              >
                ${this.strings.showMoreSectionButton}
              </fluent-button>
          </div>
          <div class="section__content">${t.asCompactView()}</div>
        </div>
      `)),o=this.renderTemplate("additional-details",{person:this.internalPersonDetails,personImage:this.getImage(),state:this._cardState});return o&&t.splice(1,0,AI`
           <div class="section">
             <div class="additional-details">${o}</div>
           </div>
         `),AI`
       <div class="sections">
          ${this.renderMessagingSection()}
          ${t}
       </div>
     `}renderCurrentSection(){var t;if((null===(t=this.sections)||void 0===t?void 0:t.length)||this.hasTemplate("additional-details"))return 1!==this.sections.length||this.hasTemplate("additional-details")?this._currentSection?AI`
       ${this._currentSection.asFullView()}
     `:this.renderOverviewSection():AI`
         ${this.sections[0].asFullView()}
       `}renderMessagingSection(){const t=this.personDetails,o=this._me.userPrincipalName,s=this._chatInput;return(null==t?void 0:t.userPrincipalName)===o?void 0:AI`
      <div class="message-section">
        <fluent-text-field
          autocomplete="off"
          appearance="outline"
          placeholder="${this.strings.quickMessage}"
          .value=${s}
          @input=${t=>{this._chatInput=t.target.value,this.requestUpdate()}}
          @keydown="${t=>this.sendQuickMessageOnEnter(t)}">
        </fluent-text-field>
        <fluent-button class="send-message-icon"
          aria-label=${this.strings.sendMessageLabel}
          @click=${this.sendQuickMessage}
          ?disabled=${this.isSending}>
          ${this.isSending?getSvg(yP.Confirmation):getSvg(yP.Send)}
        </fluent-button>
      </div>
      `}loadState(){var t,o;return __awaiter$e(this,void 0,void 0,(function*(){if(this._cardState)return;if(!this.personDetails&&this.inheritDetails){let t=this.parentElement;for(;t&&t.tagName!==`${YA.prefix}-PERSON`.toUpperCase();)t=t.parentElement;const o=t.personDetails||t.personDetailsInternal;t&&o&&(this.personDetails=o,this.personImage=t.personImage)}const s=Providers.globalProvider;if(!s||s.state!==exports.ProviderState.SignedIn)return;const l=s.graph.forComponent(this);if(this._graph=l,this._isStateLoading=!0,this._me||(this._me=yield Providers.me()),this.personDetails){const t=this.personDetails;let o;if(isUser(t)&&(o=t.userPrincipalName||t.id),o&&!getEmailFromGraphEntity(t)){const t=yield getUserWithPhoto(l,o);this.personDetails=t,this.personImage=this.getImage()}}else if(this.userId||"me"===this.personQuery){const t=yield getUserWithPhoto(l,this.userId);this.personDetails=t,this.personImage=this.getImage()}else if(this.personQuery){const t=yield findPeople(l,this.personQuery,1);(null==t?void 0:t.length)&&(this.personDetails=t[0],yield getPersonImage(l,this.personDetails,JF.config.useContactApis).then((t=>{t&&(this.personDetails.personImage=t,this.personImage=t)})))}const h={activity:"Offline",availability:"Offline",id:null};if(!this.personPresence&&this.showPresence)try{(null===(t=this.personDetails)||void 0===t?void 0:t.id)?this.personPresence=yield getUserPresence(l,this.personDetails.id):this.personPresence=h}catch(t){this.personPresence=h}(null===(o=this.personDetails)||void 0===o?void 0:o.id)&&(this._cardState=yield((t,o,s,l)=>__awaiter$f(void 0,void 0,void 0,(function*(){var h;const m=o.id,_=getEmailFromGraphEntity(o),E="classification"in o||"personType"in o&&("PersonalContact"===o.personType.subclass||"Group"===o.personType.class),$=t.createBatch();let B;E||l.sections.organization&&(buildOrgStructureRequest($,m),"boolean"!=typeof l.sections.organization&&l.sections.organization.showWorksWith&&buildWorksWithRequest($,m)),l.sections.mailMessages&&_&&buildMessagesWithUserRequest($,_),l.sections.files&&buildFilesRequest($,s?null:_);const q={};try{B=yield $.executeAll()}catch(t){}if(B)for(const[t,o]of B)q[t]=(null===(h=o.content)||void 0===h?void 0:h.value)||o.content;if(!E&&l.sections.profile)try{const o=yield getProfile(t,m);o&&(q.profile=o)}catch(t){}return q.directReports&&q.directReports.length>0&&(q.directReports=q.directReports.filter((t=>t.accountEnabled))),q})))(l,this.personDetails,this._me===this.personDetails.id,JF.config)),this.loadSections(),this._isStateLoading=!1}))}get hasPhone(){var t,o;const s=this.personDetails,l=this.personDetails;return Boolean(null===(t=null==s?void 0:s.businessPhones)||void 0===t?void 0:t.length)||Boolean(null===(o=null==l?void 0:l.phones)||void 0===o?void 0:o.length)}loadSections(){if(this.sections=[],!this.internalPersonDetails)return;const t=new exports.MgtContact(this.internalPersonDetails);if(t.hasData&&this.sections.push(t),!this._cardState)return;const{person:o,directReports:s,messages:l,files:h,profile:m}=this._cardState;if(JF.config.sections.organization&&((null==o?void 0:o.manager)||(null==s?void 0:s.length))&&this.sections.push(new exports.MgtOrganization(this._cardState,this._me)),JF.config.sections.mailMessages&&(null==l?void 0:l.length)&&this.sections.push(new exports.MgtMessages(l)),JF.config.sections.files&&(null==h?void 0:h.length)&&this.sections.push(new exports.MgtFileList),JF.config.sections.profile&&m){const t=new exports.MgtProfile(m);t.hasData&&this.sections.push(t)}}getImage(){if(this.personImage)return this.personImage;const t=this.personDetails;return(null==t?void 0:t.personImage)?t.personImage:null}clearInputData(){this._chatInput="",this.requestUpdate()}getPersonBusinessPhones(t){const o=t.phones,s=[];for(const t of o)"business"===t.type&&s.push(t.number);return s}updateCurrentSection(t){if(t){const o=t.tagName.toLowerCase();this.renderRoot.querySelector(`#${o}-Tab`).click()}const o=this.renderRoot.querySelectorAll("fluent-tab-panel");for(const t of o)t.scrollTop=0;this._currentSection=t,this.requestUpdate()}handleSectionScroll(t){const o=this.renderRoot.querySelectorAll("fluent-tab-panel");for(const s of o)s&&(t.deltaY<0&&0===s.scrollTop||t.deltaY>0&&s.clientHeight+s.scrollTop>=s.scrollHeight-1||t.stopPropagation())}},exports.MgtPersonCard._config={sections:{files:!0,mailMessages:!0,organization:{showWorksWith:!0},profile:!0},useContactApis:!0,isSendMessageVisible:!0},__decorate$c([n$1({attribute:"person-details",type:Object}),__metadata$c("design:type",Object),__metadata$c("design:paramtypes",[Object])],exports.MgtPersonCard.prototype,"personDetails",null),__decorate$c([n$1({attribute:"person-query"}),__metadata$c("design:type",String)],exports.MgtPersonCard.prototype,"personQuery",void 0),__decorate$c([n$1({attribute:"lock-tab-navigation",type:Boolean}),__metadata$c("design:type",Boolean)],exports.MgtPersonCard.prototype,"lockTabNavigation",void 0),__decorate$c([n$1({attribute:"user-id"}),__metadata$c("design:type",String),__metadata$c("design:paramtypes",[String])],exports.MgtPersonCard.prototype,"userId",null),__decorate$c([n$1({attribute:"person-image",type:String}),__metadata$c("design:type",String)],exports.MgtPersonCard.prototype,"personImage",void 0),__decorate$c([n$1({attribute:"fetch-image",type:Boolean}),__metadata$c("design:type",Boolean)],exports.MgtPersonCard.prototype,"fetchImage",void 0),__decorate$c([n$1({attribute:"is-expanded",type:Boolean}),__metadata$c("design:type",Boolean)],exports.MgtPersonCard.prototype,"isExpanded",void 0),__decorate$c([n$1({attribute:"inherit-details",type:Boolean}),__metadata$c("design:type",Boolean)],exports.MgtPersonCard.prototype,"inheritDetails",void 0),__decorate$c([n$1({attribute:"show-presence",type:Boolean}),__metadata$c("design:type",Boolean)],exports.MgtPersonCard.prototype,"showPresence",void 0),__decorate$c([n$1({attribute:"person-presence",type:Object}),__metadata$c("design:type",Object)],exports.MgtPersonCard.prototype,"personPresence",void 0),__decorate$c([t$1(),__metadata$c("design:type",Object)],exports.MgtPersonCard.prototype,"isSending",void 0),__decorate$c([t$1(),__metadata$c("design:type",Object)],exports.MgtPersonCard.prototype,"_cardState",void 0),__decorate$c([t$1(),__metadata$c("design:type",Boolean)],exports.MgtPersonCard.prototype,"_isStateLoading",void 0),exports.MgtPersonCard=JF=__decorate$c([customElement("person-card"),__metadata$c("design:paramtypes",[])],exports.MgtPersonCard);const XF=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{position:relative}:host .header::part(control){font-size:var(--arrow-options-button-font-size,large);font-weight:var(--arrow-options-button-font-weight,600);color:var(--arrow-options-button-font-color,var(--accent-base-color));background:var(--arrow-options-button-background-color,transparent)}:host .header::part(control):hover{background:var(--neutral-fill-stealth-hover)}:host .header::part(control):active,:host .header::part(control):focus{background:var(--neutral-fill-stealth-active)}:host .menu{position:absolute;left:var(--arrow-options-left,0);z-index:1;display:none}:host .menu.open{display:block;width:max-content}
`];var __decorate$b=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$b=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};registerFluentComponents(zL,VL,AL);let eB=class MgtArrowOptions extends MgtBaseComponent{static get styles(){return XF}constructor(){super(),this.onHeaderClick=t=>{Object.keys(this.options).length>1&&(t.preventDefault(),t.stopPropagation(),this.open=!this.open)},this.onHeaderKeyDown=t=>{if("Enter"===t.key){t.preventDefault(),t.stopPropagation(),this.open=!this.open;const o=this.renderRoot.querySelector("fluent-menu");o&&(o.classList.remove("closed"),o.classList.add("open"));const s=t.target;if(s){const t=this.renderRoot.querySelector("fluent-menu-item[tabindex='0']");t&&(s.blur(),t.focus())}}},this.value="",this.options={},this._clickHandler=()=>this.open=!1,window.addEventListener("onblur",(()=>this.open=!1))}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}render(){return AI`
      <fluent-button
        class="header"
        @click=${this.onHeaderClick}
        @keydown=${this.onHeaderKeyDown}
        appearance="lightweight">
          ${this.value}
      </fluent-button>
      <fluent-menu
        class=${iP({menu:!0,open:this.open,closed:!this.open})}>
          ${this.getMenuOptions()}
      </fluent-menu>`}getMenuOptions(){return Object.keys(this.options).map((t=>AI`
          <fluent-menu-item
            @click=${o=>{this.open=!1,this.options[t](o)}}
            @keydown=${o=>{const s=this.renderRoot.querySelector(".header");"Enter"===o.key?(this.open=!1,this.options[t](o),s.focus()):"Tab"===o.key?this.open=!1:"Escape"===o.key&&(this.open=!1,s&&s.focus())}}>
              ${t}
          </fluent-menu-item>`))}};__decorate$b([n$1({type:Boolean}),__metadata$b("design:type",Boolean)],eB.prototype,"open",void 0),__decorate$b([n$1({type:String}),__metadata$b("design:type",String)],eB.prototype,"value",void 0),__decorate$b([n$1({type:Object}),__metadata$b("design:type",Object)],eB.prototype,"options",void 0),eB=__decorate$b([customElement("arrow-options"),__metadata$b("design:paramtypes",[])],eB);const tB={dotOptionsTitle:"More options"},rB=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{display:flex;flex-direction:column;align-items:flex-end}:host .dot-icon{font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .menu{position:absolute;box-shadow:var(--neutral-fill-rest) 0 0 40px 5px;background:var(--neutral-fill-rest);z-index:1;display:none;white-space:nowrap;transform:var(--dot-options-translatey,translateY(32px))}:host .menu.open{display:block}:host fluent-button::part(control){background:inherit}
`];var __makeTemplateObject=function(t,o){return Object.defineProperty?Object.defineProperty(t,"raw",{value:o}):t.raw=o,t},__decorate$a=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$a=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};registerFluentComponents(zL,VL,AL);let oB=class MgtDotOptions extends MgtBaseComponent{constructor(){super(...arguments),this._clickHandler=()=>this.open=!1,this.handleItemClick=(t,o)=>{t.preventDefault(),t.stopPropagation(),o(t),this.open=!1},this.handleItemKeydown=(t,o)=>{this.handleKeydownMenuOption(t),o(t),this.open=!1},this.onDotClick=t=>{t.preventDefault(),t.stopPropagation(),this.open=!this.open},this.onDotKeydown=t=>{"Enter"===t.key&&(t.preventDefault(),t.stopPropagation(),this.open=!this.open)}}static get styles(){return rB}get strings(){return tB}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this._clickHandler)}disconnectedCallback(){window.removeEventListener("click",this._clickHandler),super.disconnectedCallback()}render(){const t=Object.keys(this.options);return AI(nB||(nB=__makeTemplateObject(['\n      <fluent-button\n        appearance="stealth"\n        aria-label=',"\n        @click=","\n        @keydown=",'\n        class="dot-icon">î</fluent-button>\n      <fluent-menu class=',">\n        ","\n      </fluent-menu>"],['\n      <fluent-button\n        appearance="stealth"\n        aria-label=',"\n        @click=","\n        @keydown=",'\n        class="dot-icon">\\uE712</fluent-button>\n      <fluent-menu class=',">\n        ","\n      </fluent-menu>"])),this.strings.dotOptionsTitle,this.onDotClick,this.onDotKeydown,iP({menu:!0,open:this.open}),t.map((t=>this.getMenuOption(t,this.options[t]))))}getMenuOption(t,o){return AI`
      <fluent-menu-item
        @click=${t=>this.handleItemClick(t,o)}
        @keydown=${t=>this.handleItemKeydown(t,o)}>
          ${t}
      </fluent-menu-item>`}handleKeydownMenuOption(t){"Enter"===t.key&&(t.preventDefault(),t.stopPropagation())}};var nB;__decorate$a([n$1({type:Boolean}),__metadata$a("design:type",Boolean)],oB.prototype,"open",void 0),__decorate$a([n$1({type:Object}),__metadata$a("design:type",Object)],oB.prototype,"options",void 0),oB=__decorate$a([customElement("dot-options")],oB);const iB=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{background-color:var(--tasks-background-color,transparent);padding:var(--tasks-padding,12px);border:var(--tasks-border,0);border-radius:var(--tasks-border-radius,0);--skeleton-fill:var(--neutral-foreground-active)}:host .header{display:flex;align-items:center;justify-content:space-between;padding:var(--tasks-header-padding,0 0 14px 0);margin:var(--tasks-header-padding,0 0 14px 0);font-size:var(--tasks-header-font-size,16px);font-weight:var(--tasks-header-font-weight,600);color:var(--tasks-header-text-color,var(--neutral-foreground-hint))}:host .header:hover{color:var(--tasks-header-text-hover-color,var(--neutral-foreground-hover))}:host .header .title{justify-content:left;display:flex;align-items:center}:host .header .title .shimmer{width:80px;height:20px}:host .header .title svg{margin-top:3px;padding:0 4px;width:16px;height:16px}:host .header .new-task-button{justify-content:right}:host .header .new-task-button .shimmer{width:40px;height:24px}:host .header .new-task-button::part(control){font-weight:var(--tasks-new-button-text-font-weight,700);color:var(--tasks-new-button-text-color,var(--foreground-on-accent-rest));width:var(--tasks-new-button-width,none);height:var(--tasks-new-button-height,none);background:var(--tasks-new-button-background,padding-box linear-gradient(var(--accent-fill-rest),var(--accent-fill-rest)),border-box var(--accent-stroke-control-rest))}:host .header .new-task-button::part(control):hover{background:var(--tasks-new-button-background-hover,var(--accent-fill-hover))}:host .header .new-task-button::part(control):active{background:var(--tasks-new-button-background-active,var(--accent-fill-active))}:host .tasks{display:flex;flex-direction:column;row-gap:var(--tasks-gap,20px)}:host .tasks .task{display:flex;column-gap:4px;align-items:flex-start;justify-content:space-between}:host .tasks .task.updating{background:var(--neutral-stroke-rest)!important;pointer-events:none;opacity:.4}:host .tasks .task.complete{border:var(--task-complete-border,2px dotted var(--neutral-foreground-active));border-radius:var(--task-complete-border-radius,4px);background:var(--task-complete-background-color,transparent);padding:var(--task-complete-padding,10px)}:host .tasks .task.incomplete{border:var(--task-incomplete-border,1px solid var(--neutral-foreground-active));border-radius:var(--task-complete-border-radius,4px);background:var(--task-incomplete-background-color,var(--neutral-layer-1));padding:var(--task-incomplete-padding,10px)}:host .tasks .task .task-details-container{display:flex;flex-direction:column;row-gap:12px;width:100%}:host .tasks .task .task-details-container .top{display:flex;justify-content:space-between;column-gap:4px}:host .tasks .task .task-details-container .top.add-new-task{flex-direction:row}:host .tasks .task .task-details-container .top .check-and-title{display:flex;align-items:flex-start;flex-direction:column;width:100%;row-gap:12px}:host .tasks .task .task-details-container .top .check-and-title.shimmer{display:flex;flex-direction:inherit;gap:10px}:host .tasks .task .task-details-container .top .check-and-title.shimmer .checkbox{height:10px;width:10px}:host .tasks .task .task-details-container .top .check-and-title.shimmer .title{height:10px;width:100%}:host .tasks .task .task-details-container .top .check-and-title .task-content{display:grid;grid-template-columns:repeat(auto-fit,250px);gap:12px;justify-content:start;width:100%}:host .tasks .task .task-details-container .top .check-and-title .task-content .picker{max-width:250px}:host .tasks .task .task-details-container .top .check-and-title .task-content .task-due fluent-text-field.dark::part(control){color-scheme:dark}:host .tasks .task .task-details-container .top .task-options .options{height:10px;width:20px}:host .tasks .task .task-details-container .top .task-options.new-task-action-buttons{display:flex;flex-direction:column;row-gap:12px}:host .tasks .task .task-details-container .bottom{display:grid;grid-auto-flow:column;grid-auto-columns:1fr;grid-column-gap:6px}:host .tasks .task .task-details-container .bottom .task-bucket,:host .tasks .task .task-details-container .bottom .task-due,:host .tasks .task .task-details-container .bottom .task-group{display:flex;align-items:center;gap:6px}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon,:host .tasks .task .task-details-container .bottom .task-due .task-icon,:host .tasks .task .task-details-container .bottom .task-group .task-icon{display:flex;place-content:center;width:var(--task-icons-width,20px);height:var(--task-icons-height,20px)}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon .shimmer.icon,:host .tasks .task .task-details-container .bottom .task-due .task-icon .shimmer.icon,:host .tasks .task .task-details-container .bottom .task-group .task-icon .shimmer.icon{width:20px;height:20px}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon svg,:host .tasks .task .task-details-container .bottom .task-due .task-icon svg,:host .tasks .task .task-details-container .bottom .task-group .task-icon svg{width:var(--task-icons-width,20px);height:var(--task-icons-height,20px)}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon svg path,:host .tasks .task .task-details-container .bottom .task-due .task-icon svg path,:host .tasks .task .task-details-container .bottom .task-group .task-icon svg path{fill:var(--task-icons-background-color,var(--neutral-foreground-hint))}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon-text,:host .tasks .task .task-details-container .bottom .task-due .task-icon-text,:host .tasks .task .task-details-container .bottom .task-group .task-icon-text{color:var(--task-icons-text-font-color,var(--neutral-foreground-hint));font-size:var(--task-icons-text-font-size,12px);font-weight:var(--task-icons-text-font-weight,600);white-space:normal;width:100%}:host .tasks .task .task-details-container .bottom .task-bucket .task-icon-text .shimmer.text,:host .tasks .task .task-details-container .bottom .task-due .task-icon-text .shimmer.text,:host .tasks .task .task-details-container .bottom .task-group .task-icon-text .shimmer.text{width:100%;height:10px}:host .tasks .task .task-details-container .task-details{display:flex;flex-direction:column;row-gap:8px}:host .tasks .task .task-details-container .task-details.shimmer{flex-direction:row;place-items:center;column-gap:6px}:host .tasks .task .task-details-container .task-details.shimmer .shimmer.icon{width:24px;height:24px}:host .tasks .task .task-details-container .task-details.shimmer .shimmer.text{width:100%;height:10px}:host .tasks .task .task-details-container .task-details .task-title{color:var(--foreground-on-neutral-rest)}:host .tasks .task .task-details-container .task-details .task-body{display:flex}:host fluent-button.add-task::part(control){font-weight:var(--task-add-new-button-text-font-weight,initial);color:var(--task-add-new-button-text-color,var(--neutral-foreground-rest));width:var(--task-add-new-button-width,none);height:var(--task-add-new-button-height,none);background:var(--task-add-new-button-background,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active));border:var(--task-add-new-button-border,calc(var(--stroke-width) * 1px) solid transparent)}:host fluent-button.add-task::part(control):hover{background:var(--task-add-new-button-background-hover,padding-box linear-gradient(var(--neutral-fill-hover),var(--neutral-fill-hover)),border-box var(--neutral-stroke-control-hover))}:host fluent-button.add-task::part(control):active{background:var(--task-add-new-button-background-active,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active))}:host fluent-button.cancel-task::part(control){font-weight:var(--task-cancel-new-button-text-font-weight,initial);color:var(--task-cancel-new-button-text-color,var(--neutral-foreground-rest));width:var(--task-cancel-new-button-width,none);height:var(--task-cancel-new-button-height,none);background:var(--task-cancel-new-button-background,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active));border:var(--task-cancel-new-button-border,calc(var(--stroke-width) * 1px) solid transparent)}:host fluent-button.cancel-task::part(control):hover{background:var(--task-cancel-new-button-background-hover,padding-box linear-gradient(var(--neutral-fill-hover),var(--neutral-fill-hover)),border-box var(--neutral-stroke-control-hover))}:host fluent-button.cancel-task::part(control):active{background:var(--task-cancel-new-button-background-active,padding-box linear-gradient(var(--neutral-fill-active),var(--neutral-fill-active)),border-box var(--neutral-stroke-control-active))}:host fluent-option{background:var(--task-new-dropdown-list-background-color,var(--fill-color))}:host fluent-option:hover{background:var(--task-new-dropdown-option-hover-background-color,var(--neutral-fill-stealth-hover))}:host fluent-option::part(content){color:var(--task-new-dropdown-option-text-color,var(--neutral-foreground-rest))}:host fluent-select::part(listbox){background:var(--task-new-dropdown-list-background-color,var(--fill-color))}:host fluent-select::part(control){border:var(--task-new-dropdown-border,calc(var(--stroke-width) * 1px) solid transparent);border-radius:var(--task-new-dropdown-border-radius,calc(var(--control-corner-radius) * 1px));background:var(--task-new-dropdown-background-color,padding-box linear-gradient(var(--neutral-fill-input-rest),var(--neutral-fill-input-rest)),border-box var(--neutral-stroke-input-rest))}:host fluent-select::part(control):hover{background:var(--task-new-dropdown-hover-background-color,padding-box linear-gradient(var(--neutral-fill-input-hover),var(--neutral-fill-input-hover)),border-box var(--neutral-stroke-input-hover))}:host fluent-select::part(control)::placeholder{color:var(--task-new-dropdown-placeholder-color,var(--input-placeholder-rest))}:host fluent-checkbox{padding-top:1px}:host fluent-checkbox::part(control){border-radius:50%;background:var(--task-incomplete-checkbox-background-color,var(--neutral-fill-input-alt-rest))}:host fluent-checkbox::part(control):hover{background:var(--task-incomplete-checkbox-background-hover-color,var(--neutral-fill-input-alt-hover))}:host fluent-checkbox::part(label){font-size:var(--task-title-text-font-size,medium);font-weight:var(--task-title-text-font-weight,600);color:var(--task-incomplete-title-text-color,var(var(--neutral-foreground-rest)))}:host fluent-checkbox.checked::part(control){background:var(--task-complete-checkbox-background-color,var(--accent-fill-rest));color:var(--task-complete-checkbox-text-color,currentColor)}:host fluent-checkbox.checked::part(label){text-decoration:line-through;color:var(--task-complete-title-text-color,var(--neutral-foreground-hint))}:host fluent-text-field.new-task{width:100%}:host fluent-text-field.new-task::part(root){border:var(--task-new-input-border,calc(var(--stroke-width) * 1px) solid transparent);border-radius:var(--task-new-input-border-radius,calc(var(--control-corner-radius) * 1px));background:var(--task-new-input-background-color,padding-box linear-gradient(var(--neutral-fill-input-rest),var(--neutral-fill-input-rest)),border-box var(--neutral-stroke-input-rest))}:host fluent-text-field.new-task::part(root):hover{background:var(--task-new-input-hover-background-color,padding-box linear-gradient(var(--neutral-fill-input-hover),var(--neutral-fill-input-hover)),border-box var(--neutral-stroke-input-hover))}:host fluent-text-field.new-task::part(root)::placeholder{color:var(--task-new-input-placeholder-color,var(--input-placeholder-rest))}:host .people [slot=no-data] fluent-button::part(control){color:var(--task-new-person-icon-text-color,var(--neutral-foreground-hint))}:host .people [slot=no-data] svg{fill:var(--task-new-person-icon-color,var(--neutral-foreground-hint))}@media only screen and (width <= 600px){:host fluent-select{width:100%}:host .tasks .task .task-details-container .bottom{display:grid;grid-auto-flow:row;grid-auto-columns:unset;row-gap:4px}:host .tasks .task .task-details-container .bottom .ask-bucket,:host .tasks .task .task-details-container .bottom .ask-due,:host .tasks .task .task-details-container .bottom .ask-group{margin-inline-start:8px}:host .tasks .task .task-details-container .top.add-new-task{flex-direction:column;row-gap:12px}:host .tasks .task .task-details-container .top.add-new-task .check-and-title .task-content{display:grid;grid-auto-flow:row;row-gap:12px;width:100%}:host .tasks .task .task-details-container .top.add-new-task .task-options.new-task-action-buttons{flex-direction:row;column-gap:4px}}
`],sB={removeTaskSubtitle:"Delete Task",cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Adding a task...",addTaskButtonSubtitle:"Add",due:"Due ",addTaskDate:"Add the task date",assign:"Assign"};var __awaiter$d=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const assignPeopleToPlannerTask=(t,o,s)=>__awaiter$d(void 0,void 0,void 0,(function*(){const l={assignments:s,appliedCategories:{category4:!0}};yield setPlannerTaskDetails(t,o,l)})),setPlannerTaskDetails=(t,o,s)=>__awaiter$d(void 0,void 0,void 0,(function*(){let l;try{l=yield t.api(`/planner/tasks/${o.id}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.ReadWrite.All")).header("Prefer","return=representation").header("If-Match",o.eTag).update(s)}catch(t){}return l}));var __awaiter$c=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const setTodoTaskDetails=(t,o,s,l)=>__awaiter$c(void 0,void 0,void 0,(function*(){return yield t.api(`/me/outlook/tasks/${o}`).header("Cache-Control","no-store").header("If-Match",l).middlewareOptions(prepScopes("Tasks.ReadWrite")).patch(s)}));var __awaiter$b=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class TaskSourceBase{constructor(t){this.graph=BetaGraph.fromGraph(t)}}class PlannerTaskSource extends TaskSourceBase{getTaskGroups(){return __awaiter$b(this,void 0,void 0,(function*(){var t;return(yield(t=this.graph,__awaiter$d(void 0,void 0,void 0,(function*(){const o=yield t.api("/me/planner/plans").header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return null==o?void 0:o.value})))).map((t=>{var o;return{id:t.id,title:t.title,containerId:null===(o=null==t?void 0:t.container)||void 0===o?void 0:o.containerId}}))}))}getTaskGroupsForGroup(t){return __awaiter$b(this,void 0,void 0,(function*(){var o,s;return(yield(o=this.graph,s=t,__awaiter$d(void 0,void 0,void 0,(function*(){const t=`/groups/${s}/planner/plans`,l=yield o.api(t).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return null==l?void 0:l.value})))).map((t=>({id:t.id,title:t.title})))}))}getTaskGroup(t){return __awaiter$b(this,void 0,void 0,(function*(){const o=yield(s=this.graph,l=t,__awaiter$d(void 0,void 0,void 0,(function*(){return yield s.api(`/planner/plans/${l}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get()})));var s,l;return{id:o.id,title:o.title,_raw:o}}))}getTaskFoldersForTaskGroup(t){return __awaiter$b(this,void 0,void 0,(function*(){var o,s;return(yield(o=this.graph,s=t,__awaiter$d(void 0,void 0,void 0,(function*(){const t=yield o.api(`/planner/plans/${s}/buckets`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return null==t?void 0:t.value})))).map((t=>({_raw:t,id:t.id,name:t.name,parentId:t.planId})))}))}getTasksForTaskFolder(t){return __awaiter$b(this,void 0,void 0,(function*(){var o,s;return(yield(o=this.graph,s=t,__awaiter$d(void 0,void 0,void 0,(function*(){const t=yield o.api(`/planner/buckets/${s}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.Read.All")).get();return null==t?void 0:t.value})))).map((t=>({_raw:t,assignments:t.assignments,completed:100===t.percentComplete,dueDate:t.dueDateTime&&new Date(t.dueDateTime),eTag:t["@odata.etag"],id:t.id,immediateParentId:t.bucketId,name:t.title,topParentId:t.planId})))}))}setTaskComplete(t){return __awaiter$b(this,void 0,void 0,(function*(){return yield((t,o)=>__awaiter$d(void 0,void 0,void 0,(function*(){yield setPlannerTaskDetails(t,o,{percentComplete:100})})))(this.graph,t)}))}setTaskIncomplete(t){return __awaiter$b(this,void 0,void 0,(function*(){return((t,o)=>__awaiter$d(void 0,void 0,void 0,(function*(){yield setPlannerTaskDetails(t,o,{percentComplete:0})})))(this.graph,t)}))}addTask(t){var o;return __awaiter$b(this,void 0,void 0,(function*(){return yield((t,o)=>__awaiter$d(void 0,void 0,void 0,(function*(){return yield t.api("/planner/tasks").header("Cache-Control","no-store").middlewareOptions(prepScopes("Group.ReadWrite.All")).post(o)})))(this.graph,{assignments:t.assignments,bucketId:t.immediateParentId,dueDateTime:null===(o=t.dueDate)||void 0===o?void 0:o.toISOString(),planId:t.topParentId,title:t.name})}))}assignPeopleToTask(t,o){return __awaiter$b(this,void 0,void 0,(function*(){return assignPeopleToPlannerTask(this.graph,t,o)}))}removeTask(t){return __awaiter$b(this,void 0,void 0,(function*(){return yield((t,o)=>__awaiter$d(void 0,void 0,void 0,(function*(){yield t.api(`/planner/tasks/${o.id}`).header("Cache-Control","no-store").header("If-Match",o.eTag).middlewareOptions(prepScopes("Group.ReadWrite.All")).delete()})))(this.graph,t)}))}isAssignedToMe(t,o){return Object.keys(t.assignments).includes(o)}}class TodoTaskSource extends TaskSourceBase{getTaskGroups(){return __awaiter$b(this,void 0,void 0,(function*(){var t;return(yield(t=this.graph,__awaiter$c(void 0,void 0,void 0,(function*(){const o=yield t.api("/me/outlook/taskGroups").header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return null==o?void 0:o.value})))).map((t=>({_raw:t,id:t.id,secondaryId:t.groupKey,title:t.name})))}))}getTaskGroup(t){return __awaiter$b(this,void 0,void 0,(function*(){const o=yield(s=this.graph,l=t,__awaiter$c(void 0,void 0,void 0,(function*(){return yield s.api(`/me/outlook/taskGroups/${l}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get()})));var s,l;return{id:o.id,secondaryId:o.groupKey,title:o.name,_raw:o}}))}getTaskFoldersForTaskGroup(t){return __awaiter$b(this,void 0,void 0,(function*(){var o,s;return(yield(o=this.graph,s=t,__awaiter$c(void 0,void 0,void 0,(function*(){const t=yield o.api(`/me/outlook/taskGroups/${s}/taskFolders`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return null==t?void 0:t.value})))).map((o=>({_raw:o,id:o.id,name:o.name,parentId:t})))}))}getTasksForTaskFolder(t,o){return __awaiter$b(this,void 0,void 0,(function*(){var s,l;return(yield(s=this.graph,l=t,__awaiter$c(void 0,void 0,void 0,(function*(){const t=yield s.api(`/me/outlook/taskFolders/${l}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return null==t?void 0:t.value})))).map((s=>({_raw:s,assignments:{},completed:!!s.completedDateTime,dueDate:s.dueDateTime&&new Date(s.dueDateTime.dateTime+"Z"),eTag:s["@odata.etag"],id:s.id,immediateParentId:t,name:s.subject,topParentId:o})))}))}setTaskComplete(t){return __awaiter$b(this,void 0,void 0,(function*(){var o,s,l;yield(o=this.graph,s=t.id,l=t.eTag,__awaiter$c(void 0,void 0,void 0,(function*(){return yield setTodoTaskDetails(o,s,{isReminderOn:!1,status:"completed"},l)})))}))}assignPeopleToTask(t,o){return __awaiter$b(this,void 0,void 0,(function*(){return yield assignPeopleToPlannerTask(this.graph,t,o)}))}setTaskIncomplete(t){return __awaiter$b(this,void 0,void 0,(function*(){var o,s,l;yield(o=this.graph,s=t.id,l=t.eTag,__awaiter$c(void 0,void 0,void 0,(function*(){return yield setTodoTaskDetails(o,s,{isReminderOn:!0,status:"notStarted"},l)})))}))}addTask(t){return __awaiter$b(this,void 0,void 0,(function*(){const o={parentFolderId:t.immediateParentId,subject:t.name};return t.dueDate&&(o.dueDateTime={dateTime:t.dueDate.toISOString(),timeZone:"UTC"}),yield((t,o)=>__awaiter$c(void 0,void 0,void 0,(function*(){const{parentFolderId:s=null}=o;return s?yield t.api(`/me/outlook/taskFolders/${s}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).post(o):yield t.api("/me/outlook/tasks").header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).post(o)})))(this.graph,o)}))}removeTask(t){return __awaiter$b(this,void 0,void 0,(function*(){return yield(o=this.graph,s=t.id,l=t.eTag,__awaiter$c(void 0,void 0,void 0,(function*(){yield o.api(`/me/outlook/tasks/${s}`).header("Cache-Control","no-store").header("If-Match",l).middlewareOptions(prepScopes("Tasks.ReadWrite")).delete()})));var o,s,l}))}isAssignedToMe(t,o){return Object.keys(t.assignments).includes(o)}getTaskGroupsForGroup(t){return __awaiter$b(this,void 0,void 0,(function*(){return Promise.resolve(void 0)}))}}const isElementDark=t=>{const o=bO.getValueFor(t);return isDark(_M.create(o,o,o))};var aB,__decorate$9=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$9=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$a=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(XL,jL,sF,AL,ML,eF),exports.TasksSource=void 0,(aB=exports.TasksSource||(exports.TasksSource={}))[aB.planner=0]="planner",aB[aB.todo=1]="todo";const lB={BASE_SELF_ASSIGNED:"All Tasks",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Folder not found",PLANS_SELF_ASSIGNED:"All groups",PLAN_NOT_FOUND:"Group not found"},cB={BASE_SELF_ASSIGNED:"Assigned to Me",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Bucket not found",PLANS_SELF_ASSIGNED:"All Plans",PLAN_NOT_FOUND:"Plan not found"},dB={"@odata.type":"#microsoft.graph.plannerAssignment",orderHint:" !"};exports.MgtTasks=class MgtTasks extends MgtTemplatedComponent{get res(){switch(this.dataSource){case exports.TasksSource.todo:return lB;case exports.TasksSource.planner:default:return cB}}static get styles(){return iB}get strings(){return sB}get isNewTaskVisible(){return this._isNewTaskVisible}set isNewTaskVisible(t){this._isNewTaskVisible=t,t||(this._newTaskDueDate=null,this._newTaskName="",this._newTaskGroupId="",this._newTaskContainerId="")}static get requiredScopes(){return[...new Set(["group.read.all","group.readwrite.all","tasks.read","tasks.readwrite",...exports.MgtPeople.requiredScopes,...exports.MgtPeoplePicker.requiredScopes])]}constructor(){super(),this.dataSource=exports.TasksSource.planner,this._isDarkMode=!1,this._me=null,this.onResize=()=>{this.mediaQuery!==this.previousMediaQuery&&(this.previousMediaQuery=this.mediaQuery,this.requestUpdate())},this.onThemeChanged=()=>{this._isDarkMode=isElementDark(this)},this.onAddTaskClick=()=>{var t;const o=this.getPeoplePicker(null),s={};if(o)for(const l of null!==(t=null==o?void 0:o.selectedPeople)&&void 0!==t?t:[])s[l.id]=dB;!this._newTaskBeingAdded&&this._newTaskName&&(this._currentGroup||this._newTaskGroupId)&&this.addTask(this._newTaskName,this._newTaskDueDate,this._currentGroup?this._currentGroup:this._newTaskGroupId,this._currentFolder?this._currentFolder:this._newTaskFolderId,s)},this.onAddTaskKeyDown=t=>{"Enter"!==t.key&&" "!==t.key||this.onAddTaskClick()},this.newTaskButtonKeydown=t=>{"Enter"===t.key&&(this.isNewTaskVisible=!this.isNewTaskVisible)},this.addNewTaskButtonClick=()=>{this.isNewTaskVisible=!this.isNewTaskVisible},this.handleNewTaskDateChange=t=>{const o=t.target.value;this._newTaskDueDate=o?new Date(o+"T17:00"):null},this.handleSelectedPlan=t=>{var o,s;if(this._newTaskGroupId=t.target.value,this.dataSource===exports.TasksSource.planner){const t=this._groups.filter((t=>t.id===this._newTaskGroupId));this._newTaskContainerId=null!==(s=null===(o=t.pop())||void 0===o?void 0:o.containerId)&&void 0!==s?s:this._newTaskContainerId}},this.newTaskVisible=t=>{"Enter"===t.key&&(this.isNewTaskVisible=!1)},this.handleDateChange=t=>{const o=t.target.value;this._newTaskDueDate=o?new Date(o+"T17:00"):null},this.renderPlannerIcon=t=>getSvg(yP.Planner,t),this.renderBucketIcon=t=>getSvg(yP.Milestone,t),this.handlePeopleClick=(t,o)=>{this.togglePeoplePicker(o),t.stopPropagation()},this.handlePeopleKeydown=(t,o)=>{"Enter"!==t.key&&" "!==t.key||(this.togglePeoplePicker(o),t.stopPropagation(),t.preventDefault())},this.handlePeoplePickerKeydown=t=>{"Enter"===t.key&&t.stopPropagation()},this.clearState(),this.previousMediaQuery=this.mediaQuery}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize),window.addEventListener("darkmodechanged",this.onThemeChanged),this.onThemeChanged()}disconnectedCallback(){window.removeEventListener("resize",this.onResize),window.removeEventListener("darkmodechanged",this.onThemeChanged),super.disconnectedCallback()}attributeChangedCallback(t,o,s){super.attributeChangedCallback(t,o,s),"data-source"===t&&(this.dataSource===exports.TasksSource.planner?(this._currentGroup=this.initialId,this._currentFolder=this.initialBucketId):this.dataSource===exports.TasksSource.todo&&(this._currentGroup=null,this._currentFolder=this.initialId),this.clearState(),this.requestStateUpdate())}clearState(){this._newTaskFolderId="",this._newTaskGroupId="",this._newTaskDueDate=null,this._newTaskName="",this._newTaskBeingAdded=!1,this._tasks=[],this._folders=[],this._groups=[],this._hiddenTasks=[],this._loadingTasks=[],this._hasDoneInitialLoad=!1,this._inTaskLoad=!1,this._todoDefaultSet=!1}firstUpdated(t){super.firstUpdated(t),this.initialId&&!this._currentGroup&&(this.dataSource===exports.TasksSource.planner?this._currentGroup=this.initialId:this.dataSource===exports.TasksSource.todo&&(this._currentFolder=this.initialId)),this.dataSource===exports.TasksSource.planner&&this.initialBucketId&&!this._currentFolder&&(this._currentFolder=this.initialBucketId)}render(){const t=this._inTaskLoad&&!this._hasDoneInitialLoad?this.renderLoadingTask():null;let o;return this.hideHeader||(o=AI`
        <div class="header">
          ${this.renderPlanOptions()}
        </div>
      `),AI`
      ${o}
      <div class="tasks">
        ${this._isNewTaskVisible?this.renderNewTask():null} ${t}
        ${RP(this._tasks,(t=>t.id),(t=>this.renderTask(t)))}
      </div>
    `}loadState(){return __awaiter$a(this,void 0,void 0,(function*(){const t=this.getTaskSource();if(!t)return;const o=Providers.globalProvider;if(o&&o.state===exports.ProviderState.SignedIn){if(this._inTaskLoad=!0,!this._me){const t=o.graph.forComponent(this);this._me=yield getMe(t)}this.groupId&&this.dataSource===exports.TasksSource.planner?yield this._loadTasksForGroup(t):this.targetId?this.dataSource===exports.TasksSource.todo?yield this._loadTargetTodoTasks(t):yield this._loadTargetPlannerTasks(t):yield this._loadAllTasks(t),this._tasks=this._tasks.filter((t=>this.isTaskInSelectedGroupFilter(t))).filter((t=>this.isTaskInSelectedFolderFilter(t))).filter((t=>!this._hiddenTasks.includes(t.id))),this.taskFilter&&(this._tasks=this._tasks.filter((t=>this.taskFilter(t._raw)))),this._inTaskLoad=!1,this._hasDoneInitialLoad=!0}}))}_loadTargetTodoTasks(t){return __awaiter$a(this,void 0,void 0,(function*(){const o=yield t.getTaskGroups(),s=(yield Promise.all(o.map((o=>t.getTaskFoldersForTaskGroup(o.id))))).reduce(((t,o)=>[...t,...o]),[]),l=(yield Promise.all(s.map((o=>t.getTasksForTaskFolder(o.id,o.parentId))))).reduce(((t,o)=>[...t,...o]),[]);this._tasks=l,this._folders=s,this._groups=o,this._currentGroup=null}))}_loadTargetPlannerTasks(t){return __awaiter$a(this,void 0,void 0,(function*(){const o=yield t.getTaskGroup(this.targetId);let s=yield t.getTaskFoldersForTaskGroup(o.id);this.targetBucketId&&(s=s.filter((t=>t.id===this.targetBucketId)));const l=(yield Promise.all(s.map((o=>t.getTasksForTaskFolder(o.id,o.parentId))))).reduce(((t,o)=>[...t,...o]),[]);this._tasks=l,this._folders=s,this._groups=[o]}))}_loadAllTasks(t){return __awaiter$a(this,void 0,void 0,(function*(){const o=yield t.getTaskGroups(),s=(yield Promise.all(o.map((o=>t.getTaskFoldersForTaskGroup(o.id))))).reduce(((t,o)=>[...t,...o]),[]);if(!this.initialId&&this.dataSource===exports.TasksSource.todo&&!this._todoDefaultSet){this._todoDefaultSet=!0;const t=s.find((t=>t._raw.isDefaultFolder));t&&(this._currentFolder=t.id)}const l=(yield Promise.all(s.map((o=>t.getTasksForTaskFolder(o.id,o.parentId))))).reduce(((t,o)=>[...t,...o]),[]);this._tasks=l,this._folders=s,this._groups=o}))}_loadTasksForGroup(t){return __awaiter$a(this,void 0,void 0,(function*(){const o=yield t.getTaskGroupsForGroup(this.groupId),s=(yield Promise.all(o.map((o=>t.getTaskFoldersForTaskGroup(o.id))))).reduce(((t,o)=>[...t,...o]),[]),l=(yield Promise.all(s.map((o=>t.getTasksForTaskFolder(o.id,o.parentId))))).reduce(((t,o)=>[...t,...o]),[]);this._tasks=l,this._folders=s,this._groups=o}))}addTask(t,o,s,l,h={}){return __awaiter$a(this,void 0,void 0,(function*(){const m=this.getTaskSource();if(!m)return;const _={assignments:h,dueDate:o,immediateParentId:l,name:t,topParentId:s};this._newTaskBeingAdded=!0,_._raw=yield m.addTask(_),this.fireCustomEvent("taskAdded",_),yield this.requestStateUpdate(),this._newTaskBeingAdded=!1,this.isNewTaskVisible=!1}))}completeTask(t){return __awaiter$a(this,void 0,void 0,(function*(){const o=this.getTaskSource();o&&(this._loadingTasks=[...this._loadingTasks,t.id],yield o.setTaskComplete(t),this.fireCustomEvent("taskChanged",t),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((o=>o!==t.id)))}))}uncompleteTask(t){return __awaiter$a(this,void 0,void 0,(function*(){const o=this.getTaskSource();o&&(this._loadingTasks=[...this._loadingTasks,t.id],yield o.setTaskIncomplete(t),this.fireCustomEvent("taskChanged",t),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((o=>o!==t.id)))}))}removeTask(t){return __awaiter$a(this,void 0,void 0,(function*(){const o=this.getTaskSource();o&&(this._hiddenTasks=[...this._hiddenTasks,t.id],yield o.removeTask(t),this.fireCustomEvent("taskRemoved",t),yield this.requestStateUpdate(),this._hiddenTasks=this._hiddenTasks.filter((o=>o!==t.id)))}))}assignPeople(t,o=[]){return __awaiter$a(this,void 0,void 0,(function*(){const s=this.getTaskSource();if(!s)return;let l=[];t&&t.assignments&&(l=Object.keys(t.assignments).sort());const h=o.map((t=>t.id)),m=h.length===l.length&&h.sort().every(((t,o)=>t===l[o]));if(m)return;const _={};for(const t of l)h.includes(t)?_[t]=dB:_[t]=null;h.forEach((t=>{l.includes(t)||(_[t]=dB)})),t&&(yield s.assignPeopleToTask(t,_),yield this.requestStateUpdate(),this._loadingTasks=this._loadingTasks.filter((o=>o!==t.id)))}))}renderPlanOptions(){var t;const o=Providers.globalProvider;if(!o||o.state!==exports.ProviderState.SignedIn)return null;if(this._inTaskLoad&&!this._hasDoneInitialLoad)return AI`<span class="loading-header"></span>`;const s=this.readOnly||this._isNewTaskVisible?null:AI`
          <fluent-button
            appearance="accent"
            class="new-task-button"
            @keydown=${this.newTaskButtonKeydown}
            @click=${()=>this.isNewTaskVisible=!this.isNewTaskVisible}>
              <span slot="start">${getSvg(yP.Add,"currentColor")}</span>
              ${this.strings.addTaskButtonSubtitle}
          </fluent-button>
        `;if(this.dataSource===exports.TasksSource.planner){const o=this._groups.find((t=>t.id===this._currentGroup))||{title:this.res.BASE_SELF_ASSIGNED},l={[this.res.BASE_SELF_ASSIGNED]:()=>{this._currentGroup=null,this._currentFolder=null}};for(const t of this._groups)l[t.title]=()=>{this._currentGroup=t.id,this._currentFolder=null};const h=mgtHtml`
        <mgt-arrow-options
          class="arrow-options"
          .options="${l}"
          .value="${o.title}"></mgt-arrow-options>`,m=this._currentGroup?getSvg(yP.ChevronRight):null,_=this._folders.find((t=>t.id===this._currentFolder))||{name:this.res.BUCKETS_SELF_ASSIGNED},E={[this.res.BUCKETS_SELF_ASSIGNED]:()=>{this._currentFolder=null}};for(const t of this._folders.filter((t=>t.parentId===this._currentGroup)))E[t.name]=()=>{this._currentFolder=t.id};const $=this.targetBucketId?AI`
            <span class="plan-title">
              ${(null===(t=this._folders[0])||void 0===t?void 0:t.name)||""}
            </span>`:mgtHtml`
            <mgt-arrow-options class="arrow-options" .options="${E}" .value="${_.name}"></mgt-arrow-options>
          `;return AI`
        <div class="Title">
          ${h} ${m} ${this._currentGroup?$:null}
        </div>
        ${s}
      `}{const t=this._folders.find((t=>t.id===this.targetId))||{name:this.res.BUCKETS_SELF_ASSIGNED},o=this._folders.find((t=>t.id===this._currentFolder))||{name:this.res.BUCKETS_SELF_ASSIGNED},l={};for(const t of this._folders)l[t.name]=()=>{this._currentFolder=t.id};l[this.res.BUCKETS_SELF_ASSIGNED]=()=>{this._currentFolder=null};const h=this.targetId?AI`
            <span class="plan-title">
              ${t.name}
            </span>
          `:mgtHtml`
            <mgt-arrow-options class="arrow-options" .value="${o.name}" .options="${l}"></mgt-arrow-options>
          `;return AI`
        <span class="title">
          ${h}
        </span>
        ${s}
      `}}renderNewTask(){const t="var(--neutral-foreground-hint)",o=AI`
      <fluent-text-field
        autocomplete="off"
        placeholder=${this.strings.newTaskPlaceholder}
        .value="${this._newTaskName}"
        class="new-task"
        aria-label=${this.strings.newTaskPlaceholder}
        @input=${t=>this._newTaskName=t.target.value}>
      </fluent-text-field>`;this._groups.length>0&&!this._newTaskGroupId&&(this._newTaskGroupId=this._groups[0].id);const s=AI`
      ${RP(this._groups,(t=>t.id),(t=>AI`<fluent-option value="${t.id}">${t.title}</fluent-option>`))}`,l=this.dataSource===exports.TasksSource.todo?null:this._currentGroup?AI`
          <span class="new-task-group">
            ${this.renderPlannerIcon(t)}
            <span>${this.getPlanTitle(this._currentGroup)}</span>
          </span>`:AI`
            <fluent-select>
              <span slot="start">${this.renderPlannerIcon(t)}</span>
              ${this._groups.length>0?s:AI`<fluent-option selected>No groups found</fluent-option>`}
            </fluent-select>`,h=this._folders.filter((t=>this._currentGroup&&t.parentId===this._currentGroup||!this._currentGroup&&t.parentId===this._newTaskGroupId));h.length>0&&!this._newTaskFolderId&&(this._newTaskFolderId=h[0].id);const m=AI`
      ${RP(h,(t=>t.id),(t=>AI`<fluent-option value="${t.id}">${t.name}</fluent-option>`))}`,_=this._currentFolder?AI`
          <span class="new-task-bucket">
            ${this.renderBucketIcon(t)}
            <span>${this.getFolderName(this._currentFolder)}</span>
          </span>
        `:AI`
         <fluent-select>
          <span slot="start">${this.renderBucketIcon(t)}</span>
          ${h.length>0?m:AI`<fluent-option selected>No folders found</fluent-option>`}
        </fluent-select>`,E={dark:this._isDarkMode,"new-task":!0},$=AI`
      <fluent-text-field
        autocomplete="off"
        type="date"
        class=${iP(E)}
        aria-label="${this.strings.addTaskDate}"
        .value="${this.dateToInputValue(this._newTaskDueDate)}"
        @change=${this.handleDateChange}>
      </fluent-text-field>`,B=this.dataSource===exports.TasksSource.todo?null:this.renderAssignedPeople(null),q=this._newTaskBeingAdded?AI`<div class="task-add-button-container"></div>`:AI`
          <fluent-button
            class="add-task"
            @click=${this.onAddTaskClick}
            @keydown=${this.onAddTaskKeyDown}
            appearance="neutral">
              ${this.strings.addTaskButtonSubtitle}
          </fluent-button>
          <fluent-button
            class="cancel-task"
            @click=${()=>this.isNewTaskVisible=!1}
            @keydown=${this.newTaskVisible}
            appearance="neutral">
              ${this.strings.cancelNewTaskSubtitle}
          </fluent-button>`;return AI`
    <div
      class=${iP({task:!0,"new-task":!0})}>
      <div class="task-details-container">
        <div class="top add-new-task">
          <div class="check-and-title">
            ${o}
            <div class="task-content">
              <div class="task-group">${l}</div>
              <div class="task-bucket">${_}</div>
              ${B}
              <div class="task-due">${$}</div>
            </div>
          </div>
          <div class="task-options new-task-action-buttons">${q}</div>
        </div>
      </div>
    </div>
  `}togglePeoplePicker(t){const o=this.getPeoplePicker(t),s=this.getMgtPeople(t),l=this.getFlyout(t);o&&s&&l&&(l.isOpen?l.close():(o.selectedPeople=s.people,l.open(),setTimeout((()=>o.focus()),100)))}updateAssignedPeople(t){const o=this.getPeoplePicker(t),s=this.getMgtPeople(t);o&&o.selectedPeople!==s.people&&(s.people=o.selectedPeople,this.assignPeople(t,o.selectedPeople))}getPeoplePicker(t){const o=t?t.id:"new-task";return this.renderRoot.querySelector(`.picker-${o}`)}getMgtPeople(t){const o=t?t.id:"new-task";return this.renderRoot.querySelector(`.people-${o}`)}getFlyout(t){const o=t?t.id:"new-task";return this.renderRoot.querySelector(`.flyout-${o}`)}renderTask(t){const{name:o="Task",completed:s=!1,dueDate:l}=t,h=this._currentGroup?null:this.getPlanTitle(t.topParentId),m=this._currentFolder?null:this.getFolderName(t.immediateParentId),_={task:Object.assign(Object.assign({},t._raw),{groupTitle:h,folderTitle:m})},E=this.renderTemplate("task",_,t.id);if(E)return E;let $=this.renderTemplate("task-details",_,`task-details-${t.id}`);if(!$){const o="var(--neutral-foreground-hint)",s=this.dataSource===exports.TasksSource.todo||this._currentGroup?null:AI`
              <div class="task-group">
                <span class="task-icon">${this.renderPlannerIcon(o)}</span>
                <span class="task-icon-text">${this.getPlanTitle(t.topParentId)}</span>
              </div>
            `,h=this._currentFolder?null:AI`
            <div class="task-bucket">
              <span class="task-icon">${this.renderBucketIcon(o)}</span>
              <span class="task-icon-text">${this.getFolderName(t.immediateParentId)}</span>
            </div>
          `,m=l?AI`
            <div class="task-due">
              <span class="task-icon-text">${this.strings.due}${(t=>{const o=t.getMonth(),s=t.getDate();return`${getMonthString(o)} ${s}`})(l)}</span>
            </div>
          `:null,_=this.dataSource===exports.TasksSource.todo?null:this.renderAssignedPeople(t);$=AI`${s} ${h} ${_} ${m}`}const B=this.readOnly||this.hideOptions?null:mgtHtml`
            <mgt-dot-options
              class="dot-options"
              .options="${{[this.strings.removeTaskSubtitle]:()=>this.removeTask(t)}}"
            ></mgt-dot-options>`,q=iP({task:!0,complete:s,incomplete:!s,"read-only":this.readOnly});return AI`
      <div
        data-id="task-${t.id}"
        class=${q}
        @click=${()=>this.handleTaskClick(t)}>
        <div class="task-details-container">
          <div class="top">
            <div class="check-and-title">
              <fluent-checkbox
                @click=${o=>this.checkTask(o,t)}
                @keydown=${o=>this.handleTaskCheckKeyDown(o,t)}
                ?checked=${s}>
                  ${o}
              </fluent-checkbox>
            </div>
            <div class="task-options">${B}</div>
          </div>
          <div class="bottom">${$}</div>
        </div>
      </div>
    `}handleTaskCheckKeyDown(t,o){return __awaiter$a(this,void 0,void 0,(function*(){"Enter"===t.key&&(this.readOnly||(o.completed?yield this.uncompleteTask(o):yield this.completeTask(o),t.stopPropagation(),t.preventDefault()))}))}checkTask(t,o){return __awaiter$a(this,void 0,void 0,(function*(){if(!this.readOnly){const s=this.shadowRoot.querySelector(`[data-id='task-${o.id}'`);s&&s.classList.add("updating"),o.completed?yield this.uncompleteTask(o):yield this.completeTask(o),s&&s.classList.remove("updating"),t.stopPropagation(),t.preventDefault()}}))}renderAssignedPeople(t){var o;let s;const l={"new-task-assignee":null===t,"task-assignee":null!==t,"task-detail":null!==t},h=t?t.id:"new-task";l[`flyout-${h}`]=!0;const m=t?Object.keys(t.assignments).map((t=>t)):[];if(!this.newTaskVisible){const l=null==t?void 0:t._raw,h=null==l?void 0:l.planId;if(h){s=null===(o=this._groups.filter((t=>t.id===h)).pop())||void 0===o?void 0:o.containerId}}const _=this.isNewTaskVisible?this._newTaskContainerId:s,E=mgtHtml`
      <mgt-people
        class="people people-${h}"
        .userIds=${m}
        .personCardInteraction=${exports.PersonCardInteraction.none}
        @click=${o=>this.handlePeopleClick(o,t)}
        @keydown=${o=>this.handlePeopleKeydown(o,t)}
      >
        <template data-type="no-data">
          <fluent-button>
            <span style="display:flex;place-content:start;gap:4px;padding-inline-start:4px">
              <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="svg" fill="currentColor">
                <path d="M9 2a4 4 0 100 8 4 4 0 000-8zM6 6a3 3 0 116 0 3 3 0 01-6 0z"></path>
                <path d="M4 11a2 2 0 00-2 2c0 1.7.83 2.97 2.13 3.8A9.14 9.14 0 009 18c.41 0 .82-.02 1.21-.06A5.5 5.5 0 019.6 17 12 12 0 019 17a8.16 8.16 0 01-4.33-1.05A3.36 3.36 0 013 13a1 1 0 011-1h5.6c.18-.36.4-.7.66-1H4z"></path>
                <path d="M14.5 19a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-7c.28 0 .5.22.5.5V14h1.5a.5.5 0 010 1H15v1.5a.5.5 0 01-1 0V15h-1.5a.5.5 0 010-1H14v-1.5c0-.28.22-.5.5-.5z"></path>
              </svg> Assign</span>
            </fluent-button>
        </template>
      </mgt-people>`,$=mgtHtml`
      <mgt-people-picker
        class="people-picker picker-${h}"
        .groupId=${l$1(_)}
        @keydown=${this.handlePeoplePickerKeydown}>
      ></mgt-people-picker>`;return mgtHtml`
      <mgt-flyout
        light-dismiss
        class=${iP(l)}
        @closed=${()=>this.updateAssignedPeople(t)}
      >
        <div slot="anchor">${E}</div>
        <div slot="flyout" part="picker" class="picker">${$}</div>
      </mgt-flyout>
    `}handleTaskClick(t){t&&this.fireCustomEvent("taskClick",t)}renderLoadingTask(){return AI`
      <div class="header">
        <div class="title">
          <fluent-skeleton shimmer class="shimmer" shape="rect"></fluent-skeleton>
        </div>
        <div class="new-task-button">
          <fluent-skeleton shimmer class="shimmer" shape="rect"></fluent-skeleton>
        </div>
      </div>
      <div class="tasks">
        <div class="task incomplete">
          <div class="task-details-container">
            <div class="top">
              <div class="check-and-title shimmer">
                <fluent-skeleton shimmer class="checkbox" shape="circle"></fluent-skeleton>
                <fluent-skeleton shimmer class="title" shape="rect"></fluent-skeleton>
              </div>
              <div class="task-options">
                <fluent-skeleton shimmer class="options" shape="rect"></fluent-skeleton>
              </div>
            </div>
            <div class="bottom">
              <div class="task-group">
                <div class="task-icon">
                  <fluent-skeleton shimmer class="shimmer icon" shape="rect"></fluent-skeleton>
                </div>
                <div class="task-icon-text">
                  <fluent-skeleton shimmer class="shimmer text" shape="rect"></fluent-skeleton>
                </div>
              </div>
              <div class="task-bucket">
                <div class="task-icon">
                  <fluent-skeleton shimmer class="shimmer icon" shape="rect"></fluent-skeleton>
                </div>
                <div class="task-icon-text">
                  <fluent-skeleton shimmer class="shimmer text" shape="rect"></fluent-skeleton>
                </div>
              </div>
              <div class="task-details shimmer">
                <fluent-skeleton shimmer class="shimmer icon" shape="circle"></fluent-skeleton>
                <fluent-skeleton shimmer class="shimmer icon" shape="circle"></fluent-skeleton>
                <fluent-skeleton shimmer class="shimmer icon" shape="circle"></fluent-skeleton>
              </div>
              <div class="task-due">
                <div class="task-icon-text">
                  <fluent-skeleton shimmer class="shimmer text" shape="rect"></fluent-skeleton>
                </div>
              </div>
              </div>
          </div>
        </div>
      </div>
    `}getTaskSource(){const t=Providers.globalProvider;if(!t||t.state!==exports.ProviderState.SignedIn)return null;const o=t.graph.forComponent(this);return this.dataSource===exports.TasksSource.planner?new PlannerTaskSource(o):this.dataSource===exports.TasksSource.todo?new TodoTaskSource(o):null}getPlanTitle(t){return t?t===this.res.PLANS_SELF_ASSIGNED?this.res.PLANS_SELF_ASSIGNED:(this._groups.find((o=>o.id===t))||{title:this.res.PLAN_NOT_FOUND}).title:this.res.BASE_SELF_ASSIGNED}getFolderName(t){return t?(this._folders.find((o=>o.id===t))||{name:this.res.BUCKET_NOT_FOUND}).name:this.res.BUCKETS_SELF_ASSIGNED}isTaskInSelectedGroupFilter(t){var o;return!this._currentGroup||t.topParentId===this._currentGroup||!this._currentGroup&&this.getTaskSource().isAssignedToMe(t,null===(o=this._me)||void 0===o?void 0:o.id)}isTaskInSelectedFolderFilter(t){return t.immediateParentId===this._currentFolder||!this._currentFolder}dateToInputValue(t){return t?new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().split("T")[0]:null}},__decorate$9([n$1({attribute:"read-only",type:Boolean}),__metadata$9("design:type",Boolean)],exports.MgtTasks.prototype,"readOnly",void 0),__decorate$9([n$1({attribute:"data-source",converter:(t,o)=>(t=t.toLowerCase(),exports.TasksSource[t]||exports.TasksSource.planner)}),__metadata$9("design:type",Number)],exports.MgtTasks.prototype,"dataSource",void 0),__decorate$9([n$1({attribute:"target-id",type:String}),__metadata$9("design:type",String)],exports.MgtTasks.prototype,"targetId",void 0),__decorate$9([n$1({attribute:"target-bucket-id",type:String}),__metadata$9("design:type",String)],exports.MgtTasks.prototype,"targetBucketId",void 0),__decorate$9([n$1({attribute:"initial-id",type:String}),__metadata$9("design:type",String)],exports.MgtTasks.prototype,"initialId",void 0),__decorate$9([n$1({attribute:"initial-bucket-id",type:String}),__metadata$9("design:type",String)],exports.MgtTasks.prototype,"initialBucketId",void 0),__decorate$9([n$1({attribute:"hide-header",type:Boolean}),__metadata$9("design:type",Boolean)],exports.MgtTasks.prototype,"hideHeader",void 0),__decorate$9([n$1({attribute:"hide-options",type:Boolean}),__metadata$9("design:type",Boolean)],exports.MgtTasks.prototype,"hideOptions",void 0),__decorate$9([n$1({attribute:"group-id",type:String}),__metadata$9("design:type",String)],exports.MgtTasks.prototype,"groupId",void 0),__decorate$9([n$1(),__metadata$9("design:type",Boolean)],exports.MgtTasks.prototype,"_isNewTaskVisible",void 0),__decorate$9([n$1(),__metadata$9("design:type",Boolean)],exports.MgtTasks.prototype,"_newTaskBeingAdded",void 0),__decorate$9([n$1(),__metadata$9("design:type",String)],exports.MgtTasks.prototype,"_newTaskName",void 0),__decorate$9([n$1(),__metadata$9("design:type",Date)],exports.MgtTasks.prototype,"_newTaskDueDate",void 0),__decorate$9([n$1(),__metadata$9("design:type",String)],exports.MgtTasks.prototype,"_newTaskGroupId",void 0),__decorate$9([n$1(),__metadata$9("design:type",String)],exports.MgtTasks.prototype,"_newTaskFolderId",void 0),__decorate$9([n$1(),__metadata$9("design:type",String)],exports.MgtTasks.prototype,"_newTaskContainerId",void 0),__decorate$9([n$1(),__metadata$9("design:type",Array)],exports.MgtTasks.prototype,"_groups",void 0),__decorate$9([n$1(),__metadata$9("design:type",Array)],exports.MgtTasks.prototype,"_folders",void 0),__decorate$9([n$1(),__metadata$9("design:type",Array)],exports.MgtTasks.prototype,"_tasks",void 0),__decorate$9([n$1(),__metadata$9("design:type",Array)],exports.MgtTasks.prototype,"_hiddenTasks",void 0),__decorate$9([n$1(),__metadata$9("design:type",Array)],exports.MgtTasks.prototype,"_loadingTasks",void 0),__decorate$9([n$1(),__metadata$9("design:type",Boolean)],exports.MgtTasks.prototype,"_inTaskLoad",void 0),__decorate$9([n$1(),__metadata$9("design:type",Boolean)],exports.MgtTasks.prototype,"_hasDoneInitialLoad",void 0),__decorate$9([n$1(),__metadata$9("design:type",Boolean)],exports.MgtTasks.prototype,"_todoDefaultSet",void 0),__decorate$9([n$1(),__metadata$9("design:type",String)],exports.MgtTasks.prototype,"_currentGroup",void 0),__decorate$9([n$1(),__metadata$9("design:type",String)],exports.MgtTasks.prototype,"_currentFolder",void 0),__decorate$9([t$1(),__metadata$9("design:type",Object)],exports.MgtTasks.prototype,"_isDarkMode",void 0),__decorate$9([t$1(),__metadata$9("design:type",Object)],exports.MgtTasks.prototype,"_me",void 0),exports.MgtTasks=__decorate$9([customElement("tasks"),__metadata$9("design:paramtypes",[])],exports.MgtTasks);const uB=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host .container{display:flex;flex-direction:column;position:relative}:host .dropdown{display:none;position:absolute;z-index:1000;top:34px}:host .dropdown.visible{display:flex}:host .dropdown .team-photo{width:24px;position:inherit;border-radius:50%;margin:0 6px}:host .dropdown .team-start-slot{width:max-content}:host .dropdown .team-parent-name{width:auto}:host .loading-text,:host .search-error-text{font-style:normal;font-weight:400;font-size:14px;line-height:20px}:host .message-parent{display:flex;flex-direction:row;gap:5px;padding:5px}:host .message-parent .loading-text{margin:auto}:host fluent-card{background:var(--channel-picker-dropdown-background-color,var(--fill-color));padding:2px;--card-height:auto;--width:var(--card-width)}:host fluent-text-field{width:100%}:host fluent-text-field::part(root){background:padding-box linear-gradient(var(--channel-picker-input-background-color,var(--neutral-fill-input-rest)),var(--channel-picker-input-background-color,var(--neutral-fill-input-rest))),border-box var(--channel-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover)),var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover))),border-box var(--channel-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus)),var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus))),border-box var(--channel-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(control){word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-text-field::part(control)::placeholder{color:var(--channel-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--channel-picker-input-placeholder-text-color-hover,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--channel-picker-input-placeholder-text-color-focus,var(--input-placeholder-filled))}:host fluent-text-field .search-icon svg path{fill:var(--channel-picker-search-icon-color,currentColor)}:host fluent-text-field .down-chevron{height:auto;min-width:auto}:host fluent-text-field .down-chevron svg path{fill:var(--channel-picker-down-chevron-color,currentColor)}:host fluent-text-field .up-chevron{height:auto;min-width:auto}:host fluent-text-field .up-chevron svg path{fill:var(--channel-picker-up-chevron-color,currentColor)}:host fluent-text-field .close-icon{height:auto;min-width:auto}:host fluent-text-field .close-icon svg path{fill:var(--channel-picker-close-icon-color,currentColor)}:host fluent-tree-view{min-width:100%;--tree-item-nested-width:2em}:host fluent-tree-item{width:100%;--tree-item-nested-width:2em}:host fluent-tree-item:focus-visible{outline:0}:host fluent-tree-item::part(expand-collapse-button){background:0 0}:host fluent-tree-item::part(content-region),:host fluent-tree-item::part(positioning-region){color:var(--channel-picker-dropdown-item-text-color,currentColor);background:var(--channel-picker-dropdown-background-color,transparent);border:calc(var(--stroke-width) * 2px) solid transparent;height:auto}:host fluent-tree-item::part(content-region):hover,:host fluent-tree-item::part(positioning-region):hover{background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item::part(content-region):hover::part(expand-collapse-button),:host fluent-tree-item::part(positioning-region):hover::part(expand-collapse-button){background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item fluent-tree-item::part(content-region){height:auto}:host fluent-breadcrumb-item{color:var(--channel-picker-dropdown-item-text-color-selected,var(--neutral-foreground-rest))}:host fluent-breadcrumb-item .team-parent-name{font-weight:700}:host fluent-breadcrumb-item .team-photo{width:19px;position:inherit;border-radius:50%}:host fluent-breadcrumb-item .arrow{margin-left:8px;margin-right:8px}:host fluent-breadcrumb-item .arrow svg{stroke:var(--channel-picker-arrow-fill,var(--neutral-foreground-rest))}[dir=rtl] :host{--direction:rtl}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{transform:scaleX(-1);filter:fliph;filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}[dir=rtl] .message-parent .loading-text{right:auto;left:10px;padding-right:8px;text-align:right}@media (forced-colors:active) and (prefers-color-scheme:dark){:host fluent-text-field svg{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host fluent-text-field svg{stroke:#000!important}}
`];var __awaiter$9=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const hB={inputPlaceholderText:"Select a channel",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading...",photoFor:"Teams photo for",teamsChannels:"Teams and channels results",closeButtonAriaLabel:"remove the selected channel"};var pB,__decorate$8=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$8=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$8=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(xL,SL,$L,lF,fF,sF),exports.MgtTeamsChannelPicker=pB=class MgtTeamsChannelPicker extends MgtTemplatedComponent{static get styles(){return uB}get strings(){return hB}get selectedItem(){return this._selectedItemState?{channel:this._selectedItemState.item,team:this._selectedItemState.parent.item}:null}static get requiredScopes(){return["team.readbasic.all","channel.readbasic.all"]}set items(t){this._items!==t&&(this._items=t,this._treeViewState=t?this.generateTreeViewState(t):[],this.resetFocusState())}get items(){return this._items}get _inputWrapper(){return this.renderRoot.querySelector("fluent-text-field")}get _input(){return this._inputWrapper.shadowRoot.querySelector("input")}constructor(){super(),this.teamsPhotos={},this._inputValue="",this._treeViewState=[],this._focusList=[],this.handleInputClick=t=>{t.stopPropagation(),this.gainedFocus()},this.handleInputKeydown=t=>{const o=t.key;if(["ArrowDown","Enter"].includes(o))if(this._isDropdownVisible){this.renderRoot.querySelector("fluent-tree-item").focus()}else this.gainedFocus();else"Escape"===o&&this.lostFocus()},this.onClickCloseButton=()=>{this.removeSelectedChannel(null)},this.onKeydownCloseButton=t=>{"Enter"===t.key&&this.removeSelectedChannel(null)},this.onKeydownTreeView=t=>{"Escape"===t.key&&this.lostFocus()},this.handleTeamTreeItemClick=t=>{t.preventDefault(),t.stopImmediatePropagation();const o=t.target;if(o){o.getAttribute("expanded")?o.removeAttribute("expanded"):o.setAttribute("expanded","true"),o.removeAttribute("selected");o.getAttribute("id")&&o.setAttribute("selected","true")}},this.handleInputChanged=t=>{const o=t.target;this._inputValue!==(null==o?void 0:o.value)&&(this._inputValue=null==o?void 0:o.value,this.gainedFocus(),this.debouncedSearch||(this.debouncedSearch=debounce((()=>{this.filterList()}),400)),this.debouncedSearch())},this.handleWindowClick=t=>{t.target!==this&&this.lostFocus()},this.gainedFocus=()=>{const t=this._input;t&&t.focus(),this._isDropdownVisible=!0,this.toggleChevron(),this.resetFocusState(),this.requestUpdate()},this.lostFocus=()=>{this._input.value=this._inputValue="",this._input.textContent="";this._inputWrapper.value="",this._isDropdownVisible=!1,this.filterList(),this.toggleChevron(),this.requestUpdate(),void 0!==this._selectedItemState&&this.showCloseIcon()},this.handleFocus=()=>{this.lostFocus(),this.gainedFocus()},this.handleUpChevronClick=t=>{t.stopPropagation(),this.lostFocus()},this.addEventListener("focus",(()=>this.loadTeamsIfNotLoaded())),this.addEventListener("mouseover",(()=>this.loadTeamsIfNotLoaded())),this.addEventListener("blur",(()=>this.lostFocus())),this._inputValue="",this._treeViewState=[],this._focusList=[],this._isDropdownVisible=!1}connectedCallback(){super.connectedCallback(),window.addEventListener("click",this.handleWindowClick);const t=this.renderRoot.ownerDocument;t&&t.documentElement.setAttribute("dir",this.direction)}disconnectedCallback(){window.removeEventListener("click",this.handleWindowClick),super.disconnectedCallback()}selectChannelById(t){return __awaiter$8(this,void 0,void 0,(function*(){const o=Providers.globalProvider;if(o&&o.state===exports.ProviderState.SignedIn){this.items||(yield this.requestStateUpdate());for(const o of this._treeViewState)for(const s of o.channels)if(s.item.id===t)return o.isExpanded=!0,this.selectChannel(s),this.markSelectedChannelInDropdown(t),!0}return!1}))}markSelectedChannelInDropdown(t){const o=this.renderRoot.querySelector(`[id='${t}']`);o&&(o.setAttribute("selected","true"),o.parentElement&&o.parentElement.setAttribute("expanded","true"))}render(){var t;const o={dropdown:!0,visible:this._isDropdownVisible};return this.renderTemplate("default",{teams:null!==(t=this.items)&&void 0!==t?t:[]})||AI`
        <div class="container" @blur=${this.lostFocus}>
          <fluent-text-field
            autocomplete="off"
            appearance="outline"
            id="teams-channel-picker-input"
            role="combobox"
            placeholder="${this._selectedItemState?"":this.strings.inputPlaceholderText} "
            aria-label=${this.strings.inputPlaceholderText}
            aria-expanded="${this._isDropdownVisible}"
            label="teams-channel-picker-input"
            @focus=${this.handleFocus}
            @keyup=${this.handleInputChanged}
            @click=${this.handleInputClick}
            @keydown=${this.handleInputKeydown}
          >
            <div tabindex="0" slot="start" style="width: max-content;">${this.renderSelected()}</div>
            <div tabindex="0" slot="end">${this.renderChevrons()}${this.renderCloseButton()}</div>
          </fluent-text-field>
          <fluent-card
            class=${iP(o)}
          >
            ${this.renderDropdown()}
          </fluent-card>
        </div>`}renderSelected(){var t,o,s,l,h,m;if(!this._selectedItemState)return this.renderSearchIcon();let _;if(this._selectedItemState.parent.channels){const o=null===(t=this.teamsPhotos[this._selectedItemState.parent.item.id])||void 0===t?void 0:t.photo;_=AI`<img
        class="team-photo"
        alt="${this._selectedItemState.parent.item.displayName}"
        role="img"
        src=${o} />`}const E=null===(l=null===(s=null===(o=this._selectedItemState)||void 0===o?void 0:o.parent)||void 0===s?void 0:s.item)||void 0===l?void 0:l.displayName.trim(),$=null===(m=null===(h=this._selectedItemState)||void 0===h?void 0:h.item)||void 0===m?void 0:m.displayName.trim();return AI`
      <fluent-breadcrumb title=${this._selectedItemState.item.displayName}>
        <fluent-breadcrumb-item>
          <span slot="start">${_}</span>
          <span class="team-parent-name">${E}</span>
          <span slot="separator" class="arrow">${getSvg(yP.TeamSeparator,"#000000")}</span>
        </fluent-breadcrumb-item>
        <fluent-breadcrumb-item>${$}</fluent-breadcrumb-item>
      </fluent-breadcrumb>`}clearState(){this._inputValue="",this._treeViewState=[],this._focusList=[],this._isDropdownVisible=!1}renderSearchIcon(){return AI`
      <div class="search-icon">
        ${getSvg(yP.Search,"#252424")}
      </div>
    `}renderCloseButton(){return AI`
      <fluent-button
        appearance="stealth"
        class="close-icon"
        style="display:none"
        aria-label=${this.strings.closeButtonAriaLabel}
        @click=${this.onClickCloseButton}
        @keydown=${this.onKeydownCloseButton}>
        <svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M0.0885911 0.215694L0.146447 0.146447C0.320013 -0.0271197 0.589437 -0.046405 0.784306 0.0885911L0.853553 0.146447L4 3.293L7.14645 0.146447C7.34171 -0.0488154 7.65829 -0.0488154 7.85355 0.146447C8.04882 0.341709 8.04882 0.658291 7.85355 0.853553L4.707 4L7.85355 7.14645C8.02712 7.32001 8.0464 7.58944 7.91141 7.78431L7.85355 7.85355C7.67999 8.02712 7.41056 8.0464 7.21569 7.91141L7.14645 7.85355L4 4.707L0.853553 7.85355C0.658291 8.04882 0.341709 8.04882 0.146447 7.85355C-0.0488154 7.65829 -0.0488154 7.34171 0.146447 7.14645L3.293 4L0.146447 0.853553C-0.0271197 0.679987 -0.046405 0.410563 0.0885911 0.215694L0.146447 0.146447L0.0885911 0.215694Z" fill="#212121"/>
        </svg>
      </fluent-button>
    `}showCloseIcon(){const t=this.renderRoot.querySelector(".down-chevron"),o=this.renderRoot.querySelector(".up-chevron"),s=this.renderRoot.querySelector(".close-icon");t&&(t.style.display="none"),o&&(o.style.display="none"),s&&(s.style.display=null)}renderDownChevron(){return AI`
      <fluent-button appearance="stealth" class="down-chevron" @click=${this.gainedFocus}>
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M2.21967 4.46967C2.51256 4.17678 2.98744 4.17678 3.28033 4.46967L6 7.18934L8.71967 4.46967C9.01256 4.17678 9.48744 4.17678 9.78033 4.46967C10.0732 4.76256 10.0732 5.23744 9.78033 5.53033L6.53033 8.78033C6.23744 9.07322 5.76256 9.07322 5.46967 8.78033L2.21967 5.53033C1.92678 5.23744 1.92678 4.76256 2.21967 4.46967Z" fill="#212121" />
        </svg>
      </fluent-button>`}renderUpChevron(){return AI`
      <fluent-button appearance="stealth" style="display:none" class="up-chevron" @click=${this.handleUpChevronClick}>
        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M2.21967 7.53033C2.51256 7.82322 2.98744 7.82322 3.28033 7.53033L6 4.81066L8.71967 7.53033C9.01256 7.82322 9.48744 7.82322 9.78033 7.53033C10.0732 7.23744 10.0732 6.76256 9.78033 6.46967L6.53033 3.21967C6.23744 2.92678 5.76256 2.92678 5.46967 3.21967L2.21967 6.46967C1.92678 6.76256 1.92678 7.23744 2.21967 7.53033Z" fill="#212121" />
        </svg>
      </fluent-button>`}renderChevrons(){return AI`${this.renderUpChevron()}${this.renderDownChevron()}`}renderDropdown(){return this.isLoadingState||!this._treeViewState?this.renderLoading():this._treeViewState?!this.isLoadingState&&0===this._treeViewState.length&&this._inputValue.length>0?this.renderError():this.renderDropdownList(this._treeViewState):AI``}renderDropdownList(t){if(t&&t.length>0){let o=null;return AI`
        <fluent-tree-view
          class="tree-view"
          dir=${this.direction}
          aria-live="polite"
          aria-relevant="all"
          aria-atomic="true"
          aria-label=${this.strings.teamsChannels}
          aria-orientation="horizontal"
          @keydown=${this.onKeydownTreeView}>
          ${RP(t,(t=>null==t?void 0:t.item),(t=>{var s;return t.channels&&(o=AI`<img
                  class="team-photo"
                  alt="${this.strings.photoFor} ${t.item.displayName}"
                  src=${null===(s=this.teamsPhotos[t.item.id])||void 0===s?void 0:s.photo} />`),AI`
                <fluent-tree-item
                  ?expanded=${null==t?void 0:t.isExpanded}
                  @click=${this.handleTeamTreeItemClick}>
                    <span slot="start">${o}</span>${t.item.displayName}
                    ${RP(null==t?void 0:t.channels,(t=>t.item),(t=>this.renderItem(t)))}
                </fluent-tree-item>`}))}
        </fluent-tree-view>`}return null}renderItem(t){var o;return AI`
      <fluent-tree-item
        id=${null===(o=null==t?void 0:t.item)||void 0===o?void 0:o.id}
        @keydown=${o=>this.onUserKeyDown(o,t)}
        @click=${()=>this.handleItemClick(t)}>
          ${null==t?void 0:t.item.displayName}
      </fluent-tree-item>`}renderError(){return this.renderTemplate("error",null,"error")||AI`
        <div class="message-parent">
          <div
            label="search-error-text"
            aria-live="polite"
            aria-relevant="all"
            aria-atomic="true"
            class="search-error-text"
          >
            ${this.strings.noResultsFound}
          </div>
        </div>
      `}renderLoading(){return this.renderTemplate("loading",null,"loading")||mgtHtml`
        <div class="message-parent">
          <mgt-spinner></mgt-spinner>
          <div label="loading-text" aria-label="loading" class="loading-text">
            ${this.strings.loadingMessage}
          </div>
        </div>
      `}loadState(){var t,o;return __awaiter$8(this,void 0,void 0,(function*(){const s=Providers.globalProvider;let l;if(s&&s.state===exports.ProviderState.SignedIn){const h=s.graph.forComponent(this);l=yield((t,o)=>__awaiter$9(void 0,void 0,void 0,(function*(){const s=yield t.api("/me/joinedTeams").select(["displayName","id","isArchived"]).middlewareOptions(prepScopes(...o)).get();return null==s?void 0:s.value})))(h,pB.requiredScopes),l=l.filter((t=>!t.isArchived));const m=BetaGraph.fromGraph(h),_=l.map((t=>t.id));this.teamsPhotos=yield((t,o)=>__awaiter$9(void 0,void 0,void 0,(function*(){let s,l={};if(getIsPhotosCacheEnabled()){s=CacheService.getCache(lP,lP.stores.teams);for(const t of o)try{const o=yield s.getValue(t);o&&getPhotoInvalidationTime()>Date.now()-o.timeCached&&(l[t]=o)}catch(t){}if(Object.keys(l).length)return l}const h=["team.readbasic.all"];l={};for(const m of o)try{const o=yield getPhotoForResource(t,`/teams/${m}`,h);getIsPhotosCacheEnabled()&&o&&(yield s.putValue(m,o)),l[m]=o}catch(t){}return l})))(m,_);const E=h.createBatch();for(const t of l)E.get(t.id,`teams/${t.id}/channels`,pB.requiredScopes);const $=yield E.executeAll();this._items=[];for(const s of l){const l=$.get(s.id);(null===(o=null===(t=l.content)||void 0===t?void 0:t.value)||void 0===o?void 0:o.length)&&this.items.push({item:s,channels:l.content.value.map((t=>({item:t})))})}}this.filterList(),this.resetFocusState()}))}removeSelectedChannel(t){this.selectChannel(t);const o=this.renderRoot.querySelectorAll("fluent-tree-item");o&&o.forEach((t=>{t.removeAttribute("expanded"),t.removeAttribute("selected")}))}handleItemClick(t){t.channels?t.isExpanded=!t.isExpanded:(this.selectChannel(t),this.lostFocus())}onUserKeyDown(t,o){switch(t.code){case"Enter":this.selectChannel(o),this.resetFocusState(),this.lostFocus(),t.preventDefault();break;case"Backspace":0===this._inputValue.length&&this._selectedItemState&&(this.selectChannel(null),this.resetFocusState(),t.preventDefault())}}filterList(){this.items&&(this._treeViewState=this.generateTreeViewState(this.items,this._inputValue),this.resetFocusState())}generateTreeViewState(t,o="",s=null){const l=[];if(o=o.toLowerCase(),t)for(const h of t){let t;if(0===o.length||h.item.displayName.toLowerCase().includes(o))t={item:h.item,parent:s},h.channels&&(t.channels=this.generateTreeViewState(h.channels,"",t),t.isExpanded=o.length>0);else if(h.channels){const l={item:h.item,parent:s},m=this.generateTreeViewState(h.channels,o,l);m.length>0&&(t=l,t.channels=m,t.isExpanded=!0)}t&&l.push(t)}return l}generateFocusList(t){if(!t||0===t.length)return[];let o=[];for(const s of t)o.push(s),s.channels&&s.isExpanded&&(o=[...o,...this.generateFocusList(s.channels)]);return o}resetFocusState(){this._focusList=this.generateFocusList(this._treeViewState),this.requestUpdate()}loadTeamsIfNotLoaded(){this.items||this.isLoadingState||this.requestStateUpdate()}selectChannel(t){t&&this._selectedItemState!==t?this._input.setAttribute("disabled","true"):this._input.removeAttribute("disabled"),this._selectedItemState=t,this.lostFocus(),this.fireCustomEvent("selectionChanged",this.selectedItem)}hideCloseIcon(){const t=this.renderRoot.querySelector(".close-icon");t&&(t.style.display="none")}toggleChevron(){const t=this.renderRoot.querySelector(".down-chevron"),o=this.renderRoot.querySelector(".up-chevron");this._isDropdownVisible?(t&&(t.style.display="none"),o&&(o.style.display=null)):(t&&(t.style.display=null,this.hideCloseIcon()),o&&(o.style.display="none")),this.hideCloseIcon()}},__decorate$8([t$1(),__metadata$8("design:type",Object)],exports.MgtTeamsChannelPicker.prototype,"_selectedItemState",void 0),__decorate$8([t$1(),__metadata$8("design:type",Boolean)],exports.MgtTeamsChannelPicker.prototype,"_isDropdownVisible",void 0),exports.MgtTeamsChannelPicker=pB=__decorate$8([customElement("teams-channel-picker"),__metadata$8("design:paramtypes",[])],exports.MgtTeamsChannelPicker);const fB={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Add a task",addTaskButtonSubtitle:"Add",removeTaskSubtitle:"Delete Task"};var __decorate$7=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$7=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};registerFluentComponents(sF,AL,RL);class MgtTasksBase extends MgtTemplatedComponent{get strings(){return fB}constructor(){super(),this.handleTaskClick=t=>{this.fireCustomEvent("taskClick",{task:t})},this.onResize=()=>{this.mediaQuery!==this._previousMediaQuery&&(this._previousMediaQuery=this.mediaQuery,this.requestUpdate())},this.clearState(),this._previousMediaQuery=this.mediaQuery}attributeChangedCallback(t,o,s){switch(super.attributeChangedCallback(t,o,s),t){case"target-id":case"initial-id":this.clearState(),this.requestStateUpdate()}}connectedCallback(){super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}render(){const t=Providers.globalProvider;if(!t||t.state!==exports.ProviderState.SignedIn)return AI``;if(this.isLoadingState)return this.renderLoadingTask();const o=this.renderPicker(),s=this.renderNewTask(),l=this.isLoadingState?this.renderLoadingTask():this.renderTasks();return AI`
      ${o}
      ${s}
      <div class="tasks" dir=${this.direction}>
        ${l}
      </div>
    `}renderLoadingTask(){return AI`
      <div class="task loading-task">
        <div class="task-details">
          <div class="title"></div>
          <div class="task-due"></div>
          <div class="task-delete"></div>
        </div>
      </div>
    `}clearState(){this.requestUpdate()}dateToInputValue(t){return t?new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().split("T")[0]:null}}__decorate$7([n$1({attribute:"read-only",type:Boolean}),__metadata$7("design:type",Boolean)],MgtTasksBase.prototype,"readOnly",void 0),__decorate$7([n$1({attribute:"hide-header",type:Boolean}),__metadata$7("design:type",Boolean)],MgtTasksBase.prototype,"hideHeader",void 0),__decorate$7([n$1({attribute:"hide-options",type:Boolean}),__metadata$7("design:type",Boolean)],MgtTasksBase.prototype,"hideOptions",void 0),__decorate$7([n$1({attribute:"target-id",type:String}),__metadata$7("design:type",String)],MgtTasksBase.prototype,"targetId",void 0),__decorate$7([n$1({attribute:"initial-id",type:String}),__metadata$7("design:type",String)],MgtTasksBase.prototype,"initialId",void 0);var __awaiter$7=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};const getTodoTasks=(t,o)=>__awaiter$7(void 0,void 0,void 0,(function*(){const s=yield t.api(`/me/todo/lists/${o}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return null==s?void 0:s.value})),getTodoTaskList=(t,o)=>__awaiter$7(void 0,void 0,void 0,(function*(){return yield t.api(`/me/todo/lists/${o}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get()})),gB=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{display:flex;flex-direction:column;color:var(--color,var(--neutral-foreground-rest))}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;appearance:none}:host .task-icon{font-family:FabricMDL2Icons;user-select:none}:host .task-icon.divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .header{margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .header select{font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;appearance:none;cursor:pointer}:host .header select::-ms-expand{display:none}:host .header .plan-title{font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .header .add-bar{display:flex}:host .header .add-bar .add-bar-item{flex:1 1 auto}:host .header .new-task-due{display:flex}:host .header .new-task-due input{flex:1 1 auto;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .header .title-cont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .header .new-task-button{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;cursor:pointer}:host .header .new-task-button span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .header .new-task-button .task-icon{margin-right:8px}:host .header .new-task-button.hidden{visibility:hidden}:host .header .new-task-button:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .header .new-task-button:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .task{position:relative;margin:var(--task-margin,0 0 0 0);padding:var(--task-padding,0 0 0 0);background-color:var(--task-background-color,var(--neutral-layer-floating));border:var(--task-border,var(--neutral-stroke-input-active));border-radius:8px}:host .task .task-content{display:flex}:host .task .task-content .divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task .task-content .task-details-container{flex:1;display:grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .task .task-content .task-details-container .task-detail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .task .task-content .task-details-container .task-title{color:var(--task-color,var(--neutral-foreground-rest));font-size:14px;font-weight:600;grid-row:1;grid-column:1/3;grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .task .task-content .task-details-container .task-group{min-height:24px;grid-row:2;grid-column:1}:host .task .task-content .task-details-container .task-bucket{min-height:24px;grid-row:2;grid-column:2}:host .task .task-content .task-details-container .task-due{justify-content:flex-end;align-items:flex-start;grid-row:4;grid-column:1/3;grid-column:1;-ms-grid-column-span:2}:host .task .task-content .task-details-container.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .task .task-content .task-details-container.tablet.no-plan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .task .task-content .task-details-container.tablet .task-detail{margin:4px 24px 6px 0}:host .task .task-content .task-details-container.tablet .task-title{grid-row:1;grid-column:1/5;grid-column:1;-ms-grid-column-span:4}:host .task .task-content .task-details-container.tablet .task-group{grid-row:2;grid-column:1}:host .task .task-content .task-details-container.tablet .task-bucket{grid-row:2;grid-column:2}:host .task .task-content .task-details-container.tablet .task-assignee{grid-row:2;grid-column:3}:host .task .task-content .task-details-container.tablet .task-due{justify-content:flex-start;align-items:center;grid-row:2;grid-column:4}:host .task .task-content .task-details-container.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .task .task-content .task-details-container.desktop.no-plan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .task .task-content .task-details-container.desktop .task-detail{margin:0 24px 0 0}:host .task .task-content .task-details-container.desktop .task-title{padding:0;grid-row:1;grid-column:1}:host .task .task-content .task-details-container.desktop .task-group{min-height:61px;grid-row:1;grid-column:2}:host .task .task-content .task-details-container.desktop .task-bucket{grid-row:1;grid-column:3}:host .task .task-content .task-details-container.desktop .task-assignee{grid-row:1;grid-column:4}:host .task .task-content .task-details-container.desktop .task-due{justify-content:flex-start;align-items:center;grid-row:1;grid-column:5}:host .task .task-content .task-details-container svg{vertical-align:middle;margin-right:4px}:host .task .task-content .task-details-container svg path{fill:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container select,:host .task .task-content .task-details-container span{vertical-align:middle;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container .task-icon{color:#797775;margin-right:8px}:host .task .task-content .task-details-container .people{color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:16px}:host .task .task-content .task-details-container .person{display:inline-block}:host .task .task-content .task-details-container .picker{background-color:var(--task-background-color,var(--neutral-layer-floating));background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container .picker .people-picker{--separator-margin:0px 10px 0px 10px}:host .task .task-content .task-details-container input,:host .task .task-content .task-details-container select{color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:.9em;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task .task-check-container{font-family:FabricMDL2Icons;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none}:host .task .task-check-container.complete .task-check{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .task .task-check-container.complete .task-content .task-details-container .task-title{text-decoration:line-through;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-check-container .task-check{font-family:FabricMDL2Icons;font-size:12px;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-color,var(--neutral-foreground-rest));display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none}:host .task .task-check-container .task-check.loading .task-check-content{animation:rotate-icon 2s infinite linear}:host .task .task-options{cursor:pointer;user-select:none;margin:16px 8px 0 0}:host .task.read-only .task-check-container{cursor:default}:host .task.complete{background:var(--task-complete-background,var(--neutral-layer-1));border:var(--task-complete-border,2px dotted inherit)}:host .task.complete .task-content .task-details-container .task-title{text-decoration:line-through;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task.new-task{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .task.new-task .self-assign{display:none}:host .task.new-task .assign-to{border:0;background:0 0}:host .task.new-task .fake-check-box{width:15px;height:15px;cursor:pointer;margin:0 5px}:host .task.new-task .fake-check-box::after{font-family:FabricMDL2Icons;content:"uE739"}:host .task.new-task .fake-check-box~:checked{font-family:FabricMDL2Icons;content:"uE73A"}:host .task.new-task .task-content{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .task.new-task .task-content .task-details-container{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .task.new-task .task-content .task-details-container .task-title{display:flex;height:32px;padding:2px}:host .task.new-task .task-content .task-details-container .task-title input{flex:1;margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task.new-task .task-content .task-details-container .task-title input:hover{border-bottom:1px solid #106ebe}:host .task.new-task .task-content .task-details-container .task-title input:active{border-bottom:1px solid #005a9e}:host .task.new-task .task-content .task-details-container .task-title input:focus{border-bottom:1px solid #0078d4}:host .task.new-task .task-content .task-details-container .task-details{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .task.new-task .task-content .task-details-container .task-details .new-task-group{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-bucket{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-due{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-assignee{margin:8px 16px;min-width:80px}:host .task.new-task .task-content .task-details-container .task-details .task-people label{display:flex;align-content:center;align-items:center}:host .task.new-task .task-content .task-details-container .task-details input,:host .task.new-task .task-content .task-details-container .task-details select{font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .task.new-task .task-content .task-details-container .task-details input:hover,:host .task.new-task .task-content .task-details-container .task-details select:hover{border-bottom:1px solid #106ebe}:host .task.new-task .task-content .task-details-container .task-details input:active,:host .task.new-task .task-content .task-details-container .task-details select:active{border-bottom:1px solid #005a9e}:host .task.new-task .task-content .task-details-container .task-details input:focus,:host .task.new-task .task-content .task-details-container .task-details select:focus{border-bottom:1px solid #0078d4}:host .task.new-task .task-add-button-container{margin-right:28px}:host .task.new-task .task-add-button-container .task-add,:host .task.new-task .task-add-button-container .task-cancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-size:14px;line-height:20px}:host .task.new-task .task-add-button-container .task-add{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .task.new-task .task-add-button-container .task-cancel{color:var(--task-new-cancel-button-color,var(--neutral-foreground-rest))}:host .task.new-task .task-add-button-container.disabled .task-add{color:var(--task-new-cancel-button-color,var(--neutral-foreground-rest));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}@keyframes rotate-icon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] .arrow-options{--arrow-options-left:auto}[dir=rtl] .dot-options{--dot-options-translatex:translateX(60px)}[dir=rtl] .task-details{margin-right:14px!important}[dir=rtl] .task-icon{margin-left:8px}[dir=rtl] .task-detail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}:host{border-radius:8px;width:100%}:host .task,:host.loading-task{margin-block:1px;box-shadow:var(--task-box-shadow,var(--elevation-shadow-card-active));width:100%;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task.new-task,:host.loading-task.new-task{margin:14px 0 1px;box-shadow:var(--task-box-shadow,var(--elevation-shadow-card-active))}:host .task.complete,:host.loading-task.complete{text-decoration:line-through;border:1px solid var(--task-border-completed,var(--neutral-stroke-input-active));background:var(--task-complete-background,var(--neutral-layer-1))}:host .task.read-only,:host.loading-task.read-only{opacity:1}:host .task:hover,:host.loading-task:hover{background-color:var(--task-background-color-hover,var(--neutral-fill-hover));border-radius:8px}:host .task .task-details,:host.loading-task .task-details{box-sizing:border-box;display:flex;flex-direction:row;align-items:center;padding:2px;line-height:24px;border-radius:4px}:host .task .task-details .task>div,:host.loading-task .task-details .task>div{display:flex;align-items:center;width:200px}:host .task .task-details .title,:host.loading-task .task-details .title{flex-grow:1}:host .task .task-details .task-delete,:host.loading-task .task-details .task-delete{display:flex}:host .task .task-details .task-due,:host.loading-task .task-details .task-due{min-width:120px;margin-inline-end:12px;height:32px;text-decoration:inherit;display:flex}:host .task .task-details .task-due .task-calendar,:host.loading-task .task-details .task-due .task-calendar{display:flex;margin-top:5px;margin-inline-end:10px}:host .task .task-details .task-due .task-calendar svg,:host.loading-task .task-details .task-due .task-calendar svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host .task .task-details .task-due .task-due-date,:host.loading-task .task-details .task-due .task-due-date{display:flex;margin-top:5px}:host fluent-text-field::part(end),:host fluent-text-field::part(start){margin-inline:unset}:host fluent-text-field::part(control){padding:0;cursor:pointer}:host fluent-text-field::part(root){background:0 0}:host fluent-text-field.new-task{width:100%;height:34px}:host fluent-text-field.new-task div.start .add-icon{display:flex;margin-inline:10px}:host fluent-text-field.new-task div:nth-child(2){display:flex;align-items:center}:host fluent-text-field.new-task div:nth-child(2) .calendar{display:flex;align-items:center}:host fluent-text-field.new-task div:nth-child(2) .calendar svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-text-field.new-task div:nth-child(2) .calendar .date{margin-inline-start:10px;color:var(--task-color,var(--neutral-foreground-rest));width:auto;cursor:pointer}:host fluent-text-field.new-task div:nth-child(2) .calendar .date::after{border-bottom:none}:host fluent-text-field.new-task div:nth-child(2) .calendar .date.dark::part(control){color-scheme:dark}:host fluent-text-field.new-task div:nth-child(2) .calendar input{flex:1;border:none;border-bottom:1px solid var(--task-color,var(--neutral-foreground-rest));outline:0;border-radius:0}:host fluent-text-field.new-task div:nth-child(2) .calendar input:hover{border-bottom:1px solid var(--task-date-input-hover-color,var(--neutral-layer-1))}:host fluent-text-field.new-task div:nth-child(2) .calendar input:active{border-bottom:1px solid var(--task-date-input-active-color,var(--accent-fill-rest))}:host fluent-text-field.new-task div:nth-child(2) .calendar input:focus{border-bottom:1px solid var(--task-date-input-active-color,var(--accent-fill-rest))}:host fluent-button.task-add-icon.neutral,:host fluent-button.task-cancel-icon.neutral,:host fluent-button.task-delete.neutral{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-button.task-add-icon.neutral::part(control),:host fluent-button.task-cancel-icon.neutral::part(control),:host fluent-button.task-delete.neutral::part(control){border:none;background:inherit}:host fluent-button.task-add-icon.neutral::part(control) svg,:host fluent-button.task-cancel-icon.neutral::part(control) svg,:host fluent-button.task-delete.neutral::part(control) svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-checkbox.task.complete div>svg .filled{display:block}:host fluent-checkbox.task.complete div>svg .regular{display:none}:host fluent-checkbox.task.complete div>svg path{fill:var(--task-radio-background-color,var(--accent-fill-rest))}:host fluent-checkbox.task div>svg .filled{display:none}:host fluent-checkbox.task div>svg .regular{display:block}:host fluent-checkbox.task div>svg path{fill:var(--task-background-color,var(--neutral-layer-floating))}:host fluent-checkbox::part(control){margin-inline-start:10px;background:0 0;border-radius:50%}:host fluent-checkbox::part(label){margin-inline-end:unset;width:100%}
`],vB={cancelNewTaskSubtitle:"Cancel",newTaskPlaceholder:"Add a task",newTaskLabel:"New Task Input",addTaskButtonSubtitle:"Add",deleteTaskLabel:"Delete Task",dueDate:"Due date",newTaskDateInputLabel:"New Task Date Input",newTaskNameInputLabel:"New Task Name Input",cancelAddingTask:"Cancel adding a new task"};var __decorate$6=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$6=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$6=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(ML,WL,AL),exports.MgtTodo=class MgtTodo extends MgtTasksBase{static get styles(){return gB}get strings(){return vB}static get requiredScopes(){return["tasks.read","tasks.readwrite"]}constructor(){super(),this._isDarkMode=!1,this.onThemeChanged=()=>{this._isDarkMode=isElementDark(this)},this.addTask=()=>__awaiter$6(this,void 0,void 0,(function*(){if(!this._isNewTaskBeingAdded&&this._newTaskName){this._isNewTaskBeingAdded=!0,this.requestUpdate();try{yield this.createNewTask()}finally{this.clearNewTaskData(),this._isNewTaskBeingAdded=!1,this.requestUpdate()}}})),this.renderNewTask=()=>{const t=this._newTaskName?AI`
        <fluent-checkbox
          class="task-add-icon"
          @click="${this.addTask}">
        </fluent-checkbox>
      `:AI`
        <span class="add-icon">${getSvg(yP.Add)}</span>
      `,o=AI`
      <fluent-button
        aria-label=${this.strings.cancelAddingTask}
        class="task-cancel-icon" 
        @click="${this.clearNewTaskData}"
      >
        ${getSvg(yP.Cancel)}
      </fluent-button>
    `,s={dark:this._isDarkMode,date:!0},l=AI`
      <fluent-text-field
        autocomplete="off"
        type="date"
        id="new-taskDate-input"
        class="${iP(s)}"
        aria-label="${this.strings.newTaskDateInputLabel}"
        .value="${this.dateToInputValue(this._newTaskDueDate)}"
        @change="${this.handleDateChange}"
      >
      </fluent-text-field>
    `,h=this.readOnly?PI:AI`
      <fluent-text-field
        autocomplete="off"
        appearance="outline"
        class="new-task"
        id="new-task-name-input"
        aria-label="${this.strings.newTaskLabel}"
        .value=${this._newTaskName}
        placeholder="${this.strings.newTaskPlaceholder}"
        @keydown="${this.handleKeyDown}"
        @input="${this.handleInput}"
      >
        <div slot="start" class="start">${t}</div>
        ${this._newTaskName?AI`
              <div slot="end" class="end">
                <span class="calendar">${l}</span>
                ${o}
              </div> `:AI``}
      </fluent-text-field>
    `;return AI`
      ${this.currentList?AI`
            <div dir=${this.direction} class="task new-task incomplete">
              ${h}
            </div>
        `:AI``}  
     `},this.handleSelectionChanged=t=>{this.currentList=t.detail,this.loadTasks(this.currentList)},this.renderTaskDetails=t=>{const o={task:t,list:this.currentList};if(this.hasTemplate("task"))return this.renderTemplate("task",o,t.id);let s=null;const l=t.dueDateTime?AI`
        <span class="task-calendar">${getSvg(yP.Calendar)}</span>
        <span class="task-due-date">${(t=>{const o=t.getMonth();return`${t.getDate()} / ${o} / ${t.getFullYear()}`})(new Date(t.dueDateTime.dateTime))}</span>
      `:AI``,h=this.readOnly?AI``:AI`
        <fluent-button class="task-delete"
          @click="${()=>this.removeTask(t.id)}"
          aria-label="${this.strings.deleteTaskLabel}"
        >
          ${getSvg(yP.Delete)}
        </fluent-button>
      `;return s=this.hasTemplate("task-details")?this.renderTemplate("task-details",o,`task-details-${t.id}`):AI`
      <div class="task-details">
        <div class="title">${t.title}</div>
        <div class="task-due">${l}</div>
        ${h}
      </div>
      `,AI`${s}`},this.renderTask=t=>{const o=iP({"read-only":this.readOnly,task:!0});return AI`
      <fluent-checkbox 
        id=${t.id}
        class=${o}
        ?disabled=${this.readOnly}
        @click="${()=>this.handleTaskCheckClick(t)}"
      >
        ${this.renderTaskDetails(t)}
      </fluent-checkbox>
    `},this.renderCompletedTask=t=>{const o=iP({complete:!0,"read-only":this.readOnly,task:!0}),s=AI`${getSvg(yP.CheckMark)}`;return AI`
      <fluent-checkbox 
        id=${t.id} 
        class=${o} 
        checked 
        ?disabled=${this.readOnly} 
        @click="${()=>this.handleTaskCheckClick(t)}"
      >
        <div slot="checked-indicator">
          ${s}
        </div>
        ${this.renderTaskDetails(t)}
      </fluent-checkbox>
    `},this.loadState=()=>__awaiter$6(this,void 0,void 0,(function*(){const t=Providers.globalProvider;if(t&&t.state===exports.ProviderState.SignedIn){if(this._isLoadingTasks=!0,!this._graph){const o=t.graph.forComponent(this);this._graph=o}if(!this.currentList&&!this.initialId){const t=yield(o=this._graph,__awaiter$7(void 0,void 0,void 0,(function*(){const t=yield o.api("/me/todo/lists").header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.Read")).get();return null==t?void 0:t.value}))),s=null==t?void 0:t.find((t=>"defaultList"===t.wellknownListName));s&&(yield this.loadTasks(s))}var o;this.targetId?(this.currentList=yield getTodoTaskList(this._graph,this.targetId),this._tasks=yield getTodoTasks(this._graph,this.targetId)):this.initialId&&(this.currentList=yield getTodoTaskList(this._graph,this.initialId),this._tasks=yield getTodoTasks(this._graph,this.initialId)),this._isLoadingTasks=!1}})),this.clearNewTaskData=()=>{this._newTaskDueDate=null,this._newTaskName=""},this.clearState=()=>{super.clearState(),this.currentList=null,this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1},this.loadTasks=t=>__awaiter$6(this,void 0,void 0,(function*(){this._isLoadingTasks=!0,this.currentList=t,this._tasks=yield getTodoTasks(this._graph,t.id),this._isLoadingTasks=!1,this.requestUpdate()})),this.updateTaskStatus=(t,o)=>__awaiter$6(this,void 0,void 0,(function*(){this._loadingTasks=[...this._loadingTasks,t.id],this.requestUpdate(),t.status=o;const s=this.currentList.id;t=yield((t,o,s,l)=>__awaiter$7(void 0,void 0,void 0,(function*(){return yield t.api(`/me/todo/lists/${o}/tasks/${s}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).patch(l)})))(this._graph,s,t.id,t);const l=this._tasks.findIndex((o=>o.id===t.id));this._tasks[l]=t,this._loadingTasks=this._loadingTasks.filter((o=>o!==t.id)),this.requestUpdate()})),this.removeTask=t=>__awaiter$6(this,void 0,void 0,(function*(){this._tasks=this._tasks.filter((o=>o.id!==t)),this.requestUpdate();const o=this.currentList.id;yield((t,o,s)=>__awaiter$7(void 0,void 0,void 0,(function*(){yield t.api(`/me/todo/lists/${o}/tasks/${s}`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).delete()})))(this._graph,o,t),this._tasks=this._tasks.filter((o=>o.id!==t))})),this.handleInput=t=>{"new-task-name-input"===t.target.id&&(this._newTaskName=t.target.value)},this.handleKeyDown=t=>__awaiter$6(this,void 0,void 0,(function*(){"Enter"===t.key&&(yield this.addTask())})),this.handleDateChange=t=>{const o=t.target.value;this._newTaskDueDate=o?new Date(o+"T17:00"):null},this._graph=null,this._newTaskDueDate=null,this._tasks=[],this._loadingTasks=[],this._isLoadingTasks=!1,this.addEventListener("selectionChanged",this.handleSelectionChanged)}connectedCallback(){super.connectedCallback(),window.addEventListener("darkmodechanged",this.onThemeChanged),this.onThemeChanged()}disconnectedCallback(){window.removeEventListener("darkmodechanged",this.onThemeChanged),super.disconnectedCallback()}renderTasks(){if(this._isLoadingTasks)return this.renderLoadingTask();let t=this._tasks;t&&this.taskFilter&&(t=t.filter((t=>this.taskFilter(t))));const o=t.filter((t=>"completed"===t.status)),s=RP(t.filter((t=>"completed"!==t.status)),(t=>t.id),(t=>this.renderTask(t))),l=RP(o.sort(((t,o)=>new Date(t.lastModifiedDateTime).getTime()-new Date(o.lastModifiedDateTime).getTime())),(t=>t.id),(t=>this.renderCompletedTask(t)));return AI`
      ${s}
      ${l}
    `}renderPicker(){var t,o;return this.targetId?AI`<p>${null===(t=this.currentList)||void 0===t?void 0:t.displayName}</p>`:mgtHtml`
        <mgt-picker
          resource="me/todo/lists"
          scopes="tasks.read, tasks.readwrite"
          key-name="displayName"
          selected-value="${l$1(null===(o=this.currentList)||void 0===o?void 0:o.displayName)}"
          placeholder="Select a task list">
        </mgt-picker>`}createNewTask(){return __awaiter$6(this,void 0,void 0,(function*(){const t=this.currentList.id,o={title:this._newTaskName};this._newTaskDueDate&&(o.dueDateTime={dateTime:new Date(this._newTaskDueDate).toLocaleDateString(),timeZone:"UTC"});const s=yield((t,o,s)=>__awaiter$7(void 0,void 0,void 0,(function*(){return yield t.api(`/me/todo/lists/${o}/tasks`).header("Cache-Control","no-store").middlewareOptions(prepScopes("Tasks.ReadWrite")).post(s)})))(this._graph,t,o);this._tasks.unshift(s)}))}handleTaskCheckClick(t){this.handleTaskClick(t),this.readOnly||("completed"===t.status?this.updateTaskStatus(t,"notStarted"):this.updateTaskStatus(t,"completed"))}},__decorate$6([t$1(),__metadata$6("design:type",String)],exports.MgtTodo.prototype,"_newTaskName",void 0),__decorate$6([t$1(),__metadata$6("design:type",Object)],exports.MgtTodo.prototype,"currentList",void 0),__decorate$6([t$1(),__metadata$6("design:type",Object)],exports.MgtTodo.prototype,"_isDarkMode",void 0),exports.MgtTodo=__decorate$6([customElement("todo"),__metadata$6("design:paramtypes",[])],exports.MgtTodo);const mB="#717171",yB=$$.create("secondary-text-color").withDefault(mB),bB="#1a1a1a",wB=$$.create("secondary-text-hover-color").withDefault(bB),applyTheme=(t,o=document.body)=>{const s=getThemeSettings(t);applyColorScheme(s,o)},applyColorScheme=(t,o=document.body)=>{var s;bN.setValueFor(o,_M.from(parseColorHexRGB(t.accentBaseColor))),mN.setValueFor(o,_M.from(parseColorHexRGB(t.neutralBaseColor))),bO.setValueFor(o,t.baseLayerLuminance),null===(s=t.designTokenOverrides)||void 0===s||s.call(t,o)},getThemeSettings=t=>{switch(t){case"contrast":return{accentBaseColor:"#7f85f5",neutralBaseColor:"#adadad",baseLayerLuminance:MM.DarkMode};case"default":return{accentBaseColor:"#5b5fc7",neutralBaseColor:"#616161",baseLayerLuminance:MM.LightMode};case"dark":return{accentBaseColor:"#479ef5",neutralBaseColor:"#adadad",baseLayerLuminance:MM.DarkMode,designTokenOverrides:t=>{$N.setValueFor(t,_M.from(parseColorHexRGB("#115ea3"))),MN.setValueFor(t,_M.from(parseColorHexRGB("#0f6cbd"))),ON.setValueFor(t,_M.from(parseColorHexRGB("#0c3b5e"))),NN.setValueFor(t,_M.from(parseColorHexRGB("#0f548c"))),qN.setValueFor(t,_M.from(parseColorHexRGB("#479EF5"))),jN.setValueFor(t,_M.from(parseColorHexRGB("#62abf5"))),zN.setValueFor(t,_M.from(parseColorHexRGB("#2886de"))),VN.setValueFor(t,_M.from(parseColorHexRGB("#479ef5"))),KN.setValueFor(t,_M.from(parseColorHexRGB("#115ea3"))),WN.setValueFor(t,_M.from(parseColorHexRGB("#0f6cbd"))),QN.setValueFor(t,_M.from(parseColorHexRGB("#0c3b5e"))),YN.setValueFor(t,_M.from(parseColorHexRGB("#0f548c"))),BN.setValueFor(t,_M.from(parseColorHexRGB("#ffffff"))),LN.setValueFor(t,_M.from(parseColorHexRGB("#ffffff"))),FN.setValueFor(t,_M.from(parseColorHexRGB("#ffffff"))),HN.setValueFor(t,_M.from(parseColorHexRGB("#ffffff"))),yB.setValueFor(t,"#8e8e8e"),wB.setValueFor(t,"#ffffff")}};default:return{accentBaseColor:"#0f6cbd",neutralBaseColor:"#616161",baseLayerLuminance:MM.LightMode,designTokenOverrides:t=>{yB.setValueFor(t,mB),wB.setValueFor(t,bB)}}}},CB={label:"Color mode:",on:"Dark",off:"Light"};var __decorate$5=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$5=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};registerFluentComponents(tF),exports.MgtThemeToggle=class MgtThemeToggle extends MgtBaseComponent{constructor(){super(),this.onSwitchChanged=t=>{this.darkModeActive=t.target.checked};const t=window.matchMedia("(prefers-color-scheme:dark)").matches;this.darkModeActive=t,this.applyTheme(this.darkModeActive)}get strings(){return CB}updated(t){t.has("darkModeActive")&&this.applyTheme(this.darkModeActive)}render(){return AI`
      <fluent-switch checked=${this.darkModeActive} @change=${this.onSwitchChanged}>
        <span slot="checked-message">${CB.on}</span>
        <span slot="unchecked-message">${CB.off}</span>
        <label for="direction-switch">${CB.label}</label>
      </fluent-switch>
`}applyTheme(t){const o=t?"dark":"light";applyTheme(o),document.body.classList.remove("mgt-dark-mode","mgt-light-mode"),document.body.classList.add(`mgt-${o}-mode`),this.fireCustomEvent("darkmodechanged",this.darkModeActive,!0,!1,!0)}},__decorate$5([n$1({attribute:"mode",reflect:!0,type:String,converter:{fromAttribute:t=>"dark"===t,toAttribute:t=>t?"dark":"light"}}),__metadata$5("design:type",Boolean)],exports.MgtThemeToggle.prototype,"darkModeActive",void 0),exports.MgtThemeToggle=__decorate$5([customElement("theme-toggle"),__metadata$5("design:paramtypes",[])],exports.MgtThemeToggle);const _B={placeholder:"Search",title:"Search"},kB=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host fluent-search{width:100%}
`];var __decorate$4=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$4=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};registerFluentComponents(JL),exports.MgtSearchBox=class MgtSearchBox extends MgtBaseComponent{static get styles(){return kB}get strings(){return _B}get searchTerm(){return this._searchTerm}set searchTerm(t){this._searchTerm=t,this.fireSearchTermChanged()}constructor(){super(),this._searchTerm="",this.onInputChanged=t=>{this.searchTerm=t.target.value},console.warn("ð¦: <mgt-search-box> is a preview component and may change prior to becoming generally available. See more information https://aka.ms/mgt/preview-components"),this.debounceDelay=300}render(){var t;return AI`
      <fluent-search
        autocomplete="off"
        class="search-term-input"
        appearance="outline"
        value=${null!==(t=this.searchTerm)&&void 0!==t?t:""}
        placeholder=${this.placeholder?this.placeholder:_B.placeholder}
        title=${this.title?this.title:_B.title}
        @input=${this.onInputChanged}
        @change=${this.onInputChanged}
      >
      </fluent-search>`}fireSearchTermChanged(){this.debouncedSearchTermChanged||(this.debouncedSearchTermChanged=debounce((()=>{this.fireCustomEvent("searchTermChanged",this.searchTerm)}),this.debounceDelay)),this.debouncedSearchTermChanged()}},__decorate$4([n$1({attribute:"placeholder",type:String}),__metadata$4("design:type",String)],exports.MgtSearchBox.prototype,"placeholder",void 0),__decorate$4([n$1({attribute:"search-term",type:String}),__metadata$4("design:type",Object),__metadata$4("design:paramtypes",[Object])],exports.MgtSearchBox.prototype,"searchTerm",null),__decorate$4([n$1({attribute:"debounce-delay",type:Number,reflect:!0}),__metadata$4("design:type",Number)],exports.MgtSearchBox.prototype,"debounceDelay",void 0),exports.MgtSearchBox=__decorate$4([customElement("search-box"),__metadata$4("design:paramtypes",[])],exports.MgtSearchBox);const xB={modified:"modified on",back:"Back",next:"Next",pages:"pages",page:"Page"},SB=[i$3`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}.search-results{scroll-margin:100px}.search-result-grid{font-size:14px;margin:16px 4px;display:grid;grid-template-columns:32px 2fr 0fr;gap:.5rem}.search-result{font-size:14px;margin:16px 4px}.file-icon{--file-type-icon-height:32px}.search-result-info{margin:4px 0;display:inline-flex}.search-result-date{padding-top:3px}.search-result-date__shimmer{border-radius:4px;margin-top:2%;margin-left:5px;height:10px;width:200px}.search-result-summary{margin:4px 0;color:var(--body-subtle-text-color)}.search-result-thumbnail__shimmer{width:126px;height:72px}.search-result-thumbnail img{height:72px;max-width:126px;width:126px;object-fit:cover}.search-result-url{font-size:14px;font-weight:600;margin:4px 0}.search-result-url a{color:var(--color);text-decoration:none}.search-result-url a:hover{text-decoration:underline}.search-result-content__shimmer{border-radius:4px;margin-top:10px;height:10px}.search-result-name{font-size:16px;font-weight:600;margin:4px 0}.search-result-name__shimmer{border-radius:4px;margin-top:10px;height:10px;width:20%}.search-result-name a{color:var(--color);text-decoration:none}.search-result-name a:hover{text-decoration:underline}.search-result-author__shimmer{width:24px;height:24px}.search-result-icon{width:30px;height:30px}.search-result-icon__shimmer{width:32px;height:32px}.search-result-icon img{width:100%}.search-result-icon svg,.search-result-icon svg>path{width:100%;height:100%;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-results-page-active{border-bottom-style:solid;border-bottom-color:var(--accent-base-color)}.search-results-page svg,.search-results-page svg>path{height:12px;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-result-answer{box-shadow:var(--answer-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--answer-border-radius,4px);border:var(--answer-border,none);padding:var(--answer-padding,10px)}.search-results-pages{margin:16px 4px}
`];var __decorate$3=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$3=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)},__awaiter$5=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};registerFluentComponents(eF,AL,aF,UL),exports.MgtSearchResults=class MgtSearchResults extends MgtTemplatedComponent{static get styles(){return SB}get strings(){return xB}get queryString(){return this._queryString}set queryString(t){this._queryString!==t&&(this._queryString=t,this._currentPage=1,this.setLoadingState(!0),this.requestStateUpdate(!0))}get from(){return(this.currentPage-1)*this.size}get size(){return this._size}set size(t){t>this.maxPageSize?this._size=this.maxPageSize:this._size=t}get searchEndpoint(){return"/search/query"}get maxPageSize(){return 1e3}get currentPage(){return this._currentPage}set currentPage(t){this._currentPage!==t&&(this._currentPage=t,this.requestStateUpdate(!0))}constructor(){super(),this._size=10,this.entityTypes=["driveItem","listItem","site"],this.scopes=[],this.contentSources=[],this.version="v1.0",this.pagingMax=7,this.enableTopResults=!1,this.cacheEnabled=!1,this.cacheInvalidationPeriod=3e4,this.isRefreshing=!1,this.defaultFields=["webUrl","lastModifiedBy","lastModifiedDateTime","summary","displayName","name"],this._currentPage=1,this.onFirstPageClick=()=>{this.currentPage=1,this.scrollToFirstResult()},this.onPageBackClick=()=>{this.currentPage--,this.scrollToFirstResult()},this.onPageNextClick=()=>{this.currentPage++,this.scrollToFirstResult()},console.warn("ð¦: <mgt-search-results> is a preview component and may change prior to becoming generally available. See more information https://aka.ms/mgt/preview-components")}attributeChangedCallback(t,o,s){super.attributeChangedCallback(t,o,s),this.requestStateUpdate()}refresh(t=!1){this.isRefreshing=!0,t&&this.clearState(),this.requestStateUpdate(t)}clearState(){this.response=null}render(){var t,o,s,l,h,m,_,E;let $=null,B=null,q=null;return this.hasTemplate("header")&&(B=this.renderTemplate("header",this.response)),q=this.renderFooter(null===(o=null===(t=this.response)||void 0===t?void 0:t.value[0])||void 0===o?void 0:o.hitsContainers[0]),$=this.isLoadingState?this.renderLoading():this.error?this.renderError():this.response&&this.hasTemplate("default")?this.renderTemplate("default",this.response)||AI``:(null===(l=null===(s=this.response)||void 0===s?void 0:s.value[0])||void 0===l?void 0:l.hitsContainers[0])?AI`${null===(E=null===(_=null===(m=null===(h=this.response)||void 0===h?void 0:h.value[0])||void 0===m?void 0:m.hitsContainers[0])||void 0===_?void 0:_.hits)||void 0===E?void 0:E.map((t=>this.renderResult(t)))}`:this.hasTemplate("no-data")?this.renderTemplate("no-data",null):AI``,AI`
      ${B}
      <div class="search-results">
        ${$}
      </div>
      ${q}`}loadState(){var t,o,s,l,h,m;return __awaiter$5(this,void 0,void 0,(function*(){const _=Providers.globalProvider;if(this.error=null,_&&_.state===exports.ProviderState.SignedIn){if(this.queryString){try{const E=this.getRequestOptions();let $;const B=JSON.stringify({endpoint:`${this.version}${this.searchEndpoint}`,requestOptions:E});let q=null;if(this.shouldRetrieveCache()){$=CacheService.getCache(hP,hP.stores.responses);const t=getIsResponseCacheEnabled$1()?yield $.getValue(B):null;t&&(this.cacheInvalidationPeriod||CacheService.config.response.invalidationPeriod||CacheService.config.defaultInvalidationPeriod)>Date.now()-t.timeCached&&(q=JSON.parse(t.response))}if(!q){const j=_.graph.forComponent(this);let K=j.api(this.searchEndpoint).version(this.version);if((null===(t=this.scopes)||void 0===t?void 0:t.length)&&(K=K.middlewareOptions(prepScopes(...this.scopes))),q=yield K.post({requests:[E]}),this.fetchThumbnail){const t=j.createBatch(),_=BetaGraph.fromGraph(j).createBatch(),E=(null===(o=q.value)||void 0===o?void 0:o.length)&&(null===(s=q.value[0].hitsContainers)||void 0===s?void 0:s.length)&&null!==(h=null===(l=q.value[0].hitsContainers[0])||void 0===l?void 0:l.hits)&&void 0!==h?h:[];for(const o of E){const s=o.resource;!(s.size>0||(null===(m=s.webUrl)||void 0===m?void 0:m.endsWith(".aspx")))||"#microsoft.graph.driveItem"!==s["@odata.type"]&&"#microsoft.graph.listItem"!==s["@odata.type"]||("#microsoft.graph.listItem"===s["@odata.type"]?_.get(o.hitId.toString(),`/sites/${s.parentReference.siteId}/pages/${s.id}`):t.get(o.hitId.toString(),`/drives/${s.parentReference.driveId}/items/${s.id}/thumbnails/0/medium`))}const augmentResponse=t=>{if(t&&t.size>0)for(const[o,s]of t){const t=q.value[0].hitsContainers[0].hits[o],l="#microsoft.graph.listItem"===t.resource["@odata.type"]?{url:s.content.thumbnailWebUrl}:{url:s.content.url};t.resource.thumbnail=l}};try{augmentResponse(yield t.executeAll()),augmentResponse(yield _.executeAll())}catch(t){}}this.shouldUpdateCache()&&q&&($=CacheService.getCache(hP,hP.stores.responses),yield $.putValue(B,{response:JSON.stringify(q)}))}equals(this.response,q)||(this.response=q)}catch(t){this.error=t}this.response&&(this.error=null)}else this.response=null;this.isRefreshing=!1,this.fireCustomEvent("dataChange",{response:this.response,error:this.error})}}))}renderLoading(){return this.renderTemplate("loading",null)||AI`
        ${[...Array(this.size)].map((()=>AI`
            <div class="search-result">
              <div class="search-result-grid">
                <div class="search-result-icon">
                  <fluent-skeleton class="search-result-icon__shimmer" shape="rect" shimmer></fluent-skeleton>
                </div>
                <div class="searc-result-content">
                  <div class="search-result-name">
                    <fluent-skeleton class="search-result-name__shimmer" shape="rect" shimmer></fluent-skeleton>
                  </div>
                  <div class="search-result-info">
                    <div class="search-result-author">
                      <fluent-skeleton class="search-result-author__shimmer" shape="circle" shimmer></fluent-skeleton>
                    </div>
                    <div class="search-result-date">
                      <fluent-skeleton class="search-result-date__shimmer" shape="rect" shimmer></fluent-skeleton>
                    </div>
                  </div>
                  <fluent-skeleton class="search-result-content__shimmer" shape="rect" shimmer></fluent-skeleton>
                  <fluent-skeleton class="search-result-content__shimmer" shape="rect" shimmer></fluent-skeleton>
                </div>
                ${this.fetchThumbnail&&AI`
                    <div class="search-result-thumbnail">
                      <fluent-skeleton class="search-result-thumbnail__shimmer" shape="rect" shimmer></fluent-skeleton>
                    </div>
                  `}
              </div>
              <fluent-divider></fluent-divider>
            </div>
          `))}
       `}renderResult(t){const o=this.getResourceType(t.resource);if(this.hasTemplate(`result-${o}`))return this.renderTemplate(`result-${o}`,t,t.hitId);switch(t.resource["@odata.type"]){case"#microsoft.graph.driveItem":return this.renderDriveItem(t);case"#microsoft.graph.site":return this.renderSite(t);case"#microsoft.graph.person":return this.renderPerson(t);case"#microsoft.graph.drive":case"#microsoft.graph.list":return this.renderList(t);case"#microsoft.graph.listItem":return this.renderListItem(t);case"#microsoft.graph.search.bookmark":return this.renderBookmark(t);case"#microsoft.graph.search.acronym":return this.renderAcronym(t);case"#microsoft.graph.search.qna":return this.renderQnA(t);default:return this.renderDefault(t)}}renderFooter(t){if(this.pagingRequired(t)){const o=this.getActivePages(t.total);return AI`
        <div class="search-results-pages">
          ${this.renderPreviousPage()}
          ${this.renderFirstPage(o)}
          ${this.renderAllPages(o)}
          ${this.renderNextPage()}
        </div>
      `}}pagingRequired(t){return(null==t?void 0:t.moreResultsAvailable)||this.currentPage*this.size<(null==t?void 0:t.total)}getActivePages(t){const o=[],s=(()=>{const t=this.currentPage-Math.floor(this.pagingMax/2)-1;return t>=Math.floor(this.pagingMax/2)?t:0})();if(s+1>this.pagingMax-this.currentPage||this.pagingMax===this.currentPage)for(let l=s+1;l<Math.ceil(t/this.size)&&l<this.pagingMax+(this.currentPage-1)&&o.length<this.pagingMax-2;++l)o.push(l+1);else for(let t=s;t<this.pagingMax;++t)o.push(t+1);return o}renderAllPages(t){return AI`
      ${t.map((t=>AI`
            <fluent-button
              title="${xB.page} ${t}"
              appearance="stealth"
              class="${t===this.currentPage?"search-results-page-active":"search-results-page"}"
              @click="${()=>this.onPageClick(t)}">
                ${t}
            </fluent-button>`))}`}renderFirstPage(t){return AI`
      ${t.some((t=>1===t))?PI:AI`
              <fluent-button
                 title="${xB.page} 1"
                 appearance="stealth"
                 class="search-results-page"
                 @click="${this.onFirstPageClick}">
                 1
               </fluent-button>`?AI`
              <fluent-button
                id="page-back-dot"
                appearance="stealth"
                class="search-results-page"
                title="${this.getDotButtonTitle()}"
                @click="${()=>this.onPageClick(this.currentPage-Math.ceil(this.pagingMax/2))}"
              >
                ...
              </fluent-button>`:PI}`}getDotButtonTitle(){return`${xB.back} ${Math.ceil(this.pagingMax/2)} ${xB.pages}`}renderPreviousPage(){return this.currentPage>1?AI`
          <fluent-button
            appearance="stealth"
            class="search-results-page"
            title="${xB.back}"
            @click="${this.onPageBackClick}">
              ${getSvg(yP.ChevronLeft)}
            </fluent-button>`:PI}renderNextPage(){return this.isLastPage()?PI:AI`
          <fluent-button
            appearance="stealth"
            class="search-results-page"
            title="${xB.next}"
            aria-label="${xB.next}"
            @click="${this.onPageNextClick}">
              ${getSvg(yP.ChevronRight)}
            </fluent-button>`}onPageClick(t){this.currentPage=t,this.scrollToFirstResult()}isLastPage(){return this.currentPage===Math.ceil(this.response.value[0].hitsContainers[0].total/this.size)}scrollToFirstResult(){this.renderRoot.querySelector(".search-results").scrollIntoView({block:"start",behavior:"smooth"})}getResourceType(t){return t["@odata.type"].split(".").pop()}renderDriveItem(t){var o,s;const l=t.resource;return mgtHtml`
      <div class="search-result-grid">
        <div class="search-result-icon">
          <mgt-file
            .fileDetails="${t.resource}"
            view="image"
            class="file-icon">
          </mgt-file>
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            <a href="${l.webUrl}?Web=1" target="_blank">${trimFileExtension(l.name)}</a>
          </div>
          <div class="search-result-info">
            <div class="search-result-author">
              <mgt-person
                person-query=${l.lastModifiedBy.user.email}
                view="oneLine"
                person-card="hover"
                show-presence="true">
              </mgt-person>
            </div>
            <div class="search-result-date">
              &nbsp; ${xB.modified} ${getRelativeDisplayDate(new Date(l.lastModifiedDateTime))}
            </div>
          </div>
          <div class="search-result-summary" .innerHTML="${sanitizeSummary(t.summary)}"></div>
        </div>
        ${(null===(o=l.thumbnail)||void 0===o?void 0:o.url)&&AI`
          <div class="search-result-thumbnail">
            <a href="${l.webUrl}" target="_blank"><img alt="${l.name}" src="${null===(s=l.thumbnail)||void 0===s?void 0:s.url}" /></a>
          </div>`}

      </div>
      <fluent-divider></fluent-divider>
    `}renderSite(t){const o=t.resource;return AI`
      <div class="search-result-grid">
        <div class="search-result-icon">
          ${this.getResourceIcon(o)}
        </div>
        <div class="searc-result-content">
          <div class="search-result-name">
            <a href="${o.webUrl}" target="_blank">${o.displayName}</a>
          </div>
          <div class="search-result-info">
            <div class="search-result-url">
              <a href="${o.webUrl}" target="_blank">${o.webUrl}</a>
            </div>
          </div>
          <div class="search-result-summary" .innerHTML="${sanitizeSummary(t.summary)}"></div>
        </div>
      </div>
      <fluent-divider></fluent-divider>
    `}renderList(t){const o=t.resource;return mgtHtml`
      <div class="search-result-grid">
        <div class="search-result-icon">
          <mgt-file
            .fileDetails="${t.resource}"
            view="image">
          </mgt-file>
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            <a href="${o.webUrl}?Web=1" target="_blank">
              ${trimFileExtension(o.name||getNameFromUrl(o.webUrl))}
            </a>
          </div>
          <div class="search-result-summary" .innerHTML="${sanitizeSummary(t.summary)}"></div>
        </div>
      </div>
      <fluent-divider></fluent-divider>
    `}renderListItem(t){var o,s;const l=t.resource;return mgtHtml`
      <div class="search-result-grid">
        <div class="search-result-icon">
          ${l.webUrl.endsWith(".aspx")?getSvg(yP.News):getSvg(yP.FileOuter)}
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            <a href="${l.webUrl}?Web=1" target="_blank">
              ${trimFileExtension(l.name||getNameFromUrl(l.webUrl))}
            </a>
          </div>
          <div class="search-result-info">
            <div class="search-result-author">
              <mgt-person
                person-query=${l.lastModifiedBy.user.email}
                view="oneLine"
                person-card="hover"
                show-presence="true">
              </mgt-person>
            </div>
            <div class="search-result-date">
              &nbsp; ${xB.modified} ${getRelativeDisplayDate(new Date(l.lastModifiedDateTime))}
            </div>
          </div>
          <div class="search-result-summary" .innerHTML="${sanitizeSummary(t.summary)}"></div>
        </div>
        ${(null===(o=l.thumbnail)||void 0===o?void 0:o.url)&&AI`
          <div class="search-result-thumbnail">
            <a href="${l.webUrl}" target="_blank"><img alt="${trimFileExtension(l.name||getNameFromUrl(l.webUrl))}" src="${(null===(s=l.thumbnail)||void 0===s?void 0:s.url)||PI}" /></a>
          </div>`}
      </div>
      <fluent-divider></fluent-divider>
    `}renderPerson(t){const o=t.resource;return mgtHtml`
      <div class="search-result">
        <mgt-person
          view="fourLines"
          person-query=${o.userPrincipalName}
          person-card="hover"
          show-presence="true">
        </mgt-person>
      </div>
      <fluent-divider></fluent-divider>
    `}renderBookmark(t){return this.renderAnswer(t,yP.DoubleBookmark)}renderAcronym(t){return this.renderAnswer(t,yP.BookOpen)}renderQnA(t){return this.renderAnswer(t,yP.BookQuestion)}renderAnswer(t,o){const s=t.resource;return AI`
      <div class="search-result-grid search-result-answer">
        <div class="search-result-icon">
          ${getSvg(o)}
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            <a href="${this.getResourceUrl(s)}?Web=1" target="_blank">${s.displayName}</a>
          </div>
          <div class="search-result-summary">${s.description}</div>
        </div>
      </div>
      <fluent-divider></fluent-divider>
    `}renderDefault(t){const o=t.resource,s=this.getResourceUrl(o);return AI`
      <div class="search-result-grid">
        <div class="search-result-icon">
          ${this.getResourceIcon(o)}
        </div>
        <div class="search-result-content">
          <div class="search-result-name">
            ${s?AI`
                  <a href="${s}?Web=1" target="_blank">${this.getResourceName(o)}</a>
                `:AI`
                  ${this.getResourceName(o)}
                `}
          </div>
          <div class="search-result-summary" .innerHTML="${this.getResultSummary(t)}"></div>
        </div>
      </div>
      <fluent-divider></fluent-divider>
    `}getResourceUrl(t){return t.webUrl||t.webLink||null}getResourceName(t){return t.displayName||t.subject||trimFileExtension(t.name)}getResultSummary(t){var o;return sanitizeSummary(t.summary||(null===(o=t.resource)||void 0===o?void 0:o.description)||null)}getResourceIcon(t){switch(t["@odata.type"]){case"#microsoft.graph.site":return getSvg(yP.Globe);case"#microsoft.graph.message":return getSvg(yP.Email);case"#microsoft.graph.event":return getSvg(yP.Event);case"microsoft.graph.chatMessage":return getSvg(yP.SmallChat);default:return getSvg(yP.FileOuter)}}shouldRetrieveCache(){return getIsResponseCacheEnabled$1()&&this.cacheEnabled&&!this.isRefreshing}shouldUpdateCache(){return getIsResponseCacheEnabled$1()&&this.cacheEnabled}getRequestOptions(){const t={entityTypes:this.entityTypes,query:{queryString:this.queryString},from:this.from?this.from:void 0,size:this.size?this.size:void 0,fields:this.getFields(),enableTopResults:this.enableTopResults?this.enableTopResults:void 0};return this.entityTypes.includes("externalItem")&&(t.contentSources=this.contentSources),"beta"===this.version&&(t.query.queryTemplate=this.queryTemplate?this.queryTemplate:void 0),t}getFields(){if(this.fields)return this.defaultFields.concat(this.fields)}},__decorate$3([n$1({attribute:"query-string",type:String}),__metadata$3("design:type",String),__metadata$3("design:paramtypes",[String])],exports.MgtSearchResults.prototype,"queryString",null),__decorate$3([n$1({attribute:"query-template",type:String}),__metadata$3("design:type",String)],exports.MgtSearchResults.prototype,"queryTemplate",void 0),__decorate$3([n$1({attribute:"entity-types",converter:t=>t.split(",").map((t=>t.trim())),type:String}),__metadata$3("design:type",Array)],exports.MgtSearchResults.prototype,"entityTypes",void 0),__decorate$3([n$1({attribute:"scopes",converter:(t,o)=>t?t.toLowerCase().split(","):null}),__metadata$3("design:type",Array)],exports.MgtSearchResults.prototype,"scopes",void 0),__decorate$3([n$1({attribute:"content-sources",converter:(t,o)=>t?t.toLowerCase().split(","):null}),__metadata$3("design:type",Array)],exports.MgtSearchResults.prototype,"contentSources",void 0),__decorate$3([n$1({attribute:"version",reflect:!0,type:String}),__metadata$3("design:type",Object)],exports.MgtSearchResults.prototype,"version",void 0),__decorate$3([n$1({attribute:"size",reflect:!0,type:Number}),__metadata$3("design:type",Number),__metadata$3("design:paramtypes",[Object])],exports.MgtSearchResults.prototype,"size",null),__decorate$3([n$1({attribute:"paging-max",reflect:!0,type:Number}),__metadata$3("design:type",Object)],exports.MgtSearchResults.prototype,"pagingMax",void 0),__decorate$3([n$1({attribute:"fetch-thumbnail",type:Boolean}),__metadata$3("design:type",Boolean)],exports.MgtSearchResults.prototype,"fetchThumbnail",void 0),__decorate$3([n$1({attribute:"fields",converter:t=>t.split(",").map((t=>t.trim())),type:String}),__metadata$3("design:type",Array)],exports.MgtSearchResults.prototype,"fields",void 0),__decorate$3([n$1({attribute:"enable-top-results",reflect:!0,type:Boolean}),__metadata$3("design:type",Object)],exports.MgtSearchResults.prototype,"enableTopResults",void 0),__decorate$3([n$1({attribute:"cache-enabled",reflect:!0,type:Boolean}),__metadata$3("design:type",Object)],exports.MgtSearchResults.prototype,"cacheEnabled",void 0),__decorate$3([n$1({attribute:"cache-invalidation-period",reflect:!0,type:Number}),__metadata$3("design:type",Object)],exports.MgtSearchResults.prototype,"cacheInvalidationPeriod",void 0),__decorate$3([t$1(),__metadata$3("design:type",Object)],exports.MgtSearchResults.prototype,"response",void 0),__decorate$3([t$1(),__metadata$3("design:type",Number),__metadata$3("design:paramtypes",[Number])],exports.MgtSearchResults.prototype,"currentPage",null),exports.MgtSearchResults=__decorate$3([customElement("search-results"),__metadata$3("design:paramtypes",[])],exports.MgtSearchResults);var __awaiter$4=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};class CustomHeaderMiddleware{constructor(t){this._getCustomHeaders=t}execute(t){return __awaiter$4(this,void 0,void 0,(function*(){if(this._getCustomHeaders){const o=yield this._getCustomHeaders();for(const s in o)Object.prototype.hasOwnProperty.call(o,s)&&setRequestHeader(t.request,t.options,s,o[s])}return yield this._nextMiddleware.execute(t)}))}setNext(t){this._nextMiddleware=t}}class ProxyGraph extends Graph{constructor(t,o){const s=[new RetryHandler(new RetryHandlerOptions),new TelemetryHandler,new SdkVersionMiddleware(QA),new CustomHeaderMiddleware(o),new HTTPMessageHandler];super(Client.initWithMiddleware({baseUrl:t,middleware:chainMiddleware(...s),customHosts:new Set([new URL(t).hostname])}))}}class ProxyProvider extends IProvider{get name(){return"MgtProxyProvider"}constructor(t,o){super(),this.graph=new ProxyGraph(t,o),this.graph.api("me").get().then((t=>{null!=t?this.setState(exports.ProviderState.SignedIn):this.setState(exports.ProviderState.SignedOut)}),(t=>{this.setState(exports.ProviderState.SignedOut)}))}getAccessToken(){return Promise.resolve("")}}var __decorate$2=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$2=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtProxyProvider=class MgtProxyProvider extends MgtBaseProvider{get isAvailable(){return!0}initializeProvider(){void 0!==this.graphProxyUrl&&(this.provider=new ProxyProvider(this.graphProxyUrl),Providers.globalProvider=this.provider)}},__decorate$2([n$1({attribute:"graph-proxy-url"}),__metadata$2("design:type",String)],exports.MgtProxyProvider.prototype,"graphProxyUrl",void 0),exports.MgtProxyProvider=__decorate$2([customElement("proxy-provider")],exports.MgtProxyProvider);var __awaiter$3=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};
/*! @azure/msal-browser v2.38.2 2023-08-24 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var extendStatics$1=function(t,o){return extendStatics$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])},extendStatics$1(t,o)};function __extends$1(t,o){function __(){this.constructor=t}extendStatics$1(t,o),t.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}var __assign$1=function(){return __assign$1=Object.assign||function __assign(t){for(var o,s=1,l=arguments.length;s<l;s++)for(var h in o=arguments[s])Object.prototype.hasOwnProperty.call(o,h)&&(t[h]=o[h]);return t},__assign$1.apply(this,arguments)};function __rest(t,o){var s={};for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&o.indexOf(l)<0&&(s[l]=t[l]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var h=0;for(l=Object.getOwnPropertySymbols(t);h<l.length;h++)o.indexOf(l[h])<0&&Object.prototype.propertyIsEnumerable.call(t,l[h])&&(s[l[h]]=t[l[h]])}return s}function __awaiter$2(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))}function __generator$1(t,o){var s,l,h,m,_={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return m={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(m[Symbol.iterator]=function(){return this}),m;function verb(m){return function(E){return function step(m){if(s)throw new TypeError("Generator is already executing.");for(;_;)try{if(s=1,l&&(h=2&m[0]?l.return:m[0]?l.throw||((h=l.return)&&h.call(l),0):l.next)&&!(h=h.call(l,m[1])).done)return h;switch(l=0,h&&(m=[2&m[0],h.value]),m[0]){case 0:case 1:h=m;break;case 4:return _.label++,{value:m[1],done:!1};case 5:_.label++,l=m[1],m=[0];continue;case 7:m=_.ops.pop(),_.trys.pop();continue;default:if(!(h=_.trys,(h=h.length>0&&h[h.length-1])||6!==m[0]&&2!==m[0])){_=0;continue}if(3===m[0]&&(!h||m[1]>h[0]&&m[1]<h[3])){_.label=m[1];break}if(6===m[0]&&_.label<h[1]){_.label=h[1],h=m;break}if(h&&_.label<h[2]){_.label=h[2],_.ops.push(m);break}h[2]&&_.ops.pop(),_.trys.pop();continue}m=o.call(t,_)}catch(t){m=[6,t],l=0}finally{s=h=0}if(5&m[0])throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}([m,E])}}}function __read(t,o){var s="function"==typeof Symbol&&t[Symbol.iterator];if(!s)return t;var l,h,m=s.call(t),_=[];try{for(;(void 0===o||o-- >0)&&!(l=m.next()).done;)_.push(l.value)}catch(t){h={error:t}}finally{try{l&&!l.done&&(s=m.return)&&s.call(m)}finally{if(h)throw h.error}}return _}function __spread(){for(var t=[],o=0;o<arguments.length;o++)t=t.concat(__read(arguments[o]));return t}
/*! @azure/msal-common v13.3.0 2023-08-24 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(t,o){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])},extendStatics(t,o)};function __extends(t,o){function __(){this.constructor=t}extendStatics(t,o),t.prototype=null===o?Object.create(o):(__.prototype=o.prototype,new __)}var __assign=function(){return __assign=Object.assign||function __assign(t){for(var o,s=1,l=arguments.length;s<l;s++)for(var h in o=arguments[s])Object.prototype.hasOwnProperty.call(o,h)&&(t[h]=o[h]);return t},__assign.apply(this,arguments)};function __awaiter$1(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))}function __generator(t,o){var s,l,h,m,_={label:0,sent:function(){if(1&h[0])throw h[1];return h[1]},trys:[],ops:[]};return m={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(m[Symbol.iterator]=function(){return this}),m;function verb(m){return function(E){return function step(m){if(s)throw new TypeError("Generator is already executing.");for(;_;)try{if(s=1,l&&(h=2&m[0]?l.return:m[0]?l.throw||((h=l.return)&&h.call(l),0):l.next)&&!(h=h.call(l,m[1])).done)return h;switch(l=0,h&&(m=[2&m[0],h.value]),m[0]){case 0:case 1:h=m;break;case 4:return _.label++,{value:m[1],done:!1};case 5:_.label++,l=m[1],m=[0];continue;case 7:m=_.ops.pop(),_.trys.pop();continue;default:if(!(h=_.trys,(h=h.length>0&&h[h.length-1])||6!==m[0]&&2!==m[0])){_=0;continue}if(3===m[0]&&(!h||m[1]>h[0]&&m[1]<h[3])){_.label=m[1];break}if(6===m[0]&&_.label<h[1]){_.label=h[1],h=m;break}if(h&&_.label<h[2]){_.label=h[2],_.ops.push(m);break}h[2]&&_.ops.pop(),_.trys.pop();continue}m=o.call(t,_)}catch(t){m=[6,t],l=0}finally{s=h=0}if(5&m[0])throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}([m,E])}}}function __spreadArrays(){for(var t=0,o=0,s=arguments.length;o<s;o++)t+=arguments[o].length;var l=Array(t),h=0;for(o=0;o<s;o++)for(var m=arguments[o],_=0,E=m.length;_<E;_++,h++)l[h]=m[_];return l}
/*! @azure/msal-common v13.3.0 2023-08-24 */var TB,EB,AB,IB,PB,RB={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},$B=[RB.OPENID_SCOPE,RB.PROFILE_SCOPE,RB.OFFLINE_ACCESS_SCOPE],MB=__spreadArrays($B,[RB.EMAIL_SCOPE]);!function(t){t.CONTENT_TYPE="Content-Type",t.RETRY_AFTER="Retry-After",t.CCS_HEADER="X-AnchorMailbox",t.WWWAuthenticate="WWW-Authenticate",t.AuthenticationInfo="Authentication-Info",t.X_MS_REQUEST_ID="x-ms-request-id",t.X_MS_HTTP_VERSION="x-ms-httpver"}(TB||(TB={})),function(t){t.ID_TOKEN="idtoken",t.CLIENT_INFO="client.info",t.ADAL_ID_TOKEN="adal.idtoken",t.ERROR="error",t.ERROR_DESC="error.description",t.ACTIVE_ACCOUNT="active-account",t.ACTIVE_ACCOUNT_FILTERS="active-account-filters"}(EB||(EB={})),function(t){t.COMMON="common",t.ORGANIZATIONS="organizations",t.CONSUMERS="consumers"}(AB||(AB={})),function(t){t.CLIENT_ID="client_id",t.REDIRECT_URI="redirect_uri",t.RESPONSE_TYPE="response_type",t.RESPONSE_MODE="response_mode",t.GRANT_TYPE="grant_type",t.CLAIMS="claims",t.SCOPE="scope",t.ERROR="error",t.ERROR_DESCRIPTION="error_description",t.ACCESS_TOKEN="access_token",t.ID_TOKEN="id_token",t.REFRESH_TOKEN="refresh_token",t.EXPIRES_IN="expires_in",t.STATE="state",t.NONCE="nonce",t.PROMPT="prompt",t.SESSION_STATE="session_state",t.CLIENT_INFO="client_info",t.CODE="code",t.CODE_CHALLENGE="code_challenge",t.CODE_CHALLENGE_METHOD="code_challenge_method",t.CODE_VERIFIER="code_verifier",t.CLIENT_REQUEST_ID="client-request-id",t.X_CLIENT_SKU="x-client-SKU",t.X_CLIENT_VER="x-client-VER",t.X_CLIENT_OS="x-client-OS",t.X_CLIENT_CPU="x-client-CPU",t.X_CLIENT_CURR_TELEM="x-client-current-telemetry",t.X_CLIENT_LAST_TELEM="x-client-last-telemetry",t.X_MS_LIB_CAPABILITY="x-ms-lib-capability",t.X_APP_NAME="x-app-name",t.X_APP_VER="x-app-ver",t.POST_LOGOUT_URI="post_logout_redirect_uri",t.ID_TOKEN_HINT="id_token_hint",t.DEVICE_CODE="device_code",t.CLIENT_SECRET="client_secret",t.CLIENT_ASSERTION="client_assertion",t.CLIENT_ASSERTION_TYPE="client_assertion_type",t.TOKEN_TYPE="token_type",t.REQ_CNF="req_cnf",t.OBO_ASSERTION="assertion",t.REQUESTED_TOKEN_USE="requested_token_use",t.ON_BEHALF_OF="on_behalf_of",t.FOCI="foci",t.CCS_HEADER="X-AnchorMailbox",t.RETURN_SPA_CODE="return_spa_code",t.NATIVE_BROKER="nativebroker",t.LOGOUT_HINT="logout_hint"}(IB||(IB={})),function(t){t.ACCESS_TOKEN="access_token",t.XMS_CC="xms_cc"}(PB||(PB={}));var OB,NB={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"};!function(t){t.ACCOUNT="account",t.SID="sid",t.LOGIN_HINT="login_hint",t.ID_TOKEN="id_token",t.DOMAIN_HINT="domain_hint",t.ORGANIZATIONS="organizations",t.CONSUMERS="consumers",t.ACCOUNT_ID="accountIdentifier",t.HOMEACCOUNT_ID="homeAccountIdentifier"}(OB||(OB={}));var DB,LB,FB,BB,HB,UB,qB={PLAIN:"plain",S256:"S256"};!function(t){t.QUERY="query",t.FRAGMENT="fragment",t.FORM_POST="form_post"}(DB||(DB={})),function(t){t.IMPLICIT_GRANT="implicit",t.AUTHORIZATION_CODE_GRANT="authorization_code",t.CLIENT_CREDENTIALS_GRANT="client_credentials",t.RESOURCE_OWNER_PASSWORD_GRANT="password",t.REFRESH_TOKEN_GRANT="refresh_token",t.DEVICE_CODE_GRANT="device_code",t.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(LB||(LB={})),function(t){t.MSSTS_ACCOUNT_TYPE="MSSTS",t.ADFS_ACCOUNT_TYPE="ADFS",t.MSAV1_ACCOUNT_TYPE="MSA",t.GENERIC_ACCOUNT_TYPE="Generic"}(FB||(FB={})),function(t){t.CACHE_KEY_SEPARATOR="-",t.CLIENT_INFO_SEPARATOR="."}(BB||(BB={})),function(t){t.ID_TOKEN="IdToken",t.ACCESS_TOKEN="AccessToken",t.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",t.REFRESH_TOKEN="RefreshToken"}(HB||(HB={})),function(t){t[t.ADFS=1001]="ADFS",t[t.MSA=1002]="MSA",t[t.MSSTS=1003]="MSSTS",t[t.GENERIC=1004]="GENERIC",t[t.ACCESS_TOKEN=2001]="ACCESS_TOKEN",t[t.REFRESH_TOKEN=2002]="REFRESH_TOKEN",t[t.ID_TOKEN=2003]="ID_TOKEN",t[t.APP_METADATA=3001]="APP_METADATA",t[t.UNDEFINED=9999]="UNDEFINED"}(UB||(UB={}));var jB,zB="appmetadata",VB="1",GB="authority-metadata",KB=86400;!function(t){t.CONFIG="config",t.CACHE="cache",t.NETWORK="network",t.HARDCODED_VALUES="hardcoded_values"}(jB||(jB={}));var WB,QB={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(t){t.BEARER="Bearer",t.POP="pop",t.SSH="ssh-cert"}(WB||(WB={}));var YB,ZB,JB,XB,eH,tH,rH=60,oH=3600,nH="throttling",iH="retry-after, h429",sH="invalid_grant",aH="client_mismatch";!function(t){t.username="username",t.password="password"}(YB||(YB={})),function(t){t[t.httpSuccess=200]="httpSuccess",t[t.httpBadRequest=400]="httpBadRequest"}(ZB||(ZB={})),function(t){t.FAILED_AUTO_DETECTION="1",t.INTERNAL_CACHE="2",t.ENVIRONMENT_VARIABLE="3",t.IMDS="4"}(JB||(JB={})),function(t){t.CONFIGURED_MATCHES_DETECTED="1",t.CONFIGURED_NO_AUTO_DETECTION="2",t.CONFIGURED_NOT_DETECTED="3",t.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",t.AUTO_DETECTION_REQUESTED_FAILED="5"}(XB||(XB={})),function(t){t.NO_CACHE_HIT="0",t.FORCE_REFRESH="1",t.NO_CACHED_ACCESS_TOKEN="2",t.CACHED_ACCESS_TOKEN_EXPIRED="3",t.REFRESH_CACHED_ACCESS_TOKEN="4",t.CLAIMS_REQUESTED_CACHE_SKIPPED="5"}(eH||(eH={})),function(t){t.Jwt="JWT",t.Jwk="JWK",t.Pop="pop"}(tH||(tH={}));
/*! @azure/msal-common v13.3.0 2023-08-24 */
var lH,cH={code:"unexpected_error",desc:"Unexpected error in authentication."},dH={code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},uH=function(t){function AuthError(o,s,l){var h=this,m=s?o+": "+s:o;return h=t.call(this,m)||this,Object.setPrototypeOf(h,AuthError.prototype),h.errorCode=o||RB.EMPTY_STRING,h.errorMessage=s||RB.EMPTY_STRING,h.subError=l||RB.EMPTY_STRING,h.name="AuthError",h}return __extends(AuthError,t),AuthError.prototype.setCorrelationId=function(t){this.correlationId=t},AuthError.createUnexpectedError=function(t){return new AuthError(cH.code,cH.desc+": "+t)},AuthError.createPostRequestFailed=function(t){return new AuthError(dH.code,dH.desc+": "+t)},AuthError}(Error),hH={createNewGuid:function(){throw uH.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw uH.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw uH.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - generatePkceCodes() has not been implemented",uH.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",uH.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - removeTokenBindingKey() has not been implemented",uH.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - clearKeystore() has not been implemented",uH.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - signJwt() has not been implemented",uH.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))},hashString:function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Crypto interface - hashString() has not been implemented",uH.createUnexpectedError("Crypto interface - hashString() has not been implemented")}))}))}},pH={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},fH={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},gH={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},vH={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},mH={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},yH={code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},bH={code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},wH={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},CH={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},_H={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},kH={code:"state_not_found",desc:"State not found"},xH={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},SH={code:"nonce_not_found",desc:"nonce not found"},TH={code:"auth_time_not_found",desc:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information."},EH={code:"max_age_transpired",desc:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication."},AH={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},IH={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},PH={code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},RH={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},$H={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},MH={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},OH={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},NH={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DH={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},LH={code:"device_code_expired",desc:"Device code is expired."},FH={code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},BH={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},HH={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},UH={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},qH={code:"no_account_found",desc:"No account found in cache for given key."},jH={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},zH={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},VH={code:"invalid_cache_type",desc:"Invalid cache type"},GH={code:"unexpected_account_type",desc:"Unexpected account type."},KH={code:"unexpected_credential_type",desc:"Unexpected credential type."},WH={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},QH={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},YH={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},ZH={code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},JH={code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},XH={code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},eU={code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},tU={code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},rU={code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."},oU={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},nU={code:"user_canceled",desc:"User canceled the flow."},iU=function(t){function ClientAuthError(o,s){var l=t.call(this,o,s)||this;return l.name="ClientAuthError",Object.setPrototypeOf(l,ClientAuthError.prototype),l}return __extends(ClientAuthError,t),ClientAuthError.createClientInfoDecodingError=function(t){return new ClientAuthError(pH.code,pH.desc+" Failed with error: "+t)},ClientAuthError.createClientInfoEmptyError=function(){return new ClientAuthError(fH.code,""+fH.desc)},ClientAuthError.createTokenParsingError=function(t){return new ClientAuthError(gH.code,gH.desc+" Failed with error: "+t)},ClientAuthError.createTokenNullOrEmptyError=function(t){return new ClientAuthError(vH.code,vH.desc+" Raw Token Value: "+t)},ClientAuthError.createEndpointDiscoveryIncompleteError=function(t){return new ClientAuthError(mH.code,mH.desc+" Detail: "+t)},ClientAuthError.createNetworkError=function(t,o){return new ClientAuthError(yH.code,yH.desc+" | Fetch client threw: "+o+" | Attempted to reach: "+t.split("?")[0])},ClientAuthError.createUnableToGetOpenidConfigError=function(t){return new ClientAuthError(bH.code,bH.desc+" Attempted to retrieve endpoints from: "+t)},ClientAuthError.createHashNotDeserializedError=function(t){return new ClientAuthError(wH.code,wH.desc+" Given Object: "+t)},ClientAuthError.createInvalidStateError=function(t,o){return new ClientAuthError(CH.code,CH.desc+" Invalid State: "+t+", Root Err: "+o)},ClientAuthError.createStateMismatchError=function(){return new ClientAuthError(_H.code,_H.desc)},ClientAuthError.createStateNotFoundError=function(t){return new ClientAuthError(kH.code,kH.desc+":  "+t)},ClientAuthError.createNonceMismatchError=function(){return new ClientAuthError(xH.code,xH.desc)},ClientAuthError.createAuthTimeNotFoundError=function(){return new ClientAuthError(TH.code,TH.desc)},ClientAuthError.createMaxAgeTranspiredError=function(){return new ClientAuthError(EH.code,EH.desc)},ClientAuthError.createNonceNotFoundError=function(t){return new ClientAuthError(SH.code,SH.desc+":  "+t)},ClientAuthError.createMultipleMatchingTokensInCacheError=function(){return new ClientAuthError(AH.code,AH.desc+".")},ClientAuthError.createMultipleMatchingAccountsInCacheError=function(){return new ClientAuthError(IH.code,IH.desc)},ClientAuthError.createMultipleMatchingAppMetadataInCacheError=function(){return new ClientAuthError(PH.code,PH.desc)},ClientAuthError.createTokenRequestCannotBeMadeError=function(){return new ClientAuthError(RH.code,RH.desc)},ClientAuthError.createAppendEmptyScopeToSetError=function(t){return new ClientAuthError($H.code,$H.desc+" Given Scope: "+t)},ClientAuthError.createRemoveEmptyScopeFromSetError=function(t){return new ClientAuthError(MH.code,MH.desc+" Given Scope: "+t)},ClientAuthError.createAppendScopeSetError=function(t){return new ClientAuthError(OH.code,OH.desc+" Detail Error: "+t)},ClientAuthError.createEmptyInputScopeSetError=function(){return new ClientAuthError(NH.code,""+NH.desc)},ClientAuthError.createDeviceCodeCancelledError=function(){return new ClientAuthError(DH.code,""+DH.desc)},ClientAuthError.createDeviceCodeExpiredError=function(){return new ClientAuthError(LH.code,""+LH.desc)},ClientAuthError.createDeviceCodeUnknownError=function(){return new ClientAuthError(FH.code,""+FH.desc)},ClientAuthError.createNoAccountInSilentRequestError=function(){return new ClientAuthError(BH.code,""+BH.desc)},ClientAuthError.createNullOrUndefinedCacheRecord=function(){return new ClientAuthError(HH.code,HH.desc)},ClientAuthError.createInvalidCacheEnvironmentError=function(){return new ClientAuthError(UH.code,UH.desc)},ClientAuthError.createNoAccountFoundError=function(){return new ClientAuthError(qH.code,qH.desc)},ClientAuthError.createCachePluginError=function(){return new ClientAuthError(jH.code,""+jH.desc)},ClientAuthError.createNoCryptoObjectError=function(t){return new ClientAuthError(zH.code,""+zH.desc+t)},ClientAuthError.createInvalidCacheTypeError=function(){return new ClientAuthError(VH.code,""+VH.desc)},ClientAuthError.createUnexpectedAccountTypeError=function(){return new ClientAuthError(GH.code,""+GH.desc)},ClientAuthError.createUnexpectedCredentialTypeError=function(){return new ClientAuthError(KH.code,""+KH.desc)},ClientAuthError.createInvalidAssertionError=function(){return new ClientAuthError(WH.code,""+WH.desc)},ClientAuthError.createInvalidCredentialError=function(){return new ClientAuthError(QH.code,""+QH.desc)},ClientAuthError.createRefreshRequiredError=function(){return new ClientAuthError(YH.code,YH.desc)},ClientAuthError.createUserTimeoutReachedError=function(){return new ClientAuthError(ZH.code,ZH.desc)},ClientAuthError.createTokenClaimsRequiredError=function(){return new ClientAuthError(JH.code,JH.desc)},ClientAuthError.createNoAuthCodeInServerResponseError=function(){return new ClientAuthError(XH.code,XH.desc)},ClientAuthError.createBindingKeyNotRemovedError=function(){return new ClientAuthError(eU.code,eU.desc)},ClientAuthError.createLogoutNotSupportedError=function(){return new ClientAuthError(tU.code,tU.desc)},ClientAuthError.createKeyIdMissingError=function(){return new ClientAuthError(rU.code,rU.desc)},ClientAuthError.createNoNetworkConnectivityError=function(){return new ClientAuthError(oU.code,oU.desc)},ClientAuthError.createUserCanceledError=function(){return new ClientAuthError(nU.code,nU.desc)},ClientAuthError}(uH),sU=function(){function StringUtils(){}return StringUtils.decodeAuthToken=function(t){if(StringUtils.isEmpty(t))throw iU.createTokenNullOrEmptyError(t);var o=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!o||o.length<4)throw iU.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:o[1],JWSPayload:o[2],JWSSig:o[3]}},StringUtils.isEmpty=function(t){return void 0===t||!t||0===t.length},StringUtils.isEmptyObj=function(t){if(t&&!StringUtils.isEmpty(t))try{var o=JSON.parse(t);return 0===Object.keys(o).length}catch(t){}return!0},StringUtils.startsWith=function(t,o){return 0===t.indexOf(o)},StringUtils.endsWith=function(t,o){return t.length>=o.length&&t.lastIndexOf(o)===t.length-o.length},StringUtils.queryStringToObject=function(t){var o={},s=t.split("&"),decode=function(t){return decodeURIComponent(t.replace(/\+/g," "))};return s.forEach((function(t){if(t.trim()){var s=t.split(/=(.+)/g,2),l=s[0],h=s[1];l&&h&&(o[decode(l)]=decode(h))}})),o},StringUtils.trimArrayEntries=function(t){return t.map((function(t){return t.trim()}))},StringUtils.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!StringUtils.isEmpty(t)}))},StringUtils.jsonParseHelper=function(t){try{return JSON.parse(t)}catch(t){return null}},StringUtils.matchPattern=function(t,o){return new RegExp(t.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(o)},StringUtils}();!function(t){t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose",t[t.Trace=4]="Trace"}(lH||(lH={}));var aU,lU=function(){function Logger(t,o,s){this.level=lH.Info;var l=t||Logger.createDefaultLoggerOptions();this.localCallback=l.loggerCallback||function(){},this.piiLoggingEnabled=l.piiLoggingEnabled||!1,this.level="number"==typeof l.logLevel?l.logLevel:lH.Info,this.correlationId=l.correlationId||RB.EMPTY_STRING,this.packageName=o||RB.EMPTY_STRING,this.packageVersion=s||RB.EMPTY_STRING}return Logger.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:lH.Info}},Logger.prototype.clone=function(t,o,s){return new Logger({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:s||this.correlationId},t,o)},Logger.prototype.logMessage=function(t,o){if(!(o.logLevel>this.level||!this.piiLoggingEnabled&&o.containsPii)){var s=(new Date).toUTCString(),l=(sU.isEmpty(o.correlationId)?sU.isEmpty(this.correlationId)?"["+s+"]":"["+s+"] : ["+this.correlationId+"]":"["+s+"] : ["+o.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+lH[o.logLevel]+" - "+t;this.executeCallback(o.logLevel,l,o.containsPii||!1)}},Logger.prototype.executeCallback=function(t,o,s){this.localCallback&&this.localCallback(t,o,s)},Logger.prototype.error=function(t,o){this.logMessage(t,{logLevel:lH.Error,containsPii:!1,correlationId:o||RB.EMPTY_STRING})},Logger.prototype.errorPii=function(t,o){this.logMessage(t,{logLevel:lH.Error,containsPii:!0,correlationId:o||RB.EMPTY_STRING})},Logger.prototype.warning=function(t,o){this.logMessage(t,{logLevel:lH.Warning,containsPii:!1,correlationId:o||RB.EMPTY_STRING})},Logger.prototype.warningPii=function(t,o){this.logMessage(t,{logLevel:lH.Warning,containsPii:!0,correlationId:o||RB.EMPTY_STRING})},Logger.prototype.info=function(t,o){this.logMessage(t,{logLevel:lH.Info,containsPii:!1,correlationId:o||RB.EMPTY_STRING})},Logger.prototype.infoPii=function(t,o){this.logMessage(t,{logLevel:lH.Info,containsPii:!0,correlationId:o||RB.EMPTY_STRING})},Logger.prototype.verbose=function(t,o){this.logMessage(t,{logLevel:lH.Verbose,containsPii:!1,correlationId:o||RB.EMPTY_STRING})},Logger.prototype.verbosePii=function(t,o){this.logMessage(t,{logLevel:lH.Verbose,containsPii:!0,correlationId:o||RB.EMPTY_STRING})},Logger.prototype.trace=function(t,o){this.logMessage(t,{logLevel:lH.Trace,containsPii:!1,correlationId:o||RB.EMPTY_STRING})},Logger.prototype.tracePii=function(t,o){this.logMessage(t,{logLevel:lH.Trace,containsPii:!0,correlationId:o||RB.EMPTY_STRING})},Logger.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},Logger}(),cU="@azure/msal-common",dU="13.3.0";
/*! @azure/msal-common v13.3.0 2023-08-24 */!function(t){t[t.None=0]="None",t.AzurePublic="https://login.microsoftonline.com",t.AzurePpe="https://login.windows-ppe.net",t.AzureChina="https://login.chinacloudapi.cn",t.AzureGermany="https://login.microsoftonline.de",t.AzureUsGovernment="https://login.microsoftonline.us"}(aU||(aU={}));
/*! @azure/msal-common v13.3.0 2023-08-24 */
var uU,hU={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},pU={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},fU={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},gU={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},vU={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},mU={code:"empty_url_error",desc:"URL was empty or null."},yU={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},bU={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},wU={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},CU={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},_U={code:"token_request_empty",desc:"Token request was empty and not found in cache."},kU={code:"logout_request_empty",desc:"The logout request was null or undefined."},xU={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},SU={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},TU={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},EU={code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},AU={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},IU={code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},PU={code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},RU={code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},$U={code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},MU={code:"invalid_authentication_header",desc:"Invalid authentication header provided"},OU={code:"authority_mismatch",desc:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},NU=function(t){function ClientConfigurationError(o,s){var l=t.call(this,o,s)||this;return l.name="ClientConfigurationError",Object.setPrototypeOf(l,ClientConfigurationError.prototype),l}return __extends(ClientConfigurationError,t),ClientConfigurationError.createRedirectUriEmptyError=function(){return new ClientConfigurationError(hU.code,hU.desc)},ClientConfigurationError.createPostLogoutRedirectUriEmptyError=function(){return new ClientConfigurationError(pU.code,pU.desc)},ClientConfigurationError.createClaimsRequestParsingError=function(t){return new ClientConfigurationError(fU.code,fU.desc+" Given value: "+t)},ClientConfigurationError.createInsecureAuthorityUriError=function(t){return new ClientConfigurationError(gU.code,gU.desc+" Given URI: "+t)},ClientConfigurationError.createUrlParseError=function(t){return new ClientConfigurationError(vU.code,vU.desc+" Given Error: "+t)},ClientConfigurationError.createUrlEmptyError=function(){return new ClientConfigurationError(mU.code,mU.desc)},ClientConfigurationError.createEmptyScopesArrayError=function(){return new ClientConfigurationError(yU.code,""+yU.desc)},ClientConfigurationError.createClientIdSingleScopeError=function(t){return new ClientConfigurationError(bU.code,bU.desc+" Given Scopes: "+t)},ClientConfigurationError.createInvalidPromptError=function(t){return new ClientConfigurationError(wU.code,wU.desc+" Given value: "+t)},ClientConfigurationError.createInvalidClaimsRequestError=function(){return new ClientConfigurationError(CU.code,CU.desc)},ClientConfigurationError.createEmptyLogoutRequestError=function(){return new ClientConfigurationError(kU.code,kU.desc)},ClientConfigurationError.createEmptyTokenRequestError=function(){return new ClientConfigurationError(_U.code,_U.desc)},ClientConfigurationError.createInvalidCodeChallengeMethodError=function(){return new ClientConfigurationError(xU.code,xU.desc)},ClientConfigurationError.createInvalidCodeChallengeParamsError=function(){return new ClientConfigurationError(SU.code,SU.desc)},ClientConfigurationError.createInvalidCloudDiscoveryMetadataError=function(){return new ClientConfigurationError(TU.code,TU.desc)},ClientConfigurationError.createInvalidAuthorityMetadataError=function(){return new ClientConfigurationError(EU.code,EU.desc)},ClientConfigurationError.createUntrustedAuthorityError=function(){return new ClientConfigurationError(AU.code,AU.desc)},ClientConfigurationError.createInvalidAzureCloudInstanceError=function(){return new ClientConfigurationError(IU.code,IU.desc)},ClientConfigurationError.createMissingSshJwkError=function(){return new ClientConfigurationError(PU.code,PU.desc)},ClientConfigurationError.createMissingSshKidError=function(){return new ClientConfigurationError(RU.code,RU.desc)},ClientConfigurationError.createMissingNonceAuthenticationHeadersError=function(){return new ClientConfigurationError($U.code,$U.desc)},ClientConfigurationError.createInvalidAuthenticationHeaderError=function(t,o){return new ClientConfigurationError(MU.code,MU.desc+". Invalid header: "+t+". Details: "+o)},ClientConfigurationError.createAuthorityMismatchError=function(){return new ClientConfigurationError(OU.code,OU.desc)},ClientConfigurationError}(iU),DU=function(){function ScopeSet(t){var o=this,s=t?sU.trimArrayEntries(__spreadArrays(t)):[],l=s?sU.removeEmptyStringsFromArray(s):[];this.validateInputScopes(l),this.scopes=new Set,l.forEach((function(t){return o.scopes.add(t)}))}return ScopeSet.fromString=function(t){return new ScopeSet((t||RB.EMPTY_STRING).split(" "))},ScopeSet.createSearchScopes=function(t){var o=new ScopeSet(t);return o.containsOnlyOIDCScopes()?o.removeScope(RB.OFFLINE_ACCESS_SCOPE):o.removeOIDCScopes(),o},ScopeSet.prototype.validateInputScopes=function(t){if(!t||t.length<1)throw NU.createEmptyScopesArrayError()},ScopeSet.prototype.containsScope=function(t){var o=new ScopeSet(this.printScopesLowerCase().split(" "));return!sU.isEmpty(t)&&o.scopes.has(t.toLowerCase())},ScopeSet.prototype.containsScopeSet=function(t){var o=this;return!(!t||t.scopes.size<=0)&&(this.scopes.size>=t.scopes.size&&t.asArray().every((function(t){return o.containsScope(t)})))},ScopeSet.prototype.containsOnlyOIDCScopes=function(){var t=this,o=0;return MB.forEach((function(s){t.containsScope(s)&&(o+=1)})),this.scopes.size===o},ScopeSet.prototype.appendScope=function(t){sU.isEmpty(t)||this.scopes.add(t.trim())},ScopeSet.prototype.appendScopes=function(t){var o=this;try{t.forEach((function(t){return o.appendScope(t)}))}catch(t){throw iU.createAppendScopeSetError(t)}},ScopeSet.prototype.removeScope=function(t){if(sU.isEmpty(t))throw iU.createRemoveEmptyScopeFromSetError(t);this.scopes.delete(t.trim())},ScopeSet.prototype.removeOIDCScopes=function(){var t=this;MB.forEach((function(o){t.scopes.delete(o)}))},ScopeSet.prototype.unionScopeSets=function(t){if(!t)throw iU.createEmptyInputScopeSetError();var o=new Set;return t.scopes.forEach((function(t){return o.add(t.toLowerCase())})),this.scopes.forEach((function(t){return o.add(t.toLowerCase())})),o},ScopeSet.prototype.intersectingScopeSets=function(t){if(!t)throw iU.createEmptyInputScopeSetError();t.containsOnlyOIDCScopes()||t.removeOIDCScopes();var o=this.unionScopeSets(t),s=t.getScopeCount(),l=this.getScopeCount();return o.size<l+s},ScopeSet.prototype.getScopeCount=function(){return this.scopes.size},ScopeSet.prototype.asArray=function(){var t=[];return this.scopes.forEach((function(o){return t.push(o)})),t},ScopeSet.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):RB.EMPTY_STRING},ScopeSet.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},ScopeSet}();
/*! @azure/msal-common v13.3.0 2023-08-24 */
function buildClientInfo(t,o){if(sU.isEmpty(t))throw iU.createClientInfoEmptyError();try{var s=o.base64Decode(t);return JSON.parse(s)}catch(t){throw iU.createClientInfoDecodingError(t.message)}}function buildClientInfoFromHomeAccountId(t){if(sU.isEmpty(t))throw iU.createClientInfoDecodingError("Home account ID was empty.");var o=t.split(BB.CLIENT_INFO_SEPARATOR,2);return{uid:o[0],utid:o.length<2?RB.EMPTY_STRING:o[1]}}
/*! @azure/msal-common v13.3.0 2023-08-24 */!function(t){t[t.Default=0]="Default",t[t.Adfs=1]="Adfs",t[t.Dsts=2]="Dsts",t[t.Ciam=3]="Ciam"}(uU||(uU={}));
/*! @azure/msal-common v13.3.0 2023-08-24 */
var LU=function(){function AccountEntity(){}return AccountEntity.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(BB.CACHE_KEY_SEPARATOR).toLowerCase()},AccountEntity.prototype.generateAccountKey=function(){return AccountEntity.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},AccountEntity.prototype.generateType=function(){switch(this.authorityType){case FB.ADFS_ACCOUNT_TYPE:return UB.ADFS;case FB.MSAV1_ACCOUNT_TYPE:return UB.MSA;case FB.MSSTS_ACCOUNT_TYPE:return UB.MSSTS;case FB.GENERIC_ACCOUNT_TYPE:return UB.GENERIC;default:throw iU.createUnexpectedAccountTypeError()}},AccountEntity.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},AccountEntity.generateAccountCacheKey=function(t){return[t.homeAccountId,t.environment||RB.EMPTY_STRING,t.tenantId||RB.EMPTY_STRING].join(BB.CACHE_KEY_SEPARATOR).toLowerCase()},AccountEntity.createAccount=function(t,o,s,l,h,m,_,E){var $,B,q,j,K,W,X=new AccountEntity;X.authorityType=FB.MSSTS_ACCOUNT_TYPE,X.clientInfo=t,X.homeAccountId=o,X.nativeAccountId=E;var re=_||l&&l.getPreferredCache();if(!re)throw iU.createInvalidCacheEnvironmentError();if(X.environment=re,X.realm=(null===($=null==s?void 0:s.claims)||void 0===$?void 0:$.tid)||RB.EMPTY_STRING,s){X.idTokenClaims=s.claims,X.localAccountId=(null===(B=null==s?void 0:s.claims)||void 0===B?void 0:B.oid)||(null===(q=null==s?void 0:s.claims)||void 0===q?void 0:q.sub)||RB.EMPTY_STRING;var oe=null===(j=null==s?void 0:s.claims)||void 0===j?void 0:j.preferred_username,ne=(null===(K=null==s?void 0:s.claims)||void 0===K?void 0:K.emails)?s.claims.emails[0]:null;X.username=oe||ne||RB.EMPTY_STRING,X.name=null===(W=null==s?void 0:s.claims)||void 0===W?void 0:W.name}return X.cloudGraphHostName=h,X.msGraphHost=m,X},AccountEntity.createGenericAccount=function(t,o,s,l,h,m){var _,E,$,B,q=new AccountEntity;q.authorityType=s&&s.authorityType===uU.Adfs?FB.ADFS_ACCOUNT_TYPE:FB.GENERIC_ACCOUNT_TYPE,q.homeAccountId=t,q.realm=RB.EMPTY_STRING;var j=m||s&&s.getPreferredCache();if(!j)throw iU.createInvalidCacheEnvironmentError();return o&&(q.localAccountId=(null===(_=null==o?void 0:o.claims)||void 0===_?void 0:_.oid)||(null===(E=null==o?void 0:o.claims)||void 0===E?void 0:E.sub)||RB.EMPTY_STRING,q.username=(null===($=null==o?void 0:o.claims)||void 0===$?void 0:$.upn)||RB.EMPTY_STRING,q.name=(null===(B=null==o?void 0:o.claims)||void 0===B?void 0:B.name)||RB.EMPTY_STRING,q.idTokenClaims=null==o?void 0:o.claims),q.environment=j,q.cloudGraphHostName=l,q.msGraphHost=h,q},AccountEntity.generateHomeAccountId=function(t,o,s,l,h){var m,_=(null===(m=null==h?void 0:h.claims)||void 0===m?void 0:m.sub)?h.claims.sub:RB.EMPTY_STRING;if(o===uU.Adfs||o===uU.Dsts)return _;if(t)try{var E=buildClientInfo(t,l);if(!sU.isEmpty(E.uid)&&!sU.isEmpty(E.utid))return""+E.uid+BB.CLIENT_INFO_SEPARATOR+E.utid}catch(t){}return s.verbose("No client info in response"),_},AccountEntity.isAccountEntity=function(t){return!!t&&(t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("localAccountId")&&t.hasOwnProperty("username")&&t.hasOwnProperty("authorityType"))},AccountEntity.accountInfoIsEqual=function(t,o,s){if(!t||!o)return!1;var l=!0;if(s){var h=t.idTokenClaims||{},m=o.idTokenClaims||{};l=h.iat===m.iat&&h.nonce===m.nonce}return t.homeAccountId===o.homeAccountId&&t.localAccountId===o.localAccountId&&t.username===o.username&&t.tenantId===o.tenantId&&t.environment===o.environment&&t.nativeAccountId===o.nativeAccountId&&l},AccountEntity}(),FU=function(){function AuthToken(t,o){if(sU.isEmpty(t))throw iU.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=AuthToken.extractTokenClaims(t,o)}return AuthToken.extractTokenClaims=function(t,o){var s=sU.decodeAuthToken(t);try{var l=s.JWSPayload,h=o.base64Decode(l);return JSON.parse(h)}catch(t){throw iU.createTokenParsingError(t)}},AuthToken.checkMaxAge=function(t,o){if(0===o||Date.now()-3e5>t+o)throw iU.createMaxAgeTranspiredError()},AuthToken}(),BU=function(){function CacheManager(t,o,s){this.clientId=t,this.cryptoImpl=o,this.commonLogger=s.clone(cU,dU)}return CacheManager.prototype.getAllAccounts=function(){var t=this,o=this.getAccountKeys();if(o.length<1)return[];var s=o.reduce((function(o,s){var l=t.getAccount(s);return l?(o.push(l),o):o}),[]);return s.length<1?[]:s.map((function(o){return t.getAccountInfoFromEntity(o)}))},CacheManager.prototype.getAccountInfoFilteredBy=function(t){var o=this.getAccountsFilteredBy(t);return o.length>0?this.getAccountInfoFromEntity(o[0]):null},CacheManager.prototype.getAccountInfoFromEntity=function(t){var o=t.getAccountInfo(),s=this.getIdToken(o);return s&&(o.idToken=s.secret,o.idTokenClaims=new FU(s.secret,this.cryptoImpl).claims),o},CacheManager.prototype.saveCacheRecord=function(t){return __awaiter$1(this,void 0,void 0,(function(){return __generator(this,(function(o){switch(o.label){case 0:if(!t)throw iU.createNullOrUndefinedCacheRecord();return t.account&&this.setAccount(t.account),t.idToken&&this.setIdTokenCredential(t.idToken),t.accessToken?[4,this.saveAccessToken(t.accessToken)]:[3,2];case 1:o.sent(),o.label=2;case 2:return t.refreshToken&&this.setRefreshTokenCredential(t.refreshToken),t.appMetadata&&this.setAppMetadata(t.appMetadata),[2]}}))}))},CacheManager.prototype.saveAccessToken=function(t){return __awaiter$1(this,void 0,void 0,(function(){var o,s,l,h,m=this;return __generator(this,(function(_){switch(_.label){case 0:return o={clientId:t.clientId,credentialType:t.credentialType,environment:t.environment,homeAccountId:t.homeAccountId,realm:t.realm,tokenType:t.tokenType,requestedClaimsHash:t.requestedClaimsHash},s=this.getTokenKeys(),l=DU.fromString(t.target),h=[],s.accessToken.forEach((function(t){if(m.accessTokenKeyMatchesFilter(t,o,!1)){var s=m.getAccessTokenCredential(t);if(s&&m.credentialMatchesFilter(s,o))DU.fromString(s.target).intersectingScopeSets(l)&&h.push(m.removeAccessToken(t))}})),[4,Promise.all(h)];case 1:return _.sent(),this.setAccessTokenCredential(t),[2]}}))}))},CacheManager.prototype.getAccountsFilteredBy=function(t){var o=this,s=this.getAccountKeys(),l=[];return s.forEach((function(s){if(o.isAccountKey(s,t.homeAccountId,t.realm)){var h=o.getAccount(s);h&&(t.homeAccountId&&!o.matchHomeAccountId(h,t.homeAccountId)||t.localAccountId&&!o.matchLocalAccountId(h,t.localAccountId)||t.username&&!o.matchUsername(h,t.username)||t.environment&&!o.matchEnvironment(h,t.environment)||t.realm&&!o.matchRealm(h,t.realm)||t.nativeAccountId&&!o.matchNativeAccountId(h,t.nativeAccountId)||l.push(h))}})),l},CacheManager.prototype.isAccountKey=function(t,o,s){return!(t.split(BB.CACHE_KEY_SEPARATOR).length<3)&&(!(o&&!t.toLowerCase().includes(o.toLowerCase()))&&!(s&&!t.toLowerCase().includes(s.toLowerCase())))},CacheManager.prototype.isCredentialKey=function(t){if(t.split(BB.CACHE_KEY_SEPARATOR).length<6)return!1;var o=t.toLowerCase();if(-1===o.indexOf(HB.ID_TOKEN.toLowerCase())&&-1===o.indexOf(HB.ACCESS_TOKEN.toLowerCase())&&-1===o.indexOf(HB.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===o.indexOf(HB.REFRESH_TOKEN.toLowerCase()))return!1;if(o.indexOf(HB.REFRESH_TOKEN.toLowerCase())>-1){var s=""+HB.REFRESH_TOKEN+BB.CACHE_KEY_SEPARATOR+this.clientId+BB.CACHE_KEY_SEPARATOR,l=""+HB.REFRESH_TOKEN+BB.CACHE_KEY_SEPARATOR+VB+BB.CACHE_KEY_SEPARATOR;if(-1===o.indexOf(s.toLowerCase())&&-1===o.indexOf(l.toLowerCase()))return!1}else if(-1===o.indexOf(this.clientId.toLowerCase()))return!1;return!0},CacheManager.prototype.credentialMatchesFilter=function(t,o){if(o.clientId&&!this.matchClientId(t,o.clientId))return!1;if(o.userAssertionHash&&!this.matchUserAssertionHash(t,o.userAssertionHash))return!1;if("string"==typeof o.homeAccountId&&!this.matchHomeAccountId(t,o.homeAccountId))return!1;if(o.environment&&!this.matchEnvironment(t,o.environment))return!1;if(o.realm&&!this.matchRealm(t,o.realm))return!1;if(o.credentialType&&!this.matchCredentialType(t,o.credentialType))return!1;if(o.familyId&&!this.matchFamilyId(t,o.familyId))return!1;if(o.target&&!this.matchTarget(t,o.target))return!1;if((o.requestedClaimsHash||t.requestedClaimsHash)&&t.requestedClaimsHash!==o.requestedClaimsHash)return!1;if(t.credentialType===HB.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(o.tokenType&&!this.matchTokenType(t,o.tokenType))return!1;if(o.tokenType===WB.SSH&&o.keyId&&!this.matchKeyId(t,o.keyId))return!1}return!0},CacheManager.prototype.getAppMetadataFilteredBy=function(t){return this.getAppMetadataFilteredByInternal(t.environment,t.clientId)},CacheManager.prototype.getAppMetadataFilteredByInternal=function(t,o){var s=this,l=this.getKeys(),h={};return l.forEach((function(l){if(s.isAppMetadata(l)){var m=s.getAppMetadata(l);m&&(t&&!s.matchEnvironment(m,t)||o&&!s.matchClientId(m,o)||(h[l]=m))}})),h},CacheManager.prototype.getAuthorityMetadataByAlias=function(t){var o=this,s=this.getAuthorityMetadataKeys(),l=null;return s.forEach((function(s){if(o.isAuthorityMetadata(s)&&-1!==s.indexOf(o.clientId)){var h=o.getAuthorityMetadata(s);h&&-1!==h.aliases.indexOf(t)&&(l=h)}})),l},CacheManager.prototype.removeAllAccounts=function(){return __awaiter$1(this,void 0,void 0,(function(){var t,o,s=this;return __generator(this,(function(l){switch(l.label){case 0:return t=this.getAccountKeys(),o=[],t.forEach((function(t){o.push(s.removeAccount(t))})),[4,Promise.all(o)];case 1:return l.sent(),[2]}}))}))},CacheManager.prototype.removeAccount=function(t){return __awaiter$1(this,void 0,void 0,(function(){var o;return __generator(this,(function(s){switch(s.label){case 0:if(!(o=this.getAccount(t)))throw iU.createNoAccountFoundError();return[4,this.removeAccountContext(o)];case 1:return s.sent(),this.removeItem(t),[2]}}))}))},CacheManager.prototype.removeAccountContext=function(t){return __awaiter$1(this,void 0,void 0,(function(){var o,s,l,h=this;return __generator(this,(function(m){switch(m.label){case 0:return o=this.getTokenKeys(),s=t.generateAccountId(),l=[],o.idToken.forEach((function(t){0===t.indexOf(s)&&h.removeIdToken(t)})),o.accessToken.forEach((function(t){0===t.indexOf(s)&&l.push(h.removeAccessToken(t))})),o.refreshToken.forEach((function(t){0===t.indexOf(s)&&h.removeRefreshToken(t)})),[4,Promise.all(l)];case 1:return m.sent(),[2]}}))}))},CacheManager.prototype.removeAccessToken=function(t){return __awaiter$1(this,void 0,void 0,(function(){var o,s;return __generator(this,(function(l){switch(l.label){case 0:if(!(o=this.getAccessTokenCredential(t)))return[2];if(o.credentialType.toLowerCase()!==HB.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(o.tokenType!==WB.POP)return[3,4];if(!(s=o.keyId))return[3,4];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(s)];case 2:return l.sent(),[3,4];case 3:throw l.sent(),iU.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(t)]}}))}))},CacheManager.prototype.removeAppMetadata=function(){var t=this;return this.getKeys().forEach((function(o){t.isAppMetadata(o)&&t.removeItem(o)})),!0},CacheManager.prototype.readCacheRecord=function(t,o,s){var l=this.getTokenKeys(),h=this.readAccountFromCache(t),m=this.getIdToken(t,l),_=this.getAccessToken(t,o,l),E=this.getRefreshToken(t,!1,l),$=this.readAppMetadataFromCache(s);return h&&m&&(h.idTokenClaims=new FU(m.secret,this.cryptoImpl).claims),{account:h,idToken:m,accessToken:_,refreshToken:E,appMetadata:$}},CacheManager.prototype.readAccountFromCache=function(t){var o=LU.generateAccountCacheKey(t);return this.getAccount(o)},CacheManager.prototype.getIdToken=function(t,o){this.commonLogger.trace("CacheManager - getIdToken called");var s={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:HB.ID_TOKEN,clientId:this.clientId,realm:t.tenantId},l=this.getIdTokensByFilter(s,o),h=l.length;if(h<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(h>1)throw iU.createMultipleMatchingTokensInCacheError();return this.commonLogger.info("CacheManager:getIdToken - Returning id token"),l[0]},CacheManager.prototype.getIdTokensByFilter=function(t,o){var s=this,l=o&&o.idToken||this.getTokenKeys().idToken,h=[];return l.forEach((function(o){if(s.idTokenKeyMatchesFilter(o,__assign({clientId:s.clientId},t))){var l=s.getIdTokenCredential(o);l&&s.credentialMatchesFilter(l,t)&&h.push(l)}})),h},CacheManager.prototype.idTokenKeyMatchesFilter=function(t,o){var s=t.toLowerCase();return(!o.clientId||-1!==s.indexOf(o.clientId.toLowerCase()))&&(!o.homeAccountId||-1!==s.indexOf(o.homeAccountId.toLowerCase()))},CacheManager.prototype.removeIdToken=function(t){this.removeItem(t)},CacheManager.prototype.removeRefreshToken=function(t){this.removeItem(t)},CacheManager.prototype.getAccessToken=function(t,o,s){var l=this;this.commonLogger.trace("CacheManager - getAccessToken called");var h=DU.createSearchScopes(o.scopes),m=o.authenticationScheme||WB.BEARER,_=m&&m.toLowerCase()!==WB.BEARER.toLowerCase()?HB.ACCESS_TOKEN_WITH_AUTH_SCHEME:HB.ACCESS_TOKEN,E={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:_,clientId:this.clientId,realm:t.tenantId,target:h,tokenType:m,keyId:o.sshKid,requestedClaimsHash:o.requestedClaimsHash},$=s&&s.accessToken||this.getTokenKeys().accessToken,B=[];$.forEach((function(t){if(l.accessTokenKeyMatchesFilter(t,E,!0)){var o=l.getAccessTokenCredential(t);o&&l.credentialMatchesFilter(o,E)&&B.push(o)}}));var q=B.length;if(q<1)return this.commonLogger.info("CacheManager:getAccessToken - No token found"),null;if(q>1)throw iU.createMultipleMatchingTokensInCacheError();return this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),B[0]},CacheManager.prototype.accessTokenKeyMatchesFilter=function(t,o,s){var l=t.toLowerCase();if(o.clientId&&-1===l.indexOf(o.clientId.toLowerCase()))return!1;if(o.homeAccountId&&-1===l.indexOf(o.homeAccountId.toLowerCase()))return!1;if(o.realm&&-1===l.indexOf(o.realm.toLowerCase()))return!1;if(o.requestedClaimsHash&&-1===l.indexOf(o.requestedClaimsHash.toLowerCase()))return!1;if(o.target)for(var h=o.target.asArray(),m=0;m<h.length;m++){if(s&&!l.includes(h[m].toLowerCase()))return!1;if(!s&&l.includes(h[m].toLowerCase()))return!0}return!0},CacheManager.prototype.getAccessTokensByFilter=function(t){var o=this,s=this.getTokenKeys(),l=[];return s.accessToken.forEach((function(s){if(o.accessTokenKeyMatchesFilter(s,t,!0)){var h=o.getAccessTokenCredential(s);h&&o.credentialMatchesFilter(h,t)&&l.push(h)}})),l},CacheManager.prototype.getRefreshToken=function(t,o,s){var l=this;this.commonLogger.trace("CacheManager - getRefreshToken called");var h=o?VB:void 0,m={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:HB.REFRESH_TOKEN,clientId:this.clientId,familyId:h},_=s&&s.refreshToken||this.getTokenKeys().refreshToken,E=[];return _.forEach((function(t){if(l.refreshTokenKeyMatchesFilter(t,m)){var o=l.getRefreshTokenCredential(t);o&&l.credentialMatchesFilter(o,m)&&E.push(o)}})),E.length<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),E[0])},CacheManager.prototype.refreshTokenKeyMatchesFilter=function(t,o){var s=t.toLowerCase();return(!o.familyId||-1!==s.indexOf(o.familyId.toLowerCase()))&&(!(!o.familyId&&o.clientId&&-1===s.indexOf(o.clientId.toLowerCase()))&&(!o.homeAccountId||-1!==s.indexOf(o.homeAccountId.toLowerCase())))},CacheManager.prototype.readAppMetadataFromCache=function(t){var o={environment:t,clientId:this.clientId},s=this.getAppMetadataFilteredBy(o),l=Object.keys(s).map((function(t){return s[t]})),h=l.length;if(h<1)return null;if(h>1)throw iU.createMultipleMatchingAppMetadataInCacheError();return l[0]},CacheManager.prototype.isAppMetadataFOCI=function(t){var o=this.readAppMetadataFromCache(t);return!(!o||o.familyId!==VB)},CacheManager.prototype.matchHomeAccountId=function(t,o){return!("string"!=typeof t.homeAccountId||o!==t.homeAccountId)},CacheManager.prototype.matchLocalAccountId=function(t,o){return!("string"!=typeof t.localAccountId||o!==t.localAccountId)},CacheManager.prototype.matchUsername=function(t,o){return!("string"!=typeof t.username||o.toLowerCase()!==t.username.toLowerCase())},CacheManager.prototype.matchUserAssertionHash=function(t,o){return!(!t.userAssertionHash||o!==t.userAssertionHash)},CacheManager.prototype.matchEnvironment=function(t,o){var s=this.getAuthorityMetadataByAlias(o);return!!(s&&s.aliases.indexOf(t.environment)>-1)},CacheManager.prototype.matchCredentialType=function(t,o){return t.credentialType&&o.toLowerCase()===t.credentialType.toLowerCase()},CacheManager.prototype.matchClientId=function(t,o){return!(!t.clientId||o!==t.clientId)},CacheManager.prototype.matchFamilyId=function(t,o){return!(!t.familyId||o!==t.familyId)},CacheManager.prototype.matchRealm=function(t,o){return!(!t.realm||o!==t.realm)},CacheManager.prototype.matchNativeAccountId=function(t,o){return!(!t.nativeAccountId||o!==t.nativeAccountId)},CacheManager.prototype.matchTarget=function(t,o){return!(t.credentialType!==HB.ACCESS_TOKEN&&t.credentialType!==HB.ACCESS_TOKEN_WITH_AUTH_SCHEME||!t.target)&&DU.fromString(t.target).containsScopeSet(o)},CacheManager.prototype.matchTokenType=function(t,o){return!(!t.tokenType||t.tokenType!==o)},CacheManager.prototype.matchKeyId=function(t,o){return!(!t.keyId||t.keyId!==o)},CacheManager.prototype.isAppMetadata=function(t){return-1!==t.indexOf(zB)},CacheManager.prototype.isAuthorityMetadata=function(t){return-1!==t.indexOf(GB)},CacheManager.prototype.generateAuthorityMetadataCacheKey=function(t){return GB+"-"+this.clientId+"-"+t},CacheManager.toObject=function(t,o){for(var s in o)t[s]=o[s];return t},CacheManager}(),HU=function(t){function DefaultStorageClass(){return null!==t&&t.apply(this,arguments)||this}return __extends(DefaultStorageClass,t),DefaultStorageClass.prototype.setAccount=function(){throw uH.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAccount=function(){throw uH.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setIdTokenCredential=function(){throw uH.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getIdTokenCredential=function(){throw uH.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAccessTokenCredential=function(){throw uH.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAccessTokenCredential=function(){throw uH.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setRefreshTokenCredential=function(){throw uH.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getRefreshTokenCredential=function(){throw uH.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAppMetadata=function(){throw uH.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAppMetadata=function(){throw uH.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setServerTelemetry=function(){throw uH.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getServerTelemetry=function(){throw uH.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setAuthorityMetadata=function(){throw uH.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAuthorityMetadata=function(){throw uH.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAuthorityMetadataKeys=function(){throw uH.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.setThrottlingCache=function(){throw uH.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getThrottlingCache=function(){throw uH.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.removeItem=function(){throw uH.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.containsKey=function(){throw uH.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getKeys=function(){throw uH.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getAccountKeys=function(){throw uH.createUnexpectedError("Storage interface - getAccountKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.getTokenKeys=function(){throw uH.createUnexpectedError("Storage interface - getTokenKeys() has not been implemented for the cacheStorage interface.")},DefaultStorageClass.prototype.clear=function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Storage interface - clear() has not been implemented for the cacheStorage interface.",uH.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},DefaultStorageClass.prototype.updateCredentialCacheKey=function(){throw uH.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},DefaultStorageClass}(BU),UU={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},qU={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:lH.Info,correlationId:RB.EMPTY_STRING},jU={claimsBasedCachingEnabled:!0},zU={sendGetRequestAsync:function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Network interface - sendGetRequestAsync() has not been implemented",uH.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return __awaiter$1(this,void 0,void 0,(function(){return __generator(this,(function(t){throw"Network interface - sendPostRequestAsync() has not been implemented",uH.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},VU={sku:RB.SKU,version:dU,cpu:RB.EMPTY_STRING,os:RB.EMPTY_STRING},GU={clientSecret:RB.EMPTY_STRING,clientAssertion:void 0},KU={azureCloudInstance:aU.None,tenant:""+RB.DEFAULT_COMMON_TENANT},WU={application:{appName:"",appVersion:""}};
/*! @azure/msal-common v13.3.0 2023-08-24 */
/*! @azure/msal-common v13.3.0 2023-08-24 */
var QU,YU=function(t){function ServerError(o,s,l){var h=t.call(this,o,s,l)||this;return h.name="ServerError",Object.setPrototypeOf(h,ServerError.prototype),h}return __extends(ServerError,t),ServerError}(uH),ZU=function(){function ThrottlingUtils(){}return ThrottlingUtils.generateThrottlingStorageKey=function(t){return nH+"."+JSON.stringify(t)},ThrottlingUtils.preProcess=function(t,o){var s,l=ThrottlingUtils.generateThrottlingStorageKey(o),h=t.getThrottlingCache(l);if(h){if(h.throttleTime<Date.now())return void t.removeItem(l);throw new YU((null===(s=h.errorCodes)||void 0===s?void 0:s.join(" "))||RB.EMPTY_STRING,h.errorMessage,h.subError)}},ThrottlingUtils.postProcess=function(t,o,s){if(ThrottlingUtils.checkResponseStatus(s)||ThrottlingUtils.checkResponseForRetryAfter(s)){var l={throttleTime:ThrottlingUtils.calculateThrottleTime(parseInt(s.headers[TB.RETRY_AFTER])),error:s.body.error,errorCodes:s.body.error_codes,errorMessage:s.body.error_description,subError:s.body.suberror};t.setThrottlingCache(ThrottlingUtils.generateThrottlingStorageKey(o),l)}},ThrottlingUtils.checkResponseStatus=function(t){return 429===t.status||t.status>=500&&t.status<600},ThrottlingUtils.checkResponseForRetryAfter=function(t){return!!t.headers&&(t.headers.hasOwnProperty(TB.RETRY_AFTER)&&(t.status<200||t.status>=300))},ThrottlingUtils.calculateThrottleTime=function(t){var o=t<=0?0:t,s=Date.now()/1e3;return Math.floor(1e3*Math.min(s+(o||rH),s+oH))},ThrottlingUtils.removeThrottle=function(t,o,s,l){var h={clientId:o,authority:s.authority,scopes:s.scopes,homeAccountIdentifier:l,claims:s.claims,authenticationScheme:s.authenticationScheme,resourceRequestMethod:s.resourceRequestMethod,resourceRequestUri:s.resourceRequestUri,shrClaims:s.shrClaims,sshKid:s.sshKid},m=this.generateThrottlingStorageKey(h);t.removeItem(m)},ThrottlingUtils}(),JU=function(){function NetworkManager(t,o){this.networkClient=t,this.cacheManager=o}return NetworkManager.prototype.sendPostRequest=function(t,o,s){return __awaiter$1(this,void 0,void 0,(function(){var l,h;return __generator(this,(function(m){switch(m.label){case 0:ZU.preProcess(this.cacheManager,t),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(o,s)];case 2:return l=m.sent(),[3,4];case 3:throw(h=m.sent())instanceof uH?h:iU.createNetworkError(o,h);case 4:return ZU.postProcess(this.cacheManager,t,l),[2,l]}}))}))},NetworkManager}();
/*! @azure/msal-common v13.3.0 2023-08-24 */!function(t){t.HOME_ACCOUNT_ID="home_account_id",t.UPN="UPN"}(QU||(QU={}));
/*! @azure/msal-common v13.3.0 2023-08-24 */
var XU,eq,tq=function(){function RequestValidator(){}return RequestValidator.validateRedirectUri=function(t){if(sU.isEmpty(t))throw NU.createRedirectUriEmptyError()},RequestValidator.validatePrompt=function(t){var o=[];for(var s in NB)o.push(NB[s]);if(o.indexOf(t)<0)throw NU.createInvalidPromptError(t)},RequestValidator.validateClaims=function(t){try{JSON.parse(t)}catch(t){throw NU.createInvalidClaimsRequestError()}},RequestValidator.validateCodeChallengeParams=function(t,o){if(sU.isEmpty(t)||sU.isEmpty(o))throw NU.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(o)},RequestValidator.validateCodeChallengeMethod=function(t){if([qB.PLAIN,qB.S256].indexOf(t)<0)throw NU.createInvalidCodeChallengeMethodError()},RequestValidator.sanitizeEQParams=function(t,o){return t?(o.forEach((function(o,s){t[s]&&delete t[s]})),Object.fromEntries(Object.entries(t).filter((function(t){return""!==t[1]})))):{}},RequestValidator}(),rq=function(){function RequestParameterBuilder(){this.parameters=new Map}return RequestParameterBuilder.prototype.addResponseTypeCode=function(){this.parameters.set(IB.RESPONSE_TYPE,encodeURIComponent(RB.CODE_RESPONSE_TYPE))},RequestParameterBuilder.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(IB.RESPONSE_TYPE,encodeURIComponent(RB.TOKEN_RESPONSE_TYPE+" "+RB.ID_TOKEN_RESPONSE_TYPE))},RequestParameterBuilder.prototype.addResponseMode=function(t){this.parameters.set(IB.RESPONSE_MODE,encodeURIComponent(t||DB.QUERY))},RequestParameterBuilder.prototype.addNativeBroker=function(){this.parameters.set(IB.NATIVE_BROKER,encodeURIComponent("1"))},RequestParameterBuilder.prototype.addScopes=function(t,o){void 0===o&&(o=!0);var s=o?__spreadArrays(t||[],$B):t||[],l=new DU(s);this.parameters.set(IB.SCOPE,encodeURIComponent(l.printScopes()))},RequestParameterBuilder.prototype.addClientId=function(t){this.parameters.set(IB.CLIENT_ID,encodeURIComponent(t))},RequestParameterBuilder.prototype.addRedirectUri=function(t){tq.validateRedirectUri(t),this.parameters.set(IB.REDIRECT_URI,encodeURIComponent(t))},RequestParameterBuilder.prototype.addPostLogoutRedirectUri=function(t){tq.validateRedirectUri(t),this.parameters.set(IB.POST_LOGOUT_URI,encodeURIComponent(t))},RequestParameterBuilder.prototype.addIdTokenHint=function(t){this.parameters.set(IB.ID_TOKEN_HINT,encodeURIComponent(t))},RequestParameterBuilder.prototype.addDomainHint=function(t){this.parameters.set(OB.DOMAIN_HINT,encodeURIComponent(t))},RequestParameterBuilder.prototype.addLoginHint=function(t){this.parameters.set(OB.LOGIN_HINT,encodeURIComponent(t))},RequestParameterBuilder.prototype.addCcsUpn=function(t){this.parameters.set(TB.CCS_HEADER,encodeURIComponent("UPN:"+t))},RequestParameterBuilder.prototype.addCcsOid=function(t){this.parameters.set(TB.CCS_HEADER,encodeURIComponent("Oid:"+t.uid+"@"+t.utid))},RequestParameterBuilder.prototype.addSid=function(t){this.parameters.set(OB.SID,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClaims=function(t,o){var s=this.addClientCapabilitiesToClaims(t,o);tq.validateClaims(s),this.parameters.set(IB.CLAIMS,encodeURIComponent(s))},RequestParameterBuilder.prototype.addCorrelationId=function(t){this.parameters.set(IB.CLIENT_REQUEST_ID,encodeURIComponent(t))},RequestParameterBuilder.prototype.addLibraryInfo=function(t){this.parameters.set(IB.X_CLIENT_SKU,t.sku),this.parameters.set(IB.X_CLIENT_VER,t.version),t.os&&this.parameters.set(IB.X_CLIENT_OS,t.os),t.cpu&&this.parameters.set(IB.X_CLIENT_CPU,t.cpu)},RequestParameterBuilder.prototype.addApplicationTelemetry=function(t){(null==t?void 0:t.appName)&&this.parameters.set(IB.X_APP_NAME,t.appName),(null==t?void 0:t.appVersion)&&this.parameters.set(IB.X_APP_VER,t.appVersion)},RequestParameterBuilder.prototype.addPrompt=function(t){tq.validatePrompt(t),this.parameters.set(""+IB.PROMPT,encodeURIComponent(t))},RequestParameterBuilder.prototype.addState=function(t){sU.isEmpty(t)||this.parameters.set(IB.STATE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addNonce=function(t){this.parameters.set(IB.NONCE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addCodeChallengeParams=function(t,o){if(tq.validateCodeChallengeParams(t,o),!t||!o)throw NU.createInvalidCodeChallengeParamsError();this.parameters.set(IB.CODE_CHALLENGE,encodeURIComponent(t)),this.parameters.set(IB.CODE_CHALLENGE_METHOD,encodeURIComponent(o))},RequestParameterBuilder.prototype.addAuthorizationCode=function(t){this.parameters.set(IB.CODE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addDeviceCode=function(t){this.parameters.set(IB.DEVICE_CODE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addRefreshToken=function(t){this.parameters.set(IB.REFRESH_TOKEN,encodeURIComponent(t))},RequestParameterBuilder.prototype.addCodeVerifier=function(t){this.parameters.set(IB.CODE_VERIFIER,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClientSecret=function(t){this.parameters.set(IB.CLIENT_SECRET,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClientAssertion=function(t){sU.isEmpty(t)||this.parameters.set(IB.CLIENT_ASSERTION,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClientAssertionType=function(t){sU.isEmpty(t)||this.parameters.set(IB.CLIENT_ASSERTION_TYPE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addOboAssertion=function(t){this.parameters.set(IB.OBO_ASSERTION,encodeURIComponent(t))},RequestParameterBuilder.prototype.addRequestTokenUse=function(t){this.parameters.set(IB.REQUESTED_TOKEN_USE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addGrantType=function(t){this.parameters.set(IB.GRANT_TYPE,encodeURIComponent(t))},RequestParameterBuilder.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},RequestParameterBuilder.prototype.addExtraQueryParameters=function(t){var o=this,s=tq.sanitizeEQParams(t,this.parameters);Object.keys(s).forEach((function(s){o.parameters.set(s,t[s])}))},RequestParameterBuilder.prototype.addClientCapabilitiesToClaims=function(t,o){var s;if(t)try{s=JSON.parse(t)}catch(t){throw NU.createInvalidClaimsRequestError()}else s={};return o&&o.length>0&&(s.hasOwnProperty(PB.ACCESS_TOKEN)||(s[PB.ACCESS_TOKEN]={}),s[PB.ACCESS_TOKEN][PB.XMS_CC]={values:o}),JSON.stringify(s)},RequestParameterBuilder.prototype.addUsername=function(t){this.parameters.set(YB.username,encodeURIComponent(t))},RequestParameterBuilder.prototype.addPassword=function(t){this.parameters.set(YB.password,encodeURIComponent(t))},RequestParameterBuilder.prototype.addPopToken=function(t){sU.isEmpty(t)||(this.parameters.set(IB.TOKEN_TYPE,WB.POP),this.parameters.set(IB.REQ_CNF,encodeURIComponent(t)))},RequestParameterBuilder.prototype.addSshJwk=function(t){sU.isEmpty(t)||(this.parameters.set(IB.TOKEN_TYPE,WB.SSH),this.parameters.set(IB.REQ_CNF,encodeURIComponent(t)))},RequestParameterBuilder.prototype.addServerTelemetry=function(t){this.parameters.set(IB.X_CLIENT_CURR_TELEM,t.generateCurrentRequestHeaderValue()),this.parameters.set(IB.X_CLIENT_LAST_TELEM,t.generateLastRequestHeaderValue())},RequestParameterBuilder.prototype.addThrottling=function(){this.parameters.set(IB.X_MS_LIB_CAPABILITY,iH)},RequestParameterBuilder.prototype.addLogoutHint=function(t){this.parameters.set(IB.LOGOUT_HINT,encodeURIComponent(t))},RequestParameterBuilder.prototype.createQueryString=function(){var t=new Array;return this.parameters.forEach((function(o,s){t.push(s+"="+o)})),t.join("&")},RequestParameterBuilder}(),oq=function(){function BaseClient(t,o){this.config=function buildClientConfiguration(t){var o,s=t.authOptions,l=t.systemOptions,h=t.loggerOptions,m=t.cacheOptions,_=t.storageInterface,E=t.networkInterface,$=t.cryptoInterface,B=t.clientCredentials,q=t.libraryInfo,j=t.telemetry,K=t.serverTelemetryManager,W=t.persistencePlugin,X=t.serializableCache,re=__assign(__assign({},qU),h);return{authOptions:(o=s,__assign({clientCapabilities:[],azureCloudOptions:KU,skipAuthorityMetadataCache:!1},o)),systemOptions:__assign(__assign({},UU),l),loggerOptions:re,cacheOptions:__assign(__assign({},jU),m),storageInterface:_||new HU(s.clientId,hH,new lU(re)),networkInterface:E||zU,cryptoInterface:$||hH,clientCredentials:B||GU,libraryInfo:__assign(__assign({},VU),q),telemetry:__assign(__assign({},WU),j),serverTelemetryManager:K||null,persistencePlugin:W||null,serializableCache:X||null}}(t),this.logger=new lU(this.config.loggerOptions,cU,dU),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new JU(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=o}return BaseClient.prototype.createTokenRequestHeaders=function(t){var o={};if(o[TB.CONTENT_TYPE]=RB.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&t)switch(t.type){case QU.HOME_ACCOUNT_ID:try{var s=buildClientInfoFromHomeAccountId(t.credential);o[TB.CCS_HEADER]="Oid:"+s.uid+"@"+s.utid}catch(t){this.logger.verbose("Could not parse home account ID for CCS Header: "+t)}break;case QU.UPN:o[TB.CCS_HEADER]="UPN: "+t.credential}return o},BaseClient.prototype.executePostToTokenEndpoint=function(t,o,s,l){return __awaiter$1(this,void 0,void 0,(function(){var h;return __generator(this,(function(m){switch(m.label){case 0:return[4,this.networkManager.sendPostRequest(l,t,{body:o,headers:s})];case 1:return h=m.sent(),this.config.serverTelemetryManager&&h.status<500&&429!==h.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,h]}}))}))},BaseClient.prototype.updateAuthority=function(t){if(!t.discoveryComplete())throw iU.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=t},BaseClient.prototype.createTokenQueryParameters=function(t){var o=new rq;return t.tokenQueryParameters&&o.addExtraQueryParameters(t.tokenQueryParameters),o.createQueryString()},BaseClient}(),nq=function(){function CredentialEntity(){}return CredentialEntity.prototype.generateAccountId=function(){return CredentialEntity.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},CredentialEntity.prototype.generateCredentialId=function(){return CredentialEntity.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},CredentialEntity.prototype.generateTarget=function(){return CredentialEntity.generateTargetForCacheKey(this.target)},CredentialEntity.prototype.generateCredentialKey=function(){return CredentialEntity.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},CredentialEntity.prototype.generateType=function(){switch(this.credentialType){case HB.ID_TOKEN:return UB.ID_TOKEN;case HB.ACCESS_TOKEN:case HB.ACCESS_TOKEN_WITH_AUTH_SCHEME:return UB.ACCESS_TOKEN;case HB.REFRESH_TOKEN:return UB.REFRESH_TOKEN;default:throw iU.createUnexpectedCredentialTypeError()}},CredentialEntity.generateCredentialCacheKey=function(t,o,s,l,h,m,_,E,$){return[this.generateAccountIdForCacheKey(t,o),this.generateCredentialIdForCacheKey(s,l,h,_),this.generateTargetForCacheKey(m),this.generateClaimsHashForCacheKey($),this.generateSchemeForCacheKey(E)].join(BB.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateAccountIdForCacheKey=function(t,o){return[t,o].join(BB.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateCredentialIdForCacheKey=function(t,o,s,l){return[t,t===HB.REFRESH_TOKEN&&l||o,s||RB.EMPTY_STRING].join(BB.CACHE_KEY_SEPARATOR).toLowerCase()},CredentialEntity.generateTargetForCacheKey=function(t){return(t||RB.EMPTY_STRING).toLowerCase()},CredentialEntity.generateClaimsHashForCacheKey=function(t){return(t||RB.EMPTY_STRING).toLowerCase()},CredentialEntity.generateSchemeForCacheKey=function(t){return t&&t.toLowerCase()!==WB.BEARER.toLowerCase()?t.toLowerCase():RB.EMPTY_STRING},CredentialEntity}(),iq=function(t){function IdTokenEntity(){return null!==t&&t.apply(this,arguments)||this}return __extends(IdTokenEntity,t),IdTokenEntity.createIdTokenEntity=function(t,o,s,l,h){var m=new IdTokenEntity;return m.credentialType=HB.ID_TOKEN,m.homeAccountId=t,m.environment=o,m.clientId=l,m.secret=s,m.realm=h,m},IdTokenEntity.isIdTokenEntity=function(t){return!!t&&(t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===HB.ID_TOKEN)},IdTokenEntity}(nq),sq=function(){function TimeUtils(){}return TimeUtils.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},TimeUtils.isTokenExpired=function(t,o){var s=Number(t)||0;return TimeUtils.nowSeconds()+o>s},TimeUtils.wasClockTurnedBack=function(t){return Number(t)>TimeUtils.nowSeconds()},TimeUtils.delay=function(t,o){return new Promise((function(s){return setTimeout((function(){return s(o)}),t)}))},TimeUtils}(),aq=function(t){function AccessTokenEntity(){return null!==t&&t.apply(this,arguments)||this}return __extends(AccessTokenEntity,t),AccessTokenEntity.createAccessTokenEntity=function(t,o,s,l,h,m,_,E,$,B,q,j,K,W,X){var re,oe,ne=new AccessTokenEntity;ne.homeAccountId=t,ne.credentialType=HB.ACCESS_TOKEN,ne.secret=s;var ae=sq.nowSeconds();if(ne.cachedAt=ae.toString(),ne.expiresOn=_.toString(),ne.extendedExpiresOn=E.toString(),B&&(ne.refreshOn=B.toString()),ne.environment=o,ne.clientId=l,ne.realm=h,ne.target=m,ne.userAssertionHash=j,ne.tokenType=sU.isEmpty(q)?WB.BEARER:q,W&&(ne.requestedClaims=W,ne.requestedClaimsHash=X),(null===(re=ne.tokenType)||void 0===re?void 0:re.toLowerCase())!==WB.BEARER.toLowerCase())switch(ne.credentialType=HB.ACCESS_TOKEN_WITH_AUTH_SCHEME,ne.tokenType){case WB.POP:var le=FU.extractTokenClaims(s,$);if(!(null===(oe=null==le?void 0:le.cnf)||void 0===oe?void 0:oe.kid))throw iU.createTokenClaimsRequiredError();ne.keyId=le.cnf.kid;break;case WB.SSH:ne.keyId=K}return ne},AccessTokenEntity.isAccessTokenEntity=function(t){return!!t&&(t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.hasOwnProperty("target")&&(t.credentialType===HB.ACCESS_TOKEN||t.credentialType===HB.ACCESS_TOKEN_WITH_AUTH_SCHEME))},AccessTokenEntity}(nq),lq=function(t){function RefreshTokenEntity(){return null!==t&&t.apply(this,arguments)||this}return __extends(RefreshTokenEntity,t),RefreshTokenEntity.createRefreshTokenEntity=function(t,o,s,l,h,m){var _=new RefreshTokenEntity;return _.clientId=l,_.credentialType=HB.REFRESH_TOKEN,_.environment=o,_.homeAccountId=t,_.secret=s,_.userAssertionHash=m,h&&(_.familyId=h),_},RefreshTokenEntity.isRefreshTokenEntity=function(t){return!!t&&(t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===HB.REFRESH_TOKEN)},RefreshTokenEntity}(nq),cq=["interaction_required","consent_required","login_required"],dq=["message_only","additional_action","basic_action","user_password_expired","consent_required"],uq={code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},hq={code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."},pq=function(t){function InteractionRequiredAuthError(o,s,l,h,m,_,E){var $=t.call(this,o,s,l)||this;return Object.setPrototypeOf($,InteractionRequiredAuthError.prototype),$.timestamp=h||RB.EMPTY_STRING,$.traceId=m||RB.EMPTY_STRING,$.correlationId=_||RB.EMPTY_STRING,$.claims=E||RB.EMPTY_STRING,$.name="InteractionRequiredAuthError",$}return __extends(InteractionRequiredAuthError,t),InteractionRequiredAuthError.isInteractionRequiredError=function(t,o,s){var l=!!t&&cq.indexOf(t)>-1,h=!!s&&dq.indexOf(s)>-1,m=!!o&&cq.some((function(t){return o.indexOf(t)>-1}));return l||m||h},InteractionRequiredAuthError.createNoTokensFoundError=function(){return new InteractionRequiredAuthError(uq.code,uq.desc)},InteractionRequiredAuthError.createNativeAccountUnavailableError=function(){return new InteractionRequiredAuthError(hq.code,hq.desc)},InteractionRequiredAuthError}(uH),fq=function fq(t,o,s,l,h){this.account=t||null,this.idToken=o||null,this.accessToken=s||null,this.refreshToken=l||null,this.appMetadata=h||null},gq=function(){function ProtocolUtils(){}return ProtocolUtils.setRequestState=function(t,o,s){var l=ProtocolUtils.generateLibraryState(t,s);return sU.isEmpty(o)?l:""+l+RB.RESOURCE_DELIM+o},ProtocolUtils.generateLibraryState=function(t,o){if(!t)throw iU.createNoCryptoObjectError("generateLibraryState");var s={id:t.createNewGuid()};o&&(s.meta=o);var l=JSON.stringify(s);return t.base64Encode(l)},ProtocolUtils.parseRequestState=function(t,o){if(!t)throw iU.createNoCryptoObjectError("parseRequestState");if(sU.isEmpty(o))throw iU.createInvalidStateError(o,"Null, undefined or empty state");try{var s=o.split(RB.RESOURCE_DELIM),l=s[0],h=s.length>1?s.slice(1).join(RB.RESOURCE_DELIM):RB.EMPTY_STRING,m=t.base64Decode(l),_=JSON.parse(m);return{userRequestState:sU.isEmpty(h)?RB.EMPTY_STRING:h,libraryState:_}}catch(t){throw iU.createInvalidStateError(o,t)}},ProtocolUtils}(),vq=function(){function UrlString(t){if(this._urlString=t,sU.isEmpty(this._urlString))throw NU.createUrlEmptyError();sU.isEmpty(this.getHash())&&(this._urlString=UrlString.canonicalizeUri(t))}return Object.defineProperty(UrlString.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),UrlString.canonicalizeUri=function(t){if(t){var o=t.toLowerCase();return sU.endsWith(o,"?")?o=o.slice(0,-1):sU.endsWith(o,"?/")&&(o=o.slice(0,-2)),sU.endsWith(o,"/")||(o+="/"),o}return t},UrlString.prototype.validateAsUri=function(){var t;try{t=this.getUrlComponents()}catch(t){throw NU.createUrlParseError(t)}if(!t.HostNameAndPort||!t.PathSegments)throw NU.createUrlParseError("Given url string: "+this.urlString);if(!t.Protocol||"https:"!==t.Protocol.toLowerCase())throw NU.createInsecureAuthorityUriError(this.urlString)},UrlString.appendQueryString=function(t,o){return sU.isEmpty(o)?t:t.indexOf("?")<0?t+"?"+o:t+"&"+o},UrlString.removeHashFromUrl=function(t){return UrlString.canonicalizeUri(t.split("#")[0])},UrlString.prototype.replaceTenantPath=function(t){var o=this.getUrlComponents(),s=o.PathSegments;return!t||0===s.length||s[0]!==AB.COMMON&&s[0]!==AB.ORGANIZATIONS||(s[0]=t),UrlString.constructAuthorityUriFromObject(o)},UrlString.prototype.getHash=function(){return UrlString.parseHash(this.urlString)},UrlString.prototype.getUrlComponents=function(){var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),o=this.urlString.match(t);if(!o)throw NU.createUrlParseError("Given url string: "+this.urlString);var s={Protocol:o[1],HostNameAndPort:o[4],AbsolutePath:o[5],QueryString:o[7]},l=s.AbsolutePath.split("/");return l=l.filter((function(t){return t&&t.length>0})),s.PathSegments=l,!sU.isEmpty(s.QueryString)&&s.QueryString.endsWith("/")&&(s.QueryString=s.QueryString.substring(0,s.QueryString.length-1)),s},UrlString.getDomainFromUrl=function(t){var o=RegExp("^([^:/?#]+://)?([^/?#]*)"),s=t.match(o);if(!s)throw NU.createUrlParseError("Given url string: "+t);return s[2]},UrlString.getAbsoluteUrl=function(t,o){if(t[0]===RB.FORWARD_SLASH){var s=new UrlString(o).getUrlComponents();return s.Protocol+"//"+s.HostNameAndPort+t}return t},UrlString.parseHash=function(t){var o=t.indexOf("#"),s=t.indexOf("#/");return s>-1?t.substring(s+2):o>-1?t.substring(o+1):RB.EMPTY_STRING},UrlString.parseQueryString=function(t){var o=t.indexOf("?"),s=t.indexOf("/?");return s>-1?t.substring(s+2):o>-1?t.substring(o+1):RB.EMPTY_STRING},UrlString.constructAuthorityUriFromObject=function(t){return new UrlString(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},UrlString.getDeserializedHash=function(t){if(sU.isEmpty(t))return{};var o=UrlString.parseHash(t),s=sU.queryStringToObject(sU.isEmpty(o)?t:o);if(!s)throw iU.createHashNotDeserializedError(JSON.stringify(s));return s},UrlString.getDeserializedQueryString=function(t){if(sU.isEmpty(t))return{};var o=UrlString.parseQueryString(t),s=sU.queryStringToObject(sU.isEmpty(o)?t:o);if(!s)throw iU.createHashNotDeserializedError(JSON.stringify(s));return s},UrlString.hashContainsKnownProperties=function(t){if(sU.isEmpty(t)||t.indexOf("=")<0)return!1;var o=UrlString.getDeserializedHash(t);return!!(o.code||o.error_description||o.error||o.state)},UrlString}();
/*! @azure/msal-common v13.3.0 2023-08-24 */!function(t){t.AcquireTokenByCode="acquireTokenByCode",t.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",t.AcquireTokenSilent="acquireTokenSilent",t.AcquireTokenSilentAsync="acquireTokenSilentAsync",t.AcquireTokenPopup="acquireTokenPopup",t.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",t.CryptoOptsSignJwt="cryptoOptsSignJwt",t.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",t.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",t.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",t.SsoSilent="ssoSilent",t.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",t.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",t.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",t.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",t.BrokerHandhshake="brokerHandshake",t.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",t.AcquireTokenByBroker="acquireTokenByBroker",t.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",t.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",t.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",t.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",t.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",t.AcquireTokenFromCache="acquireTokenFromCache",t.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",t.InitializeBaseRequest="initializeBaseRequest",t.InitializeSilentRequest="initializeSilentRequest",t.InitializeClientApplication="initializeClientApplication",t.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",t.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",t.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",t.SilentHandlerLoadFrame="silentHandlerLoadFrame",t.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",t.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",t.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",t.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",t.GetAuthCodeUrl="getAuthCodeUrl",t.HandleCodeResponseFromServer="handleCodeResponseFromServer",t.HandleCodeResponseFromHash="handleCodeResponseFromHash",t.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",t.AuthClientAcquireToken="authClientAcquireToken",t.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",t.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",t.AuthClientCreateQueryString="authClientCreateQueryString",t.PopTokenGenerateCnf="popTokenGenerateCnf",t.PopTokenGenerateKid="popTokenGenerateKid",t.HandleServerTokenResponse="handleServerTokenResponse",t.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",t.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",t.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",t.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",t.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",t.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",t.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",t.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",t.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",t.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",t.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",t.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",t.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",t.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",t.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",t.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken",t.NativeMessageHandlerHandshake="nativeMessageHandlerHandshake",t.ClearTokensAndKeysWithClaims="clearTokensAndKeysWithClaims"}(XU||(XU={})),function(t){t[t.NotStarted=0]="NotStarted",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed"}(eq||(eq={}));var mq,yq=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"]);
/*! @azure/msal-common v13.3.0 2023-08-24 */!function(t){t.SW="sw",t.UHW="uhw"}(mq||(mq={}));var bq=function(){function PopTokenGenerator(t,o){this.cryptoUtils=t,this.performanceClient=o}return PopTokenGenerator.prototype.generateCnf=function(t){var o,s;return __awaiter$1(this,void 0,void 0,(function(){var l,h,m;return __generator(this,(function(_){switch(_.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(XU.PopTokenGenerateCnf,t.correlationId),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(XU.PopTokenGenerateKid,t.correlationId),[4,this.generateKid(t)];case 1:return l=_.sent(),h=this.cryptoUtils.base64Encode(JSON.stringify(l)),m={kid:l.kid,reqCnfString:h},[4,this.cryptoUtils.hashString(h)];case 2:return[2,(m.reqCnfHash=_.sent(),m)]}}))}))},PopTokenGenerator.prototype.generateKid=function(t){var o;return __awaiter$1(this,void 0,void 0,(function(){return __generator(this,(function(s){switch(s.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(XU.PopTokenGenerateKid,t.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(t)];case 1:return[2,{kid:s.sent(),xms_ksl:mq.SW}]}}))}))},PopTokenGenerator.prototype.signPopToken=function(t,o,s){return __awaiter$1(this,void 0,void 0,(function(){return __generator(this,(function(l){return[2,this.signPayload(t,o,s)]}))}))},PopTokenGenerator.prototype.signPayload=function(t,o,s,l){return __awaiter$1(this,void 0,void 0,(function(){var h,m,_,E,$,B;return __generator(this,(function(q){switch(q.label){case 0:return h=s.resourceRequestMethod,m=s.resourceRequestUri,_=s.shrClaims,E=s.shrNonce,$=m?new vq(m):void 0,B=null==$?void 0:$.getUrlComponents(),[4,this.cryptoUtils.signJwt(__assign({at:t,ts:sq.nowSeconds(),m:null==h?void 0:h.toUpperCase(),u:null==B?void 0:B.HostNameAndPort,nonce:E||this.cryptoUtils.createNewGuid(),p:null==B?void 0:B.AbsolutePath,q:(null==B?void 0:B.QueryString)?[[],B.QueryString]:void 0,client_claims:_||void 0},l),o,s.correlationId)];case 1:return[2,q.sent()]}}))}))},PopTokenGenerator}(),wq=function(){function AppMetadataEntity(){}return AppMetadataEntity.prototype.generateAppMetadataKey=function(){return AppMetadataEntity.generateAppMetadataCacheKey(this.environment,this.clientId)},AppMetadataEntity.generateAppMetadataCacheKey=function(t,o){return[zB,t,o].join(BB.CACHE_KEY_SEPARATOR).toLowerCase()},AppMetadataEntity.createAppMetadataEntity=function(t,o,s){var l=new AppMetadataEntity;return l.clientId=t,l.environment=o,s&&(l.familyId=s),l},AppMetadataEntity.isAppMetadataEntity=function(t,o){return!!o&&(0===t.indexOf(zB)&&o.hasOwnProperty("clientId")&&o.hasOwnProperty("environment"))},AppMetadataEntity}(),Cq=function(){function TokenCacheContext(t,o){this.cache=t,this.hasChanged=o}return Object.defineProperty(TokenCacheContext.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(TokenCacheContext.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),TokenCacheContext}(),_q=function(){function ResponseHandler(t,o,s,l,h,m,_){this.clientId=t,this.cacheStorage=o,this.cryptoObj=s,this.logger=l,this.serializableCache=h,this.persistencePlugin=m,this.performanceClient=_}return ResponseHandler.prototype.validateServerAuthorizationCodeResponse=function(t,o,s){if(!t.state||!o)throw t.state?iU.createStateNotFoundError("Cached State"):iU.createStateNotFoundError("Server State");if(decodeURIComponent(t.state)!==decodeURIComponent(o))throw iU.createStateMismatchError();if(t.error||t.error_description||t.suberror){if(pq.isInteractionRequiredError(t.error,t.error_description,t.suberror))throw new pq(t.error||RB.EMPTY_STRING,t.error_description,t.suberror,t.timestamp||RB.EMPTY_STRING,t.trace_id||RB.EMPTY_STRING,t.correlation_id||RB.EMPTY_STRING,t.claims||RB.EMPTY_STRING);throw new YU(t.error||RB.EMPTY_STRING,t.error_description,t.suberror)}t.client_info&&buildClientInfo(t.client_info,s)},ResponseHandler.prototype.validateTokenResponse=function(t){if(t.error||t.error_description||t.suberror){if(pq.isInteractionRequiredError(t.error,t.error_description,t.suberror))throw new pq(t.error,t.error_description,t.suberror,t.timestamp||RB.EMPTY_STRING,t.trace_id||RB.EMPTY_STRING,t.correlation_id||RB.EMPTY_STRING,t.claims||RB.EMPTY_STRING);var o=t.error_codes+" - ["+t.timestamp+"]: "+t.error_description+" - Correlation ID: "+t.correlation_id+" - Trace ID: "+t.trace_id;throw new YU(t.error,o,t.suberror)}},ResponseHandler.prototype.handleServerTokenResponse=function(t,o,s,l,h,m,_,E,$){var B;return __awaiter$1(this,void 0,void 0,(function(){var q,j,K,W,X,re;return __generator(this,(function(oe){switch(oe.label){case 0:if(null===(B=this.performanceClient)||void 0===B||B.addQueueMeasurement(XU.HandleServerTokenResponse,t.correlation_id),t.id_token){if(q=new FU(t.id_token||RB.EMPTY_STRING,this.cryptoObj),h&&!sU.isEmpty(h.nonce)&&q.claims.nonce!==h.nonce)throw iU.createNonceMismatchError();if(l.maxAge||0===l.maxAge){if(!(j=q.claims.auth_time))throw iU.createAuthTimeNotFoundError();FU.checkMaxAge(j,l.maxAge)}}this.homeAccountIdentifier=LU.generateHomeAccountId(t.client_info||RB.EMPTY_STRING,o.authorityType,this.logger,this.cryptoObj,q),h&&h.state&&(K=gq.parseRequestState(this.cryptoObj,h.state)),t.key_id=t.key_id||l.sshKid||void 0,W=this.generateCacheRecord(t,o,s,l,q,m,h),oe.label=1;case 1:return oe.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),X=new Cq(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(X)]):[3,3];case 2:oe.sent(),oe.label=3;case 3:return!_||E||!W.account||(re=W.account.generateAccountKey(),this.cacheStorage.getAccount(re))?[4,this.cacheStorage.saveCacheRecord(W)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,ResponseHandler.generateAuthenticationResult(this.cryptoObj,o,W,!1,l,q,K,void 0,$)]);case 4:return oe.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&X?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(X)]):[3,7];case 6:oe.sent(),oe.label=7;case 7:return[7];case 8:return[2,ResponseHandler.generateAuthenticationResult(this.cryptoObj,o,W,!1,l,q,K,t,$)]}}))}))},ResponseHandler.prototype.generateCacheRecord=function(t,o,s,l,h,m,_){var E,$,B=o.getPreferredCache();if(sU.isEmpty(B))throw iU.createInvalidCacheEnvironmentError();!sU.isEmpty(t.id_token)&&h&&(E=iq.createIdTokenEntity(this.homeAccountIdentifier,B,t.id_token||RB.EMPTY_STRING,this.clientId,h.claims.tid||RB.EMPTY_STRING),$=this.generateAccountEntity(t,h,o,_));var q=null;if(!sU.isEmpty(t.access_token)){var j=t.scope?DU.fromString(t.scope):new DU(l.scopes||[]),K=("string"==typeof t.expires_in?parseInt(t.expires_in,10):t.expires_in)||0,W=("string"==typeof t.ext_expires_in?parseInt(t.ext_expires_in,10):t.ext_expires_in)||0,X=("string"==typeof t.refresh_in?parseInt(t.refresh_in,10):t.refresh_in)||void 0,re=s+K,oe=re+W,ne=X&&X>0?s+X:void 0;q=aq.createAccessTokenEntity(this.homeAccountIdentifier,B,t.access_token||RB.EMPTY_STRING,this.clientId,h?h.claims.tid||RB.EMPTY_STRING:o.tenant,j.printScopes(),re,oe,this.cryptoObj,ne,t.token_type,m,t.key_id,l.claims,l.requestedClaimsHash)}var ae=null;sU.isEmpty(t.refresh_token)||(ae=lq.createRefreshTokenEntity(this.homeAccountIdentifier,B,t.refresh_token||RB.EMPTY_STRING,this.clientId,t.foci,m));var le=null;return sU.isEmpty(t.foci)||(le=wq.createAppMetadataEntity(this.clientId,B,t.foci)),new fq($,E,q,ae,le)},ResponseHandler.prototype.generateAccountEntity=function(t,o,s,l){var h=s.authorityType,m=l?l.cloud_graph_host_name:RB.EMPTY_STRING,_=l?l.msgraph_host:RB.EMPTY_STRING;if(h===uU.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),LU.createGenericAccount(this.homeAccountIdentifier,o,s,m,_);if(sU.isEmpty(t.client_info)&&"AAD"===s.protocolMode)throw iU.createClientInfoEmptyError();return t.client_info?LU.createAccount(t.client_info,this.homeAccountIdentifier,o,s,m,_):LU.createGenericAccount(this.homeAccountIdentifier,o,s,m,_)},ResponseHandler.generateAuthenticationResult=function(t,o,s,l,h,m,_,E,$){var B,q,j;return __awaiter$1(this,void 0,void 0,(function(){var K,W,X,re,oe,ne,ae,le,de,me,we;return __generator(this,(function(_e){switch(_e.label){case 0:if(K=RB.EMPTY_STRING,W=[],X=null,oe=RB.EMPTY_STRING,!s.accessToken)return[3,4];if(s.accessToken.tokenType!==WB.POP)return[3,2];if(ne=new bq(t),ae=s.accessToken,le=ae.secret,!(de=ae.keyId))throw iU.createKeyIdMissingError();return[4,ne.signPopToken(le,de,h)];case 1:return K=_e.sent(),[3,3];case 2:K=s.accessToken.secret,_e.label=3;case 3:W=DU.fromString(s.accessToken.target).asArray(),X=new Date(1e3*Number(s.accessToken.expiresOn)),re=new Date(1e3*Number(s.accessToken.extendedExpiresOn)),_e.label=4;case 4:return s.appMetadata&&(oe=s.appMetadata.familyId===VB?VB:RB.EMPTY_STRING),me=(null==m?void 0:m.claims.oid)||(null==m?void 0:m.claims.sub)||RB.EMPTY_STRING,we=(null==m?void 0:m.claims.tid)||RB.EMPTY_STRING,(null==E?void 0:E.spa_accountid)&&s.account&&(s.account.nativeAccountId=null==E?void 0:E.spa_accountid),[2,{authority:o.canonicalAuthority,uniqueId:me,tenantId:we,scopes:W,account:s.account?s.account.getAccountInfo():null,idToken:m?m.rawToken:RB.EMPTY_STRING,idTokenClaims:m?m.claims:{},accessToken:K,fromCache:l,expiresOn:X,correlationId:h.correlationId,requestId:$||RB.EMPTY_STRING,extExpiresOn:re,familyId:oe,tokenType:(null===(B=s.accessToken)||void 0===B?void 0:B.tokenType)||RB.EMPTY_STRING,state:_?_.userRequestState:RB.EMPTY_STRING,cloudGraphHostName:(null===(q=s.account)||void 0===q?void 0:q.cloudGraphHostName)||RB.EMPTY_STRING,msGraphHost:(null===(j=s.account)||void 0===j?void 0:j.msGraphHost)||RB.EMPTY_STRING,code:null==E?void 0:E.spa_code,fromNativeBroker:!1}]}}))}))},ResponseHandler}(),kq=function(t){function AuthorizationCodeClient(o,s){var l=t.call(this,o,s)||this;return l.includeRedirectUri=!0,l}return __extends(AuthorizationCodeClient,t),AuthorizationCodeClient.prototype.getAuthCodeUrl=function(t){var o,s;return __awaiter$1(this,void 0,void 0,(function(){var l;return __generator(this,(function(h){switch(h.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(XU.GetAuthCodeUrl,t.correlationId),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(XU.AuthClientCreateQueryString,t.correlationId),[4,this.createAuthCodeUrlQueryString(t)];case 1:return l=h.sent(),[2,vq.appendQueryString(this.authority.authorizationEndpoint,l)]}}))}))},AuthorizationCodeClient.prototype.acquireToken=function(t,o){var s,l,h,m,_,E;return __awaiter$1(this,void 0,void 0,(function(){var $,B,q,j,K,W,X=this;return __generator(this,(function(re){switch(re.label){case 0:if(!t||!t.code)throw iU.createTokenRequestCannotBeMadeError();return null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(XU.AuthClientAcquireToken,t.correlationId),$=null===(l=this.performanceClient)||void 0===l?void 0:l.startMeasurement("AuthCodeClientAcquireToken",t.correlationId),this.logger.info("in acquireToken call in auth-code client"),B=sq.nowSeconds(),null===(h=this.performanceClient)||void 0===h||h.setPreQueueTime(XU.AuthClientExecuteTokenRequest,t.correlationId),[4,this.executeTokenRequest(this.authority,t)];case 1:return q=re.sent(),j=null===(m=q.headers)||void 0===m?void 0:m[TB.X_MS_REQUEST_ID],(K=null===(_=q.headers)||void 0===_?void 0:_[TB.X_MS_HTTP_VERSION])&&(null==$||$.addStaticFields({httpVerAuthority:K})),(W=new _q(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient)).validateTokenResponse(q.body),null===(E=this.performanceClient)||void 0===E||E.setPreQueueTime(XU.HandleServerTokenResponse,t.correlationId),[2,W.handleServerTokenResponse(q.body,this.authority,B,t,o,void 0,void 0,void 0,j).then((function(t){return null==$||$.endMeasurement({success:!0}),t})).catch((function(o){throw X.logger.verbose("Error in fetching token in ACC",t.correlationId),null==$||$.endMeasurement({errorCode:o.errorCode,subErrorCode:o.subError,success:!1}),o}))]}}))}))},AuthorizationCodeClient.prototype.handleFragmentResponse=function(t,o){var s=new _q(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),l=new vq(t),h=vq.getDeserializedHash(l.getHash());if(s.validateServerAuthorizationCodeResponse(h,o,this.cryptoUtils),!h.code)throw iU.createNoAuthCodeInServerResponseError();return __assign(__assign({},h),{code:h.code})},AuthorizationCodeClient.prototype.getLogoutUri=function(t){if(!t)throw NU.createEmptyLogoutRequestError();var o=this.createLogoutUrlQueryString(t);return vq.appendQueryString(this.authority.endSessionEndpoint,o)},AuthorizationCodeClient.prototype.executeTokenRequest=function(t,o){var s,l;return __awaiter$1(this,void 0,void 0,(function(){var h,m,_,E,$,B,q;return __generator(this,(function(j){switch(j.label){case 0:return null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(XU.AuthClientExecuteTokenRequest,o.correlationId),null===(l=this.performanceClient)||void 0===l||l.setPreQueueTime(XU.AuthClientCreateTokenRequestBody,o.correlationId),h=this.createTokenQueryParameters(o),m=vq.appendQueryString(t.tokenEndpoint,h),[4,this.createTokenRequestBody(o)];case 1:if(_=j.sent(),E=void 0,o.clientInfo)try{$=buildClientInfo(o.clientInfo,this.cryptoUtils),E={credential:""+$.uid+BB.CLIENT_INFO_SEPARATOR+$.utid,type:QU.HOME_ACCOUNT_ID}}catch(t){this.logger.verbose("Could not parse client info for CCS Header: "+t)}return B=this.createTokenRequestHeaders(E||o.ccsCredential),q={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:o.scopes,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},[2,this.executePostToTokenEndpoint(m,_,B,q)]}}))}))},AuthorizationCodeClient.prototype.createTokenRequestBody=function(t){var o,s;return __awaiter$1(this,void 0,void 0,(function(){var l,h,m,_,E,$,B,q;return __generator(this,(function(j){switch(j.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(XU.AuthClientCreateTokenRequestBody,t.correlationId),(l=new rq).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?l.addRedirectUri(t.redirectUri):tq.validateRedirectUri(t.redirectUri),l.addScopes(t.scopes),l.addAuthorizationCode(t.code),l.addLibraryInfo(this.config.libraryInfo),l.addApplicationTelemetry(this.config.telemetry.application),l.addThrottling(),this.serverTelemetryManager&&l.addServerTelemetry(this.serverTelemetryManager),t.codeVerifier&&l.addCodeVerifier(t.codeVerifier),this.config.clientCredentials.clientSecret&&l.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(h=this.config.clientCredentials.clientAssertion,l.addClientAssertion(h.assertion),l.addClientAssertionType(h.assertionType)),l.addGrantType(LB.AUTHORIZATION_CODE_GRANT),l.addClientInfo(),t.authenticationScheme!==WB.POP?[3,2]:(m=new bq(this.cryptoUtils,this.performanceClient),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(XU.PopTokenGenerateCnf,t.correlationId),[4,m.generateCnf(t)]);case 1:return _=j.sent(),l.addPopToken(_.reqCnfString),[3,3];case 2:if(t.authenticationScheme===WB.SSH){if(!t.sshJwk)throw NU.createMissingSshJwkError();l.addSshJwk(t.sshJwk)}j.label=3;case 3:if(E=t.correlationId||this.config.cryptoInterface.createNewGuid(),l.addCorrelationId(E),(!sU.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&l.addClaims(t.claims,this.config.authOptions.clientCapabilities),$=void 0,t.clientInfo)try{B=buildClientInfo(t.clientInfo,this.cryptoUtils),$={credential:""+B.uid+BB.CLIENT_INFO_SEPARATOR+B.utid,type:QU.HOME_ACCOUNT_ID}}catch(t){this.logger.verbose("Could not parse client info for CCS Header: "+t)}else $=t.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&$)switch($.type){case QU.HOME_ACCOUNT_ID:try{B=buildClientInfoFromHomeAccountId($.credential),l.addCcsOid(B)}catch(t){this.logger.verbose("Could not parse home account ID for CCS Header: "+t)}break;case QU.UPN:l.addCcsUpn($.credential)}return t.tokenBodyParameters&&l.addExtraQueryParameters(t.tokenBodyParameters),!t.enableSpaAuthorizationCode||t.tokenBodyParameters&&t.tokenBodyParameters[IB.RETURN_SPA_CODE]||l.addExtraQueryParameters(((q={})[IB.RETURN_SPA_CODE]="1",q)),[2,l.createQueryString()]}}))}))},AuthorizationCodeClient.prototype.createAuthCodeUrlQueryString=function(t){var o;return __awaiter$1(this,void 0,void 0,(function(){var s,l,h,m,_,E,$;return __generator(this,(function(B){switch(B.label){case 0:if(null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(XU.AuthClientCreateQueryString,t.correlationId),(s=new rq).addClientId(this.config.authOptions.clientId),l=__spreadArrays(t.scopes||[],t.extraScopesToConsent||[]),s.addScopes(l),s.addRedirectUri(t.redirectUri),h=t.correlationId||this.config.cryptoInterface.createNewGuid(),s.addCorrelationId(h),s.addResponseMode(t.responseMode),s.addResponseTypeCode(),s.addLibraryInfo(this.config.libraryInfo),s.addApplicationTelemetry(this.config.telemetry.application),s.addClientInfo(),t.codeChallenge&&t.codeChallengeMethod&&s.addCodeChallengeParams(t.codeChallenge,t.codeChallengeMethod),t.prompt&&s.addPrompt(t.prompt),t.domainHint&&s.addDomainHint(t.domainHint),t.prompt!==NB.SELECT_ACCOUNT)if(t.sid&&t.prompt===NB.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),s.addSid(t.sid);else if(t.account){if(m=this.extractAccountSid(t.account),_=this.extractLoginHint(t.account)){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),s.addLoginHint(_);try{E=buildClientInfoFromHomeAccountId(t.account.homeAccountId),s.addCcsOid(E)}catch(t){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(m&&t.prompt===NB.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),s.addSid(m);try{E=buildClientInfoFromHomeAccountId(t.account.homeAccountId),s.addCcsOid(E)}catch(t){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),s.addLoginHint(t.loginHint),s.addCcsUpn(t.loginHint);else if(t.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),s.addLoginHint(t.account.username);try{E=buildClientInfoFromHomeAccountId(t.account.homeAccountId),s.addCcsOid(E)}catch(t){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),s.addLoginHint(t.loginHint),s.addCcsUpn(t.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return t.nonce&&s.addNonce(t.nonce),t.state&&s.addState(t.state),(!sU.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&s.addClaims(t.claims,this.config.authOptions.clientCapabilities),t.extraQueryParameters&&s.addExtraQueryParameters(t.extraQueryParameters),t.nativeBroker?(s.addNativeBroker(),t.authenticationScheme!==WB.POP?[3,2]:[4,new bq(this.cryptoUtils).generateCnf(t)]):[3,2];case 1:$=B.sent(),s.addPopToken($.reqCnfString),B.label=2;case 2:return[2,s.createQueryString()]}}))}))},AuthorizationCodeClient.prototype.createLogoutUrlQueryString=function(t){var o=new rq;return t.postLogoutRedirectUri&&o.addPostLogoutRedirectUri(t.postLogoutRedirectUri),t.correlationId&&o.addCorrelationId(t.correlationId),t.idTokenHint&&o.addIdTokenHint(t.idTokenHint),t.state&&o.addState(t.state),t.logoutHint&&o.addLogoutHint(t.logoutHint),t.extraQueryParameters&&o.addExtraQueryParameters(t.extraQueryParameters),o.createQueryString()},AuthorizationCodeClient.prototype.extractAccountSid=function(t){var o;return(null===(o=t.idTokenClaims)||void 0===o?void 0:o.sid)||null},AuthorizationCodeClient.prototype.extractLoginHint=function(t){var o;return(null===(o=t.idTokenClaims)||void 0===o?void 0:o.login_hint)||null},AuthorizationCodeClient}(oq),xq=function(t){function RefreshTokenClient(o,s){return t.call(this,o,s)||this}return __extends(RefreshTokenClient,t),RefreshTokenClient.prototype.acquireToken=function(t){var o,s,l,h,m,_,E;return __awaiter$1(this,void 0,void 0,(function(){var $,B,q,j,K,W,X=this;return __generator(this,(function(re){switch(re.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(XU.RefreshTokenClientAcquireToken,t.correlationId),$=null===(s=this.performanceClient)||void 0===s?void 0:s.startMeasurement(XU.RefreshTokenClientAcquireToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",t.correlationId),B=sq.nowSeconds(),null===(l=this.performanceClient)||void 0===l||l.setPreQueueTime(XU.RefreshTokenClientExecuteTokenRequest,t.correlationId),[4,this.executeTokenRequest(t,this.authority)];case 1:return q=re.sent(),j=null===(h=q.headers)||void 0===h?void 0:h[TB.X_MS_HTTP_VERSION],null==$||$.addStaticFields({refreshTokenSize:(null===(m=q.body.refresh_token)||void 0===m?void 0:m.length)||0}),j&&(null==$||$.addStaticFields({httpVerToken:j})),K=null===(_=q.headers)||void 0===_?void 0:_[TB.X_MS_REQUEST_ID],(W=new _q(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(q.body),null===(E=this.performanceClient)||void 0===E||E.setPreQueueTime(XU.HandleServerTokenResponse,t.correlationId),[2,W.handleServerTokenResponse(q.body,this.authority,B,t,void 0,void 0,!0,t.forceCache,K).then((function(t){return null==$||$.endMeasurement({success:!0}),t})).catch((function(o){throw X.logger.verbose("Error in fetching refresh token",t.correlationId),null==$||$.endMeasurement({errorCode:o.errorCode,subErrorCode:o.subError,success:!1}),o}))]}}))}))},RefreshTokenClient.prototype.acquireTokenByRefreshToken=function(t){var o,s,l,h;return __awaiter$1(this,void 0,void 0,(function(){var m,_;return __generator(this,(function(E){if(!t)throw NU.createEmptyTokenRequestError();if(null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(XU.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),!t.account)throw iU.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(t.account.environment))try{return null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(XU.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!0)]}catch(o){if(m=o instanceof pq&&o.errorCode===uq.code,_=o instanceof YU&&o.errorCode===sH&&o.subError===aH,m||_)return null===(l=this.performanceClient)||void 0===l||l.setPreQueueTime(XU.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!1)];throw o}return null===(h=this.performanceClient)||void 0===h||h.setPreQueueTime(XU.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),[2,this.acquireTokenWithCachedRefreshToken(t,!1)]}))}))},RefreshTokenClient.prototype.acquireTokenWithCachedRefreshToken=function(t,o){var s,l,h;return __awaiter$1(this,void 0,void 0,(function(){var m,_,E;return __generator(this,(function($){if(null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(XU.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),m=null===(l=this.performanceClient)||void 0===l?void 0:l.startMeasurement(XU.RefreshTokenClientAcquireTokenWithCachedRefreshToken,t.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",t.correlationId),!(_=this.cacheManager.getRefreshToken(t.account,o)))throw null==m||m.discardMeasurement(),pq.createNoTokensFoundError();return null==m||m.endMeasurement({success:!0}),E=__assign(__assign({},t),{refreshToken:_.secret,authenticationScheme:t.authenticationScheme||WB.BEARER,ccsCredential:{credential:t.account.homeAccountId,type:QU.HOME_ACCOUNT_ID}}),null===(h=this.performanceClient)||void 0===h||h.setPreQueueTime(XU.RefreshTokenClientAcquireToken,t.correlationId),[2,this.acquireToken(E)]}))}))},RefreshTokenClient.prototype.executeTokenRequest=function(t,o){var s,l,h;return __awaiter$1(this,void 0,void 0,(function(){var m,_,E,$,B,q;return __generator(this,(function(j){switch(j.label){case 0:return null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(XU.RefreshTokenClientExecuteTokenRequest,t.correlationId),m=null===(l=this.performanceClient)||void 0===l?void 0:l.startMeasurement(XU.RefreshTokenClientExecuteTokenRequest,t.correlationId),null===(h=this.performanceClient)||void 0===h||h.setPreQueueTime(XU.RefreshTokenClientCreateTokenRequestBody,t.correlationId),_=this.createTokenQueryParameters(t),E=vq.appendQueryString(o.tokenEndpoint,_),[4,this.createTokenRequestBody(t)];case 1:return $=j.sent(),B=this.createTokenRequestHeaders(t.ccsCredential),q={clientId:this.config.authOptions.clientId,authority:o.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},[2,this.executePostToTokenEndpoint(E,$,B,q).then((function(t){return null==m||m.endMeasurement({success:!0}),t})).catch((function(t){throw null==m||m.endMeasurement({success:!1}),t}))]}}))}))},RefreshTokenClient.prototype.createTokenRequestBody=function(t){var o,s,l;return __awaiter$1(this,void 0,void 0,(function(){var h,m,_,E,$,B,q;return __generator(this,(function(j){switch(j.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(XU.RefreshTokenClientCreateTokenRequestBody,t.correlationId),h=t.correlationId,m=null===(s=this.performanceClient)||void 0===s?void 0:s.startMeasurement(XU.BaseClientCreateTokenRequestHeaders,h),(_=new rq).addClientId(this.config.authOptions.clientId),_.addScopes(t.scopes),_.addGrantType(LB.REFRESH_TOKEN_GRANT),_.addClientInfo(),_.addLibraryInfo(this.config.libraryInfo),_.addApplicationTelemetry(this.config.telemetry.application),_.addThrottling(),this.serverTelemetryManager&&_.addServerTelemetry(this.serverTelemetryManager),_.addCorrelationId(h),_.addRefreshToken(t.refreshToken),this.config.clientCredentials.clientSecret&&_.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(E=this.config.clientCredentials.clientAssertion,_.addClientAssertion(E.assertion),_.addClientAssertionType(E.assertionType)),t.authenticationScheme!==WB.POP?[3,2]:($=new bq(this.cryptoUtils,this.performanceClient),null===(l=this.performanceClient)||void 0===l||l.setPreQueueTime(XU.PopTokenGenerateCnf,t.correlationId),[4,$.generateCnf(t)]);case 1:return B=j.sent(),_.addPopToken(B.reqCnfString),[3,3];case 2:if(t.authenticationScheme===WB.SSH){if(!t.sshJwk)throw null==m||m.endMeasurement({success:!1}),NU.createMissingSshJwkError();_.addSshJwk(t.sshJwk)}j.label=3;case 3:if((!sU.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&_.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.ccsCredential)switch(t.ccsCredential.type){case QU.HOME_ACCOUNT_ID:try{q=buildClientInfoFromHomeAccountId(t.ccsCredential.credential),_.addCcsOid(q)}catch(t){this.logger.verbose("Could not parse home account ID for CCS Header: "+t)}break;case QU.UPN:_.addCcsUpn(t.ccsCredential.credential)}return null==m||m.endMeasurement({success:!0}),[2,_.createQueryString()]}}))}))},RefreshTokenClient}(oq),Sq=function(t){function SilentFlowClient(o,s){return t.call(this,o,s)||this}return __extends(SilentFlowClient,t),SilentFlowClient.prototype.acquireToken=function(t){return __awaiter$1(this,void 0,void 0,(function(){var o;return __generator(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.acquireCachedToken(t)];case 1:return[2,s.sent()];case 2:if((o=s.sent())instanceof iU&&o.errorCode===YH.code)return[2,new xq(this.config,this.performanceClient).acquireTokenByRefreshToken(t)];throw o;case 3:return[2]}}))}))},SilentFlowClient.prototype.acquireCachedToken=function(t){var o,s,l,h,m;return __awaiter$1(this,void 0,void 0,(function(){var _,E;return __generator(this,(function($){switch($.label){case 0:if(!t)throw NU.createEmptyTokenRequestError();if(t.forceRefresh)throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome(eH.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),iU.createRefreshRequiredError();if(!this.config.cacheOptions.claimsBasedCachingEnabled&&!sU.isEmptyObj(t.claims))throw null===(s=this.serverTelemetryManager)||void 0===s||s.setCacheOutcome(eH.CLAIMS_REQUESTED_CACHE_SKIPPED),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because claims-based caching is disabled and claims were requested."),iU.createRefreshRequiredError();if(!t.account)throw iU.createNoAccountInSilentRequestError();if(_=t.authority||this.authority.getPreferredCache(),!(E=this.cacheManager.readCacheRecord(t.account,t,_)).accessToken)throw null===(l=this.serverTelemetryManager)||void 0===l||l.setCacheOutcome(eH.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),iU.createRefreshRequiredError();if(sq.wasClockTurnedBack(E.accessToken.cachedAt)||sq.isTokenExpired(E.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(h=this.serverTelemetryManager)||void 0===h||h.setCacheOutcome(eH.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),iU.createRefreshRequiredError();if(E.accessToken.refreshOn&&sq.isTokenExpired(E.accessToken.refreshOn,0))throw null===(m=this.serverTelemetryManager)||void 0===m||m.setCacheOutcome(eH.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),iU.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(E,t)];case 1:return[2,$.sent()]}}))}))},SilentFlowClient.prototype.generateResultFromCacheRecord=function(t,o){return __awaiter$1(this,void 0,void 0,(function(){var s,l;return __generator(this,(function(h){switch(h.label){case 0:if(t.idToken&&(s=new FU(t.idToken.secret,this.config.cryptoInterface)),o.maxAge||0===o.maxAge){if(!(l=null==s?void 0:s.claims.auth_time))throw iU.createAuthTimeNotFoundError();FU.checkMaxAge(l,o.maxAge)}return[4,_q.generateAuthenticationResult(this.cryptoUtils,this.authority,t,!0,o,s)];case 1:return[2,h.sent()]}}))}))},SilentFlowClient}(oq);
/*! @azure/msal-common v13.3.0 2023-08-24 */
/*! @azure/msal-common v13.3.0 2023-08-24 */
function isOpenIdConfigResponse(t){return t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("jwks_uri")}
/*! @azure/msal-common v13.3.0 2023-08-24 */var Tq,Eq={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},Aq={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}};!function(t){t.AAD="AAD",t.OIDC="OIDC"}(Tq||(Tq={}));
/*! @azure/msal-common v13.3.0 2023-08-24 */
var Iq=function(){function AuthorityMetadataEntity(){this.expiresAt=sq.nowSeconds()+KB}return AuthorityMetadataEntity.prototype.updateCloudDiscoveryMetadata=function(t,o){this.aliases=t.aliases,this.preferred_cache=t.preferred_cache,this.preferred_network=t.preferred_network,this.aliasesFromNetwork=o},AuthorityMetadataEntity.prototype.updateEndpointMetadata=function(t,o){this.authorization_endpoint=t.authorization_endpoint,this.token_endpoint=t.token_endpoint,this.end_session_endpoint=t.end_session_endpoint,this.issuer=t.issuer,this.endpointsFromNetwork=o,this.jwks_uri=t.jwks_uri},AuthorityMetadataEntity.prototype.updateCanonicalAuthority=function(t){this.canonical_authority=t},AuthorityMetadataEntity.prototype.resetExpiresAt=function(){this.expiresAt=sq.nowSeconds()+KB},AuthorityMetadataEntity.prototype.isExpired=function(){return this.expiresAt<=sq.nowSeconds()},AuthorityMetadataEntity.isAuthorityMetadataEntity=function(t,o){return!!o&&(0===t.indexOf(GB)&&o.hasOwnProperty("aliases")&&o.hasOwnProperty("preferred_cache")&&o.hasOwnProperty("preferred_network")&&o.hasOwnProperty("canonical_authority")&&o.hasOwnProperty("authorization_endpoint")&&o.hasOwnProperty("token_endpoint")&&o.hasOwnProperty("issuer")&&o.hasOwnProperty("aliasesFromNetwork")&&o.hasOwnProperty("endpointsFromNetwork")&&o.hasOwnProperty("expiresAt")&&o.hasOwnProperty("jwks_uri"))},AuthorityMetadataEntity}();
/*! @azure/msal-common v13.3.0 2023-08-24 */
/*! @azure/msal-common v13.3.0 2023-08-24 */
var Pq,Rq,$q,Mq,Oq,Nq,Dq,Lq,Fq,Bq=function(){function RegionDiscovery(t,o,s){this.networkInterface=t,this.performanceClient=o,this.correlationId=s}return RegionDiscovery.prototype.detectRegion=function(t,o){var s,l,h,m;return __awaiter$1(this,void 0,void 0,(function(){var _,E,$,B,q;return __generator(this,(function(j){switch(j.label){case 0:if(null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(XU.RegionDiscoveryDetectRegion,this.correlationId),_=t)return[3,8];E=RegionDiscovery.IMDS_OPTIONS,j.label=1;case 1:return j.trys.push([1,6,,7]),null===(l=this.performanceClient)||void 0===l||l.setPreQueueTime(XU.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(RB.IMDS_VERSION,E)];case 2:return($=j.sent()).status===ZB.httpSuccess&&(_=$.body,o.region_source=JB.IMDS),$.status!==ZB.httpBadRequest?[3,5]:(null===(h=this.performanceClient)||void 0===h||h.setPreQueueTime(XU.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(E)]);case 3:return(B=j.sent())?(null===(m=this.performanceClient)||void 0===m||m.setPreQueueTime(XU.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(B,E)]):(o.region_source=JB.FAILED_AUTO_DETECTION,[2,null]);case 4:(q=j.sent()).status===ZB.httpSuccess&&(_=q.body,o.region_source=JB.IMDS),j.label=5;case 5:return[3,7];case 6:return j.sent(),o.region_source=JB.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:o.region_source=JB.ENVIRONMENT_VARIABLE,j.label=9;case 9:return _||(o.region_source=JB.FAILED_AUTO_DETECTION),[2,_||null]}}))}))},RegionDiscovery.prototype.getRegionFromIMDS=function(t,o){var s;return __awaiter$1(this,void 0,void 0,(function(){return __generator(this,(function(l){return null===(s=this.performanceClient)||void 0===s||s.addQueueMeasurement(XU.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(RB.IMDS_ENDPOINT+"?api-version="+t+"&format=text",o,RB.IMDS_TIMEOUT)]}))}))},RegionDiscovery.prototype.getCurrentVersion=function(t){var o;return __awaiter$1(this,void 0,void 0,(function(){var s;return __generator(this,(function(l){switch(l.label){case 0:null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(XU.RegionDiscoveryGetCurrentVersion,this.correlationId),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(RB.IMDS_ENDPOINT+"?format=json",t)];case 2:return(s=l.sent()).status===ZB.httpBadRequest&&s.body&&s.body["newest-versions"]&&s.body["newest-versions"].length>0?[2,s.body["newest-versions"][0]]:[2,null];case 3:return l.sent(),[2,null];case 4:return[2]}}))}))},RegionDiscovery.IMDS_OPTIONS={headers:{Metadata:"true"}},RegionDiscovery}(),Hq=function(){function Authority(t,o,s,l,h,m,_){this.canonicalAuthority=t,this._canonicalAuthority.validateAsUri(),this.networkInterface=o,this.cacheManager=s,this.authorityOptions=l,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=h,this.performanceClient=m,this.correlationId=_,this.regionDiscovery=new Bq(o,this.performanceClient,this.correlationId)}return Authority.prototype.getAuthorityType=function(t){if(t.HostNameAndPort.endsWith(RB.CIAM_AUTH_URL))return uU.Ciam;var o=t.PathSegments;if(o.length)switch(o[0].toLowerCase()){case RB.ADFS:return uU.Adfs;case RB.DSTS:return uU.Dsts}return uU.Default},Object.defineProperty(Authority.prototype,"authorityType",{get:function(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(t){this._canonicalAuthority=new vq(t),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw iU.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw iU.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw iU.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw iU.createLogoutNotSupportedError();return this.replacePath(this.metadata.end_session_endpoint)}throw iU.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw iU.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(Authority.prototype,"jwksUri",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw iU.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Authority.prototype.canReplaceTenant=function(t){return 1===t.PathSegments.length&&!Authority.reservedTenantDomains.has(t.PathSegments[0])&&this.getAuthorityType(t)===uU.Default&&this.protocolMode===Tq.AAD},Authority.prototype.replaceTenant=function(t){return t.replace(/{tenant}|{tenantid}/g,this.tenant)},Authority.prototype.replacePath=function(t){var o=this,s=t,l=new vq(this.metadata.canonical_authority).getUrlComponents(),h=l.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(t,m){var _=h[m];if(0===m&&o.canReplaceTenant(l)){var E=new vq(o.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];_!==E&&(o.logger.verbose("Replacing tenant domain name "+_+" with id "+E),_=E)}t!==_&&(s=s.replace("/"+_+"/","/"+t+"/"))})),this.replaceTenant(s)},Object.defineProperty(Authority.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===uU.Adfs||this.authorityType===uU.Dsts||this.protocolMode===Tq.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),Authority.prototype.discoveryComplete=function(){return!!this.metadata},Authority.prototype.resolveEndpointsAsync=function(){var t,o,s;return __awaiter$1(this,void 0,void 0,(function(){var l,h,m,_;return __generator(this,(function(E){switch(E.label){case 0:return null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(XU.AuthorityResolveEndpointsAsync,this.correlationId),(l=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(l=new Iq).updateCanonicalAuthority(this.canonicalAuthority),null===(o=this.performanceClient)||void 0===o||o.setPreQueueTime(XU.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(l)];case 1:return h=E.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,l.preferred_network),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(XU.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(l)];case 2:return m=E.sent(),h!==jB.CACHE&&m!==jB.CACHE&&(l.resetExpiresAt(),l.updateCanonicalAuthority(this.canonicalAuthority)),_=this.cacheManager.generateAuthorityMetadataCacheKey(l.preferred_cache),this.cacheManager.setAuthorityMetadata(_,l),this.metadata=l,[2]}}))}))},Authority.prototype.updateEndpointMetadata=function(t){var o,s,l,h,m,_;return __awaiter$1(this,void 0,void 0,(function(){var E,$;return __generator(this,(function(B){switch(B.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(XU.AuthorityUpdateEndpointMetadata,this.correlationId),(E=this.getEndpointMetadataFromConfig())?(t.updateEndpointMetadata(E,!1),[2,jB.CONFIG]):this.isAuthoritySameType(t)&&t.endpointsFromNetwork&&!t.isExpired()?[2,jB.CACHE]:(null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(XU.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return(E=B.sent())?(null===(l=this.authorityOptions.azureRegionConfiguration)||void 0===l?void 0:l.azureRegion)?(null===(h=this.performanceClient)||void 0===h||h.setPreQueueTime(XU.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(E)]):[3,3]:[3,4];case 2:E=B.sent(),B.label=3;case 3:return t.updateEndpointMetadata(E,!0),[2,jB.NETWORK];case 4:return!($=this.getEndpointMetadataFromHardcodedValues())||this.authorityOptions.skipAuthorityMetadataCache?[3,7]:(null===(m=this.authorityOptions.azureRegionConfiguration)||void 0===m?void 0:m.azureRegion)?(null===(_=this.performanceClient)||void 0===_||_.setPreQueueTime(XU.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation($)]):[3,6];case 5:$=B.sent(),B.label=6;case 6:return t.updateEndpointMetadata($,!1),[2,jB.HARDCODED_VALUES];case 7:throw iU.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},Authority.prototype.isAuthoritySameType=function(t){return new vq(t.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},Authority.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(t){throw NU.createInvalidAuthorityMetadataError()}return null},Authority.prototype.getEndpointMetadataFromNetwork=function(){var t;return __awaiter$1(this,void 0,void 0,(function(){var o,s;return __generator(this,(function(l){switch(l.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(XU.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),o={},l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,o)];case 2:return[2,isOpenIdConfigResponse((s=l.sent()).body)?s.body:null];case 3:return l.sent(),[2,null];case 4:return[2]}}))}))},Authority.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in Eq?Eq[this.canonicalAuthority]:null},Authority.prototype.updateMetadataWithRegionalInformation=function(t){var o,s,l,h;return __awaiter$1(this,void 0,void 0,(function(){var m,_;return __generator(this,(function(E){switch(E.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(XU.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),(m=null===(s=this.authorityOptions.azureRegionConfiguration)||void 0===s?void 0:s.azureRegion)?m!==RB.AZURE_REGION_AUTO_DISCOVER_FLAG?(this.regionDiscoveryMetadata.region_outcome=XB.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=m,[2,Authority.replaceWithRegionalInformation(t,m)]):(null===(l=this.performanceClient)||void 0===l||l.setPreQueueTime(XU.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion(null===(h=this.authorityOptions.azureRegionConfiguration)||void 0===h?void 0:h.environmentRegion,this.regionDiscoveryMetadata)]):[3,2];case 1:if(_=E.sent())return this.regionDiscoveryMetadata.region_outcome=XB.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=_,[2,Authority.replaceWithRegionalInformation(t,_)];this.regionDiscoveryMetadata.region_outcome=XB.AUTO_DETECTION_REQUESTED_FAILED,E.label=2;case 2:return[2,t]}}))}))},Authority.prototype.updateCloudDiscoveryMetadata=function(t){var o,s;return __awaiter$1(this,void 0,void 0,(function(){var l,h,m;return __generator(this,(function(_){switch(_.label){case 0:return null===(o=this.performanceClient)||void 0===o||o.addQueueMeasurement(XU.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||RB.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||RB.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(t.canonical_authority||RB.NOT_APPLICABLE)),(l=this.getCloudDiscoveryMetadataFromConfig())?(this.logger.verbose("Found cloud discovery metadata in the config."),t.updateCloudDiscoveryMetadata(l,!1),[2,jB.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),h=t.isExpired(),this.isAuthoritySameType(t)&&t.aliasesFromNetwork&&!h?(this.logger.verbose("Found metadata in the cache."),[2,jB.CACHE]):(h&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),null===(s=this.performanceClient)||void 0===s||s.setPreQueueTime(XU.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(l=_.sent())return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),t.updateCloudDiscoveryMetadata(l,!0),[2,jB.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),(m=this.getCloudDiscoveryMetadataFromHarcodedValues())&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),t.updateCloudDiscoveryMetadata(m,!1),[2,jB.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),NU.createUntrustedAuthorityError()}}))}))},Authority.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityType===uU.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),Authority.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),o=Authority.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),o)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),o;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(t){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),NU.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Authority.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},Authority.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var t;return __awaiter$1(this,void 0,void 0,(function(){var o,s,l,h,m,_,E,$;return __generator(this,(function(B){switch(B.label){case 0:null===(t=this.performanceClient)||void 0===t||t.addQueueMeasurement(XU.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),o=""+RB.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",s={},l=null,B.label=1;case 1:return B.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(o,s)];case 2:if(h=B.sent(),m=void 0,_=void 0,function isCloudInstanceDiscoveryResponse(t){return t.hasOwnProperty("tenant_discovery_endpoint")&&t.hasOwnProperty("metadata")}
/*! @azure/msal-common v13.3.0 2023-08-24 */(h.body))m=h.body,_=m.metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+m.tenant_discovery_endpoint);else{if(!function isCloudInstanceDiscoveryErrorResponse(t){return t.hasOwnProperty("error")&&t.hasOwnProperty("error_description")}(h.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+h.status),(m=h.body).error===RB.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+m.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+m.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),_=[]}return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),l=Authority.getCloudDiscoveryMetadataFromNetworkResponse(_,this.hostnameAndPort),[3,4];case 3:return(E=B.sent())instanceof uH?this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: "+E.errorCode+"\nError Description: "+E.errorMessage):($=E,this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: "+$.name+"\nError Description: "+$.message)),[2,null];case 4:return l||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),l=Authority.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,l]}}))}))},Authority.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in Aq?Aq[this.canonicalAuthority]:null},Authority.prototype.isInKnownAuthorities=function(){var t=this;return this.authorityOptions.knownAuthorities.filter((function(o){return vq.getDomainFromUrl(o).toLowerCase()===t.hostnameAndPort})).length>0},Authority.generateAuthority=function(t,o){var s;if(o&&o.azureCloudInstance!==aU.None){var l=o.tenant?o.tenant:RB.DEFAULT_COMMON_TENANT;s=o.azureCloudInstance+"/"+l+"/"}return s||t},Authority.createCloudDiscoveryMetadataFromHost=function(t){return{preferred_network:t,preferred_cache:t,aliases:[t]}},Authority.getCloudDiscoveryMetadataFromNetworkResponse=function(t,o){for(var s=0;s<t.length;s++){var l=t[s];if(l.aliases.indexOf(o)>-1)return l}return null},Authority.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw iU.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},Authority.prototype.isAlias=function(t){return this.metadata.aliases.indexOf(t)>-1},Authority.isPublicCloudAuthority=function(t){return RB.KNOWN_PUBLIC_CLOUDS.indexOf(t)>=0},Authority.buildRegionalAuthorityString=function(t,o,s){var l=new vq(t);l.validateAsUri();var h=l.getUrlComponents(),m=o+"."+h.HostNameAndPort;this.isPublicCloudAuthority(h.HostNameAndPort)&&(m=o+"."+RB.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var _=vq.constructAuthorityUriFromObject(__assign(__assign({},l.getUrlComponents()),{HostNameAndPort:m})).urlString;return s?_+"?"+s:_},Authority.replaceWithRegionalInformation=function(t,o){return t.authorization_endpoint=Authority.buildRegionalAuthorityString(t.authorization_endpoint,o),t.token_endpoint=Authority.buildRegionalAuthorityString(t.token_endpoint,o,RB.REGIONAL_AUTH_NON_MSI_QUERY_STRING),t.end_session_endpoint&&(t.end_session_endpoint=Authority.buildRegionalAuthorityString(t.end_session_endpoint,o)),t},Authority.transformCIAMAuthority=function(t){var o=t.endsWith(RB.FORWARD_SLASH)?t:""+t+RB.FORWARD_SLASH,s=new vq(t).getUrlComponents();0===s.PathSegments.length&&s.HostNameAndPort.endsWith(RB.CIAM_AUTH_URL)&&(o=""+o+s.HostNameAndPort.split(".")[0]+RB.AAD_TENANT_DOMAIN_SUFFIX);return o},Authority.reservedTenantDomains=new Set(["{tenant}","{tenantid}",AB.COMMON,AB.CONSUMERS,AB.ORGANIZATIONS]),Authority}(),Uq=function(){function AuthorityFactory(){}return AuthorityFactory.createDiscoveredInstance=function(t,o,s,l,h,m,_){return __awaiter$1(this,void 0,void 0,(function(){var E,$,B;return __generator(this,(function(q){switch(q.label){case 0:null==m||m.addQueueMeasurement(XU.AuthorityFactoryCreateDiscoveredInstance,_),E=Hq.transformCIAMAuthority(t),$=AuthorityFactory.createInstance(E,o,s,l,h,m,_),q.label=1;case 1:return q.trys.push([1,3,,4]),null==m||m.setPreQueueTime(XU.AuthorityResolveEndpointsAsync,_),[4,$.resolveEndpointsAsync()];case 2:return q.sent(),[2,$];case 3:throw B=q.sent(),iU.createEndpointDiscoveryIncompleteError(B);case 4:return[2]}}))}))},AuthorityFactory.createInstance=function(t,o,s,l,h,m,_){if(sU.isEmpty(t))throw NU.createUrlEmptyError();return new Hq(t,o,s,l,h,m,_)},AuthorityFactory}(),qq=function(){function ServerTelemetryEntity(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return ServerTelemetryEntity.isServerTelemetryEntity=function(t,o){var s=0===t.indexOf(QB.CACHE_KEY),l=!0;return o&&(l=o.hasOwnProperty("failedRequests")&&o.hasOwnProperty("errors")&&o.hasOwnProperty("cacheHits")),s&&l},ServerTelemetryEntity}(),jq=function(){function ThrottlingEntity(){}return ThrottlingEntity.isThrottlingEntity=function(t,o){var s=!1;t&&(s=0===t.indexOf(nH));var l=!0;return o&&(l=o.hasOwnProperty("throttleTime")),s&&l},ThrottlingEntity}(),zq={sendGetRequestAsync:function(){return Promise.reject(uH.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(uH.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},Vq={code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},Gq={code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},Kq=function(t){function JoseHeaderError(o,s){var l=t.call(this,o,s)||this;return l.name="JoseHeaderError",Object.setPrototypeOf(l,JoseHeaderError.prototype),l}return __extends(JoseHeaderError,t),JoseHeaderError.createMissingKidError=function(){return new JoseHeaderError(Vq.code,Vq.desc)},JoseHeaderError.createMissingAlgError=function(){return new JoseHeaderError(Gq.code,Gq.desc)},JoseHeaderError}(uH),Wq=function(){function JoseHeader(t){this.typ=t.typ,this.alg=t.alg,this.kid=t.kid}return JoseHeader.getShrHeaderString=function(t){if(!t.kid)throw Kq.createMissingKidError();if(!t.alg)throw Kq.createMissingAlgError();var o=new JoseHeader({typ:t.typ||tH.Pop,kid:t.kid,alg:t.alg});return JSON.stringify(o)},JoseHeader}(),Qq=function(){function ServerTelemetryManager(t,o){this.cacheOutcome=eH.NO_CACHE_HIT,this.cacheManager=o,this.apiId=t.apiId,this.correlationId=t.correlationId,this.wrapperSKU=t.wrapperSKU||RB.EMPTY_STRING,this.wrapperVer=t.wrapperVer||RB.EMPTY_STRING,this.telemetryCacheKey=QB.CACHE_KEY+BB.CACHE_KEY_SEPARATOR+t.clientId}return ServerTelemetryManager.prototype.generateCurrentRequestHeaderValue=function(){var t=""+this.apiId+QB.VALUE_SEPARATOR+this.cacheOutcome,o=[this.wrapperSKU,this.wrapperVer].join(QB.VALUE_SEPARATOR),s=[t,this.getRegionDiscoveryFields()].join(QB.VALUE_SEPARATOR);return[QB.SCHEMA_VERSION,s,o].join(QB.CATEGORY_SEPARATOR)},ServerTelemetryManager.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),o=ServerTelemetryManager.maxErrorsToSend(t),s=t.failedRequests.slice(0,2*o).join(QB.VALUE_SEPARATOR),l=t.errors.slice(0,o).join(QB.VALUE_SEPARATOR),h=t.errors.length,m=[h,o<h?QB.OVERFLOW_TRUE:QB.OVERFLOW_FALSE].join(QB.VALUE_SEPARATOR);return[QB.SCHEMA_VERSION,t.cacheHits,s,l,m].join(QB.CATEGORY_SEPARATOR)},ServerTelemetryManager.prototype.cacheFailedRequest=function(t){var o=this.getLastRequests();o.errors.length>=QB.MAX_CACHED_ERRORS&&(o.failedRequests.shift(),o.failedRequests.shift(),o.errors.shift()),o.failedRequests.push(this.apiId,this.correlationId),sU.isEmpty(t.subError)?sU.isEmpty(t.errorCode)?t&&t.toString()?o.errors.push(t.toString()):o.errors.push(QB.UNKNOWN_ERROR):o.errors.push(t.errorCode):o.errors.push(t.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)},ServerTelemetryManager.prototype.incrementCacheHits=function(){var t=this.getLastRequests();return t.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t),t.cacheHits},ServerTelemetryManager.prototype.getLastRequests=function(){var t=new qq;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||t},ServerTelemetryManager.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),o=ServerTelemetryManager.maxErrorsToSend(t);if(o===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var s=new qq;s.failedRequests=t.failedRequests.slice(2*o),s.errors=t.errors.slice(o),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,s)}},ServerTelemetryManager.maxErrorsToSend=function(t){var o,s=0,l=0,h=t.errors.length;for(o=0;o<h;o++){var m=t.failedRequests[2*o]||RB.EMPTY_STRING,_=t.failedRequests[2*o+1]||RB.EMPTY_STRING,E=t.errors[o]||RB.EMPTY_STRING;if(!((l+=m.toString().length+_.toString().length+E.length+3)<QB.MAX_LAST_HEADER_BYTES))break;s+=1}return s},ServerTelemetryManager.prototype.getRegionDiscoveryFields=function(){var t=[];return t.push(this.regionUsed||RB.EMPTY_STRING),t.push(this.regionSource||RB.EMPTY_STRING),t.push(this.regionOutcome||RB.EMPTY_STRING),t.join(",")},ServerTelemetryManager.prototype.updateRegionDiscoveryMetadata=function(t){this.regionUsed=t.region_used,this.regionSource=t.region_source,this.regionOutcome=t.region_outcome},ServerTelemetryManager.prototype.setCacheOutcome=function(t){this.cacheOutcome=t},ServerTelemetryManager}(),Yq=function(){function PerformanceClient(t,o,s,l,h,m){this.authority=o,this.libraryName=l,this.libraryVersion=h,this.applicationTelemetry=m,this.clientId=t,this.logger=s,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map}return PerformanceClient.prototype.startPerformanceMeasurement=function(t,o){return{}},PerformanceClient.prototype.startPerformanceMeasuremeant=function(t,o){return{}},PerformanceClient.prototype.getIntFields=function(){return yq},PerformanceClient.prototype.getPreQueueTime=function(t,o){var s=this.preQueueTimeByCorrelationId.get(o);if(s){if(s.name===t)return s.time;this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+t+", unable to add queue measurement")}else this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+o+", unable to add queue measurement")},PerformanceClient.prototype.calculateQueuedTime=function(t,o){return t<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+t),0):o<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+o),0):o<t?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):o-t},PerformanceClient.prototype.addQueueMeasurement=function(t,o,s,l){if(o){if(0===s)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+t+" is "+s);else if(!s)return void this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+t);var h={eventName:t,queueTime:s,manuallyCompleted:l},m=this.queueMeasurements.get(o);if(m)m.push(h),this.queueMeasurements.set(o,m);else{this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+o+" to queue measurements");var _=[h];this.queueMeasurements.set(o,_)}this.preQueueTimeByCorrelationId.delete(o)}else this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+t+", cannot add queue measurement")},PerformanceClient.prototype.startMeasurement=function(t,o){var s,l,h=this,m=o||this.generateId();o||this.logger.info("PerformanceClient: No correlation id provided for "+t+", generating",m),this.logger.trace("PerformanceClient: Performance measurement started for "+t,m);var _=this.startPerformanceMeasuremeant(t,m);_.startMeasurement();var E={eventId:this.generateId(),status:eq.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:t,startTimeMs:Date.now(),correlationId:m,appName:null===(s=this.applicationTelemetry)||void 0===s?void 0:s.appName,appVersion:null===(l=this.applicationTelemetry)||void 0===l?void 0:l.appVersion};return this.cacheEventByCorrelationId(E),{endMeasurement:function(t){return h.endMeasurement(__assign(__assign({},E),t),_)},discardMeasurement:function(){return h.discardMeasurements(E.correlationId)},addStaticFields:function(t){return h.addStaticFields(t,E.correlationId)},increment:function(t){return h.increment(t,E.correlationId)},measurement:_,event:E}},PerformanceClient.prototype.endMeasurement=function(t,o){var s,l,h=this,m=this.eventsByCorrelationId.get(t.correlationId);if(!m)return this.logger.trace("PerformanceClient: Measurement not found for "+t.eventId,t.correlationId),null;var _=t.eventId===m.eventId,E={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};_?(E=this.getQueueInfo(t.correlationId),this.discardCache(m.correlationId)):null===(s=m.incompleteSubMeasurements)||void 0===s||s.delete(t.eventId),null==o||o.endMeasurement();var $=null==o?void 0:o.flushMeasurement();if(!$)return this.logger.trace("PerformanceClient: Performance measurement not taken",m.correlationId),null;if(this.logger.trace("PerformanceClient: Performance measurement ended for "+t.name+": "+$+" ms",t.correlationId),!_)return m[t.name+"DurationMs"]=Math.floor($),__assign({},m);var B=__assign(__assign({},m),t),q=0;return null===(l=B.incompleteSubMeasurements)||void 0===l||l.forEach((function(o){h.logger.trace("PerformanceClient: Incomplete submeasurement "+o.name+" found for "+t.name,B.correlationId),q++})),B.incompleteSubMeasurements=void 0,B=__assign(__assign({},B),{durationMs:Math.round($),queuedTimeMs:E.totalQueueTime,queuedCount:E.totalQueueCount,queuedManuallyCompletedCount:E.manuallyCompletedCount,status:eq.Completed,incompleteSubsCount:q}),this.truncateIntegralFields(B,this.getIntFields()),this.emitEvents([B],t.correlationId),B},PerformanceClient.prototype.addStaticFields=function(t,o){this.logger.trace("PerformanceClient: Updating static fields");var s=this.eventsByCorrelationId.get(o);s?this.eventsByCorrelationId.set(o,__assign(__assign({},s),t)):this.logger.trace("PerformanceClient: Event not found for",o)},PerformanceClient.prototype.increment=function(t,o){this.logger.trace("PerformanceClient: Updating counters");var s=this.eventsByCorrelationId.get(o);if(s)for(var l in t)s.hasOwnProperty(l)||(s[l]=0),s[l]+=t[l];else this.logger.trace("PerformanceClient: Event not found for",o)},PerformanceClient.prototype.cacheEventByCorrelationId=function(t){var o=this.eventsByCorrelationId.get(t.correlationId);o?(this.logger.trace("PerformanceClient: Performance measurement for "+t.name+" added/updated",t.correlationId),o.incompleteSubMeasurements=o.incompleteSubMeasurements||new Map,o.incompleteSubMeasurements.set(t.eventId,{name:t.name,startTimeMs:t.startTimeMs})):(this.logger.trace("PerformanceClient: Performance measurement for "+t.name+" started",t.correlationId),this.eventsByCorrelationId.set(t.correlationId,__assign({},t)))},PerformanceClient.prototype.getQueueInfo=function(t){var o=this.queueMeasurements.get(t);o||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+t);var s=0,l=0,h=0;return null==o||o.forEach((function(t){s+=t.queueTime,l++,h+=t.manuallyCompleted?1:0})),{totalQueueTime:s,totalQueueCount:l,manuallyCompletedCount:h}},PerformanceClient.prototype.discardMeasurements=function(t){this.logger.trace("PerformanceClient: Performance measurements discarded",t),this.eventsByCorrelationId.delete(t)},PerformanceClient.prototype.discardCache=function(t){this.discardMeasurements(t),this.logger.trace("PerformanceClient: QueueMeasurements discarded",t),this.queueMeasurements.delete(t),this.logger.trace("PerformanceClient: Pre-queue times discarded",t),this.preQueueTimeByCorrelationId.delete(t)},PerformanceClient.prototype.addPerformanceCallback=function(t){var o=this.generateId();return this.callbacks.set(o,t),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+o),o},PerformanceClient.prototype.removePerformanceCallback=function(t){var o=this.callbacks.delete(t);return o?this.logger.verbose("PerformanceClient: Performance callback "+t+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+t+" not removed."),o},PerformanceClient.prototype.emitEvents=function(t,o){var s=this;this.logger.verbose("PerformanceClient: Emitting performance events",o),this.callbacks.forEach((function(l,h){s.logger.trace("PerformanceClient: Emitting event to callback "+h,o),l.apply(null,[t])}))},PerformanceClient.prototype.truncateIntegralFields=function(t,o){o.forEach((function(o){o in t&&"number"==typeof t[o]&&(t[o]=Math.floor(t[o]))}))},PerformanceClient}(),Zq=function(){function StubPerformanceMeasurement(){}return StubPerformanceMeasurement.prototype.startMeasurement=function(){},StubPerformanceMeasurement.prototype.endMeasurement=function(){},StubPerformanceMeasurement.prototype.flushMeasurement=function(){return null},StubPerformanceMeasurement}(),Jq=function(t){function StubPerformanceClient(){return null!==t&&t.apply(this,arguments)||this}return __extends(StubPerformanceClient,t),StubPerformanceClient.prototype.generateId=function(){return"callback-id"},StubPerformanceClient.prototype.startPerformanceMeasuremeant=function(){return new Zq},StubPerformanceClient.prototype.startPerformanceMeasurement=function(){return new Zq},StubPerformanceClient.prototype.calculateQueuedTime=function(t,o){return 0},StubPerformanceClient.prototype.addQueueMeasurement=function(t,o,s){},StubPerformanceClient.prototype.setPreQueueTime=function(t,o){},StubPerformanceClient}(Yq),Xq={code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},ej={code:"crypto_nonexistent",desc:"The crypto object or function is not available."},rj={code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},oj={code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},sj={code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},hj={code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},fj={code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},gj={code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},wj={code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},_j={code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},kj={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},xj={code:"empty_window_error",desc:"window.open returned null or undefined window object."},Sj={code:"user_cancelled",desc:"User cancelled the flow."},Tj={code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},Ij={code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},Pj={code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},Rj={code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},$j={code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},Mj={code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},Oj={code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},Nj={code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},Lj={code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'."},Fj={code:"no_token_request_cache_error",desc:"No token request found in cache."},Hj={code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},Uj={code:"no_cached_authority_error",desc:"No cached authority found."},Vj={code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},Gj={code:"invalid_cache_type",desc:"Invalid cache type"},Wj={code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},Qj={code:"database_not_open",desc:"Database is not open!"},Yj={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},Zj={code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},Jj={code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},Xj={code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},ez={code:"unable_to_load_token",desc:"Error loading token to cache."},tz={code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},rz={code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},oz={code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},nz={code:"spa_code_and_nativeAccountId_present",desc:"Request cannot contain both spa code and native account id."},iz={code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},sz={code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},az={code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},lz={code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},cz={code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},dz={code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},uz={code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."},hz=function(t){function BrowserAuthError(o,s){var l=t.call(this,o,s)||this;return Object.setPrototypeOf(l,BrowserAuthError.prototype),l.name="BrowserAuthError",l}return __extends$1(BrowserAuthError,t),BrowserAuthError.createPkceNotGeneratedError=function(t){return new BrowserAuthError(Xq.code,Xq.desc+" Detail:"+t)},BrowserAuthError.createCryptoNotAvailableError=function(t){return new BrowserAuthError(ej.code,ej.desc+" Detail:"+t)},BrowserAuthError.createHttpMethodNotImplementedError=function(t){return new BrowserAuthError(rj.code,rj.desc+" Given Method: "+t)},BrowserAuthError.createEmptyNavigationUriError=function(){return new BrowserAuthError(oj.code,oj.desc)},BrowserAuthError.createEmptyHashError=function(t){return new BrowserAuthError(sj.code,sj.desc+" Given Url: "+t)},BrowserAuthError.createHashDoesNotContainStateError=function(){return new BrowserAuthError(hj.code,hj.desc)},BrowserAuthError.createHashDoesNotContainKnownPropertiesError=function(){return new BrowserAuthError(fj.code,fj.desc)},BrowserAuthError.createUnableToParseStateError=function(){return new BrowserAuthError(gj.code,gj.desc)},BrowserAuthError.createStateInteractionTypeMismatchError=function(){return new BrowserAuthError(wj.code,wj.desc)},BrowserAuthError.createInteractionInProgressError=function(){return new BrowserAuthError(_j.code,_j.desc)},BrowserAuthError.createPopupWindowError=function(t){var o=kj.desc;return o=sU.isEmpty(t)?o:o+" Details: "+t,new BrowserAuthError(kj.code,o)},BrowserAuthError.createEmptyWindowCreatedError=function(){return new BrowserAuthError(xj.code,xj.desc)},BrowserAuthError.createUserCancelledError=function(){return new BrowserAuthError(Sj.code,Sj.desc)},BrowserAuthError.createMonitorPopupTimeoutError=function(){return new BrowserAuthError(Tj.code,Tj.desc)},BrowserAuthError.createMonitorIframeTimeoutError=function(){return new BrowserAuthError(Ij.code,Ij.desc)},BrowserAuthError.createRedirectInIframeError=function(t){return new BrowserAuthError(Pj.code,Pj.desc+" (window.parent !== window) => "+t)},BrowserAuthError.createBlockReloadInHiddenIframeError=function(){return new BrowserAuthError(Rj.code,Rj.desc)},BrowserAuthError.createBlockAcquireTokenInPopupsError=function(){return new BrowserAuthError($j.code,$j.desc)},BrowserAuthError.createIframeClosedPrematurelyError=function(){return new BrowserAuthError(Mj.code,Mj.desc)},BrowserAuthError.createSilentLogoutUnsupportedError=function(){return new BrowserAuthError(Oj.code,Oj.desc)},BrowserAuthError.createNoAccountError=function(){return new BrowserAuthError(Nj.code,Nj.desc)},BrowserAuthError.createSilentPromptValueError=function(t){return new BrowserAuthError(Lj.code,Lj.desc+" Given value: "+t)},BrowserAuthError.createUnableToParseTokenRequestCacheError=function(){return new BrowserAuthError(Hj.code,Hj.desc)},BrowserAuthError.createNoTokenRequestCacheError=function(){return new BrowserAuthError(Fj.code,Fj.desc)},BrowserAuthError.createAuthRequestNotSetError=function(){return new BrowserAuthError(Vj.code,Vj.desc)},BrowserAuthError.createNoCachedAuthorityError=function(){return new BrowserAuthError(Uj.code,Uj.desc)},BrowserAuthError.createInvalidCacheTypeError=function(){return new BrowserAuthError(Gj.code,""+Gj.desc)},BrowserAuthError.createNonBrowserEnvironmentError=function(){return new BrowserAuthError(Wj.code,Wj.desc)},BrowserAuthError.createDatabaseNotOpenError=function(){return new BrowserAuthError(Qj.code,Qj.desc)},BrowserAuthError.createNoNetworkConnectivityError=function(){return new BrowserAuthError(Yj.code,Yj.desc)},BrowserAuthError.createPostRequestFailedError=function(t,o){return new BrowserAuthError(Zj.code,Zj.desc+" | Network client threw: "+t+" | Attempted to reach: "+o.split("?")[0])},BrowserAuthError.createGetRequestFailedError=function(t,o){return new BrowserAuthError(Jj.code,Jj.desc+" | Network client threw: "+t+" | Attempted to reach: "+o.split("?")[0])},BrowserAuthError.createFailedToParseNetworkResponseError=function(t){return new BrowserAuthError(Xj.code,Xj.desc+" | Attempted to reach: "+t.split("?")[0])},BrowserAuthError.createUnableToLoadTokenError=function(t){return new BrowserAuthError(ez.code,ez.desc+" | "+t)},BrowserAuthError.createSigningKeyNotFoundInStorageError=function(t){return new BrowserAuthError(tz.code,tz.desc+" | No match found for KeyId: "+t)},BrowserAuthError.createAuthCodeRequiredError=function(){return new BrowserAuthError(rz.code,rz.desc)},BrowserAuthError.createAuthCodeOrNativeAccountIdRequiredError=function(){return new BrowserAuthError(oz.code,oz.desc)},BrowserAuthError.createSpaCodeAndNativeAccountIdPresentError=function(){return new BrowserAuthError(nz.code,nz.desc)},BrowserAuthError.createDatabaseUnavailableError=function(){return new BrowserAuthError(iz.code,iz.desc)},BrowserAuthError.createUnableToAcquireTokenFromNativePlatformError=function(){return new BrowserAuthError(sz.code,sz.desc)},BrowserAuthError.createNativeHandshakeTimeoutError=function(){return new BrowserAuthError(az.code,az.desc)},BrowserAuthError.createNativeExtensionNotInstalledError=function(){return new BrowserAuthError(lz.code,lz.desc)},BrowserAuthError.createNativeConnectionNotEstablishedError=function(){return new BrowserAuthError(cz.code,cz.desc)},BrowserAuthError.createNativeBrokerCalledBeforeInitialize=function(){return new BrowserAuthError(dz.code,dz.desc)},BrowserAuthError.createNativePromptParameterNotSupportedError=function(){return new BrowserAuthError(uz.code,uz.desc)},BrowserAuthError}(uH),pz="invalid_grant",fz=483,gz=600,vz="msal",mz=30,yz="msal.js.browser",bz="53ee284d-920a-4b59-9d30-a60315b26836",wz="ppnbnpeolgkicgegkbkbjmhlideopiji",Cz="MATS";
/*! @azure/msal-common v13.3.0 2023-08-24 */!function(t){t.HandshakeRequest="Handshake",t.HandshakeResponse="HandshakeResponse",t.GetToken="GetToken",t.Response="Response"}(Pq||(Pq={})),function(t){t.LocalStorage="localStorage",t.SessionStorage="sessionStorage",t.MemoryStorage="memoryStorage"}(Rq||(Rq={})),function(t){t.GET="GET",t.POST="POST"}($q||($q={})),function(t){t.AUTHORITY="authority",t.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",t.SESSION_STATE="session.state",t.REQUEST_STATE="request.state",t.NONCE_IDTOKEN="nonce.id_token",t.ORIGIN_URI="request.origin",t.RENEW_STATUS="token.renew.status",t.URL_HASH="urlHash",t.REQUEST_PARAMS="request.params",t.SCOPES="scopes",t.INTERACTION_STATUS_KEY="interaction.status",t.CCS_CREDENTIAL="ccs.credential",t.CORRELATION_ID="request.correlationId",t.NATIVE_REQUEST="request.native",t.REDIRECT_CONTEXT="request.redirect.context"}(Mq||(Mq={})),function(t){t.ACCOUNT_KEYS="msal.account.keys",t.TOKEN_KEYS="msal.token.keys"}(Oq||(Oq={})),function(t){t.WRAPPER_SKU="wrapper.sku",t.WRAPPER_VER="wrapper.version"}(Nq||(Nq={})),function(t){t[t.acquireTokenRedirect=861]="acquireTokenRedirect",t[t.acquireTokenPopup=862]="acquireTokenPopup",t[t.ssoSilent=863]="ssoSilent",t[t.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",t[t.handleRedirectPromise=865]="handleRedirectPromise",t[t.acquireTokenByCode=866]="acquireTokenByCode",t[t.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",t[t.logout=961]="logout",t[t.logoutPopup=962]="logoutPopup"}(Dq||(Dq={})),function(t){t.Redirect="redirect",t.Popup="popup",t.Silent="silent",t.None="none"}(Lq||(Lq={})),function(t){t.Startup="startup",t.Login="login",t.Logout="logout",t.AcquireToken="acquireToken",t.SsoSilent="ssoSilent",t.HandleRedirect="handleRedirect",t.None="none"}(Fq||(Fq={}));var _z,kz={scopes:$B},xz="jwk";!function(t){t.React="@azure/msal-react",t.Angular="@azure/msal-angular"}(_z||(_z={}));var Sz,Tz="msal.db",Ez=Tz+".keys";!function(t){t[t.Default=0]="Default",t[t.AccessToken=1]="AccessToken",t[t.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",t[t.RefreshToken=3]="RefreshToken",t[t.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",t[t.Skip=5]="Skip"}(Sz||(Sz={}));
/*! @azure/msal-browser v2.38.2 2023-08-24 */
var Az,Iz,Pz={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},Rz={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},$z={code:"storage_not_supported",desc:"Given storage configuration option was not supported."},Mz={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},Oz={code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},Nz={code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},Dz={code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."},Lz=function(t){function BrowserConfigurationAuthError(o,s){var l=t.call(this,o,s)||this;return l.name="BrowserConfigurationAuthError",Object.setPrototypeOf(l,BrowserConfigurationAuthError.prototype),l}return __extends$1(BrowserConfigurationAuthError,t),BrowserConfigurationAuthError.createRedirectUriEmptyError=function(){return new BrowserConfigurationAuthError(Pz.code,Pz.desc)},BrowserConfigurationAuthError.createPostLogoutRedirectUriEmptyError=function(){return new BrowserConfigurationAuthError(Rz.code,Rz.desc)},BrowserConfigurationAuthError.createStorageNotSupportedError=function(t){return new BrowserConfigurationAuthError($z.code,$z.desc+" Given Location: "+t)},BrowserConfigurationAuthError.createRedirectCallbacksNotSetError=function(){return new BrowserConfigurationAuthError(Mz.code,Mz.desc)},BrowserConfigurationAuthError.createStubPcaInstanceCalledError=function(){return new BrowserConfigurationAuthError(Oz.code,Oz.desc)},BrowserConfigurationAuthError.createInMemoryRedirectUnavailableError=function(){return new BrowserConfigurationAuthError(Nz.code,Nz.desc)},BrowserConfigurationAuthError.createEntropyNotProvided=function(){return new BrowserConfigurationAuthError(Dz.code,Dz.desc)},BrowserConfigurationAuthError}(uH),Fz=function(){function BrowserStorage(t){this.validateWindowStorage(t),this.windowStorage=window[t]}return BrowserStorage.prototype.validateWindowStorage=function(t){if(t!==Rq.LocalStorage&&t!==Rq.SessionStorage)throw Lz.createStorageNotSupportedError(t);if(!!!window[t])throw Lz.createStorageNotSupportedError(t)},BrowserStorage.prototype.getItem=function(t){return this.windowStorage.getItem(t)},BrowserStorage.prototype.setItem=function(t,o){this.windowStorage.setItem(t,o)},BrowserStorage.prototype.removeItem=function(t){this.windowStorage.removeItem(t)},BrowserStorage.prototype.getKeys=function(){return Object.keys(this.windowStorage)},BrowserStorage.prototype.containsKey=function(t){return this.windowStorage.hasOwnProperty(t)},BrowserStorage}(),Bz=function(){function MemoryStorage(){this.cache=new Map}return MemoryStorage.prototype.getItem=function(t){return this.cache.get(t)||null},MemoryStorage.prototype.setItem=function(t,o){this.cache.set(t,o)},MemoryStorage.prototype.removeItem=function(t){this.cache.delete(t)},MemoryStorage.prototype.getKeys=function(){var t=[];return this.cache.forEach((function(o,s){t.push(s)})),t},MemoryStorage.prototype.containsKey=function(t){return this.cache.has(t)},MemoryStorage.prototype.clear=function(){this.cache.clear()},MemoryStorage}(),Hz=function(){function BrowserProtocolUtils(){}return BrowserProtocolUtils.extractBrowserRequestState=function(t,o){if(sU.isEmpty(o))return null;try{return gq.parseRequestState(t,o).libraryState.meta}catch(t){throw iU.createInvalidStateError(o,t)}},BrowserProtocolUtils.parseServerResponseFromHash=function(t){if(!t)return{};var o=new vq(t);return vq.getDeserializedHash(o.getHash())},BrowserProtocolUtils}(),Uz=function(t){function BrowserCacheManager(o,s,l,h){var m=t.call(this,o,l,h)||this;return m.COOKIE_LIFE_MULTIPLIER=864e5,m.cacheConfig=s,m.logger=h,m.internalStorage=new Bz,m.browserStorage=m.setupBrowserStorage(m.cacheConfig.cacheLocation),m.temporaryCacheStorage=m.setupTemporaryCacheStorage(m.cacheConfig.temporaryCacheLocation,m.cacheConfig.cacheLocation),s.cacheMigrationEnabled&&(m.migrateCacheEntries(),m.createKeyMaps()),m}return __extends$1(BrowserCacheManager,t),BrowserCacheManager.prototype.setupBrowserStorage=function(t){switch(t){case Rq.LocalStorage:case Rq.SessionStorage:try{return new Fz(t)}catch(t){this.logger.verbose(t);break}}return this.cacheConfig.cacheLocation=Rq.MemoryStorage,new Bz},BrowserCacheManager.prototype.setupTemporaryCacheStorage=function(t,o){switch(o){case Rq.LocalStorage:case Rq.SessionStorage:try{return new Fz(t||Rq.SessionStorage)}catch(t){return this.logger.verbose(t),this.internalStorage}case Rq.MemoryStorage:default:return this.internalStorage}},BrowserCacheManager.prototype.migrateCacheEntries=function(){var t=this,o=RB.CACHE_PREFIX+"."+EB.ID_TOKEN,s=RB.CACHE_PREFIX+"."+EB.CLIENT_INFO,l=RB.CACHE_PREFIX+"."+EB.ERROR,h=RB.CACHE_PREFIX+"."+EB.ERROR_DESC,m=[this.browserStorage.getItem(o),this.browserStorage.getItem(s),this.browserStorage.getItem(l),this.browserStorage.getItem(h)];[EB.ID_TOKEN,EB.CLIENT_INFO,EB.ERROR,EB.ERROR_DESC].forEach((function(o,s){return t.migrateCacheEntry(o,m[s])}))},BrowserCacheManager.prototype.migrateCacheEntry=function(t,o){o&&this.setTemporaryCache(t,o,!0)},BrowserCacheManager.prototype.createKeyMaps=function(){var t=this;this.logger.trace("BrowserCacheManager - createKeyMaps called.");var o=this.getItem(Oq.ACCOUNT_KEYS),s=this.getItem(Oq.TOKEN_KEYS+"."+this.clientId);o&&s?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach((function(o){var s;if(t.isCredentialKey(o)&&(s=t.getItem(o))){var l=t.validateAndParseJson(s);if(l&&l.hasOwnProperty("credentialType"))switch(l.credentialType){case HB.ID_TOKEN:if(iq.isIdTokenEntity(l)){t.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: "+o+" found, saving key to token key map");var h=BU.toObject(new iq,l),m=t.updateCredentialCacheKey(o,h);return void t.addTokenKey(m,HB.ID_TOKEN)}t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: "+o);break;case HB.ACCESS_TOKEN:case HB.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(aq.isAccessTokenEntity(l)){t.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: "+o+" found, saving key to token key map");var _=BU.toObject(new aq,l);m=t.updateCredentialCacheKey(o,_);return void t.addTokenKey(m,HB.ACCESS_TOKEN)}t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: "+o);break;case HB.REFRESH_TOKEN:if(lq.isRefreshTokenEntity(l)){t.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: "+o+" found, saving key to token key map");var E=BU.toObject(new lq,l);m=t.updateCredentialCacheKey(o,E);return void t.addTokenKey(m,HB.REFRESH_TOKEN)}t.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),t.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: "+o)}}if(t.isAccountKey(o)&&(s=t.getItem(o))){var $=t.validateAndParseJson(s);$&&LU.isAccountEntity($)&&(t.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),t.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: "+o+" found, saving key to account key map"),t.addAccountKeyToMap(o))}}))},BrowserCacheManager.prototype.validateAndParseJson=function(t){try{var o=JSON.parse(t);return o&&"object"==typeof o?o:null}catch(t){return null}},BrowserCacheManager.prototype.getItem=function(t){return this.browserStorage.getItem(t)},BrowserCacheManager.prototype.setItem=function(t,o){this.browserStorage.setItem(t,o)},BrowserCacheManager.prototype.getAccount=function(t){this.logger.trace("BrowserCacheManager.getAccount called");var o=this.getItem(t);if(!o)return this.removeAccountKeyFromMap(t),null;var s=this.validateAndParseJson(o);return s&&LU.isAccountEntity(s)?BU.toObject(new LU,s):(this.removeAccountKeyFromMap(t),null)},BrowserCacheManager.prototype.setAccount=function(t){this.logger.trace("BrowserCacheManager.setAccount called");var o=t.generateAccountKey();this.setItem(o,JSON.stringify(t)),this.addAccountKeyToMap(o)},BrowserCacheManager.prototype.getAccountKeys=function(){this.logger.trace("BrowserCacheManager.getAccountKeys called");var t=this.getItem(Oq.ACCOUNT_KEYS);return t?JSON.parse(t):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])},BrowserCacheManager.prototype.addAccountKeyToMap=function(t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: "+t);var o=this.getAccountKeys();-1===o.indexOf(t)?(o.push(t),this.setItem(Oq.ACCOUNT_KEYS,JSON.stringify(o)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")},BrowserCacheManager.prototype.removeAccountKeyFromMap=function(t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: "+t);var o=this.getAccountKeys(),s=o.indexOf(t);s>-1?(o.splice(s,1),this.setItem(Oq.ACCOUNT_KEYS,JSON.stringify(o)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")},BrowserCacheManager.prototype.removeAccount=function(o){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return t.prototype.removeAccount.call(this,o),this.removeAccountKeyFromMap(o),[2]}))}))},BrowserCacheManager.prototype.removeIdToken=function(o){t.prototype.removeIdToken.call(this,o),this.removeTokenKey(o,HB.ID_TOKEN)},BrowserCacheManager.prototype.removeAccessToken=function(o){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return t.prototype.removeAccessToken.call(this,o),this.removeTokenKey(o,HB.ACCESS_TOKEN),[2]}))}))},BrowserCacheManager.prototype.removeRefreshToken=function(o){t.prototype.removeRefreshToken.call(this,o),this.removeTokenKey(o,HB.REFRESH_TOKEN)},BrowserCacheManager.prototype.getTokenKeys=function(){this.logger.trace("BrowserCacheManager.getTokenKeys called");var t=this.getItem(Oq.TOKEN_KEYS+"."+this.clientId);if(t){var o=this.validateAndParseJson(t);if(o&&o.hasOwnProperty("idToken")&&o.hasOwnProperty("accessToken")&&o.hasOwnProperty("refreshToken"))return o;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}},BrowserCacheManager.prototype.addTokenKey=function(t,o){this.logger.trace("BrowserCacheManager addTokenKey called");var s=this.getTokenKeys();switch(o){case HB.ID_TOKEN:-1===s.idToken.indexOf(t)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),s.idToken.push(t));break;case HB.ACCESS_TOKEN:-1===s.accessToken.indexOf(t)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),s.accessToken.push(t));break;case HB.REFRESH_TOKEN:-1===s.refreshToken.indexOf(t)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),s.refreshToken.push(t));break;default:this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: "+o),iU.createUnexpectedCredentialTypeError()}this.setItem(Oq.TOKEN_KEYS+"."+this.clientId,JSON.stringify(s))},BrowserCacheManager.prototype.removeTokenKey=function(t,o){this.logger.trace("BrowserCacheManager removeTokenKey called");var s=this.getTokenKeys();switch(o){case HB.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: "+t+" from map");var l=s.idToken.indexOf(t);l>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),s.idToken.splice(l,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case HB.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: "+t+" from map");var h=s.accessToken.indexOf(t);h>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),s.accessToken.splice(h,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case HB.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: "+t+" from map");var m=s.refreshToken.indexOf(t);m>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),s.refreshToken.splice(m,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: "+o),iU.createUnexpectedCredentialTypeError()}this.setItem(Oq.TOKEN_KEYS+"."+this.clientId,JSON.stringify(s))},BrowserCacheManager.prototype.getIdTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(t,HB.ID_TOKEN),null;var s=this.validateAndParseJson(o);return s&&iq.isIdTokenEntity(s)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),BU.toObject(new iq,s)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(t,HB.ID_TOKEN),null)},BrowserCacheManager.prototype.setIdTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t)),this.addTokenKey(o,HB.ID_TOKEN)},BrowserCacheManager.prototype.getAccessTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(t,HB.ACCESS_TOKEN),null;var s=this.validateAndParseJson(o);return s&&aq.isAccessTokenEntity(s)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),BU.toObject(new aq,s)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(t,HB.ACCESS_TOKEN),null)},BrowserCacheManager.prototype.setAccessTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t)),this.addTokenKey(o,HB.ACCESS_TOKEN)},BrowserCacheManager.prototype.getRefreshTokenCredential=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(t,HB.REFRESH_TOKEN),null;var s=this.validateAndParseJson(o);return s&&lq.isRefreshTokenEntity(s)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),BU.toObject(new lq,s)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(t,HB.REFRESH_TOKEN),null)},BrowserCacheManager.prototype.setRefreshTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var o=t.generateCredentialKey();this.setItem(o,JSON.stringify(t)),this.addTokenKey(o,HB.REFRESH_TOKEN)},BrowserCacheManager.prototype.getAppMetadata=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var s=this.validateAndParseJson(o);return s&&wq.isAppMetadataEntity(t,s)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),BU.toObject(new wq,s)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},BrowserCacheManager.prototype.setAppMetadata=function(t){this.logger.trace("BrowserCacheManager.setAppMetadata called");var o=t.generateAppMetadataKey();this.setItem(o,JSON.stringify(t))},BrowserCacheManager.prototype.getServerTelemetry=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var s=this.validateAndParseJson(o);return s&&qq.isServerTelemetryEntity(t,s)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),BU.toObject(new qq,s)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},BrowserCacheManager.prototype.setServerTelemetry=function(t,o){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(t,JSON.stringify(o))},BrowserCacheManager.prototype.getAuthorityMetadata=function(t){var o=this.internalStorage.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var s=this.validateAndParseJson(o);return s&&Iq.isAuthorityMetadataEntity(t,s)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),BU.toObject(new Iq,s)):null},BrowserCacheManager.prototype.getAuthorityMetadataKeys=function(){var t=this;return this.internalStorage.getKeys().filter((function(o){return t.isAuthorityMetadata(o)}))},BrowserCacheManager.prototype.setWrapperMetadata=function(t,o){this.internalStorage.setItem(Nq.WRAPPER_SKU,t),this.internalStorage.setItem(Nq.WRAPPER_VER,o)},BrowserCacheManager.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(Nq.WRAPPER_SKU)||RB.EMPTY_STRING,this.internalStorage.getItem(Nq.WRAPPER_VER)||RB.EMPTY_STRING]},BrowserCacheManager.prototype.setAuthorityMetadata=function(t,o){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(t,JSON.stringify(o))},BrowserCacheManager.prototype.getActiveAccount=function(){var t=this.generateCacheKey(EB.ACTIVE_ACCOUNT_FILTERS),o=this.getItem(t);if(!o){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");var s=this.generateCacheKey(EB.ACTIVE_ACCOUNT),l=this.getItem(s);if(!l)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;var h=this.getAccountInfoByFilter({localAccountId:l})[0]||null;return h?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(h),h):null}var m=this.validateAndParseJson(o);return m?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:m.homeAccountId,localAccountId:m.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)},BrowserCacheManager.prototype.setActiveAccount=function(t){var o=this.generateCacheKey(EB.ACTIVE_ACCOUNT_FILTERS),s=this.generateCacheKey(EB.ACTIVE_ACCOUNT);if(t){this.logger.verbose("setActiveAccount: Active account set");var l={homeAccountId:t.homeAccountId,localAccountId:t.localAccountId};this.browserStorage.setItem(o,JSON.stringify(l)),this.browserStorage.setItem(s,t.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(o),this.browserStorage.removeItem(s)},BrowserCacheManager.prototype.getAccountInfoByFilter=function(t){var o=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+o.length+" accounts found"),o.filter((function(o){return(!t.username||t.username.toLowerCase()===o.username.toLowerCase())&&((!t.homeAccountId||t.homeAccountId===o.homeAccountId)&&((!t.localAccountId||t.localAccountId===o.localAccountId)&&((!t.tenantId||t.tenantId===o.tenantId)&&(!t.environment||t.environment===o.environment))))}))},BrowserCacheManager.prototype.getAccountInfoByHints=function(t,o){var s=this.getAllAccounts().filter((function(s){if(o){var l=s.idTokenClaims&&s.idTokenClaims.sid;return o===l}return!!t&&t===s.username}));if(1===s.length)return s[0];if(s.length>1)throw iU.createMultipleMatchingAccountsInCacheError();return null},BrowserCacheManager.prototype.getThrottlingCache=function(t){var o=this.getItem(t);if(!o)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var s=this.validateAndParseJson(o);return s&&jq.isThrottlingEntity(t,s)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),BU.toObject(new jq,s)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},BrowserCacheManager.prototype.setThrottlingCache=function(t,o){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(t,JSON.stringify(o))},BrowserCacheManager.prototype.getTemporaryCache=function(t,o){var s=o?this.generateCacheKey(t):t;if(this.cacheConfig.storeAuthStateInCookie){var l=this.getItemCookie(s);if(l)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),l}var h=this.temporaryCacheStorage.getItem(s);if(!h){if(this.cacheConfig.cacheLocation===Rq.LocalStorage){var m=this.browserStorage.getItem(s);if(m)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),m}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),h},BrowserCacheManager.prototype.setTemporaryCache=function(t,o,s){var l=s?this.generateCacheKey(t):t;this.temporaryCacheStorage.setItem(l,o),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(l,o))},BrowserCacheManager.prototype.removeItem=function(t){this.browserStorage.removeItem(t),this.temporaryCacheStorage.removeItem(t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(t))},BrowserCacheManager.prototype.containsKey=function(t){return this.browserStorage.containsKey(t)||this.temporaryCacheStorage.containsKey(t)},BrowserCacheManager.prototype.getKeys=function(){return __spread(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},BrowserCacheManager.prototype.clear=function(){return __awaiter$2(this,void 0,void 0,(function(){var t=this;return __generator$1(this,(function(o){switch(o.label){case 0:return[4,this.removeAllAccounts()];case 1:return o.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(o){!t.browserStorage.containsKey(o)&&!t.temporaryCacheStorage.containsKey(o)||-1===o.indexOf(RB.CACHE_PREFIX)&&-1===o.indexOf(t.clientId)||t.removeItem(o)})),this.internalStorage.clear(),[2]}}))}))},BrowserCacheManager.prototype.clearTokensAndKeysWithClaims=function(){return __awaiter$2(this,void 0,void 0,(function(){var t,o,s=this;return __generator$1(this,(function(l){switch(l.label){case 0:return this.logger.trace("BrowserCacheManager.clearTokensAndKeysWithClaims called"),t=this.getTokenKeys(),o=[],t.accessToken.forEach((function(t){var l=s.getAccessTokenCredential(t);(null==l?void 0:l.requestedClaimsHash)&&t.includes(l.requestedClaimsHash.toLowerCase())&&o.push(s.removeAccessToken(t))})),[4,Promise.all(o)];case 1:return l.sent(),o.length>0&&this.logger.warning(o.length+" access tokens with claims in the cache keys have been removed from the cache."),[2]}}))}))},BrowserCacheManager.prototype.setItemCookie=function(t,o,s){var l=encodeURIComponent(t)+"="+encodeURIComponent(o)+";path=/;SameSite=Lax;";s&&(l+="expires="+this.getCookieExpirationTime(s)+";");this.cacheConfig.secureCookies&&(l+="Secure;"),document.cookie=l},BrowserCacheManager.prototype.getItemCookie=function(t){for(var o=encodeURIComponent(t)+"=",s=document.cookie.split(";"),l=0;l<s.length;l++){for(var h=s[l];" "===h.charAt(0);)h=h.substring(1);if(0===h.indexOf(o))return decodeURIComponent(h.substring(o.length,h.length))}return RB.EMPTY_STRING},BrowserCacheManager.prototype.clearMsalCookies=function(){var t=this,o=RB.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(s){for(;" "===s.charAt(0);)s=s.substring(1);if(0===s.indexOf(o)){var l=s.split("=")[0];t.clearItemCookie(l)}}))},BrowserCacheManager.prototype.clearItemCookie=function(t){this.setItemCookie(t,RB.EMPTY_STRING,-1)},BrowserCacheManager.prototype.getCookieExpirationTime=function(t){var o=new Date;return new Date(o.getTime()+t*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},BrowserCacheManager.prototype.getCache=function(){return this.browserStorage},BrowserCacheManager.prototype.setCache=function(){},BrowserCacheManager.prototype.generateCacheKey=function(t){return this.validateAndParseJson(t)?JSON.stringify(t):sU.startsWith(t,RB.CACHE_PREFIX)||sU.startsWith(t,EB.ADAL_ID_TOKEN)?t:RB.CACHE_PREFIX+"."+this.clientId+"."+t},BrowserCacheManager.prototype.generateAuthorityKey=function(t){var o=gq.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(Mq.AUTHORITY+"."+o)},BrowserCacheManager.prototype.generateNonceKey=function(t){var o=gq.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(Mq.NONCE_IDTOKEN+"."+o)},BrowserCacheManager.prototype.generateStateKey=function(t){var o=gq.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(Mq.REQUEST_STATE+"."+o)},BrowserCacheManager.prototype.getCachedAuthority=function(t){var o=this.generateStateKey(t),s=this.getTemporaryCache(o);if(!s)return null;var l=this.generateAuthorityKey(s);return this.getTemporaryCache(l)},BrowserCacheManager.prototype.updateCacheEntries=function(t,o,s,l,h){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var m=this.generateStateKey(t);this.setTemporaryCache(m,t,!1);var _=this.generateNonceKey(t);this.setTemporaryCache(_,o,!1);var E=this.generateAuthorityKey(t);if(this.setTemporaryCache(E,s,!1),h){var $={credential:h.homeAccountId,type:QU.HOME_ACCOUNT_ID};this.setTemporaryCache(Mq.CCS_CREDENTIAL,JSON.stringify($),!0)}else if(!sU.isEmpty(l)){$={credential:l,type:QU.UPN};this.setTemporaryCache(Mq.CCS_CREDENTIAL,JSON.stringify($),!0)}},BrowserCacheManager.prototype.resetRequestCache=function(t){var o=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),sU.isEmpty(t)||this.getKeys().forEach((function(s){-1!==s.indexOf(t)&&o.removeItem(s)})),t&&(this.removeItem(this.generateStateKey(t)),this.removeItem(this.generateNonceKey(t)),this.removeItem(this.generateAuthorityKey(t))),this.removeItem(this.generateCacheKey(Mq.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(Mq.ORIGIN_URI)),this.removeItem(this.generateCacheKey(Mq.URL_HASH)),this.removeItem(this.generateCacheKey(Mq.CORRELATION_ID)),this.removeItem(this.generateCacheKey(Mq.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(Mq.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},BrowserCacheManager.prototype.cleanRequestByState=function(t){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),t){var o=this.generateStateKey(t),s=this.temporaryCacheStorage.getItem(o);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+s),this.resetRequestCache(s||RB.EMPTY_STRING)}this.clearMsalCookies()},BrowserCacheManager.prototype.cleanRequestByInteractionType=function(t){var o=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(s){if(-1!==s.indexOf(Mq.REQUEST_STATE)){var l=o.temporaryCacheStorage.getItem(s);if(l){var h=Hz.extractBrowserRequestState(o.cryptoImpl,l);h&&h.interactionType===t&&(o.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+l),o.resetRequestCache(l))}}})),this.clearMsalCookies(),this.setInteractionInProgress(!1)},BrowserCacheManager.prototype.cacheCodeRequest=function(t,o){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var s=o.base64Encode(JSON.stringify(t));this.setTemporaryCache(Mq.REQUEST_PARAMS,s,!0)},BrowserCacheManager.prototype.getCachedRequest=function(t,o){this.logger.trace("BrowserCacheManager.getCachedRequest called");var s=this.getTemporaryCache(Mq.REQUEST_PARAMS,!0);if(!s)throw hz.createNoTokenRequestCacheError();var l=this.validateAndParseJson(o.base64Decode(s));if(!l)throw hz.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(Mq.REQUEST_PARAMS)),sU.isEmpty(l.authority)){var h=this.generateAuthorityKey(t),m=this.getTemporaryCache(h);if(!m)throw hz.createNoCachedAuthorityError();l.authority=m}return l},BrowserCacheManager.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var t=this.getTemporaryCache(Mq.NATIVE_REQUEST,!0);if(!t)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var o=this.validateAndParseJson(t);return o||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},BrowserCacheManager.prototype.isInteractionInProgress=function(t){var o=this.getInteractionInProgress();return t?o===this.clientId:!!o},BrowserCacheManager.prototype.getInteractionInProgress=function(){var t=RB.CACHE_PREFIX+"."+Mq.INTERACTION_STATUS_KEY;return this.getTemporaryCache(t,!1)},BrowserCacheManager.prototype.setInteractionInProgress=function(t){var o=RB.CACHE_PREFIX+"."+Mq.INTERACTION_STATUS_KEY;if(t){if(this.getInteractionInProgress())throw hz.createInteractionInProgressError();this.setTemporaryCache(o,this.clientId,!1)}else t||this.getInteractionInProgress()!==this.clientId||this.removeItem(o)},BrowserCacheManager.prototype.getLegacyLoginHint=function(){var t=this.getTemporaryCache(EB.ADAL_ID_TOKEN);t&&(this.browserStorage.removeItem(EB.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var o=this.getTemporaryCache(EB.ID_TOKEN,!0);o&&(this.removeItem(this.generateCacheKey(EB.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var s=o||t;if(s){var l=new FU(s,this.cryptoImpl);if(l.claims&&l.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),l.claims.preferred_username;if(l.claims&&l.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),l.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},BrowserCacheManager.prototype.updateCredentialCacheKey=function(t,o){var s=o.generateCredentialKey();if(t!==s){var l=this.getItem(t);if(l)return this.removeItem(t),this.setItem(s,l),this.logger.verbose("Updated an outdated "+o.credentialType+" cache key"),s;this.logger.error("Attempted to update an outdated "+o.credentialType+" cache key but no item matching the outdated key was found in storage")}return t},BrowserCacheManager.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(Mq.REDIRECT_CONTEXT,!0)},BrowserCacheManager.prototype.setRedirectRequestContext=function(t){this.setTemporaryCache(Mq.REDIRECT_CONTEXT,t,!0)},BrowserCacheManager}(BU),qz="@azure/msal-browser",jz="2.38.2",zz=function(){function FetchClient(){}return FetchClient.prototype.sendGetRequestAsync=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){var s,l,h;return __generator$1(this,(function(m){switch(m.label){case 0:return m.trys.push([0,2,,3]),[4,fetch(t,{method:$q.GET,headers:this.getFetchHeaders(o)})];case 1:return s=m.sent(),[3,3];case 2:throw l=m.sent(),window.navigator.onLine?hz.createGetRequestFailedError(l,t):hz.createNoNetworkConnectivityError();case 3:return m.trys.push([3,5,,6]),h={headers:this.getHeaderDict(s.headers)},[4,s.json()];case 4:return[2,(h.body=m.sent(),h.status=s.status,h)];case 5:throw m.sent(),hz.createFailedToParseNetworkResponseError(t);case 6:return[2]}}))}))},FetchClient.prototype.sendPostRequestAsync=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){var s,l,h,m;return __generator$1(this,(function(_){switch(_.label){case 0:s=o&&o.body||RB.EMPTY_STRING,_.label=1;case 1:return _.trys.push([1,3,,4]),[4,fetch(t,{method:$q.POST,headers:this.getFetchHeaders(o),body:s})];case 2:return l=_.sent(),[3,4];case 3:throw h=_.sent(),window.navigator.onLine?hz.createPostRequestFailedError(h,t):hz.createNoNetworkConnectivityError();case 4:return _.trys.push([4,6,,7]),m={headers:this.getHeaderDict(l.headers)},[4,l.json()];case 5:return[2,(m.body=_.sent(),m.status=l.status,m)];case 6:throw _.sent(),hz.createFailedToParseNetworkResponseError(t);case 7:return[2]}}))}))},FetchClient.prototype.getFetchHeaders=function(t){var o=new Headers;if(!t||!t.headers)return o;var s=t.headers;return Object.keys(s).forEach((function(t){o.append(t,s[t])})),o},FetchClient.prototype.getHeaderDict=function(t){var o={};return t.forEach((function(t,s){o[s]=t})),o},FetchClient}(),Vz=function(){function XhrClient(){}return XhrClient.prototype.sendGetRequestAsync=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,this.sendRequestAsync(t,$q.GET,o)]}))}))},XhrClient.prototype.sendPostRequestAsync=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,this.sendRequestAsync(t,$q.POST,o)]}))}))},XhrClient.prototype.sendRequestAsync=function(t,o,s){var l=this;return new Promise((function(h,m){var _=new XMLHttpRequest;if(_.open(o,t,!0),l.setXhrHeaders(_,s),_.onload=function(){(_.status<200||_.status>=300)&&(o===$q.POST?m(hz.createPostRequestFailedError("Failed with status "+_.status,t)):m(hz.createGetRequestFailedError("Failed with status "+_.status,t)));try{var s=JSON.parse(_.responseText),E={headers:l.getHeaderDict(_),body:s,status:_.status};h(E)}catch(o){m(hz.createFailedToParseNetworkResponseError(t))}},_.onerror=function(){window.navigator.onLine?o===$q.POST?m(hz.createPostRequestFailedError("Failed with status "+_.status,t)):m(hz.createGetRequestFailedError("Failed with status "+_.status,t)):m(hz.createNoNetworkConnectivityError())},o===$q.POST&&s&&s.body)_.send(s.body);else{if(o!==$q.GET)throw hz.createHttpMethodNotImplementedError(o);_.send()}}))},XhrClient.prototype.setXhrHeaders=function(t,o){if(o&&o.headers){var s=o.headers;Object.keys(s).forEach((function(o){t.setRequestHeader(o,s[o])}))}},XhrClient.prototype.getHeaderDict=function(t){var o=t.getAllResponseHeaders().trim().split(/[\r\n]+/),s={};return o.forEach((function(t){var o=t.split(": "),l=o.shift(),h=o.join(": ");l&&h&&(s[l]=h)})),s},XhrClient}(),Gz=function(){function BrowserUtils(){}return BrowserUtils.clearHash=function(t){t.location.hash=RB.EMPTY_STRING,"function"==typeof t.history.replaceState&&t.history.replaceState(null,RB.EMPTY_STRING,""+t.location.origin+t.location.pathname+t.location.search)},BrowserUtils.replaceHash=function(t){var o=t.split("#");o.shift(),window.location.hash=o.length>0?o.join("#"):RB.EMPTY_STRING},BrowserUtils.isInIframe=function(){return window.parent!==window},BrowserUtils.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(vz+".")},BrowserUtils.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},BrowserUtils.getHomepage=function(){var t=new vq(window.location.href).getUrlComponents();return t.Protocol+"//"+t.HostNameAndPort+"/"},BrowserUtils.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new zz:new Vz},BrowserUtils.blockReloadInHiddenIframes=function(){if(vq.hashContainsKnownProperties(window.location.hash)&&BrowserUtils.isInIframe())throw hz.createBlockReloadInHiddenIframeError()},BrowserUtils.blockRedirectInIframe=function(t,o){var s=BrowserUtils.isInIframe();if(t===Lq.Redirect&&s&&!o)throw hz.createRedirectInIframeError(s)},BrowserUtils.blockAcquireTokenInPopups=function(){if(BrowserUtils.isInPopup())throw hz.createBlockAcquireTokenInPopupsError()},BrowserUtils.blockNonBrowserEnvironment=function(t){if(!t)throw hz.createNonBrowserEnvironmentError()},BrowserUtils.blockNativeBrokerCalledBeforeInitialized=function(t,o){if(t&&!o)throw hz.createNativeBrokerCalledBeforeInitialize()},BrowserUtils.detectIEOrEdge=function(){var t=window.navigator.userAgent,o=t.indexOf("MSIE "),s=t.indexOf("Trident/"),l=t.indexOf("Edge/");return o>0||s>0||l>0},BrowserUtils}(),Kz=function(){function BaseInteractionClient(t,o,s,l,h,m,_,E,$){this.config=t,this.browserStorage=o,this.browserCrypto=s,this.networkClient=this.config.system.networkClient,this.eventHandler=h,this.navigationClient=m,this.nativeMessageHandler=E,this.correlationId=$||this.browserCrypto.createNewGuid(),this.logger=l.clone(yz,jz,this.correlationId),this.performanceClient=_}return BaseInteractionClient.prototype.clearCacheOnLogout=function(t){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(o){switch(o.label){case 0:if(!t)return[3,5];LU.accountInfoIsEqual(t,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(LU.generateAccountCacheKey(t))];case 2:return o.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return o.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return o.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return o.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return o.sent(),[3,9];case 8:return o.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},BaseInteractionClient.prototype.initializeBaseRequest=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){var s,l,h,m;return __generator$1(this,(function(_){switch(_.label){case 0:return this.performanceClient.addQueueMeasurement(XU.InitializeBaseRequest,t.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),s=t.authority||this.config.auth.authority,o?[4,this.validateRequestAuthority(s,o)]:[3,2];case 1:_.sent(),_.label=2;case 2:if(l=__spread(t&&t.scopes||[]),(h=__assign$1(__assign$1({},t),{correlationId:this.correlationId,authority:s,scopes:l})).authenticationScheme){if(h.authenticationScheme===WB.SSH){if(!t.sshJwk)throw NU.createMissingSshJwkError();if(!t.sshKid)throw NU.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+h.authenticationScheme+'" as configured in Auth request')}else h.authenticationScheme=WB.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return this.config.cache.claimsBasedCachingEnabled&&t.claims&&!sU.isEmptyObj(t.claims)?(m=h,[4,this.browserCrypto.hashString(t.claims)]):[3,4];case 3:m.requestedClaimsHash=_.sent(),_.label=4;case 4:return[2,h]}}))}))},BaseInteractionClient.prototype.getRedirectUri=function(t){this.logger.verbose("getRedirectUri called");var o=t||this.config.auth.redirectUri||Gz.getCurrentUri();return vq.getAbsoluteUrl(o,Gz.getCurrentUri())},BaseInteractionClient.prototype.validateRequestAuthority=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(s){switch(s.label){case 0:return[4,this.getDiscoveredAuthority(t)];case 1:if(!s.sent().isAlias(o.environment))throw NU.createAuthorityMismatchError();return[2]}}))}))},BaseInteractionClient.prototype.initializeServerTelemetryManager=function(t,o){this.logger.verbose("initializeServerTelemetryManager called");var s={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:t,forceRefresh:o||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Qq(s,this.browserStorage)},BaseInteractionClient.prototype.getDiscoveredAuthority=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(s){switch(s.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},t?(this.logger.verbose("Creating discovered authority with request authority"),[4,Uq.createDiscoveredInstance(t,this.config.system.networkClient,this.browserStorage,o,this.logger)]):[3,2];case 1:case 3:return[2,s.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,Uq.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,o,this.logger)]}}))}))},BaseInteractionClient}(),Wz=function(t){function StandardInteractionClient(){return null!==t&&t.apply(this,arguments)||this}return __extends$1(StandardInteractionClient,t),StandardInteractionClient.prototype.initializeAuthorizationCodeRequest=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s;return __generator$1(this,(function(l){switch(l.label){case 0:return this.performanceClient.addQueueMeasurement(XU.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),this.logger.verbose("initializeAuthorizationRequest called",t.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return o=l.sent(),s=__assign$1(__assign$1({},t),{redirectUri:t.redirectUri,code:RB.EMPTY_STRING,codeVerifier:o.verifier}),t.codeChallenge=o.challenge,t.codeChallengeMethod=RB.S256_CODE_CHALLENGE_METHOD,[2,s]}}))}))},StandardInteractionClient.prototype.initializeLogoutRequest=function(t){this.logger.verbose("initializeLogoutRequest called",null==t?void 0:t.correlationId);var o=__assign$1({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},t);if(t)if(t.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(t.account){var s=this.getLogoutHintFromIdTokenClaims(t.account);s&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),o.logoutHint=s)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return t&&null===t.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",o.correlationId):t&&t.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",o.correlationId),o.postLogoutRedirectUri=vq.getAbsoluteUrl(t.postLogoutRedirectUri,Gz.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",o.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",o.correlationId),o.postLogoutRedirectUri=vq.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Gz.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",o.correlationId),o.postLogoutRedirectUri=vq.getAbsoluteUrl(Gz.getCurrentUri(),Gz.getCurrentUri())),o},StandardInteractionClient.prototype.getLogoutHintFromIdTokenClaims=function(t){var o=t.idTokenClaims;if(o){if(o.login_hint)return o.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},StandardInteractionClient.prototype.createAuthCodeClient=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){var l;return __generator$1(this,(function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement(XU.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime(XU.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,s)];case 1:return l=h.sent(),[2,new kq(l,this.performanceClient)]}}))}))},StandardInteractionClient.prototype.getClientConfiguration=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){var l,h;return __generator$1(this,(function(m){switch(m.label){case 0:return this.performanceClient.addQueueMeasurement(XU.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime(XU.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(o,s)];case 1:return l=m.sent(),h=this.config.system.loggerOptions,[2,{authOptions:{clientId:this.config.auth.clientId,authority:l,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:h.loggerCallback,piiLoggingEnabled:h.piiLoggingEnabled,logLevel:h.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:yz,version:jz,cpu:RB.EMPTY_STRING,os:RB.EMPTY_STRING},telemetry:this.config.telemetry}]}}))}))},StandardInteractionClient.prototype.validateAndExtractStateFromHash=function(t,o,s){if(this.logger.verbose("validateAndExtractStateFromHash called",s),!t.state)throw hz.createHashDoesNotContainStateError();var l=Hz.extractBrowserRequestState(this.browserCrypto,t.state);if(!l)throw hz.createUnableToParseStateError();if(l.interactionType!==o)throw hz.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",s),t.state},StandardInteractionClient.prototype.getDiscoveredAuthority=function(t,o){var s;return __awaiter$2(this,void 0,void 0,(function(){var l,h,m,_;return __generator$1(this,(function(E){switch(E.label){case 0:return this.performanceClient.addQueueMeasurement(XU.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),l=null===(s=this.performanceClient)||void 0===s?void 0:s.startMeasurement(XU.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),h={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},m=t||this.config.auth.authority,_=Hq.generateAuthority(m,o||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime(XU.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,Uq.createDiscoveredInstance(_,this.config.system.networkClient,this.browserStorage,h,this.logger,this.performanceClient,this.correlationId).then((function(t){return l.endMeasurement({success:!0}),t})).catch((function(t){throw l.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))];case 1:return[2,E.sent()]}}))}))},StandardInteractionClient.prototype.initializeAuthorizationRequest=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){var s,l,h,m,_,E,$;return __generator$1(this,(function(B){switch(B.label){case 0:return this.performanceClient.addQueueMeasurement(XU.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),s=this.getRedirectUri(t.redirectUri),l={interactionType:o},h=gq.setRequestState(this.browserCrypto,t&&t.state||RB.EMPTY_STRING,l),this.performanceClient.setPreQueueTime(XU.InitializeBaseRequest,this.correlationId),_=[{}],[4,this.initializeBaseRequest(t)];case 1:return m=__assign$1.apply(void 0,[__assign$1.apply(void 0,_.concat([B.sent()])),{redirectUri:s,state:h,nonce:t.nonce||this.browserCrypto.createNewGuid(),responseMode:DB.FRAGMENT}]),(E=t.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+E.homeAccountId,this.correlationId),m.account=E),sU.isEmpty(m.loginHint)&&!E&&($=this.browserStorage.getLegacyLoginHint())&&(m.loginHint=$),[2,m]}}))}))},StandardInteractionClient}(Kz),Qz=function(){function InteractionHandler(t,o,s,l,h){this.authModule=t,this.browserStorage=o,this.authCodeRequest=s,this.logger=l,this.performanceClient=h}return InteractionHandler.prototype.handleCodeResponseFromHash=function(t,o,s,l){return __awaiter$2(this,void 0,void 0,(function(){var h,m,_;return __generator$1(this,(function(E){if(this.performanceClient.addQueueMeasurement(XU.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),sU.isEmpty(t))throw hz.createEmptyHashError(t);if(h=this.browserStorage.generateStateKey(o),!(m=this.browserStorage.getTemporaryCache(h)))throw iU.createStateNotFoundError("Cached State");try{_=this.authModule.handleFragmentResponse(t,m)}catch(t){throw t instanceof YU&&t.subError===Sj.code?hz.createUserCancelledError():t}return this.performanceClient.setPreQueueTime(XU.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(_,o,s,l)]}))}))},InteractionHandler.prototype.handleCodeResponseFromServer=function(t,o,s,l,h){return void 0===h&&(h=!0),__awaiter$2(this,void 0,void 0,(function(){var m,_,E,$,B,q;return __generator$1(this,(function(j){switch(j.label){case 0:if(this.performanceClient.addQueueMeasurement(XU.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),m=this.browserStorage.generateStateKey(o),!(_=this.browserStorage.getTemporaryCache(m)))throw iU.createStateNotFoundError("Cached State");return E=this.browserStorage.generateNonceKey(_),$=this.browserStorage.getTemporaryCache(E),this.authCodeRequest.code=t.code,t.cloud_instance_host_name?(this.performanceClient.setPreQueueTime(XU.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(t.cloud_instance_host_name,s,l)]):[3,2];case 1:j.sent(),j.label=2;case 2:return h&&(t.nonce=$||void 0),t.state=_,t.client_info?this.authCodeRequest.clientInfo=t.client_info:(B=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=B),this.performanceClient.setPreQueueTime(XU.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,t)];case 3:return q=j.sent(),this.browserStorage.cleanRequestByState(o),[2,q]}}))}))},InteractionHandler.prototype.updateTokenEndpointAuthority=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){var l,h;return __generator$1(this,(function(m){switch(m.label){case 0:return this.performanceClient.addQueueMeasurement(XU.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),l="https://"+t+"/"+o.tenant+"/",[4,Uq.createDiscoveredInstance(l,s,this.browserStorage,o.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return h=m.sent(),this.authModule.updateAuthority(h),[2]}}))}))},InteractionHandler.prototype.checkCcsCredentials=function(){var t=this.browserStorage.getTemporaryCache(Mq.CCS_CREDENTIAL,!0);if(t)try{return JSON.parse(t)}catch(o){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+t)}return null},InteractionHandler}(),Yz=function(t){function RedirectHandler(o,s,l,h,m,_){var E=t.call(this,o,s,l,h,_)||this;return E.browserCrypto=m,E}return __extends$1(RedirectHandler,t),RedirectHandler.prototype.initiateAuthRequest=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){var s;return __generator$1(this,(function(l){switch(l.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),sU.isEmpty(t)?[3,7]:(o.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Mq.ORIGIN_URI,o.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Mq.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+t),s={apiId:Dq.acquireTokenRedirect,timeout:o.redirectTimeout,noHistory:!1},"function"!=typeof o.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===o.onRedirectNavigate(t)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,o.navigationClient.navigateExternal(t,s)])));case 1:case 5:return l.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,o.navigationClient.navigateExternal(t,s)];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),hz.createEmptyNavigationUriError();case 8:return[2]}}))}))},RedirectHandler.prototype.handleCodeResponseFromHash=function(t,o,s,l){return __awaiter$2(this,void 0,void 0,(function(){var h,m,_,E,$,B,q;return __generator$1(this,(function(j){switch(j.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),sU.isEmpty(t))throw hz.createEmptyHashError(t);if(this.browserStorage.setInteractionInProgress(!1),h=this.browserStorage.generateStateKey(o),!(m=this.browserStorage.getTemporaryCache(h)))throw iU.createStateNotFoundError("Cached State");try{_=this.authModule.handleFragmentResponse(t,m)}catch(t){throw t instanceof YU&&t.subError===Sj.code?hz.createUserCancelledError():t}return E=this.browserStorage.generateNonceKey(m),$=this.browserStorage.getTemporaryCache(E),this.authCodeRequest.code=_.code,_.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(_.cloud_instance_host_name,s,l)]:[3,2];case 1:j.sent(),j.label=2;case 2:return _.nonce=$||void 0,_.state=m,_.client_info?this.authCodeRequest.clientInfo=_.client_info:(B=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=B),[4,this.authModule.acquireToken(this.authCodeRequest,_)];case 3:return q=j.sent(),this.browserStorage.cleanRequestByState(o),[2,q]}}))}))},RedirectHandler}(Qz);!function(t){t.INITIALIZE_START="msal:initializeStart",t.INITIALIZE_END="msal:initializeEnd",t.ACCOUNT_ADDED="msal:accountAdded",t.ACCOUNT_REMOVED="msal:accountRemoved",t.LOGIN_START="msal:loginStart",t.LOGIN_SUCCESS="msal:loginSuccess",t.LOGIN_FAILURE="msal:loginFailure",t.ACQUIRE_TOKEN_START="msal:acquireTokenStart",t.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",t.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",t.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",t.SSO_SILENT_START="msal:ssoSilentStart",t.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",t.SSO_SILENT_FAILURE="msal:ssoSilentFailure",t.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",t.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",t.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",t.HANDLE_REDIRECT_START="msal:handleRedirectStart",t.HANDLE_REDIRECT_END="msal:handleRedirectEnd",t.POPUP_OPENED="msal:popupOpened",t.LOGOUT_START="msal:logoutStart",t.LOGOUT_SUCCESS="msal:logoutSuccess",t.LOGOUT_FAILURE="msal:logoutFailure",t.LOGOUT_END="msal:logoutEnd",t.RESTORE_FROM_BFCACHE="msal:restoreFromBFCache"}(Az||(Az={})),function(t){t.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",t.USER_CANCEL="USER_CANCEL",t.NO_NETWORK="NO_NETWORK",t.TRANSIENT_ERROR="TRANSIENT_ERROR",t.PERSISTENT_ERROR="PERSISTENT_ERROR",t.DISABLED="DISABLED",t.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"}(Iz||(Iz={}));var Zz={code:"ContentError"},Jz={code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},Xz={code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"},eV=function(t){function NativeAuthError(o,s,l){var h=t.call(this,o,s)||this;return Object.setPrototypeOf(h,NativeAuthError.prototype),h.name="NativeAuthError",h.ext=l,h}return __extends$1(NativeAuthError,t),NativeAuthError.prototype.isFatal=function(){return!(!this.ext||!this.ext.status||this.ext.status!==Iz.PERSISTENT_ERROR&&this.ext.status!==Iz.DISABLED)||this.errorCode===Zz.code},NativeAuthError.createError=function(t,o,s){if(s&&s.status)switch(s.status){case Iz.ACCOUNT_UNAVAILABLE:return pq.createNativeAccountUnavailableError();case Iz.USER_INTERACTION_REQUIRED:return new pq(t,o);case Iz.USER_CANCEL:return hz.createUserCancelledError();case Iz.NO_NETWORK:return hz.createNoNetworkConnectivityError()}return new NativeAuthError(t,o,s)},NativeAuthError.createUserSwitchError=function(){return new NativeAuthError(Jz.code,Jz.desc)},NativeAuthError.createTokensNotFoundInCacheError=function(){return new NativeAuthError(Xz.code,Xz.desc)},NativeAuthError}(uH),tV=function(t){function SilentCacheClient(){return null!==t&&t.apply(this,arguments)||this}return __extends$1(SilentCacheClient,t),SilentCacheClient.prototype.acquireToken=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,m;return __generator$1(this,(function(_){switch(_.label){case 0:return o=this.performanceClient.startMeasurement(XU.SilentCacheClientAcquireToken,t.correlationId),s=this.initializeServerTelemetryManager(Dq.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(s,t.authority,t.azureCloudOptions)];case 1:l=_.sent(),this.logger.verbose("Silent auth client created"),_.label=2;case 2:return _.trys.push([2,4,,5]),[4,l.acquireCachedToken(t)];case 3:return h=_.sent(),o.endMeasurement({success:!0,fromCache:!0}),[2,h];case 4:throw(m=_.sent())instanceof hz&&m.errorCode===tz.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),o.endMeasurement({errorCode:m instanceof uH&&m.errorCode||void 0,subErrorCode:m instanceof uH&&m.subError||void 0,success:!1}),m;case 5:return[2]}}))}))},SilentCacheClient.prototype.logout=function(){return Promise.reject(hz.createSilentLogoutUnsupportedError())},SilentCacheClient.prototype.createSilentFlowClient=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){var l;return __generator$1(this,(function(h){switch(h.label){case 0:return this.performanceClient.setPreQueueTime(XU.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,s)];case 1:return l=h.sent(),[2,new Sq(l,this.performanceClient)]}}))}))},SilentCacheClient.prototype.initializeSilentRequest=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){var s;return __generator$1(this,(function(l){switch(l.label){case 0:return this.performanceClient.addQueueMeasurement(XU.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime(XU.InitializeBaseRequest,this.correlationId),s=[__assign$1({},t)],[4,this.initializeBaseRequest(t,o)];case 1:return[2,__assign$1.apply(void 0,[__assign$1.apply(void 0,s.concat([l.sent()])),{account:o,forceRefresh:t.forceRefresh||!1}])]}}))}))},SilentCacheClient}(Wz),rV=function(t){function NativeInteractionClient(o,s,l,h,m,_,E,$,B,q,j,K){var W=t.call(this,o,s,l,h,m,_,$,B,K)||this;return W.apiId=E,W.accountId=q,W.nativeMessageHandler=B,W.nativeStorageManager=j,W.silentCacheClient=new tV(o,W.nativeStorageManager,l,h,m,_,$,B,K),W}return __extends$1(NativeInteractionClient,t),NativeInteractionClient.prototype.acquireToken=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,m,_,E;return __generator$1(this,(function($){switch($.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),o=this.performanceClient.startMeasurement(XU.NativeInteractionClientAcquireToken,t.correlationId),s=sq.nowSeconds(),[4,this.initializeNativeRequest(t)];case 1:l=$.sent(),$.label=2;case 2:return $.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,l)];case 3:return h=$.sent(),o.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,h];case 4:return $.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return m={method:Pq.GetToken,request:l},[4,this.nativeMessageHandler.sendMessage(m)];case 6:return _=$.sent(),E=this.validateNativeResponse(_),[2,this.handleNativeResponse(E,l,s).then((function(t){return o.endMeasurement({success:!0,isNativeBroker:!0,requestId:t.requestId}),t})).catch((function(t){throw o.endMeasurement({success:!1,errorCode:t.errorCode,subErrorCode:t.subError,isNativeBroker:!0}),t}))]}}))}))},NativeInteractionClient.prototype.createSilentCacheRequest=function(t,o){return{authority:t.authority,correlationId:this.correlationId,scopes:DU.fromString(t.scope).asArray(),account:o,forceRefresh:!1}},NativeInteractionClient.prototype.acquireTokensFromCache=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){var s,l;return __generator$1(this,(function(h){switch(h.label){case 0:if(!t)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),iU.createNoAccountFoundError();if(!(s=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t})))throw iU.createNoAccountFoundError();h.label=1;case 1:return h.trys.push([1,3,,4]),l=this.createSilentCacheRequest(o,s),[4,this.silentCacheClient.acquireToken(l)];case 2:return[2,h.sent()];case 3:throw h.sent();case 4:return[2]}}))}))},NativeInteractionClient.prototype.acquireTokenRedirect=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,m,_;return __generator$1(this,(function(E){switch(E.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(t)];case 1:o=E.sent(),s={method:Pq.GetToken,request:o},E.label=2;case 2:return E.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(s)];case 3:return l=E.sent(),this.validateNativeResponse(l),[3,5];case 4:if((h=E.sent())instanceof eV&&h.isFatal())throw h;return[3,5];case 5:return this.browserStorage.setTemporaryCache(Mq.NATIVE_REQUEST,JSON.stringify(o),!0),m={apiId:Dq.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},_=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(t.redirectUri),[4,this.navigationClient.navigateExternal(_,m)];case 6:return E.sent(),[2]}}))}))},NativeInteractionClient.prototype.handleRedirectPromise=function(){return __awaiter$2(this,void 0,void 0,(function(){var t,o,s,l,h,m,_,E;return __generator$1(this,(function($){switch($.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(t=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];o=t.prompt,s=__rest(t,["prompt"]),o&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Mq.NATIVE_REQUEST)),l={method:Pq.GetToken,request:s},h=sq.nowSeconds(),$.label=1;case 1:return $.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(l)];case 2:return m=$.sent(),this.validateNativeResponse(m),_=this.handleNativeResponse(m,s,h),this.browserStorage.setInteractionInProgress(!1),[2,_];case 3:throw E=$.sent(),this.browserStorage.setInteractionInProgress(!1),E;case 4:return[2]}}))}))},NativeInteractionClient.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},NativeInteractionClient.prototype.handleNativeResponse=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){var l,h,m,_,E,$;return __generator$1(this,(function(B){switch(B.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),t.account.id!==o.accountId)throw eV.createUserSwitchError();return[4,this.getDiscoveredAuthority(o.authority)];case 1:return l=B.sent(),h=l.getPreferredCache(),m=this.createIdTokenObj(t),_=this.createHomeAccountIdentifier(t,m),E=this.createAccountEntity(t,_,m,h),[4,this.generateAuthenticationResult(t,o,m,E,l.canonicalAuthority,s)];case 2:return $=B.sent(),this.cacheAccount(E),this.cacheNativeTokens(t,o,_,E,m,$.accessToken,$.tenantId,s),[2,$]}}))}))},NativeInteractionClient.prototype.createIdTokenObj=function(t){return new FU(t.id_token||RB.EMPTY_STRING,this.browserCrypto)},NativeInteractionClient.prototype.createHomeAccountIdentifier=function(t,o){return LU.generateHomeAccountId(t.client_info||RB.EMPTY_STRING,uU.Default,this.logger,this.browserCrypto,o)},NativeInteractionClient.prototype.createAccountEntity=function(t,o,s,l){return LU.createAccount(t.client_info,o,s,void 0,void 0,void 0,l,t.account.id)},NativeInteractionClient.prototype.generateScopes=function(t,o){return t.scope?DU.fromString(t.scope):DU.fromString(o.scope)},NativeInteractionClient.prototype.generatePopAccessToken=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){var s,l;return __generator$1(this,(function(h){switch(h.label){case 0:if(o.tokenType!==WB.POP)return[3,2];if(t.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),[2,t.shr];if(s=new bq(this.browserCrypto),l={resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,shrNonce:o.shrNonce},!o.keyId)throw iU.createKeyIdMissingError();return[4,s.signPopToken(t.access_token,o.keyId,l)];case 1:return[2,h.sent()];case 2:return[2,t.access_token]}}))}))},NativeInteractionClient.prototype.generateAuthenticationResult=function(t,o,s,l,h,m){return __awaiter$2(this,void 0,void 0,(function(){var _,E,$,B,q,j,K;return __generator$1(this,(function(W){switch(W.label){case 0:return _=this.addTelemetryFromNativeResponse(t),E=t.scope?DU.fromString(t.scope):DU.fromString(o.scope),$=t.account.properties||{},B=$.UID||s.claims.oid||s.claims.sub||RB.EMPTY_STRING,q=$.TenantId||s.claims.tid||RB.EMPTY_STRING,[4,this.generatePopAccessToken(t,o)];case 1:return j=W.sent(),K=o.tokenType===WB.POP?WB.POP:WB.BEARER,[2,{authority:h,uniqueId:B,tenantId:q,scopes:E.asArray(),account:l.getAccountInfo(),idToken:t.id_token,idTokenClaims:s.claims,accessToken:j,fromCache:!!_&&this.isResponseFromCache(_),expiresOn:new Date(1e3*Number(m+t.expires_in)),tokenType:K,correlationId:this.correlationId,state:t.state,fromNativeBroker:!0}]}}))}))},NativeInteractionClient.prototype.cacheAccount=function(t){var o=this;this.browserStorage.setAccount(t),this.browserStorage.removeAccountContext(t).catch((function(t){o.logger.error("Error occurred while removing account context from browser storage. "+t)}))},NativeInteractionClient.prototype.cacheNativeTokens=function(t,o,s,l,h,m,_,E){var $=iq.createIdTokenEntity(s,o.authority,t.id_token||RB.EMPTY_STRING,o.clientId,h.claims.tid||RB.EMPTY_STRING),B=E+(o.tokenType===WB.POP?RB.SHR_NONCE_VALIDITY:("string"==typeof t.expires_in?parseInt(t.expires_in,10):t.expires_in)||0),q=this.generateScopes(t,o),j=aq.createAccessTokenEntity(s,o.authority,m,o.clientId,h?h.claims.tid||RB.EMPTY_STRING:_,q.printScopes(),B,0,this.browserCrypto),K=new fq(l,$,j);this.nativeStorageManager.saveCacheRecord(K)},NativeInteractionClient.prototype.addTelemetryFromNativeResponse=function(t){var o=this.getMATSFromResponse(t);return o?(this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:o.broker_version,matsAccountJoinOnStart:o.account_join_on_start,matsAccountJoinOnEnd:o.account_join_on_end,matsDeviceJoin:o.device_join,matsPromptBehavior:o.prompt_behavior,matsApiErrorCode:o.api_error_code,matsUiVisible:o.ui_visible,matsSilentCode:o.silent_code,matsSilentBiSubCode:o.silent_bi_sub_code,matsSilentMessage:o.silent_message,matsSilentStatus:o.silent_status,matsHttpStatus:o.http_status,matsHttpEventCount:o.http_event_count},this.correlationId),o):null},NativeInteractionClient.prototype.validateNativeResponse=function(t){if(t.hasOwnProperty("access_token")&&t.hasOwnProperty("id_token")&&t.hasOwnProperty("client_info")&&t.hasOwnProperty("account")&&t.hasOwnProperty("scope")&&t.hasOwnProperty("expires_in"))return t;throw eV.createUnexpectedError("Response missing expected properties.")},NativeInteractionClient.prototype.getMATSFromResponse=function(t){if(t.properties.MATS)try{return JSON.parse(t.properties.MATS)}catch(t){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},NativeInteractionClient.prototype.isResponseFromCache=function(t){return void 0===t.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!t.is_cached},NativeInteractionClient.prototype.initializeNativeRequest=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,m,_,E,$,B,q=this;return __generator$1(this,(function(j){switch(j.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),o=t.authority||this.config.auth.authority,t.account?[4,this.validateRequestAuthority(o,t.account)]:[3,2];case 1:j.sent(),j.label=2;case 2:return(s=new vq(o)).validateAsUri(),l=t.scopes,h=__rest(t,["scopes"]),(m=new DU(l||[])).appendScopes($B),_=function(){switch(q.apiId){case Dq.ssoSilent:case Dq.acquireTokenSilent_silentFlow:return q.logger.trace("initializeNativeRequest: silent request sets prompt to none"),NB.NONE}if(t.prompt)switch(t.prompt){case NB.NONE:case NB.CONSENT:case NB.LOGIN:return q.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),t.prompt;default:throw q.logger.trace("initializeNativeRequest: prompt = "+t.prompt+" is not compatible with native flow"),hz.createNativePromptParameterNotSupportedError()}else q.logger.trace("initializeNativeRequest: prompt was not provided")},E=__assign$1(__assign$1({},h),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:s.urlString,scope:m.printScopes(),redirectUri:this.getRedirectUri(t.redirectUri),prompt:_(),correlationId:this.correlationId,tokenType:t.authenticationScheme,windowTitleSubstring:document.title,extraParameters:__assign$1(__assign$1(__assign$1({},t.extraQueryParameters),t.tokenQueryParameters),{telemetry:Cz}),extendedExpiryToken:!1}),t.authenticationScheme!==WB.POP?[3,4]:($={resourceRequestUri:t.resourceRequestUri,resourceRequestMethod:t.resourceRequestMethod,shrClaims:t.shrClaims,shrNonce:t.shrNonce},[4,new bq(this.browserCrypto).generateCnf($)]);case 3:B=j.sent(),E.reqCnf=B.reqCnfString,E.keyId=B.kid,j.label=4;case 4:return[2,E]}}))}))},NativeInteractionClient}(Kz),oV=function(){function NativeMessageHandler(t,o,s,l){this.logger=t,this.handshakeTimeoutMs=o,this.extensionId=l,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=s,this.handshakeEvent=s.startMeasurement(XU.NativeMessageHandlerHandshake)}return NativeMessageHandler.prototype.sendMessage=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s=this;return __generator$1(this,(function(l){return this.logger.trace("NativeMessageHandler - sendMessage called."),o={channel:bz,extensionId:this.extensionId,responseId:this.responseId++,body:t},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(o)),this.messageChannel.port1.postMessage(o),[2,new Promise((function(t,l){s.resolvers.set(o.responseId,{resolve:t,reject:l})}))]}))}))},NativeMessageHandler.createProvider=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){var l,h;return __generator$1(this,(function(m){switch(m.label){case 0:t.trace("NativeMessageHandler - createProvider called."),m.label=1;case 1:return m.trys.push([1,3,,5]),[4,(l=new NativeMessageHandler(t,o,s,wz)).sendHandshakeRequest()];case 2:return m.sent(),[2,l];case 3:return m.sent(),[4,(h=new NativeMessageHandler(t,o,s)).sendHandshakeRequest()];case 4:return m.sent(),[2,h];case 5:return[2]}}))}))},NativeMessageHandler.prototype.sendHandshakeRequest=function(){return __awaiter$2(this,void 0,void 0,(function(){var t,o=this;return __generator$1(this,(function(s){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),t={channel:bz,extensionId:this.extensionId,responseId:this.responseId++,body:{method:Pq.HandshakeRequest}},this.handshakeEvent.addStaticFields({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=function(t){o.onChannelMessage(t)},window.postMessage(t,window.origin,[this.messageChannel.port2]),[2,new Promise((function(s,l){o.handshakeResolvers.set(t.responseId,{resolve:s,reject:l}),o.timeoutId=window.setTimeout((function(){window.removeEventListener("message",o.windowListener,!1),o.messageChannel.port1.close(),o.messageChannel.port2.close(),o.handshakeEvent.endMeasurement({extensionHandshakeTimedOut:!0,success:!1}),l(hz.createNativeHandshakeTimeoutError()),o.handshakeResolvers.delete(t.responseId)}),o.handshakeTimeoutMs)}))]}))}))},NativeMessageHandler.prototype.onWindowMessage=function(t){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),t.source===window){var o=t.data;if(o.channel&&o.channel===bz&&(!o.extensionId||o.extensionId===this.extensionId)&&o.body.method===Pq.HandshakeRequest){this.logger.verbose(o.extensionId?"Extension with id: "+o.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var s=this.handshakeResolvers.get(o.responseId);s&&(this.handshakeEvent.endMeasurement({success:!1,extensionInstalled:!1}),s.reject(hz.createNativeExtensionNotInstalledError()))}}},NativeMessageHandler.prototype.onChannelMessage=function(t){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var o=t.data,s=this.resolvers.get(o.responseId),l=this.handshakeResolvers.get(o.responseId);try{var h=o.body.method;if(h===Pq.Response){if(!s)return;var m=o.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(m)),"Success"!==m.status)s.reject(eV.createError(m.code,m.description,m.ext));else{if(!m.result)throw uH.createUnexpectedError("Event does not contain result.");m.result.code&&m.result.description?s.reject(eV.createError(m.result.code,m.result.description,m.result.ext)):s.resolve(m.result)}this.resolvers.delete(o.responseId)}else if(h===Pq.HandshakeResponse){if(!l)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=o.extensionId,this.extensionVersion=o.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),this.handshakeEvent.endMeasurement({extensionInstalled:!0,success:!0}),l.resolve(),this.handshakeResolvers.delete(o.responseId)}}catch(o){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+o.toString()),this.logger.errorPii("Unable to parse "+t),s?s.reject(o):l&&l.reject(o)}},NativeMessageHandler.prototype.getExtensionId=function(){return this.extensionId},NativeMessageHandler.prototype.getExtensionVersion=function(){return this.extensionVersion},NativeMessageHandler.isNativeAvailable=function(t,o,s,l){if(o.trace("isNativeAvailable called"),!t.system.allowNativeBroker)return o.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!s)return o.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(l)switch(l){case WB.BEARER:case WB.POP:return o.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return o.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},NativeMessageHandler}(),nV=function(t){function RedirectClient(o,s,l,h,m,_,E,$,B,q){var j=t.call(this,o,s,l,h,m,_,E,B,q)||this;return j.nativeStorage=$,j}return __extends$1(RedirectClient,t),RedirectClient.prototype.acquireToken=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,m,_,E,$,B,q=this;return __generator$1(this,(function(j){switch(j.label){case 0:return this.performanceClient.setPreQueueTime(XU.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,Lq.Redirect)];case 1:o=j.sent(),this.browserStorage.updateCacheEntries(o.state,o.nonce,o.authority,o.loginHint||RB.EMPTY_STRING,o.account||null),s=this.initializeServerTelemetryManager(Dq.acquireTokenRedirect),l=function(t){t.persisted&&(q.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),q.browserStorage.cleanRequestByState(o.state),q.eventHandler.emitEvent(Az.RESTORE_FROM_BFCACHE,Lq.Redirect))},j.label=2;case 2:return j.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime(XU.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(o)];case 3:return h=j.sent(),this.performanceClient.setPreQueueTime(XU.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(s,o.authority,o.azureCloudOptions)];case 4:return m=j.sent(),this.logger.verbose("Auth code client created"),_=new Yz(m,this.browserStorage,h,this.logger,this.browserCrypto,this.performanceClient),[4,m.getAuthCodeUrl(__assign$1(__assign$1({},o),{nativeBroker:oV.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 5:return E=j.sent(),$=this.getRedirectStartPage(t.redirectStartPage),this.logger.verbosePii("Redirect start page: "+$),window.addEventListener("pageshow",l),[4,_.initiateAuthRequest(E,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:$,onRedirectNavigate:t.onRedirectNavigate})];case 6:return[2,j.sent()];case 7:throw(B=j.sent())instanceof uH&&B.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",l),s.cacheFailedRequest(B),this.browserStorage.cleanRequestByState(o.state),B;case 8:return[2]}}))}))},RedirectClient.prototype.handleRedirectPromise=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,m,_,E,$,B,q,j,K;return __generator$1(this,(function(W){switch(W.label){case 0:o=this.initializeServerTelemetryManager(Dq.handleRedirectPromise),W.label=1;case 1:if(W.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(s=this.getRedirectResponseHash(t||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(Lq.Redirect),[2,null];l=void 0;try{h=vq.getDeserializedHash(s),l=this.validateAndExtractStateFromHash(h,Lq.Redirect),this.logger.verbose("State extracted from hash")}catch(t){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+t),this.browserStorage.cleanRequestByInteractionType(Lq.Redirect),[2,null]}return m=this.browserStorage.getTemporaryCache(Mq.ORIGIN_URI,!0)||RB.EMPTY_STRING,_=vq.removeHashFromUrl(m),E=vq.removeHashFromUrl(window.location.href),_===E&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(s,l,o)]):[3,3];case 2:return $=W.sent(),m.indexOf("#")>-1&&Gz.replaceHash(m),[2,$];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(s,l,o)]);case 4:return Gz.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(Mq.URL_HASH,s,!0),B={apiId:Dq.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},q=!0,m&&"null"!==m?[3,6]:(j=Gz.getHomepage(),this.browserStorage.setTemporaryCache(Mq.ORIGIN_URI,j,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(j,B)]));case 5:return q=W.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+m),[4,this.navigationClient.navigateInternal(m,B)];case 7:q=W.sent(),W.label=8;case 8:if(!q)return[2,this.handleHash(s,l,o)];W.label=9;case 9:return[2,null];case 10:throw(K=W.sent())instanceof uH&&K.setCorrelationId(this.correlationId),o.cacheFailedRequest(K),this.browserStorage.cleanRequestByInteractionType(Lq.Redirect),K;case 11:return[2]}}))}))},RedirectClient.prototype.getRedirectResponseHash=function(t){if(this.logger.verbose("getRedirectResponseHash called"),vq.hashContainsKnownProperties(t))return Gz.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),t;var o=this.browserStorage.getTemporaryCache(Mq.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Mq.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),o},RedirectClient.prototype.handleHash=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){var l,h,m,_,E,$,B=this;return __generator$1(this,(function(q){switch(q.label){case 0:if(l=this.browserStorage.getCachedRequest(o,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(h=vq.getDeserializedHash(t)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw hz.createNativeConnectionNotEstablishedError();return m=new rV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Dq.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,h.accountId,this.nativeStorage,l.correlationId),_=gq.parseRequestState(this.browserCrypto,o).userRequestState,[2,m.acquireToken(__assign$1(__assign$1({},l),{state:_,prompt:void 0})).finally((function(){B.browserStorage.cleanRequestByState(o)}))]}if(!(E=this.browserStorage.getCachedAuthority(o)))throw hz.createNoCachedAuthorityError();return this.performanceClient.setPreQueueTime(XU.StandardInteractionClientCreateAuthCodeClient,l.correlationId),[4,this.createAuthCodeClient(s,E)];case 1:return $=q.sent(),this.logger.verbose("Auth code client created"),ZU.removeThrottle(this.browserStorage,this.config.auth.clientId,l),[4,new Yz($,this.browserStorage,l,this.logger,this.browserCrypto,this.performanceClient).handleCodeResponseFromHash(t,o,$.authority,this.networkClient)];case 2:return[2,q.sent()]}}))}))},RedirectClient.prototype.logout=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,m,_;return __generator$1(this,(function(E){switch(E.label){case 0:this.logger.verbose("logoutRedirect called"),o=this.initializeLogoutRequest(t),s=this.initializeServerTelemetryManager(Dq.logout),E.label=1;case 1:return E.trys.push([1,10,,11]),this.eventHandler.emitEvent(Az.LOGOUT_START,Lq.Redirect,t),[4,this.clearCacheOnLogout(o.account)];case 2:return E.sent(),l={apiId:Dq.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime(XU.StandardInteractionClientCreateAuthCodeClient,o.correlationId),[4,this.createAuthCodeClient(s,t&&t.authority)];case 3:return h=E.sent(),this.logger.verbose("Auth code client created"),m=h.getLogoutUri(o),this.eventHandler.emitEvent(Az.LOGOUT_SUCCESS,Lq.Redirect,o),t&&"function"==typeof t.onRedirectNavigate?!1===t.onRedirectNavigate(m)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(m,l)]):[3,7];case 4:return E.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),E.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(m,l)];case 8:return E.sent(),[2];case 9:return[3,11];case 10:throw(_=E.sent())instanceof uH&&_.setCorrelationId(this.correlationId),s.cacheFailedRequest(_),this.eventHandler.emitEvent(Az.LOGOUT_FAILURE,Lq.Redirect,null,_),this.eventHandler.emitEvent(Az.LOGOUT_END,Lq.Redirect),_;case 11:return this.eventHandler.emitEvent(Az.LOGOUT_END,Lq.Redirect),[2]}}))}))},RedirectClient.prototype.getRedirectStartPage=function(t){var o=t||window.location.href;return vq.getAbsoluteUrl(o,Gz.getCurrentUri())},RedirectClient}(Wz),iV=function(t){function PopupClient(o,s,l,h,m,_,E,$,B,q){var j=t.call(this,o,s,l,h,m,_,E,B,q)||this;return j.unloadWindow=j.unloadWindow.bind(j),j.nativeStorage=$,j}return __extends$1(PopupClient,t),PopupClient.prototype.acquireToken=function(t){try{var o=this.generatePopupName(t.scopes||$B,t.authority||this.config.auth.authority),s=t.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(t,o,s);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var l=this.openSizedPopup("about:blank",o,s);return this.acquireTokenPopupAsync(t,o,s,l)}catch(t){return Promise.reject(t)}},PopupClient.prototype.logout=function(t){try{this.logger.verbose("logoutPopup called");var o=this.initializeLogoutRequest(t),s=this.generateLogoutPopupName(o),l=t&&t.authority,h=t&&t.mainWindowRedirectUri,m=(null==t?void 0:t.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(o,s,m,l,void 0,h);this.logger.verbose("asyncPopup set to false, opening popup");var _=this.openSizedPopup("about:blank",s,m);return this.logoutPopupAsync(o,s,m,l,_,h)}catch(t){return Promise.reject(t)}},PopupClient.prototype.acquireTokenPopupAsync=function(t,o,s,l){return __awaiter$2(this,void 0,void 0,(function(){var h,m,_,E,$,B,q,j,K,W,X,re,oe,ne,ae,le,de=this;return __generator$1(this,(function(me){switch(me.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),h=this.initializeServerTelemetryManager(Dq.acquireTokenPopup),this.performanceClient.setPreQueueTime(XU.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,Lq.Popup)];case 1:m=me.sent(),this.browserStorage.updateCacheEntries(m.state,m.nonce,m.authority,m.loginHint||RB.EMPTY_STRING,m.account||null),me.label=2;case 2:return me.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime(XU.StandardInteractionClientInitializeAuthorizationCodeRequest,t.correlationId),[4,this.initializeAuthorizationCodeRequest(m)];case 3:return _=me.sent(),this.performanceClient.setPreQueueTime(XU.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(h,m.authority,m.azureCloudOptions)];case 4:return E=me.sent(),this.logger.verbose("Auth code client created"),$=oV.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme),B=void 0,$&&(B=this.performanceClient.startMeasurement(XU.FetchAccountIdWithNativeBroker,t.correlationId)),[4,E.getAuthCodeUrl(__assign$1(__assign$1({},m),{nativeBroker:$}))];case 5:return q=me.sent(),j=new Qz(E,this.browserStorage,_,this.logger,this.performanceClient),K={popup:l,popupName:o,popupWindowAttributes:s},W=this.initiateAuthRequest(q,K),this.eventHandler.emitEvent(Az.POPUP_OPENED,Lq.Popup,{popupWindow:W},null),[4,this.monitorPopupForHash(W)];case 6:if(X=me.sent(),re=vq.getDeserializedHash(X),oe=this.validateAndExtractStateFromHash(re,Lq.Popup,m.correlationId),ZU.removeThrottle(this.browserStorage,this.config.auth.clientId,_),re.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),B&&B.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw hz.createNativeConnectionNotEstablishedError();return ne=new rV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Dq.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,re.accountId,this.nativeStorage,m.correlationId),ae=gq.parseRequestState(this.browserCrypto,oe).userRequestState,[2,ne.acquireToken(__assign$1(__assign$1({},m),{state:ae,prompt:void 0})).finally((function(){de.browserStorage.cleanRequestByState(oe)}))]}return[4,j.handleCodeResponseFromHash(X,oe,E.authority,this.networkClient)];case 7:return[2,me.sent()];case 8:throw le=me.sent(),l&&l.close(),le instanceof uH&&le.setCorrelationId(this.correlationId),h.cacheFailedRequest(le),this.browserStorage.cleanRequestByState(m.state),le;case 9:return[2]}}))}))},PopupClient.prototype.logoutPopupAsync=function(t,o,s,l,h,m){return __awaiter$2(this,void 0,void 0,(function(){var _,E,$,B,q,j,K;return __generator$1(this,(function(W){switch(W.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Az.LOGOUT_START,Lq.Popup,t),_=this.initializeServerTelemetryManager(Dq.logoutPopup),W.label=1;case 1:return W.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(t.account)];case 2:return W.sent(),this.performanceClient.setPreQueueTime(XU.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(_,l)];case 3:return E=W.sent(),this.logger.verbose("Auth code client created"),$=E.getLogoutUri(t),this.eventHandler.emitEvent(Az.LOGOUT_SUCCESS,Lq.Popup,t),B=this.openPopup($,{popupName:o,popupWindowAttributes:s,popup:h}),this.eventHandler.emitEvent(Az.POPUP_OPENED,Lq.Popup,{popupWindow:B},null),[4,this.waitForLogoutPopup(B)];case 4:return W.sent(),m?(q={apiId:Dq.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},j=vq.getAbsoluteUrl(m,Gz.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+j),this.navigationClient.navigateInternal(j,q)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw K=W.sent(),h&&h.close(),K instanceof uH&&K.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(Az.LOGOUT_FAILURE,Lq.Popup,null,K),this.eventHandler.emitEvent(Az.LOGOUT_END,Lq.Popup),_.cacheFailedRequest(K),K;case 6:return this.eventHandler.emitEvent(Az.LOGOUT_END,Lq.Popup),[2]}}))}))},PopupClient.prototype.initiateAuthRequest=function(t,o){if(sU.isEmpty(t))throw this.logger.error("Navigate url is empty"),hz.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+t),this.openPopup(t,o)},PopupClient.prototype.monitorPopupForHash=function(t){var o=this;return new Promise((function(s,l){var h=o.config.system.windowHashTimeout/o.config.system.pollIntervalMilliseconds,m=0;o.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var _=setInterval((function(){if(t.closed)return o.logger.error("PopupHandler.monitorPopupForHash - window closed"),o.cleanPopup(),clearInterval(_),void l(hz.createUserCancelledError());var E=RB.EMPTY_STRING,$=RB.EMPTY_STRING;try{E=t.location.href,$=t.location.hash}catch(t){}sU.isEmpty(E)||"about:blank"===E||(o.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),m++,$?(o.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(_),o.cleanPopup(t),vq.hashContainsKnownProperties($)?(o.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),s($)):(o.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),o.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+$),l(hz.createHashDoesNotContainKnownPropertiesError()))):m>h&&(o.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(_),l(hz.createMonitorPopupTimeoutError())))}),o.config.system.pollIntervalMilliseconds)}))},PopupClient.prototype.waitForLogoutPopup=function(t){var o=this;return new Promise((function(s){o.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var l=setInterval((function(){t.closed&&(o.logger.error("PopupHandler.waitForLogoutPopup - window closed"),o.cleanPopup(),clearInterval(l),s());var h=RB.EMPTY_STRING;try{h=t.location.href}catch(t){}sU.isEmpty(h)||"about:blank"===h||(o.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(l),o.cleanPopup(t),s())}),o.config.system.pollIntervalMilliseconds)}))},PopupClient.prototype.openPopup=function(t,o){try{var s=void 0;if(o.popup?(s=o.popup,this.logger.verbosePii("Navigating popup window to: "+t),s.location.assign(t)):void 0===o.popup&&(this.logger.verbosePii("Opening popup window to: "+t),s=this.openSizedPopup(t,o.popupName,o.popupWindowAttributes)),!s)throw hz.createEmptyWindowCreatedError();return s.focus&&s.focus(),this.currentWindow=s,window.addEventListener("beforeunload",this.unloadWindow),s}catch(t){throw this.logger.error("error opening popup "+t.message),this.browserStorage.setInteractionInProgress(!1),hz.createPopupWindowError(t.toString())}},PopupClient.prototype.openSizedPopup=function(t,o,s){var l,h,m,_,E=window.screenLeft?window.screenLeft:window.screenX,$=window.screenTop?window.screenTop:window.screenY,B=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,q=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,j=null===(l=s.popupSize)||void 0===l?void 0:l.width,K=null===(h=s.popupSize)||void 0===h?void 0:h.height,W=null===(m=s.popupPosition)||void 0===m?void 0:m.top,X=null===(_=s.popupPosition)||void 0===_?void 0:_.left;return(!j||j<0||j>B)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),j=fz),(!K||K<0||K>q)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),K=gz),(!W||W<0||W>q)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),W=Math.max(0,q/2-gz/2+$)),(!X||X<0||X>B)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),X=Math.max(0,B/2-fz/2+E)),window.open(t,o,"width="+j+", height="+K+", top="+W+", left="+X+", scrollbars=yes")},PopupClient.prototype.unloadWindow=function(t){this.browserStorage.cleanRequestByInteractionType(Lq.Popup),this.currentWindow&&this.currentWindow.close(),t.preventDefault()},PopupClient.prototype.cleanPopup=function(t){t&&t.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},PopupClient.prototype.generatePopupName=function(t,o){return vz+"."+this.config.auth.clientId+"."+t.join("-")+"."+o+"."+this.correlationId},PopupClient.prototype.generateLogoutPopupName=function(t){var o=t.account&&t.account.homeAccountId;return vz+"."+this.config.auth.clientId+"."+o+"."+this.correlationId},PopupClient}(Wz),sV=function(){function NavigationClient(){}return NavigationClient.prototype.navigateInternal=function(t,o){return NavigationClient.defaultNavigateWindow(t,o)},NavigationClient.prototype.navigateExternal=function(t,o){return NavigationClient.defaultNavigateWindow(t,o)},NavigationClient.defaultNavigateWindow=function(t,o){return o.noHistory?window.location.replace(t):window.location.assign(t),new Promise((function(t){setTimeout((function(){t(!0)}),o.timeout)}))},NavigationClient}(),aV=6e3;
/*! @azure/msal-browser v2.38.2 2023-08-24 */
var lV,cV=function(t){function SilentHandler(o,s,l,h,m,_){var E=t.call(this,o,s,l,h,_)||this;return E.navigateFrameWait=m.navigateFrameWait,E.pollIntervalMilliseconds=m.pollIntervalMilliseconds,E}return __extends$1(SilentHandler,t),SilentHandler.prototype.initiateAuthRequest=function(t){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(o){switch(o.label){case 0:if(this.performanceClient.addQueueMeasurement(XU.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),sU.isEmpty(t))throw this.logger.info("Navigate url is empty"),hz.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime(XU.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(t)]):[3,2];case 1:return[2,o.sent()];case 2:return[2,this.loadFrameSync(t)]}}))}))},SilentHandler.prototype.monitorIframeForHash=function(t,o){var s=this;return this.performanceClient.addQueueMeasurement(XU.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise((function(l,h){o<aV&&s.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+o+"ms) than the default ("+aV+"ms). This may result in timeouts.");var m=window.performance.now()+o,_=setInterval((function(){if(window.performance.now()>m)return s.removeHiddenIframe(t),clearInterval(_),void h(hz.createMonitorIframeTimeoutError());var o=RB.EMPTY_STRING,E=t.contentWindow;try{o=E?E.location.href:RB.EMPTY_STRING}catch(t){}if(!sU.isEmpty(o)){var $=E?E.location.hash:RB.EMPTY_STRING;return vq.hashContainsKnownProperties($)?(s.removeHiddenIframe(t),clearInterval(_),void l($)):void 0}}),s.pollIntervalMilliseconds)}))},SilentHandler.prototype.loadFrame=function(t){var o=this;return this.performanceClient.addQueueMeasurement(XU.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise((function(s,l){var h=o.createHiddenIframe();setTimeout((function(){h?(h.src=t,s(h)):l("Unable to load iframe")}),o.navigateFrameWait)}))},SilentHandler.prototype.loadFrameSync=function(t){var o=this.createHiddenIframe();return o.src=t,o},SilentHandler.prototype.createHiddenIframe=function(){var t=document.createElement("iframe");return t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(t),t},SilentHandler.prototype.removeHiddenIframe=function(t){document.body===t.parentNode&&document.body.removeChild(t)},SilentHandler}(Qz),dV=function(t){function SilentIframeClient(o,s,l,h,m,_,E,$,B,q,j){var K=t.call(this,o,s,l,h,m,_,$,q,j)||this;return K.apiId=E,K.nativeStorage=B,K}return __extends$1(SilentIframeClient,t),SilentIframeClient.prototype.acquireToken=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,m;return __generator$1(this,(function(_){switch(_.label){case 0:if(this.performanceClient.addQueueMeasurement(XU.SilentIframeClientAcquireToken,t.correlationId),this.logger.verbose("acquireTokenByIframe called"),o=this.performanceClient.startMeasurement(XU.SilentIframeClientAcquireToken,t.correlationId),sU.isEmpty(t.loginHint)&&sU.isEmpty(t.sid)&&(!t.account||sU.isEmpty(t.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),t.prompt&&t.prompt!==NB.NONE&&t.prompt!==NB.NO_SESSION)throw o.endMeasurement({success:!1}),hz.createSilentPromptValueError(t.prompt);return this.performanceClient.setPreQueueTime(XU.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(__assign$1(__assign$1({},t),{prompt:t.prompt||NB.NONE}),Lq.Silent)];case 1:s=_.sent(),this.browserStorage.updateCacheEntries(s.state,s.nonce,s.authority,s.loginHint||RB.EMPTY_STRING,s.account||null),l=this.initializeServerTelemetryManager(this.apiId),_.label=2;case 2:return _.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime(XU.StandardInteractionClientCreateAuthCodeClient,t.correlationId),[4,this.createAuthCodeClient(l,s.authority,s.azureCloudOptions)];case 3:return h=_.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime(XU.SilentIframeClientTokenHelper,t.correlationId),[4,this.silentTokenHelper(h,s).then((function(t){return o.endMeasurement({success:!0,fromCache:!1,requestId:t.requestId}),t}))];case 4:return[2,_.sent()];case 5:throw(m=_.sent())instanceof uH&&m.setCorrelationId(this.correlationId),l.cacheFailedRequest(m),this.browserStorage.cleanRequestByState(s.state),o.endMeasurement({errorCode:m instanceof uH&&m.errorCode||void 0,subErrorCode:m instanceof uH&&m.subError||void 0,success:!1}),m;case 6:return[2]}}))}))},SilentIframeClient.prototype.logout=function(){return Promise.reject(hz.createSilentLogoutUnsupportedError())},SilentIframeClient.prototype.silentTokenHelper=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){var s,l,h,m,_,E,$,B,q,j=this;return __generator$1(this,(function(K){switch(K.label){case 0:return this.performanceClient.addQueueMeasurement(XU.SilentIframeClientTokenHelper,o.correlationId),this.performanceClient.setPreQueueTime(XU.StandardInteractionClientInitializeAuthorizationCodeRequest,o.correlationId),[4,this.initializeAuthorizationCodeRequest(o)];case 1:return s=K.sent(),this.performanceClient.setPreQueueTime(XU.GetAuthCodeUrl,o.correlationId),[4,t.getAuthCodeUrl(__assign$1(__assign$1({},o),{nativeBroker:oV.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,o.authenticationScheme)}))];case 2:return l=K.sent(),h=new cV(t,this.browserStorage,s,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime(XU.SilentHandlerInitiateAuthRequest,o.correlationId),[4,h.initiateAuthRequest(l)];case 3:return m=K.sent(),this.performanceClient.setPreQueueTime(XU.SilentHandlerMonitorIframeForHash,o.correlationId),[4,h.monitorIframeForHash(m,this.config.system.iframeHashTimeout)];case 4:if(_=K.sent(),E=vq.getDeserializedHash(_),$=this.validateAndExtractStateFromHash(E,Lq.Silent,s.correlationId),E.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw hz.createNativeConnectionNotEstablishedError();return B=new rV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,E.accountId,this.browserStorage,this.correlationId),q=gq.parseRequestState(this.browserCrypto,$).userRequestState,[2,B.acquireToken(__assign$1(__assign$1({},o),{state:q,prompt:o.prompt||NB.NONE})).finally((function(){j.browserStorage.cleanRequestByState($)}))]}return this.performanceClient.setPreQueueTime(XU.HandleCodeResponseFromHash,o.correlationId),[2,h.handleCodeResponseFromHash(_,$,t.authority,this.networkClient)]}}))}))},SilentIframeClient}(Wz),uV=function(t){function SilentRefreshClient(){return null!==t&&t.apply(this,arguments)||this}return __extends$1(SilentRefreshClient,t),SilentRefreshClient.prototype.acquireToken=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,m,_=this;return __generator$1(this,(function(E){switch(E.label){case 0:return this.performanceClient.addQueueMeasurement(XU.SilentRefreshClientAcquireToken,t.correlationId),this.performanceClient.setPreQueueTime(XU.InitializeBaseRequest,t.correlationId),s=[__assign$1({},t)],[4,this.initializeBaseRequest(t,t.account)];case 1:return o=__assign$1.apply(void 0,s.concat([E.sent()])),l=this.performanceClient.startMeasurement(XU.SilentRefreshClientAcquireToken,o.correlationId),h=this.initializeServerTelemetryManager(Dq.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(h,o.authority,o.azureCloudOptions)];case 2:return m=E.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime(XU.RefreshTokenClientAcquireTokenByRefreshToken,t.correlationId),[2,m.acquireTokenByRefreshToken(o).then((function(t){return l.endMeasurement({success:!0,fromCache:t.fromCache,requestId:t.requestId}),t})).catch((function(t){throw t instanceof uH&&t.setCorrelationId(_.correlationId),h.cacheFailedRequest(t),l.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t}))]}}))}))},SilentRefreshClient.prototype.logout=function(){return Promise.reject(hz.createSilentLogoutUnsupportedError())},SilentRefreshClient.prototype.createRefreshTokenClient=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){var l;return __generator$1(this,(function(h){switch(h.label){case 0:return this.performanceClient.setPreQueueTime(XU.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(t,o,s)];case 1:return l=h.sent(),[2,new xq(l,this.performanceClient)]}}))}))},SilentRefreshClient}(Wz),hV=function(){function EventHandler(t,o){this.eventCallbacks=new Map,this.logger=t,this.browserCrypto=o,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return EventHandler.prototype.addEventCallback=function(t){if("undefined"!=typeof window){var o=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(o,t),this.logger.verbose("Event callback registered with id: "+o),o}return null},EventHandler.prototype.removeEventCallback=function(t){this.eventCallbacks.delete(t),this.logger.verbose("Event callback "+t+" removed.")},EventHandler.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},EventHandler.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},EventHandler.prototype.emitEvent=function(t,o,s,l){var h=this;if("undefined"!=typeof window){var m={eventType:t,interactionType:o||null,payload:s||null,error:l||null,timestamp:Date.now()};this.logger.info("Emitting event: "+t),this.eventCallbacks.forEach((function(o,s){h.logger.verbose("Emitting event to callback "+s+": "+t),o.apply(null,[m])}))}},EventHandler.prototype.handleAccountCacheChange=function(t){try{var o=t.newValue||t.oldValue;if(!o)return;var s=JSON.parse(o);if("object"!=typeof s||!LU.isAccountEntity(s))return;var l=BU.toObject(new LU,s).getAccountInfo();!t.oldValue&&t.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(Az.ACCOUNT_ADDED,void 0,l)):!t.newValue&&t.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(Az.ACCOUNT_REMOVED,void 0,l))}catch(t){return}},EventHandler}(),pV=function(){function MathUtils(){}return MathUtils.decimalToHex=function(t){for(var o=t.toString(16);o.length<2;)o="0"+o;return o},MathUtils}(),fV=function(){function GuidGenerator(t){this.cryptoObj=t}return GuidGenerator.prototype.generateGuid=function(){try{var t=new Uint8Array(16);return this.cryptoObj.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,pV.decimalToHex(t[0])+pV.decimalToHex(t[1])+pV.decimalToHex(t[2])+pV.decimalToHex(t[3])+"-"+pV.decimalToHex(t[4])+pV.decimalToHex(t[5])+"-"+pV.decimalToHex(t[6])+pV.decimalToHex(t[7])+"-"+pV.decimalToHex(t[8])+pV.decimalToHex(t[9])+"-"+pV.decimalToHex(t[10])+pV.decimalToHex(t[11])+pV.decimalToHex(t[12])+pV.decimalToHex(t[13])+pV.decimalToHex(t[14])+pV.decimalToHex(t[15])}catch(t){for(var o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",s="0123456789abcdef",l=0,h=RB.EMPTY_STRING,m=0;m<36;m++)"-"!==o[m]&&"4"!==o[m]&&(l=16*Math.random()|0),"x"===o[m]?h+=s[l]:"y"===o[m]?(l&=3,h+=s[l|=8]):h+=o[m];return h}},GuidGenerator.prototype.isGuid=function(t){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)},GuidGenerator}(),gV=function(){function BrowserStringUtils(){}return BrowserStringUtils.stringToUtf8Arr=function(t){for(var o,s=0,l=t.length,h=0;h<l;h++)s+=(o=t.charCodeAt(h))<128?1:o<2048?2:o<65536?3:o<2097152?4:o<67108864?5:6;for(var m=new Uint8Array(s),_=0,E=0;_<s;E++)(o=t.charCodeAt(E))<128?m[_++]=o:o<2048?(m[_++]=192+(o>>>6),m[_++]=128+(63&o)):o<65536?(m[_++]=224+(o>>>12),m[_++]=128+(o>>>6&63),m[_++]=128+(63&o)):o<2097152?(m[_++]=240+(o>>>18),m[_++]=128+(o>>>12&63),m[_++]=128+(o>>>6&63),m[_++]=128+(63&o)):o<67108864?(m[_++]=248+(o>>>24),m[_++]=128+(o>>>18&63),m[_++]=128+(o>>>12&63),m[_++]=128+(o>>>6&63),m[_++]=128+(63&o)):(m[_++]=252+(o>>>30),m[_++]=128+(o>>>24&63),m[_++]=128+(o>>>18&63),m[_++]=128+(o>>>12&63),m[_++]=128+(o>>>6&63),m[_++]=128+(63&o));return m},BrowserStringUtils.stringToArrayBuffer=function(t){for(var o=new ArrayBuffer(t.length),s=new Uint8Array(o),l=0;l<t.length;l++)s[l]=t.charCodeAt(l);return o},BrowserStringUtils.utf8ArrToString=function(t){for(var o=RB.EMPTY_STRING,s=void 0,l=t.length,h=0;h<l;h++)s=t[h],o+=String.fromCharCode(s>251&&s<254&&h+5<l?1073741824*(s-252)+(t[++h]-128<<24)+(t[++h]-128<<18)+(t[++h]-128<<12)+(t[++h]-128<<6)+t[++h]-128:s>247&&s<252&&h+4<l?(s-248<<24)+(t[++h]-128<<18)+(t[++h]-128<<12)+(t[++h]-128<<6)+t[++h]-128:s>239&&s<248&&h+3<l?(s-240<<18)+(t[++h]-128<<12)+(t[++h]-128<<6)+t[++h]-128:s>223&&s<240&&h+2<l?(s-224<<12)+(t[++h]-128<<6)+t[++h]-128:s>191&&s<224&&h+1<l?(s-192<<6)+t[++h]-128:s);return o},BrowserStringUtils.getSortedObjectString=function(t){return JSON.stringify(t,Object.keys(t).sort())},BrowserStringUtils}(),vV=function(){function Base64Encode(){}return Base64Encode.prototype.urlEncode=function(t){return encodeURIComponent(this.encode(t).replace(/=/g,RB.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},Base64Encode.prototype.urlEncodeArr=function(t){return this.base64EncArr(t).replace(/=/g,RB.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},Base64Encode.prototype.encode=function(t){var o=gV.stringToUtf8Arr(t);return this.base64EncArr(o)},Base64Encode.prototype.base64EncArr=function(t){for(var o=(3-t.length%3)%3,s=RB.EMPTY_STRING,l=void 0,h=t.length,m=0,_=0;_<h;_++)l=_%3,m|=t[_]<<(16>>>l&24),2!==l&&t.length-_!=1||(s+=String.fromCharCode(this.uint6ToB64(m>>>18&63),this.uint6ToB64(m>>>12&63),this.uint6ToB64(m>>>6&63),this.uint6ToB64(63&m)),m=0);return 0===o?s:s.substring(0,s.length-o)+(1===o?"=":"==")},Base64Encode.prototype.uint6ToB64=function(t){return t<26?t+65:t<52?t+71:t<62?t-4:62===t?43:63===t?47:65},Base64Encode}(),mV=function(){function Base64Decode(){}return Base64Decode.prototype.decode=function(t){var o=t.replace(/-/g,"+").replace(/_/g,"/");switch(o.length%4){case 0:break;case 2:o+="==";break;case 3:o+="=";break;default:throw new Error("Invalid base64 string")}var s=this.base64DecToArr(o);return gV.utf8ArrToString(s)},Base64Decode.prototype.base64DecToArr=function(t,o){for(var s=t.replace(/[^A-Za-z0-9\+\/]/g,RB.EMPTY_STRING),l=s.length,h=o?Math.ceil((3*l+1>>>2)/o)*o:3*l+1>>>2,m=new Uint8Array(h),_=void 0,E=void 0,$=0,B=0,q=0;q<l;q++)if(E=3&q,$|=this.b64ToUint6(s.charCodeAt(q))<<18-6*E,3===E||l-q==1){for(_=0;_<3&&B<h;_++,B++)m[B]=$>>>(16>>>_&24)&255;$=0}return m},Base64Decode.prototype.b64ToUint6=function(t){return t>64&&t<91?t-65:t>96&&t<123?t-71:t>47&&t<58?t+4:43===t?62:47===t?63:0},Base64Decode}(),yV=function(){function PkceGenerator(t){this.base64Encode=new vV,this.cryptoObj=t}return PkceGenerator.prototype.generateCodes=function(){return __awaiter$2(this,void 0,void 0,(function(){var t,o;return __generator$1(this,(function(s){switch(s.label){case 0:return t=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(t)];case 1:return o=s.sent(),[2,{verifier:t,challenge:o}]}}))}))},PkceGenerator.prototype.generateCodeVerifier=function(){try{var t=new Uint8Array(32);return this.cryptoObj.getRandomValues(t),this.base64Encode.urlEncodeArr(t)}catch(t){throw hz.createPkceNotGeneratedError(t)}},PkceGenerator.prototype.generateCodeChallengeFromVerifier=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s;return __generator$1(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(t)];case 1:return o=l.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(o))];case 2:throw s=l.sent(),hz.createPkceNotGeneratedError(s);case 3:return[2]}}))}))},PkceGenerator}(),bV=function(){function ModernBrowserCrypto(){}return ModernBrowserCrypto.prototype.getRandomValues=function(t){return window.crypto.getRandomValues(t)},ModernBrowserCrypto.prototype.generateKey=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(l){return[2,window.crypto.subtle.generateKey(t,o,s)]}))}))},ModernBrowserCrypto.prototype.exportKey=function(t){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,window.crypto.subtle.exportKey(xz,t)]}))}))},ModernBrowserCrypto.prototype.importKey=function(t,o,s,l){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(h){return[2,window.crypto.subtle.importKey(xz,t,o,s,l)]}))}))},ModernBrowserCrypto.prototype.sign=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(l){return[2,window.crypto.subtle.sign(t,o,s)]}))}))},ModernBrowserCrypto.prototype.digest=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,window.crypto.subtle.digest(t,o)]}))}))},ModernBrowserCrypto}(),wV=function(){function MsrBrowserCrypto(){}return MsrBrowserCrypto.prototype.initPrng=function(t){return window.msrCrypto.initPrng(__spread(t))},MsrBrowserCrypto.prototype.getRandomValues=function(t){return window.msrCrypto.getRandomValues(t)},MsrBrowserCrypto.prototype.generateKey=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(l){return[2,window.msrCrypto.subtle.generateKey(t,o,s)]}))}))},MsrBrowserCrypto.prototype.exportKey=function(t){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,window.msrCrypto.subtle.exportKey(xz,t)]}))}))},MsrBrowserCrypto.prototype.importKey=function(t,o,s,l){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(h){return[2,window.msrCrypto.subtle.importKey(xz,t,o,s,l)]}))}))},MsrBrowserCrypto.prototype.sign=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(l){return[2,window.msrCrypto.subtle.sign(t,o,s)]}))}))},MsrBrowserCrypto.prototype.digest=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,window.msrCrypto.subtle.digest(t,o)]}))}))},MsrBrowserCrypto}(),CV=function(){function MsBrowserCrypto(){}return MsBrowserCrypto.prototype.getRandomValues=function(t){return window.msCrypto.getRandomValues(t)},MsBrowserCrypto.prototype.generateKey=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(l){return[2,new Promise((function(l,h){var m=window.msCrypto.subtle.generateKey(t,o,s);m.addEventListener("complete",(function(t){l(t.target.result)})),m.addEventListener("error",(function(t){h(t)}))}))]}))}))},MsBrowserCrypto.prototype.exportKey=function(t){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,new Promise((function(o,s){var l=window.msCrypto.subtle.exportKey(xz,t);l.addEventListener("complete",(function(t){var l=t.target.result,h=gV.utf8ArrToString(new Uint8Array(l)).replace(/\r/g,RB.EMPTY_STRING).replace(/\n/g,RB.EMPTY_STRING).replace(/\t/g,RB.EMPTY_STRING).split(" ").join(RB.EMPTY_STRING).replace("\0",RB.EMPTY_STRING);try{o(JSON.parse(h))}catch(t){s(t)}})),l.addEventListener("error",(function(t){s(t)}))}))]}))}))},MsBrowserCrypto.prototype.importKey=function(t,o,s,l){return __awaiter$2(this,void 0,void 0,(function(){var h,m;return __generator$1(this,(function(_){return h=gV.getSortedObjectString(t),m=gV.stringToArrayBuffer(h),[2,new Promise((function(t,h){var _=window.msCrypto.subtle.importKey(xz,m,o,s,l);_.addEventListener("complete",(function(o){t(o.target.result)})),_.addEventListener("error",(function(t){h(t)}))}))]}))}))},MsBrowserCrypto.prototype.sign=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(l){return[2,new Promise((function(l,h){var m=window.msCrypto.subtle.sign(t,o,s);m.addEventListener("complete",(function(t){l(t.target.result)})),m.addEventListener("error",(function(t){h(t)}))}))]}))}))},MsBrowserCrypto.prototype.digest=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,new Promise((function(s,l){var h=window.msCrypto.subtle.digest(t,o.buffer);h.addEventListener("complete",(function(t){s(t.target.result)})),h.addEventListener("error",(function(t){l(t)}))}))]}))}))},MsBrowserCrypto}(),_V="SHA-256",kV=new Uint8Array([1,0,1]),xV=function(){function BrowserCrypto(t,o){var s,l;if(this.logger=t,this.cryptoOptions=o,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new bV;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new CV;else{if(!this.hasMsrCrypto()||!(null===(s=this.cryptoOptions)||void 0===s?void 0:s.useMsrCrypto))throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),hz.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new wV}if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),!(null===(l=this.cryptoOptions)||void 0===l?void 0:l.entropy))throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),Lz.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:_V,modulusLength:2048,publicExponent:kV}}return BrowserCrypto.prototype.hasIECrypto=function(){return"msCrypto"in window},BrowserCrypto.prototype.hasBrowserCrypto=function(){return"crypto"in window},BrowserCrypto.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},BrowserCrypto.prototype.sha256Digest=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(s){return o=gV.stringToUtf8Arr(t),[2,this.subtleCrypto.digest({name:_V},o)]}))}))},BrowserCrypto.prototype.getRandomValues=function(t){return this.subtleCrypto.getRandomValues(t)},BrowserCrypto.prototype.generateKeyPair=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,t,o)]}))}))},BrowserCrypto.prototype.exportJwk=function(t){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(o){return[2,this.subtleCrypto.exportKey(t)]}))}))},BrowserCrypto.prototype.importJwk=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(l){return[2,this.subtleCrypto.importKey(t,this.keygenAlgorithmOptions,o,s)]}))}))},BrowserCrypto.prototype.sign=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(s){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,t,o)]}))}))},BrowserCrypto}(),SV=function(){function DatabaseStorage(){this.dbName=Tz,this.version=1,this.tableName=Ez,this.dbOpen=!1}return DatabaseStorage.prototype.open=function(){return __awaiter$2(this,void 0,void 0,(function(){var t=this;return __generator$1(this,(function(o){return[2,new Promise((function(o,s){var l=window.indexedDB.open(t.dbName,t.version);l.addEventListener("upgradeneeded",(function(o){o.target.result.createObjectStore(t.tableName)})),l.addEventListener("success",(function(s){var l=s;t.db=l.target.result,t.dbOpen=!0,o()})),l.addEventListener("error",(function(){return s(hz.createDatabaseUnavailableError())}))}))]}))}))},DatabaseStorage.prototype.closeConnection=function(){var t=this.db;t&&this.dbOpen&&(t.close(),this.dbOpen=!1)},DatabaseStorage.prototype.validateDbIsOpen=function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(t){switch(t.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,t.sent()];case 2:return[2]}}))}))},DatabaseStorage.prototype.getItem=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o=this;return __generator$1(this,(function(s){switch(s.label){case 0:return[4,this.validateDbIsOpen()];case 1:return s.sent(),[2,new Promise((function(s,l){if(!o.db)return l(hz.createDatabaseNotOpenError());var h=o.db.transaction([o.tableName],"readonly").objectStore(o.tableName).get(t);h.addEventListener("success",(function(t){var l=t;o.closeConnection(),s(l.target.result)})),h.addEventListener("error",(function(t){o.closeConnection(),l(t)}))}))]}}))}))},DatabaseStorage.prototype.setItem=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){var s=this;return __generator$1(this,(function(l){switch(l.label){case 0:return[4,this.validateDbIsOpen()];case 1:return l.sent(),[2,new Promise((function(l,h){if(!s.db)return h(hz.createDatabaseNotOpenError());var m=s.db.transaction([s.tableName],"readwrite").objectStore(s.tableName).put(o,t);m.addEventListener("success",(function(){s.closeConnection(),l()})),m.addEventListener("error",(function(t){s.closeConnection(),h(t)}))}))]}}))}))},DatabaseStorage.prototype.removeItem=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o=this;return __generator$1(this,(function(s){switch(s.label){case 0:return[4,this.validateDbIsOpen()];case 1:return s.sent(),[2,new Promise((function(s,l){if(!o.db)return l(hz.createDatabaseNotOpenError());var h=o.db.transaction([o.tableName],"readwrite").objectStore(o.tableName).delete(t);h.addEventListener("success",(function(){o.closeConnection(),s()})),h.addEventListener("error",(function(t){o.closeConnection(),l(t)}))}))]}}))}))},DatabaseStorage.prototype.getKeys=function(){return __awaiter$2(this,void 0,void 0,(function(){var t=this;return __generator$1(this,(function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise((function(o,s){if(!t.db)return s(hz.createDatabaseNotOpenError());var l=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).getAllKeys();l.addEventListener("success",(function(s){var l=s;t.closeConnection(),o(l.target.result)})),l.addEventListener("error",(function(o){t.closeConnection(),s(o)}))}))]}}))}))},DatabaseStorage.prototype.containsKey=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o=this;return __generator$1(this,(function(s){switch(s.label){case 0:return[4,this.validateDbIsOpen()];case 1:return s.sent(),[2,new Promise((function(s,l){if(!o.db)return l(hz.createDatabaseNotOpenError());var h=o.db.transaction([o.tableName],"readonly").objectStore(o.tableName).count(t);h.addEventListener("success",(function(t){var l=t;o.closeConnection(),s(1===l.target.result)})),h.addEventListener("error",(function(t){o.closeConnection(),l(t)}))}))]}}))}))},DatabaseStorage.prototype.deleteDatabase=function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(t){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise((function(t,o){var s=window.indexedDB.deleteDatabase(Tz);s.addEventListener("success",(function(){return t(!0)})),s.addEventListener("blocked",(function(){return t(!0)})),s.addEventListener("error",(function(){return o(!1)}))}))]}))}))},DatabaseStorage}(),TV=function(){function AsyncMemoryStorage(t,o){this.inMemoryCache=new Bz,this.indexedDBCache=new SV,this.logger=t,this.storeName=o}return AsyncMemoryStorage.prototype.handleDatabaseAccessError=function(t){if(!(t instanceof hz&&t.errorCode===iz.code))throw t;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},AsyncMemoryStorage.prototype.getItem=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s;return __generator$1(this,(function(l){switch(l.label){case 0:if(o=this.inMemoryCache.getItem(t))return[3,4];l.label=1;case 1:return l.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(t)];case 2:return[2,l.sent()];case 3:return s=l.sent(),this.handleDatabaseAccessError(s),[3,4];case 4:return[2,o]}}))}))},AsyncMemoryStorage.prototype.setItem=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){var s;return __generator$1(this,(function(l){switch(l.label){case 0:this.inMemoryCache.setItem(t,o),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(t,o)];case 2:return l.sent(),[3,4];case 3:return s=l.sent(),this.handleDatabaseAccessError(s),[3,4];case 4:return[2]}}))}))},AsyncMemoryStorage.prototype.removeItem=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(s){switch(s.label){case 0:this.inMemoryCache.removeItem(t),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(t)];case 2:return s.sent(),[3,4];case 3:return o=s.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2]}}))}))},AsyncMemoryStorage.prototype.getKeys=function(){return __awaiter$2(this,void 0,void 0,(function(){var t,o;return __generator$1(this,(function(s){switch(s.label){case 0:if(0!==(t=this.inMemoryCache.getKeys()).length)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,s.sent()];case 3:return o=s.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2,t]}}))}))},AsyncMemoryStorage.prototype.containsKey=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s;return __generator$1(this,(function(l){switch(l.label){case 0:if(o=this.inMemoryCache.containsKey(t))return[3,4];l.label=1;case 1:return l.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(t)];case 2:return[2,l.sent()];case 3:return s=l.sent(),this.handleDatabaseAccessError(s),[3,4];case 4:return[2,o]}}))}))},AsyncMemoryStorage.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},AsyncMemoryStorage.prototype.clearPersistent=function(){return __awaiter$2(this,void 0,void 0,(function(){var t,o;return __generator$1(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return(t=s.sent())&&this.logger.verbose("Persistent keystore deleted"),[2,t];case 2:return o=s.sent(),this.handleDatabaseAccessError(o),[2,!1];case 3:return[2]}}))}))},AsyncMemoryStorage}();
/*! @azure/msal-browser v2.38.2 2023-08-24 */!function(t){t.asymmetricKeys="asymmetricKeys",t.symmetricKeys="symmetricKeys"}(lV||(lV={}));var EV,AV=function(){function CryptoKeyStore(t){this.logger=t,this.asymmetricKeys=new TV(this.logger,lV.asymmetricKeys),this.symmetricKeys=new TV(this.logger,lV.symmetricKeys)}return CryptoKeyStore.prototype.clear=function(){return __awaiter$2(this,void 0,void 0,(function(){var t;return __generator$1(this,(function(o){switch(o.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return o.sent(),[2,!0];case 3:return(t=o.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+t.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}}))}))},CryptoKeyStore}(),IV=function(){function CryptoOps(t,o,s){this.logger=t,this.browserCrypto=new xV(this.logger,s),this.b64Encode=new vV,this.b64Decode=new mV,this.guidGenerator=new fV(this.browserCrypto),this.pkceGenerator=new yV(this.browserCrypto),this.cache=new AV(this.logger),this.performanceClient=o}return CryptoOps.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},CryptoOps.prototype.base64Encode=function(t){return this.b64Encode.encode(t)},CryptoOps.prototype.base64Decode=function(t){return this.b64Decode.decode(t)},CryptoOps.prototype.generatePkceCodes=function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(t){return[2,this.pkceGenerator.generateCodes()]}))}))},CryptoOps.prototype.getPublicKeyThumbprint=function(t){var o;return __awaiter$2(this,void 0,void 0,(function(){var s,l,h,m,_,E,$,B;return __generator$1(this,(function(q){switch(q.label){case 0:return s=null===(o=this.performanceClient)||void 0===o?void 0:o.startMeasurement(XU.CryptoOptsGetPublicKeyThumbprint,t.correlationId),[4,this.browserCrypto.generateKeyPair(CryptoOps.EXTRACTABLE,CryptoOps.POP_KEY_USAGES)];case 1:return l=q.sent(),[4,this.browserCrypto.exportJwk(l.publicKey)];case 2:return h=q.sent(),m={e:h.e,kty:h.kty,n:h.n},_=gV.getSortedObjectString(m),[4,this.hashString(_)];case 3:return E=q.sent(),[4,this.browserCrypto.exportJwk(l.privateKey)];case 4:return $=q.sent(),[4,this.browserCrypto.importJwk($,!1,["sign"])];case 5:return B=q.sent(),[4,this.cache.asymmetricKeys.setItem(E,{privateKey:B,publicKey:l.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return q.sent(),s&&s.endMeasurement({success:!0}),[2,E]}}))}))},CryptoOps.prototype.removeTokenBindingKey=function(t){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(o){switch(o.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(t)];case 1:return o.sent(),[4,this.cache.asymmetricKeys.containsKey(t)];case 2:return[2,!o.sent()]}}))}))},CryptoOps.prototype.clearKeystore=function(){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(t){switch(t.label){case 0:return[4,this.cache.clear()];case 1:return[2,t.sent()]}}))}))},CryptoOps.prototype.signJwt=function(t,o,s){var l;return __awaiter$2(this,void 0,void 0,(function(){var h,m,_,E,$,B,q,j,K,W,X,re,oe;return __generator$1(this,(function(ne){switch(ne.label){case 0:return h=null===(l=this.performanceClient)||void 0===l?void 0:l.startMeasurement(XU.CryptoOptsSignJwt,s),[4,this.cache.asymmetricKeys.getItem(o)];case 1:if(!(m=ne.sent()))throw hz.createSigningKeyNotFoundInStorageError(o);return[4,this.browserCrypto.exportJwk(m.publicKey)];case 2:return _=ne.sent(),E=gV.getSortedObjectString(_),$=this.b64Encode.urlEncode(JSON.stringify({kid:o})),B=Wq.getShrHeaderString({kid:$,alg:_.alg}),q=this.b64Encode.urlEncode(B),t.cnf={jwk:JSON.parse(E)},j=this.b64Encode.urlEncode(JSON.stringify(t)),K=q+"."+j,W=gV.stringToArrayBuffer(K),[4,this.browserCrypto.sign(m.privateKey,W)];case 3:return X=ne.sent(),re=this.b64Encode.urlEncodeArr(new Uint8Array(X)),oe=K+"."+re,h&&h.endMeasurement({success:!0}),[2,oe]}}))}))},CryptoOps.prototype.hashString=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s;return __generator$1(this,(function(l){switch(l.label){case 0:return[4,this.browserCrypto.sha256Digest(t)];case 1:return o=l.sent(),s=new Uint8Array(o),[2,this.b64Encode.urlEncodeArr(s)]}}))}))},CryptoOps.POP_KEY_USAGES=["sign","verify"],CryptoOps.EXTRACTABLE=!0,CryptoOps}(),PV=function(){function BrowserPerformanceMeasurement(t,o){this.correlationId=o,this.measureName=BrowserPerformanceMeasurement.makeMeasureName(t,o),this.startMark=BrowserPerformanceMeasurement.makeStartMark(t,o),this.endMark=BrowserPerformanceMeasurement.makeEndMark(t,o)}return BrowserPerformanceMeasurement.makeMeasureName=function(t,o){return"msal.measure."+t+"."+o},BrowserPerformanceMeasurement.makeStartMark=function(t,o){return"msal.start."+t+"."+o},BrowserPerformanceMeasurement.makeEndMark=function(t,o){return"msal.end."+t+"."+o},BrowserPerformanceMeasurement.supportsBrowserPerformance=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName},BrowserPerformanceMeasurement.flushMeasurements=function(t,o){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{o.forEach((function(o){var s=BrowserPerformanceMeasurement.makeMeasureName(o.name,t);window.performance.getEntriesByName(s,"measure").length>0&&(window.performance.clearMeasures(s),window.performance.clearMarks(BrowserPerformanceMeasurement.makeStartMark(s,t)),window.performance.clearMarks(BrowserPerformanceMeasurement.makeEndMark(s,t)))}))}catch(t){}},BrowserPerformanceMeasurement.prototype.startMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(t){}},BrowserPerformanceMeasurement.prototype.endMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(t){}},BrowserPerformanceMeasurement.prototype.flushMeasurement=function(){if(BrowserPerformanceMeasurement.supportsBrowserPerformance())try{var t=window.performance.getEntriesByName(this.measureName,"measure");if(t.length>0){var o=t[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),o}}catch(t){}return null},BrowserPerformanceMeasurement}(),RV=function(t){function BrowserPerformanceClient(o,s,l,h,m,_,E){var $=t.call(this,o,s,l,h,m,_)||this;return $.browserCrypto=new xV($.logger,E),$.guidGenerator=new fV($.browserCrypto),$}return __extends$1(BrowserPerformanceClient,t),BrowserPerformanceClient.prototype.startPerformanceMeasuremeant=function(t,o){return new PV(t,o)},BrowserPerformanceClient.prototype.generateId=function(){return this.guidGenerator.generateGuid()},BrowserPerformanceClient.prototype.getPageVisibility=function(){var t;return(null===(t=document.visibilityState)||void 0===t?void 0:t.toString())||null},BrowserPerformanceClient.prototype.deleteIncompleteSubMeasurements=function(t){var o=this.eventsByCorrelationId.get(t.event.correlationId),s=o&&o.eventId===t.event.eventId,l=[];s&&(null==o?void 0:o.incompleteSubMeasurements)&&o.incompleteSubMeasurements.forEach((function(t){l.push(__assign$1({},t))})),l.length>0&&PV.flushMeasurements(t.event.correlationId,l)},BrowserPerformanceClient.prototype.supportsBrowserPerformanceNow=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now},BrowserPerformanceClient.prototype.startMeasurement=function(o,s){var l=this,h=this.getPageVisibility(),m=t.prototype.startMeasurement.call(this,o,s);return __assign$1(__assign$1({},m),{endMeasurement:function(t){var o=m.endMeasurement(__assign$1({startPageVisibility:h,endPageVisibility:l.getPageVisibility()},t));return l.deleteIncompleteSubMeasurements(m),o},discardMeasurement:function(){m.discardMeasurement(),l.deleteIncompleteSubMeasurements(m),m.measurement.flushMeasurement()}})},BrowserPerformanceClient.prototype.setPreQueueTime=function(t,o){if(this.supportsBrowserPerformanceNow())if(o){var s=this.preQueueTimeByCorrelationId.get(o);s&&(this.logger.trace("BrowserPerformanceClient: Incomplete pre-queue "+s.name+" found",o),this.addQueueMeasurement(s.name,o,void 0,!0)),this.preQueueTimeByCorrelationId.set(o,{name:t,time:window.performance.now()})}else this.logger.trace("BrowserPerformanceClient: correlationId for "+t+" not provided, unable to set telemetry queue time");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+t)},BrowserPerformanceClient.prototype.addQueueMeasurement=function(o,s,l,h){if(this.supportsBrowserPerformanceNow())if(s){var m=t.prototype.getPreQueueTime.call(this,o,s);if(m){var _=window.performance.now(),E=l||t.prototype.calculateQueuedTime.call(this,m,_);return t.prototype.addQueueMeasurement.call(this,o,s,E,h)}}else this.logger.trace("BrowserPerformanceClient: correlationId for "+o+" not provided, unable to add queue measurement");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+o)},BrowserPerformanceClient}(Yq),$V=function(){function TokenCache(t,o,s,l){this.isBrowserEnvironment="undefined"!=typeof window,this.config=t,this.storage=o,this.logger=s,this.cryptoObj=l}return TokenCache.prototype.loadExternalTokens=function(t,o,s){if(this.logger.info("TokenCache - loadExternalTokens called"),!o.id_token)throw hz.createUnableToLoadTokenError("Please ensure server response includes id token.");var l,h,m=new FU(o.id_token,this.cryptoObj);if(t.account){var _=this.loadAccount(m,t.account.environment,void 0,void 0,t.account.homeAccountId);l=new fq(_,this.loadIdToken(m,_.homeAccountId,t.account.environment,t.account.tenantId),this.loadAccessToken(t,o,_.homeAccountId,t.account.environment,t.account.tenantId,s),this.loadRefreshToken(t,o,_.homeAccountId,t.account.environment))}else{if(!t.authority)throw hz.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var E=Hq.generateAuthority(t.authority,t.azureCloudOptions),$={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(h=new Hq(E,this.config.system.networkClient,this.storage,$,this.logger),s.clientInfo){this.logger.trace("TokenCache - homeAccountId from options");_=this.loadAccount(m,h.hostnameAndPort,s.clientInfo,h.authorityType);l=new fq(_,this.loadIdToken(m,_.homeAccountId,h.hostnameAndPort,h.tenant),this.loadAccessToken(t,o,_.homeAccountId,h.hostnameAndPort,h.tenant,s),this.loadRefreshToken(t,o,_.homeAccountId,h.hostnameAndPort))}else{if(!o.client_info)throw hz.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response");_=this.loadAccount(m,h.hostnameAndPort,o.client_info,h.authorityType);l=new fq(_,this.loadIdToken(m,_.homeAccountId,h.hostnameAndPort,h.tenant),this.loadAccessToken(t,o,_.homeAccountId,h.hostnameAndPort,h.tenant,s),this.loadRefreshToken(t,o,_.homeAccountId,h.hostnameAndPort))}}return this.generateAuthenticationResult(t,m,l,h)},TokenCache.prototype.loadAccount=function(t,o,s,l,h){var m;if(h?m=h:void 0!==l&&s&&(m=LU.generateHomeAccountId(s,l,this.logger,this.cryptoObj,t)),!m)throw hz.createUnableToLoadTokenError("Unexpected missing homeAccountId");var _=s?LU.createAccount(s,m,t,void 0,void 0,void 0,o):LU.createGenericAccount(m,t,void 0,void 0,void 0,o);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(_),_;throw hz.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},TokenCache.prototype.loadIdToken=function(t,o,s,l){var h=iq.createIdTokenEntity(o,s,t.rawToken,this.config.auth.clientId,l);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(h),h;throw hz.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},TokenCache.prototype.loadAccessToken=function(t,o,s,l,h,m){if(!o.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!o.expires_in)throw hz.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!m.extendedExpiresOn)throw hz.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var _=new DU(t.scopes).printScopes(),E=m.expiresOn||o.expires_in+(new Date).getTime()/1e3,$=m.extendedExpiresOn,B=aq.createAccessTokenEntity(s,l,o.access_token,this.config.auth.clientId,h,_,E,$,this.cryptoObj);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(B),B;throw hz.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},TokenCache.prototype.loadRefreshToken=function(t,o,s,l){if(!o.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;var h=lq.createRefreshTokenEntity(s,l,o.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(h),h;throw hz.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},TokenCache.prototype.generateAuthenticationResult=function(t,o,s,l){var h,m,_,E,$=RB.EMPTY_STRING,B=[],q=null;(null==s?void 0:s.accessToken)&&($=s.accessToken.secret,B=DU.fromString(s.accessToken.target).asArray(),q=new Date(1e3*Number(s.accessToken.expiresOn)),E=new Date(1e3*Number(s.accessToken.extendedExpiresOn)));var j=(null==o?void 0:o.claims.oid)||(null==o?void 0:o.claims.sub)||RB.EMPTY_STRING,K=(null==o?void 0:o.claims.tid)||RB.EMPTY_STRING;return{authority:l?l.canonicalAuthority:RB.EMPTY_STRING,uniqueId:j,tenantId:K,scopes:B,account:(null==s?void 0:s.account)?s.account.getAccountInfo():null,idToken:o?o.rawToken:RB.EMPTY_STRING,idTokenClaims:o?o.claims:{},accessToken:$,fromCache:!0,expiresOn:q,correlationId:t.correlationId||RB.EMPTY_STRING,requestId:RB.EMPTY_STRING,extExpiresOn:E,familyId:RB.EMPTY_STRING,tokenType:(null===(h=null==s?void 0:s.accessToken)||void 0===h?void 0:h.tokenType)||RB.EMPTY_STRING,state:RB.EMPTY_STRING,cloudGraphHostName:(null===(m=null==s?void 0:s.account)||void 0===m?void 0:m.cloudGraphHostName)||RB.EMPTY_STRING,msGraphHost:(null===(_=null==s?void 0:s.account)||void 0===_?void 0:_.msGraphHost)||RB.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},TokenCache}(),MV=function(t){function HybridSpaAuthorizationCodeClient(o){var s=t.call(this,o)||this;return s.includeRedirectUri=!1,s}return __extends$1(HybridSpaAuthorizationCodeClient,t),HybridSpaAuthorizationCodeClient}(kq),OV=function(t){function SilentAuthCodeClient(o,s,l,h,m,_,E,$,B,q){var j=t.call(this,o,s,l,h,m,_,$,B,q)||this;return j.apiId=E,j}return __extends$1(SilentAuthCodeClient,t),SilentAuthCodeClient.prototype.acquireToken=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,m,_;return __generator$1(this,(function(E){switch(E.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!t.code)throw hz.createAuthCodeRequiredError();return this.performanceClient.setPreQueueTime(XU.StandardInteractionClientInitializeAuthorizationRequest,t.correlationId),[4,this.initializeAuthorizationRequest(t,Lq.Silent)];case 1:o=E.sent(),this.browserStorage.updateCacheEntries(o.state,o.nonce,o.authority,o.loginHint||RB.EMPTY_STRING,o.account||null),s=this.initializeServerTelemetryManager(this.apiId),E.label=2;case 2:return E.trys.push([2,4,,5]),l=__assign$1(__assign$1({},o),{code:t.code}),this.performanceClient.setPreQueueTime(XU.StandardInteractionClientGetClientConfiguration,t.correlationId),[4,this.getClientConfiguration(s,o.authority)];case 3:return h=E.sent(),m=new MV(h),this.logger.verbose("Auth code client created"),[2,new cV(m,this.browserStorage,l,this.logger,this.config.system,this.performanceClient).handleCodeResponseFromServer({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},o.state,m.authority,this.networkClient,!1)];case 4:throw(_=E.sent())instanceof uH&&_.setCorrelationId(this.correlationId),s.cacheFailedRequest(_),this.browserStorage.cleanRequestByState(o.state),_;case 5:return[2]}}))}))},SilentAuthCodeClient.prototype.logout=function(){return Promise.reject(hz.createSilentLogoutUnsupportedError())},SilentAuthCodeClient}(Wz),NV=function(){function ClientApplication(t){var o,s,l;this.isBrowserEnvironment="undefined"!=typeof window,this.config=function buildConfiguration(t,o){var s=t.auth,l=t.cache,h=t.system,m=t.telemetry,_={clientId:RB.EMPTY_STRING,authority:""+RB.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:RB.EMPTY_STRING,authorityMetadata:RB.EMPTY_STRING,redirectUri:RB.EMPTY_STRING,postLogoutRedirectUri:RB.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Tq.AAD,azureCloudOptions:{azureCloudInstance:aU.None,tenant:RB.EMPTY_STRING},skipAuthorityMetadataCache:!1},E={cacheLocation:Rq.SessionStorage,temporaryCacheLocation:Rq.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!l||l.cacheLocation!==Rq.LocalStorage),claimsBasedCachingEnabled:!0},$={loggerCallback:function(){},logLevel:lH.Info,piiLoggingEnabled:!1},B=__assign$1(__assign$1({},UU),{loggerOptions:$,networkClient:o?Gz.getBrowserNetworkClient():zq,navigationClient:new sV,loadFrameTimeout:0,windowHashTimeout:(null==h?void 0:h.loadFrameTimeout)||6e4,iframeHashTimeout:(null==h?void 0:h.loadFrameTimeout)||aV,navigateFrameWait:o&&Gz.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null==h?void 0:h.nativeBrokerHandshakeTimeout)||2e3,pollIntervalMilliseconds:mz,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),q=__assign$1(__assign$1({},h),{loggerOptions:(null==h?void 0:h.loggerOptions)||$}),j={application:{appName:RB.EMPTY_STRING,appVersion:RB.EMPTY_STRING}};return{auth:__assign$1(__assign$1({},_),s),cache:__assign$1(__assign$1({},E),l),system:__assign$1(__assign$1({},B),q),telemetry:__assign$1(__assign$1({},j),m)}}(t,this.isBrowserEnvironment),this.initialized=!1,this.logger=new lU(this.config.system.loggerOptions,qz,jz),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new RV(this.config.auth.clientId,this.config.auth.authority,this.logger,qz,jz,this.config.telemetry.application,this.config.system.cryptoOptions):new Jq(this.config.auth.clientId,this.config.auth.authority,this.logger,qz,jz,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new IV(this.logger,this.performanceClient,this.config.system.cryptoOptions):hH,this.eventHandler=new hV(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new Uz(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):(o=this.config.auth.clientId,s=this.logger,l={cacheLocation:Rq.MemoryStorage,temporaryCacheLocation:Rq.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!0},new Uz(o,l,hH,s));var h={cacheLocation:Rq.MemoryStorage,temporaryCacheLocation:Rq.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!0};this.nativeInternalStorage=new Uz(this.config.auth.clientId,h,this.browserCrypto,this.logger),this.tokenCache=new $V(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return ClientApplication.prototype.initialize=function(){return __awaiter$2(this,void 0,void 0,(function(){var t,o,s,l,h;return __generator$1(this,(function(m){switch(m.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(t=this.config.system.allowNativeBroker,o=this.performanceClient.startMeasurement(XU.InitializeClientApplication),this.eventHandler.emitEvent(Az.INITIALIZE_START),!t)return[3,4];m.label=1;case 1:return m.trys.push([1,3,,4]),s=this,[4,oV.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)];case 2:return s.nativeExtensionProvider=m.sent(),[3,4];case 3:return l=m.sent(),this.logger.verbose(l),[3,4];case 4:return this.config.cache.claimsBasedCachingEnabled?[3,6]:(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),h=this.performanceClient.startMeasurement(XU.ClearTokensAndKeysWithClaims),[4,this.browserStorage.clearTokensAndKeysWithClaims()]);case 5:m.sent(),h.endMeasurement({success:!0}),m.label=6;case 6:return this.initialized=!0,this.eventHandler.emitEvent(Az.INITIALIZE_END),o.endMeasurement({allowNativeBroker:t,success:!0}),[2]}}))}))},ClientApplication.prototype.handleRedirectPromise=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,m,_,E,$,B=this;return __generator$1(this,(function(q){return this.logger.verbose("handleRedirectPromise called"),Gz.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),o=this.getAllAccounts(),this.isBrowserEnvironment?(s=t||RB.EMPTY_STRING,void 0===(l=this.redirectResponse.get(s))?(this.eventHandler.emitEvent(Az.HANDLE_REDIRECT_START,Lq.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),h=this.browserStorage.getCachedNativeRequest(),m=void 0,h&&oV.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!t?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),_=new rV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Dq.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,h.accountId,this.nativeInternalStorage,h.correlationId),m=_.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),E=this.browserStorage.getTemporaryCache(Mq.CORRELATION_ID,!0)||RB.EMPTY_STRING,$=this.createRedirectClient(E),m=$.handleRedirectPromise(t)),l=m.then((function(t){t&&(o.length<B.getAllAccounts().length?(B.eventHandler.emitEvent(Az.LOGIN_SUCCESS,Lq.Redirect,t),B.logger.verbose("handleRedirectResponse returned result, login success")):(B.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_SUCCESS,Lq.Redirect,t),B.logger.verbose("handleRedirectResponse returned result, acquire token success")));return B.eventHandler.emitEvent(Az.HANDLE_REDIRECT_END,Lq.Redirect),t})).catch((function(t){throw o.length>0?B.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_FAILURE,Lq.Redirect,null,t):B.eventHandler.emitEvent(Az.LOGIN_FAILURE,Lq.Redirect,null,t),B.eventHandler.emitEvent(Az.HANDLE_REDIRECT_END,Lq.Redirect),t})),this.redirectResponse.set(s,l)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,l]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},ClientApplication.prototype.acquireTokenRedirect=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,m,_=this;return __generator$1(this,(function(E){return o=this.getRequestCorrelationId(t),this.logger.verbose("acquireTokenRedirect called",o),this.preflightBrowserEnvironmentCheck(Lq.Redirect),(s=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_START,Lq.Redirect,t):this.eventHandler.emitEvent(Az.LOGIN_START,Lq.Redirect,t),this.nativeExtensionProvider&&this.canUseNative(t)?(h=new rV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Dq.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(t),this.nativeInternalStorage,t.correlationId),l=h.acquireTokenRedirect(t).catch((function(o){if(o instanceof eV&&o.isFatal())return _.nativeExtensionProvider=void 0,_.createRedirectClient(t.correlationId).acquireToken(t);if(o instanceof pq)return _.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),_.createRedirectClient(t.correlationId).acquireToken(t);throw _.browserStorage.setInteractionInProgress(!1),o}))):(m=this.createRedirectClient(t.correlationId),l=m.acquireToken(t)),[2,l.catch((function(t){throw s?_.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_FAILURE,Lq.Redirect,null,t):_.eventHandler.emitEvent(Az.LOGIN_FAILURE,Lq.Redirect,null,t),t}))]}))}))},ClientApplication.prototype.acquireTokenPopup=function(t){var o=this,s=this.getRequestCorrelationId(t),l=this.performanceClient.startMeasurement(XU.AcquireTokenPopup,s);try{this.logger.verbose("acquireTokenPopup called",s),this.preflightBrowserEnvironmentCheck(Lq.Popup)}catch(t){return Promise.reject(t)}var h,m=this.getAllAccounts();(m.length>0?this.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_START,Lq.Popup,t):this.eventHandler.emitEvent(Az.LOGIN_START,Lq.Popup,t),this.canUseNative(t))?h=this.acquireTokenNative(t,Dq.acquireTokenPopup).then((function(t){return o.browserStorage.setInteractionInProgress(!1),l.endMeasurement({success:!0,isNativeBroker:!0,requestId:t.requestId}),t})).catch((function(s){if(s instanceof eV&&s.isFatal())return o.nativeExtensionProvider=void 0,o.createPopupClient(t.correlationId).acquireToken(t);if(s instanceof pq)return o.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),o.createPopupClient(t.correlationId).acquireToken(t);throw o.browserStorage.setInteractionInProgress(!1),s})):h=this.createPopupClient(t.correlationId).acquireToken(t);return h.then((function(t){return m.length<o.getAllAccounts().length?o.eventHandler.emitEvent(Az.LOGIN_SUCCESS,Lq.Popup,t):o.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_SUCCESS,Lq.Popup,t),l.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),l.endMeasurement({success:!0,requestId:t.requestId}),t})).catch((function(t){return m.length>0?o.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_FAILURE,Lq.Popup,null,t):o.eventHandler.emitEvent(Az.LOGIN_FAILURE,Lq.Popup,null,t),l.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),Promise.reject(t)}))},ClientApplication.prototype.trackPageVisibilityWithMeasurement=function(){var t=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;t&&(this.logger.info("Perf: Visibility change detected in ",t.event.name),t.increment({visibilityChangeCount:1}))},ClientApplication.prototype.ssoSilent=function(t){var o;return __awaiter$2(this,void 0,void 0,(function(){var s,l,h,m,_=this;return __generator$1(this,(function(E){return s=this.getRequestCorrelationId(t),l=__assign$1(__assign$1({},t),{prompt:t.prompt,correlationId:s}),this.preflightBrowserEnvironmentCheck(Lq.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(XU.SsoSilent,s),null===(o=this.ssoSilentMeasurement)||void 0===o||o.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",s),this.eventHandler.emitEvent(Az.SSO_SILENT_START,Lq.Silent,l),this.canUseNative(l)?h=this.acquireTokenNative(l,Dq.ssoSilent).catch((function(t){if(t instanceof eV&&t.isFatal())return _.nativeExtensionProvider=void 0,_.createSilentIframeClient(l.correlationId).acquireToken(l);throw t})):(m=this.createSilentIframeClient(l.correlationId),h=m.acquireToken(l)),[2,h.then((function(t){var o,s;return _.eventHandler.emitEvent(Az.SSO_SILENT_SUCCESS,Lq.Silent,t),null===(o=_.ssoSilentMeasurement)||void 0===o||o.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),null===(s=_.ssoSilentMeasurement)||void 0===s||s.endMeasurement({success:!0,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t})).catch((function(t){var o;throw _.eventHandler.emitEvent(Az.SSO_SILENT_FAILURE,Lq.Silent,null,t),null===(o=_.ssoSilentMeasurement)||void 0===o||o.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})).finally((function(){document.removeEventListener("visibilitychange",_.trackPageVisibilityWithMeasurement)}))]}))}))},ClientApplication.prototype.acquireTokenByCode=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,m=this;return __generator$1(this,(function(_){o=this.getRequestCorrelationId(t),this.preflightBrowserEnvironmentCheck(Lq.Silent),this.logger.trace("acquireTokenByCode called",o),this.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_BY_CODE_START,Lq.Silent,t),s=this.performanceClient.startMeasurement(XU.AcquireTokenByCode,t.correlationId);try{if(t.code&&t.nativeAccountId)throw hz.createSpaCodeAndNativeAccountIdPresentError();if(t.code)return l=t.code,(h=this.hybridAuthCodeResponses.get(l))?(this.logger.verbose("Existing acquireTokenByCode request found",t.correlationId),s.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",o),h=this.acquireTokenByCodeAsync(__assign$1(__assign$1({},t),{correlationId:o})).then((function(t){return m.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_BY_CODE_SUCCESS,Lq.Silent,t),m.hybridAuthCodeResponses.delete(l),s.addStaticFields({accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),s.endMeasurement({success:!0,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t})).catch((function(t){throw m.hybridAuthCodeResponses.delete(l),m.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_BY_CODE_FAILURE,Lq.Silent,null,t),s.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})),this.hybridAuthCodeResponses.set(l,h)),[2,h];if(t.nativeAccountId){if(this.canUseNative(t,t.nativeAccountId))return[2,this.acquireTokenNative(t,Dq.acquireTokenByCode,t.nativeAccountId).catch((function(t){throw t instanceof eV&&t.isFatal()&&(m.nativeExtensionProvider=void 0),t}))];throw hz.createUnableToAcquireTokenFromNativePlatformError()}throw hz.createAuthCodeOrNativeAccountIdRequiredError()}catch(t){throw this.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_BY_CODE_FAILURE,Lq.Silent,null,t),s.endMeasurement({errorCode:t instanceof uH&&t.errorCode||void 0,subErrorCode:t instanceof uH&&t.subError||void 0,success:!1}),t}return[2]}))}))},ClientApplication.prototype.acquireTokenByCodeAsync=function(t){var o;return __awaiter$2(this,void 0,void 0,(function(){var s=this;return __generator$1(this,(function(l){switch(l.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",t.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(XU.AcquireTokenByCodeAsync,t.correlationId),null===(o=this.acquireTokenByCodeAsyncMeasurement)||void 0===o||o.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),[4,this.createSilentAuthCodeClient(t.correlationId).acquireToken(t).then((function(t){var o;return null===(o=s.acquireTokenByCodeAsyncMeasurement)||void 0===o||o.endMeasurement({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t})).catch((function(t){var o;throw null===(o=s.acquireTokenByCodeAsyncMeasurement)||void 0===o||o.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})).finally((function(){document.removeEventListener("visibilitychange",s.trackPageVisibilityWithMeasurement)}))];case 1:return[2,l.sent()]}}))}))},ClientApplication.prototype.acquireTokenFromCache=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(l){switch(this.performanceClient.addQueueMeasurement(XU.AcquireTokenFromCache,o.correlationId),s.cacheLookupPolicy){case Sz.Default:case Sz.AccessToken:case Sz.AccessTokenAndRefreshToken:return[2,t.acquireToken(o)];default:throw iU.createRefreshRequiredError()}return[2]}))}))},ClientApplication.prototype.acquireTokenByRefreshToken=function(t,o){return __awaiter$2(this,void 0,void 0,(function(){var s;return __generator$1(this,(function(l){switch(this.performanceClient.addQueueMeasurement(XU.AcquireTokenByRefreshToken,t.correlationId),o.cacheLookupPolicy){case Sz.Default:case Sz.AccessTokenAndRefreshToken:case Sz.RefreshToken:case Sz.RefreshTokenAndNetwork:return s=this.createSilentRefreshClient(t.correlationId),this.performanceClient.setPreQueueTime(XU.SilentRefreshClientAcquireToken,t.correlationId),[2,s.acquireToken(t)];default:throw iU.createRefreshRequiredError()}return[2]}))}))},ClientApplication.prototype.acquireTokenBySilentIframe=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(s){return this.performanceClient.addQueueMeasurement(XU.AcquireTokenBySilentIframe,t.correlationId),o=this.createSilentIframeClient(t.correlationId),this.performanceClient.setPreQueueTime(XU.SilentIframeClientAcquireToken,t.correlationId),[2,o.acquireToken(t)]}))}))},ClientApplication.prototype.logout=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(s){return o=this.getRequestCorrelationId(t),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",o),[2,this.logoutRedirect(__assign$1({correlationId:o},t))]}))}))},ClientApplication.prototype.logoutRedirect=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(s){return o=this.getRequestCorrelationId(t),this.preflightBrowserEnvironmentCheck(Lq.Redirect),[2,this.createRedirectClient(o).logout(t)]}))}))},ClientApplication.prototype.logoutPopup=function(t){try{var o=this.getRequestCorrelationId(t);return this.preflightBrowserEnvironmentCheck(Lq.Popup),this.createPopupClient(o).logout(t)}catch(t){return Promise.reject(t)}},ClientApplication.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},ClientApplication.prototype.getAccountByUsername=function(t){if(this.logger.trace("getAccountByUsername called"),!t)return this.logger.warning("getAccountByUsername: No username provided"),null;var o=this.browserStorage.getAccountInfoFilteredBy({username:t});return o?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: "+t),o):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},ClientApplication.prototype.getAccountByHomeId=function(t){if(this.logger.trace("getAccountByHomeId called"),!t)return this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null;var o=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:t});return o?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: "+t),o):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},ClientApplication.prototype.getAccountByLocalId=function(t){if(this.logger.trace("getAccountByLocalId called"),!t)return this.logger.warning("getAccountByLocalId: No localAccountId provided"),null;var o=this.browserStorage.getAccountInfoFilteredBy({localAccountId:t});return o?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: "+t),o):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},ClientApplication.prototype.setActiveAccount=function(t){this.browserStorage.setActiveAccount(t)},ClientApplication.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},ClientApplication.prototype.preflightBrowserEnvironmentCheck=function(t,o){if(void 0===o&&(o=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),Gz.blockNonBrowserEnvironment(this.isBrowserEnvironment),Gz.blockRedirectInIframe(t,this.config.system.allowRedirectInIframe),Gz.blockReloadInHiddenIframes(),Gz.blockAcquireTokenInPopups(),Gz.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t===Lq.Redirect&&this.config.cache.cacheLocation===Rq.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw Lz.createInMemoryRedirectUnavailableError();t!==Lq.Redirect&&t!==Lq.Popup||this.preflightInteractiveRequest(o)},ClientApplication.prototype.preflightInteractiveRequest=function(t){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),Gz.blockReloadInHiddenIframes(),t&&this.browserStorage.setInteractionInProgress(!0)},ClientApplication.prototype.acquireTokenNative=function(t,o,s){return __awaiter$2(this,void 0,void 0,(function(){return __generator$1(this,(function(l){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw hz.createNativeConnectionNotEstablishedError();return[2,new rV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,o,this.performanceClient,this.nativeExtensionProvider,s||this.getNativeAccountId(t),this.nativeInternalStorage,t.correlationId).acquireToken(t)]}))}))},ClientApplication.prototype.canUseNative=function(t,o){if(this.logger.trace("canUseNative called"),!oV.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(t.prompt)switch(t.prompt){case NB.NONE:case NB.CONSENT:case NB.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+t.prompt+" is not compatible with native flow, returning false"),!1}return!(!o&&!this.getNativeAccountId(t))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)},ClientApplication.prototype.getNativeAccountId=function(t){var o=t.account||this.browserStorage.getAccountInfoByHints(t.loginHint,t.sid)||this.getActiveAccount();return o&&o.nativeAccountId||""},ClientApplication.prototype.createPopupClient=function(t){return new iV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t)},ClientApplication.prototype.createRedirectClient=function(t){return new nV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t)},ClientApplication.prototype.createSilentIframeClient=function(t){return new dV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Dq.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,t)},ClientApplication.prototype.createSilentCacheClient=function(t){return new tV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,t)},ClientApplication.prototype.createSilentRefreshClient=function(t){return new uV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,t)},ClientApplication.prototype.createSilentAuthCodeClient=function(t){return new OV(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Dq.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,t)},ClientApplication.prototype.addEventCallback=function(t){return this.eventHandler.addEventCallback(t)},ClientApplication.prototype.removeEventCallback=function(t){this.eventHandler.removeEventCallback(t)},ClientApplication.prototype.addPerformanceCallback=function(t){return this.performanceClient.addPerformanceCallback(t)},ClientApplication.prototype.removePerformanceCallback=function(t){return this.performanceClient.removePerformanceCallback(t)},ClientApplication.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},ClientApplication.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},ClientApplication.prototype.getTokenCache=function(){return this.tokenCache},ClientApplication.prototype.getLogger=function(){return this.logger},ClientApplication.prototype.setLogger=function(t){this.logger=t},ClientApplication.prototype.initializeWrapperLibrary=function(t,o){this.browserStorage.setWrapperMetadata(t,o)},ClientApplication.prototype.setNavigationClient=function(t){this.navigationClient=t},ClientApplication.prototype.getConfiguration=function(){return this.config},ClientApplication.prototype.getRequestCorrelationId=function(t){return(null==t?void 0:t.correlationId)?t.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():RB.EMPTY_STRING},ClientApplication}(),DV=function(t){function PublicClientApplication(o){var s=t.call(this,o)||this;return s.astsAsyncMeasurement=void 0,s.activeSilentTokenRequests=new Map,s.trackPageVisibility=s.trackPageVisibility.bind(s),s}return __extends$1(PublicClientApplication,t),PublicClientApplication.prototype.loginRedirect=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o;return __generator$1(this,(function(s){return o=this.getRequestCorrelationId(t),this.logger.verbose("loginRedirect called",o),[2,this.acquireTokenRedirect(__assign$1({correlationId:o},t||kz))]}))}))},PublicClientApplication.prototype.loginPopup=function(t){var o=this.getRequestCorrelationId(t);return this.logger.verbose("loginPopup called",o),this.acquireTokenPopup(__assign$1({correlationId:o},t||kz))},PublicClientApplication.prototype.acquireTokenSilent=function(t){return __awaiter$2(this,void 0,void 0,(function(){var o,s,l,h,m,_,E,$=this;return __generator$1(this,(function(B){if(o=this.getRequestCorrelationId(t),(s=this.performanceClient.startMeasurement(XU.AcquireTokenSilent,o)).addStaticFields({cacheLookupPolicy:t.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(Lq.Silent),this.logger.verbose("acquireTokenSilent called",o),!(l=t.account||this.getActiveAccount()))throw hz.createNoAccountError();return h={clientId:this.config.auth.clientId,authority:t.authority||RB.EMPTY_STRING,scopes:t.scopes,homeAccountIdentifier:l.homeAccountId,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},m=JSON.stringify(h),void 0===(_=this.activeSilentTokenRequests.get(m))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",o),this.performanceClient.setPreQueueTime(XU.AcquireTokenSilentAsync,o),E=this.acquireTokenSilentAsync(__assign$1(__assign$1({},t),{correlationId:o}),l).then((function(o){return $.activeSilentTokenRequests.delete(m),s.addStaticFields({accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length}),s.endMeasurement({success:!0,fromCache:o.fromCache,isNativeBroker:o.fromNativeBroker,cacheLookupPolicy:t.cacheLookupPolicy,requestId:o.requestId}),o})).catch((function(t){throw $.activeSilentTokenRequests.delete(m),s.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})),this.activeSilentTokenRequests.set(m,E),[2,E]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",o),s.discardMeasurement(),[2,_])}))}))},PublicClientApplication.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},PublicClientApplication.prototype.acquireTokenSilentAsync=function(t,o){var s;return __awaiter$2(this,void 0,void 0,(function(){var l,h,m,_,E,$=this;return __generator$1(this,(function(B){switch(B.label){case 0:return this.performanceClient.addQueueMeasurement(XU.AcquireTokenSilentAsync,t.correlationId),this.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_START,Lq.Silent,t),this.astsAsyncMeasurement=this.performanceClient.startMeasurement(XU.AcquireTokenSilentAsync,t.correlationId),null===(s=this.astsAsyncMeasurement)||void 0===s||s.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),oV.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme)&&o.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),h=__assign$1(__assign$1({},t),{account:o}),l=this.acquireTokenNative(h,Dq.acquireTokenSilent_silentFlow).catch((function(o){return __awaiter$2($,void 0,void 0,(function(){return __generator$1(this,(function(s){if(o instanceof eV&&o.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(t.correlationId).acquireToken(t)];throw o}))}))})),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),m=this.createSilentCacheClient(t.correlationId),this.performanceClient.setPreQueueTime(XU.InitializeSilentRequest,t.correlationId),[4,m.initializeSilentRequest(t,o)];case 2:_=B.sent(),E=__assign$1(__assign$1({},t),{cacheLookupPolicy:t.cacheLookupPolicy||Sz.Default}),this.performanceClient.setPreQueueTime(XU.AcquireTokenFromCache,_.correlationId),l=this.acquireTokenFromCache(m,_,E).catch((function(o){if(E.cacheLookupPolicy===Sz.AccessToken)throw o;return Gz.blockReloadInHiddenIframes(),$.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_NETWORK_START,Lq.Silent,_),$.performanceClient.setPreQueueTime(XU.AcquireTokenByRefreshToken,_.correlationId),$.acquireTokenByRefreshToken(_,E).catch((function(o){var s=o instanceof YU,l=o instanceof pq,h=o.errorCode===uq.code,m=o.errorCode===pz;if((!s||!m||l||E.cacheLookupPolicy===Sz.AccessTokenAndRefreshToken||E.cacheLookupPolicy===Sz.RefreshToken)&&E.cacheLookupPolicy!==Sz.Skip&&!h)throw o;return $.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",t.correlationId),$.performanceClient.setPreQueueTime(XU.AcquireTokenBySilentIframe,_.correlationId),$.acquireTokenBySilentIframe(_)}))})),B.label=3;case 3:return[2,l.then((function(t){var o;return $.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_SUCCESS,Lq.Silent,t),null===(o=$.astsAsyncMeasurement)||void 0===o||o.endMeasurement({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,requestId:t.requestId}),t})).catch((function(t){var o;throw $.eventHandler.emitEvent(Az.ACQUIRE_TOKEN_FAILURE,Lq.Silent,null,t),null===(o=$.astsAsyncMeasurement)||void 0===o||o.endMeasurement({errorCode:t.errorCode,subErrorCode:t.subError,success:!1}),t})).finally((function(){document.removeEventListener("visibilitychange",$.trackPageVisibility)}))]}}))}))},PublicClientApplication}(NV),__awaiter=function(t,o,s,l){return new(s||(s=Promise))((function(h,m){function fulfilled(t){try{step(l.next(t))}catch(t){m(t)}}function rejected(t){try{step(l.throw(t))}catch(t){m(t)}}function step(t){t.done?h(t.value):function adopt(t){return t instanceof s?t:new s((function(o){o(t)}))}(t.value).then(fulfilled,rejected)}step((l=l.apply(t,o||[])).next())}))};
/*! @azure/msal-browser v2.38.2 2023-08-24 */exports.PromptType=void 0,(EV=exports.PromptType||(exports.PromptType={})).SELECT_ACCOUNT="select_account",EV.LOGIN="login",EV.CONSENT="consent";class Msal2Provider extends IProvider{get publicClientApplication(){return this._publicClientApplication}get name(){return"MgtMsal2Provider"}get isMultiAccountDisabled(){return!this.isMultipleAccountEnabled}set isMultiAccountDisabled(t){this.isMultipleAccountEnabled=!t}get isMultiAccountSupportedAndEnabled(){return this.isMultipleAccountEnabled}get sessionStorageRequestedScopesKey(){return"mgt-requested-scopes"}get sessionStorageDeniedScopesKey(){return"mgt-denied-scopes"}get homeAccountKey(){return"275f3731-e4a4-468a-bf9c-baca24b31e26"}constructor(t){super(),this.isMultipleAccountEnabled=!0,this.initProvider(t)}initProvider(t){return __awaiter(this,void 0,void 0,(function*(){const o=t.options||{auth:{clientId:""}};if(this.ms_config=o,this.ms_config.cache=o.cache||{},this.ms_config.cache.cacheLocation=o.cache.cacheLocation||"localStorage",void 0!==this.ms_config.cache.storeAuthStateInCookie&&null!==this.ms_config.cache.storeAuthStateInCookie||(this.ms_config.cache.storeAuthStateInCookie=!0),this.ms_config.system=o.system||{},this.ms_config.system.iframeHashTimeout=o.system.iframeHashTimeout||1e4,t.authority&&(this.ms_config.auth.authority=t.authority),t.redirectUri&&(this.ms_config.auth.redirectUri=t.redirectUri),"clientId"in t){if(!t.clientId)throw new Error("clientId must be provided");this.ms_config.auth.clientId=t.clientId,this._publicClientApplication=new DV(this.ms_config)}else{if(!("publicClientApplication"in t))throw new Error("either clientId or publicClientApplication must be provided");if(!t.publicClientApplication)throw new Error("publicClientApplication must be provided");this._publicClientApplication=t.publicClientApplication}yield this._publicClientApplication.initialize(),this.ms_config.system=o.system||{},this.ms_config.system.iframeHashTimeout=o.system.iframeHashTimeout||1e4,this._loginType=void 0!==t.loginType?t.loginType:exports.LoginType.Redirect,this._loginHint=void 0!==t.loginHint?t.loginHint:null,this._sid=void 0!==t.sid?t.sid:null,this.isIncrementalConsentDisabled=void 0!==t.isIncrementalConsentDisabled&&t.isIncrementalConsentDisabled,this._domainHint=void 0!==t.domainHint?t.domainHint:null,this.scopes=void 0!==t.scopes?t.scopes:["user.read"],this._prompt=void 0!==t.prompt?t.prompt:exports.PromptType.SELECT_ACCOUNT;const s=t;this.isMultipleAccountEnabled=void 0===s.isMultiAccountEnabled||s.isMultiAccountEnabled,this.baseURL=void 0!==s.baseURL?s.baseURL:this.baseURL,this.customHosts=s.customHosts,this.graph=createFromProvider(this);try{const t=yield this._publicClientApplication.handleRedirectPromise();null!==t?this.handleResponse(null==t?void 0:t.account):yield this.trySilentSignIn()}catch(t){throw console.error("ð¦: Problem attempting to sign in",t),t}}))}trySilentSignIn(){return __awaiter(this,void 0,void 0,(function*(){const t={scopes:this.scopes,domainHint:this._domainHint};if(this._sid||this._loginHint){t.sid=this._sid,t.loginHint=this._loginHint;try{this.setState(exports.ProviderState.Loading);const o=yield this._publicClientApplication.ssoSilent(t);o&&this.handleResponse(null==o?void 0:o.account)}catch(t){this.setState(exports.ProviderState.SignedOut)}}else{const t=this.getAccount();if(t&&(yield this.getAccessToken(null)))return void this.handleResponse(t);this.setState(exports.ProviderState.SignedOut)}}))}login(){return __awaiter(this,void 0,void 0,(function*(){const t={scopes:this.scopes,loginHint:this._loginHint,prompt:this._prompt,domainHint:this._domainHint};if(this._loginType===exports.LoginType.Popup){const o=yield this._publicClientApplication.loginPopup(t);this.handleResponse(null==o?void 0:o.account)}else{const o=Object.assign({},t);yield this._publicClientApplication.loginRedirect(o)}}))}getAllAccounts(){const t=[];return this._publicClientApplication.getAllAccounts().forEach((o=>{t.push({name:o.name,mail:o.username,id:o.homeAccountId})})),t}setActiveAccount(t){this._publicClientApplication.setActiveAccount(this._publicClientApplication.getAccountByHomeId(t.id)),this.setStoredAccount(),super.setActiveAccount(t)}getActiveAccount(){const t=this._publicClientApplication.getActiveAccount();return{name:t.name,mail:t.username,id:t.homeAccountId,tenantId:t.tenantId}}handleResponse(t){null!==t?(this.setActiveAccount({name:t.name,id:t.homeAccountId,mail:t.username}),this.setState(exports.ProviderState.SignedIn)):this.setState(exports.ProviderState.SignedOut),this.clearRequestedScopes()}storage(){return"localStorage"===this.ms_config.cache.cacheLocation?window.localStorage:window.sessionStorage}setStoredAccount(){this.clearStoredAccount(),this.storage().setItem(this.homeAccountKey,this._publicClientApplication.getActiveAccount().homeAccountId)}getStoredAccount(){const t=this.storage().getItem(this.homeAccountKey);return this._publicClientApplication.getAccountByHomeId(t)}clearStoredAccount(){this.storage().removeItem(this.homeAccountKey)}setRequestedScopes(t){t&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(t))}addDeniedScopes(t){if(t){let o=this.getDeniedScopes()||[];o=o.concat(t);let s=o.indexOf("openid");-1!==s&&o.splice(s,1),s=o.indexOf("profile"),-1!==s&&o.splice(s,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(o))}}getDeniedScopes(){const t=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return t?JSON.parse(t):null}areScopesDenied(t){if(t){const o=this.getDeniedScopes();if(o&&o.filter((o=>-1!==t.indexOf(o))).length>0)return!0}return!1}clearRequestedScopes(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}getAccount(){const t=this.getStoredAccount();return t||(this._publicClientApplication.getAllAccounts().length>0?this._publicClientApplication.getAllAccounts()[0]:null)}logout(){return __awaiter(this,void 0,void 0,(function*(){const t={account:this._publicClientApplication.getActiveAccount()};this.clearStoredAccount(),this._loginType===exports.LoginType.Redirect?(this.setState(exports.ProviderState.SignedOut),yield this._publicClientApplication.logoutRedirect(t)):(yield this._publicClientApplication.logoutPopup(Object.assign({},t)),1!==this._publicClientApplication.getAllAccounts.length&&this.isMultipleAccountEnabled?yield this.trySilentSignIn():this.setState(exports.ProviderState.SignedOut))}))}getAccessToken(t){return __awaiter(this,void 0,void 0,(function*(){const o=t&&t.scopes||this.scopes,s={scopes:o,account:this.getAccount()};try{const t=s;return(yield this._publicClientApplication.acquireTokenSilent(t)).accessToken}catch(t){if(t instanceof pq){if(this.isIncrementalConsentDisabled)return null;if(this._loginType===exports.LoginType.Redirect){if(this.areScopesDenied(o))throw t;this.setRequestedScopes(o),yield this._publicClientApplication.acquireTokenRedirect(s)}else try{return(yield this._publicClientApplication.acquireTokenPopup(s)).accessToken}catch(t){throw console.error("ð¦: problem with pop-up sign in",t),t}}else this.setState(exports.ProviderState.SignedOut)}throw null}))}}var __decorate$1=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata$1=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtMsal2Provider=class MgtMsal2Provider extends MgtBaseProvider{constructor(){super(...arguments),this.clientId=""}get isAvailable(){return!0}initializeProvider(){if(this.clientId){const t={clientId:this.clientId};if(this.loginType&&this.loginType.length>1){let o=this.loginType.toLowerCase();o=o[0].toUpperCase()+o.slice(1);const s=exports.LoginType[o];t.loginType=s}if(this.authority&&(t.authority=this.authority),this.scopes){const o=this.scopes.split(",");o&&o.length>0&&(t.scopes=o)}if(this.redirectUri&&(t.redirectUri=this.redirectUri),this.loginHint&&(t.loginHint=this.loginHint),this.domainHint&&(t.domainHint=this.domainHint),this.prompt){const o=this.prompt.toUpperCase(),s=exports.PromptType[o];t.prompt=s}this.isIncrementalConsentDisabled&&(t.isIncrementalConsentDisabled=!0),this.isMultiAccountDisabled&&(t.isMultiAccountEnabled=!1),this.baseUrl&&(t.baseURL=this.baseUrl),this.customHosts&&(t.customHosts=this.customHosts),this.provider=new Msal2Provider(t),Providers.globalProvider=this.provider}}},__decorate$1([n$1({attribute:"client-id",type:String}),__metadata$1("design:type",Object)],exports.MgtMsal2Provider.prototype,"clientId",void 0),__decorate$1([n$1({attribute:"login-hint",type:String}),__metadata$1("design:type",String)],exports.MgtMsal2Provider.prototype,"loginHint",void 0),__decorate$1([n$1({attribute:"domain-hint",type:String}),__metadata$1("design:type",String)],exports.MgtMsal2Provider.prototype,"domainHint",void 0),__decorate$1([n$1({attribute:"login-type",type:String}),__metadata$1("design:type",String)],exports.MgtMsal2Provider.prototype,"loginType",void 0),__decorate$1([n$1(),__metadata$1("design:type",String)],exports.MgtMsal2Provider.prototype,"authority",void 0),__decorate$1([n$1({attribute:"scopes",type:String}),__metadata$1("design:type",String)],exports.MgtMsal2Provider.prototype,"scopes",void 0),__decorate$1([n$1({attribute:"redirect-uri",type:String}),__metadata$1("design:type",String)],exports.MgtMsal2Provider.prototype,"redirectUri",void 0),__decorate$1([n$1({attribute:"prompt",type:String}),__metadata$1("design:type",String)],exports.MgtMsal2Provider.prototype,"prompt",void 0),__decorate$1([n$1({attribute:"incremental-consent-disabled",type:Boolean}),__metadata$1("design:type",Boolean)],exports.MgtMsal2Provider.prototype,"isIncrementalConsentDisabled",void 0),__decorate$1([n$1({attribute:"multi-account-disabled",type:Boolean}),__metadata$1("design:type",Object)],exports.MgtMsal2Provider.prototype,"isMultiAccountDisabled",void 0),exports.MgtMsal2Provider=__decorate$1([customElement("msal2-provider")],exports.MgtMsal2Provider);var __decorate=function(t,o,s,l){var h,m=arguments.length,_=m<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,s):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(t,o,s,l);else for(var E=t.length-1;E>=0;E--)(h=t[E])&&(_=(m<3?h(_):m>3?h(o,s,_):h(o,s))||_);return m>3&&_&&Object.defineProperty(o,s,_),_},__metadata=function(t,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,o)};exports.MgtMockProvider=class MgtMockProvider extends MgtBaseProvider{initializeProvider(){Providers.globalProvider=new MockProvider(!this.signedOut)}},__decorate([n$1({attribute:"signed-out",type:Boolean}),__metadata("design:type",Object)],exports.MgtMockProvider.prototype,"signedOut",void 0),exports.MgtMockProvider=__decorate([customElement("mock-provider")],exports.MgtMockProvider),exports.BatchResponse=BatchResponse,exports.BetaGraph=BetaGraph,exports.CacheService=CacheService,exports.CacheStore=CacheStore,exports.EventDispatcher=EventDispatcher,exports.Graph=Graph,exports.GraphPageIterator=GraphPageIterator,exports.IProvider=IProvider,exports.LocalizationHelper=LocalizationHelper,exports.MICROSOFT_GRAPH_DEFAULT_ENDPOINT=NA,exports.MICROSOFT_GRAPH_ENDPOINTS=DA,exports.MgtBaseComponent=MgtBaseComponent,exports.MgtBaseProvider=MgtBaseProvider,exports.MgtTemplatedComponent=MgtTemplatedComponent,exports.MockProvider=MockProvider,exports.Msal2Provider=Msal2Provider,exports.PACKAGE_VERSION=QA,exports.Providers=Providers,exports.ProxyProvider=ProxyProvider,exports.SharePointProvider=class SharePointProvider extends IProvider{get provider(){return this._provider}get isLoggedIn(){return!!this._idToken}get name(){return"MgtSharePointProvider"}constructor(t,o=NA){super(),t.aadTokenProviderFactory.getTokenProvider().then((t=>{this._provider=t,this.baseURL=o,this.graph=createFromProvider(this),this.internalLogin()}))}getAccessToken(){return __awaiter$3(this,void 0,void 0,(function*(){const t=this.baseURL?this.baseURL:NA;return yield this.provider.getToken(t)}))}updateScopes(t){this.scopes=t}internalLogin(){return __awaiter$3(this,void 0,void 0,(function*(){this._idToken=yield this.getAccessToken(),this.setState(this._idToken?exports.ProviderState.SignedIn:exports.ProviderState.SignedOut)}))}},exports.SimpleProvider=class SimpleProvider extends IProvider{get name(){return"MgtSimpleProvider"}constructor(t,o,s){super(),this._getAccessTokenHandler=t,this._loginHandler=o,this._logoutHandler=s,this.graph=createFromProvider(this)}getAccessToken(t){return this._getAccessTokenHandler(null==t?void 0:t.scopes)}login(){return this._loginHandler()}logout(){return this._logoutHandler()}},exports.TeamsHelper=TeamsHelper,exports.TemplateHelper=TemplateHelper,exports.applyTheme=applyTheme,exports.arraysAreEqual=arraysAreEqual,exports.chainMiddleware=chainMiddleware,exports.createFromProvider=createFromProvider,exports.customElement=customElement,exports.customElementHelper=YA,exports.dbListKey=JI,exports.defaultPersonProperties=EP,exports.equals=equals,exports.isCollectionResponse=isCollectionResponse,exports.isContact=isContact,exports.isGroup=t=>"groupTypes"in t,exports.isUser=isUser,exports.mgtHtml=mgtHtml,exports.prepScopes=prepScopes,exports.validateBaseURL=validateBaseURL;
//# sourceMappingURL=index.js.map
