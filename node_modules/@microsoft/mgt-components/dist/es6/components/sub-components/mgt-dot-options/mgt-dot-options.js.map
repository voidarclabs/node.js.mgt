{"version":3,"file":"mgt-dot-options.js","sourceRoot":"src/","sources":["components/sub-components/mgt-dot-options/mgt-dot-options.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { fluentMenu, fluentMenuItem, fluentButton } from '@fluentui/web-components';\nimport { MgtBaseComponent, customElement } from '@microsoft/mgt-element';\nimport { html } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { strings } from './strings';\nimport { registerFluentComponents } from '../../../utils/FluentComponents';\nimport { styles } from './mgt-dot-options-css';\n\nregisterFluentComponents(fluentMenu, fluentMenuItem, fluentButton);\n\n/**\n * Defines the event functions passed to the option item.\n */\ntype MenuOptionEventFunction = (e: Event) => void;\n\n/**\n * Custom Component used to handle an arrow rendering for TaskGroups utilized in the task component.\n *\n * @export MgtDotOptions\n * @class MgtDotOptions\n * @extends {MgtBaseComponent}\n */\n@customElement('dot-options')\nexport class MgtDotOptions extends MgtBaseComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * user the `css` tag function.\n   */\n  public static get styles() {\n    return styles;\n  }\n\n  /**\n   * Strings for localization\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtDotOptions\n   */\n  protected get strings() {\n    return strings;\n  }\n\n  /**\n   * Determines if header menu is rendered or hidden.\n   *\n   * @type {boolean}\n   * @memberof MgtDotOptions\n   */\n  @property({ type: Boolean }) public open: boolean;\n\n  /**\n   * Menu options to be rendered with an attached MouseEvent handler for expansion of details\n   *\n   * @memberof MgtDotOptions\n   */\n  @property({ type: Object }) public options: Record<string, (e: Event) => void>;\n\n  private readonly _clickHandler = () => (this.open = false);\n\n  public connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('click', this._clickHandler);\n  }\n\n  public disconnectedCallback() {\n    window.removeEventListener('click', this._clickHandler);\n    super.disconnectedCallback();\n  }\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   */\n  public render() {\n    const menuOptions = Object.keys(this.options);\n    return html`\n      <fluent-button\n        appearance=\"stealth\"\n        aria-label=${this.strings.dotOptionsTitle}\n        @click=${this.onDotClick}\n        @keydown=${this.onDotKeydown}\n        class=\"dot-icon\">\\uE712</fluent-button>\n      <fluent-menu class=${classMap({ menu: true, open: this.open })}>\n        ${menuOptions.map(opt => this.getMenuOption(opt, this.options[opt]))}\n      </fluent-menu>`;\n  }\n\n  private readonly handleItemClick = (e: MouseEvent, fn: MenuOptionEventFunction) => {\n    e.preventDefault();\n    e.stopPropagation();\n    fn(e);\n    this.open = false;\n  };\n\n  private readonly handleItemKeydown = (e: KeyboardEvent, fn: MenuOptionEventFunction) => {\n    this.handleKeydownMenuOption(e);\n    fn(e);\n    this.open = false;\n  };\n\n  /**\n   * Used by the render method to attach click handler to each dot item\n   *\n   * @param {string} name\n   * @param {MenuOptionEventFunction} clickFn\n   * @returns\n   * @memberof MgtDotOptions\n   */\n  public getMenuOption(name: string, clickFn: (e: Event) => void) {\n    return html`\n      <fluent-menu-item\n        @click=${(e: MouseEvent) => this.handleItemClick(e, clickFn)}\n        @keydown=${(e: KeyboardEvent) => this.handleItemKeydown(e, clickFn)}>\n          ${name}\n      </fluent-menu-item>`;\n  }\n\n  private readonly onDotClick = (e: MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.open = !this.open;\n  };\n\n  private readonly onDotKeydown = (e: KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.open = !this.open;\n    }\n  };\n\n  private handleKeydownMenuOption(e: KeyboardEvent) {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  }\n}\n"]}