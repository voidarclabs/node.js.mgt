{"version":3,"file":"mgt-agenda.graph.js","sourceRoot":"src/","sources":["components/mgt-agenda/mgt-agenda.graph.ts"],"names":[],"mappings":"AAAA;;;;;GAKG;;;;;;;;;;AAEH,OAAO,EAAE,iBAAiB,EAAU,UAAU,EAAE,MAAM,wBAAwB,CAAC;AAG/E,MAAM,CAAC,MAAM,0BAA0B,GAAG,CACxC,KAAa,EACb,KAAa,EACb,MAAM,GAAG,gBAAgB,EACyB,EAAE;IACpD,MAAM,OAAO,GAAG,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,iBAAiB,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC;IAEjG,OAAO,iBAAiB,CAAC,MAAM,CAAuB,KAAK,EAAE,OAAO,CAAC,CAAC;AACxE,CAAC,CAAA,CAAC;AAEF;;;;;;;;;GASG;AACH,MAAM,CAAC,MAAM,qBAAqB,GAAG,CACnC,KAAa,EACb,aAAmB,EACnB,WAAiB,EACjB,OAAgB,EACkC,EAAE;IACpD,MAAM,GAAG,GAAG,iBAAiB,aAAa,CAAC,WAAW,EAAE,EAAE,CAAC;IAC3D,MAAM,GAAG,GAAG,eAAe,WAAW,CAAC,WAAW,EAAE,EAAE,CAAC;IAEvD,IAAI,GAAW,CAAC;IAEhB,IAAI,OAAO,EAAE;QACX,GAAG,GAAG,UAAU,OAAO,WAAW,CAAC;KACpC;SAAM;QACL,GAAG,GAAG,IAAI,CAAC;KACZ;IAED,GAAG,IAAI,iBAAiB,GAAG,IAAI,GAAG,EAAE,CAAC;IAErC,OAAO,0BAA0B,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;AAChD,CAAC,CAAA,CAAC","sourcesContent":["/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { GraphPageIterator, IGraph, prepScopes } from '@microsoft/mgt-element';\nimport * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\n\nexport const getEventsQueryPageIterator = async (\n  graph: IGraph,\n  query: string,\n  scopes = 'calendars.read'\n): Promise<GraphPageIterator<MicrosoftGraph.Event>> => {\n  const request = graph.api(query).middlewareOptions(prepScopes(scopes)).orderby('start/dateTime');\n\n  return GraphPageIterator.create<MicrosoftGraph.Event>(graph, request);\n};\n\n/**\n * returns Calender events iterator associated with either the logged in user or a specific groupId\n *\n * @param {Date} startDateTime\n * @param {Date} endDateTime\n * @param {string} [groupId]\n * @param {string} preferredTimezone\n * @returns {(Promise<Event[]>)}\n * @memberof Graph\n */\nexport const getEventsPageIterator = async (\n  graph: IGraph,\n  startDateTime: Date,\n  endDateTime: Date,\n  groupId?: string\n): Promise<GraphPageIterator<MicrosoftGraph.Event>> => {\n  const sdt = `startdatetime=${startDateTime.toISOString()}`;\n  const edt = `enddatetime=${endDateTime.toISOString()}`;\n\n  let uri: string;\n\n  if (groupId) {\n    uri = `groups/${groupId}/calendar`;\n  } else {\n    uri = 'me';\n  }\n\n  uri += `/calendarview?${sdt}&${edt}`;\n\n  return getEventsQueryPageIterator(graph, uri);\n};\n"]}