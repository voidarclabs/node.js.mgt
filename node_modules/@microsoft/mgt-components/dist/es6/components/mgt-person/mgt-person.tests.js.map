{"version":3,"file":"mgt-person.tests.js","sourceRoot":"src/","sources":["components/mgt-person/mgt-person.tests.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { screen } from 'testing-library__dom';\nimport { fixture } from '@open-wc/testing-helpers';\nimport { enableFetchMocks } from 'jest-fetch-mock';\nimport fetchMock from 'jest-fetch-mock';\nimport { MockProvider, Providers } from '@microsoft/mgt-element';\nimport { userPhotoBatchResponse } from './__test_data/mock-responses';\nimport './mgt-person';\nenableFetchMocks();\n\nlet person: Element;\ndescribe('mgt-person - tests', () => {\n  beforeEach(() => {\n    fetchMock.resetMocks();\n    fetchMock\n      // Response for the setup of the MockGraph to call to the proxy service\n      .once(() =>\n        Promise.resolve({\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          status: 200,\n          body: 'https://fake-proxy.microsoft.com/'\n        })\n      )\n      // response to the $batch request to load the user photo and user data when there is nothing in the cache\n      // note that this used mockOnceIf matching the fake url supplied in the first mock.\n      .mockOnceIf(/https:\\/\\/fake-proxy\\.microsoft\\.com\\/*$/, () =>\n        Promise.resolve({\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          status: 200,\n          body: JSON.stringify(userPhotoBatchResponse)\n        })\n      );\n  });\n\n  it('should render', async () => {\n    Providers.globalProvider = new MockProvider(true);\n    person = await fixture('<mgt-person person-query=\"me\" view=\"twoLines\"></mgt-person>');\n    const img = await screen.findAllByAltText('Photo for Megan Bowen');\n    expect(img).not.toBeNull();\n    expect(person).not.toBeUndefined();\n  });\n\n  it('should pop up a flyout on click', async () => {\n    Providers.globalProvider = new MockProvider(true);\n    person = await fixture('<mgt-person person-query=\"me\" view=\"twoLines\" person-card=\"click\"></mgt-person>');\n    const img = await screen.findAllByAltText('Photo for Megan Bowen');\n    expect(img).not.toBeNull();\n    expect(img.length).toBe(1);\n    // test that there is no flyout\n    expect(screen.queryByTestId('flyout-slot')).toBeNull();\n\n    img[0].click();\n\n    expect(screen.queryByTestId('flyout-slot')).toBeDefined();\n  });\n\n  it('should render with initials when given name and surname are supplied', async () => {\n    Providers.globalProvider = new MockProvider(true);\n    person = await fixture(\n      `<mgt-person person-details='${JSON.stringify({\n        displayName: 'Frank Herbert',\n        mail: 'herbert@dune.net',\n        givenName: 'Brian',\n        surname: 'Herbert',\n        personType: {}\n      })}' view=\"twoLines\"></mgt-person>`\n    );\n    expect(person).not.toBeUndefined();\n    const initials = await screen.findByText('BH');\n    expect(initials).toBeDefined();\n  });\n\n  it('should render with initials when given name and surname are null', async () => {\n    Providers.globalProvider = new MockProvider(true);\n    person = await fixture(\n      `<mgt-person person-details='${JSON.stringify({\n        displayName: 'Frank Herbert',\n        mail: 'herbert@dune.net',\n        givenName: null,\n        surname: null,\n        personType: {}\n      })}' view=\"twoLines\"></mgt-person>`\n    );\n    expect(person).not.toBeUndefined();\n    const initials = await screen.findByText('FH');\n    expect(initials).toBeDefined();\n  });\n\n  it('should render with first initial when only given name is supplied', async () => {\n    Providers.globalProvider = new MockProvider(true);\n    person = await fixture(\n      `<mgt-person person-details='${JSON.stringify({\n        displayName: 'Frank Herbert',\n        mail: 'herbert@dune.net',\n        givenName: 'Frank',\n        surname: null,\n        personType: {}\n      })}' view=\"twoLines\"></mgt-person>`\n    );\n    expect(person).not.toBeUndefined();\n    const initials = await screen.findByText('F');\n    expect(initials).toBeDefined();\n  });\n\n  it('should render with first initial when only given name is populated and surname is an empty string', async () => {\n    Providers.globalProvider = new MockProvider(true);\n    person = await fixture(\n      `<mgt-person person-details='${JSON.stringify({\n        displayName: 'Frank Herbert',\n        mail: 'herbert@dune.net',\n        givenName: 'Frank',\n        surname: '',\n        personType: {}\n      })}' view=\"twoLines\"></mgt-person>`\n    );\n    expect(person).not.toBeUndefined();\n    const initials = await screen.findByText('F');\n    expect(initials).toBeDefined();\n  });\n\n  it('should render with last initial when only surname is supplied', async () => {\n    Providers.globalProvider = new MockProvider(true);\n    person = await fixture(\n      `<mgt-person person-details='${JSON.stringify({\n        displayName: 'Frank Herbert',\n        mail: 'herbert@dune.net',\n        givenName: null,\n        surname: 'Herbert',\n        personType: {}\n      })}' view=\"twoLines\"></mgt-person>`\n    );\n    expect(person).not.toBeUndefined();\n    const initials = await screen.findByText('H');\n    expect(initials).toBeDefined();\n  });\n  it('should render with last initial when only surname is populated and given name is an empty string', async () => {\n    Providers.globalProvider = new MockProvider(true);\n    person = await fixture(\n      `<mgt-person person-details='${JSON.stringify({\n        displayName: 'Frank Herbert',\n        mail: 'herbert@dune.net',\n        givenName: '',\n        surname: 'Herbert',\n        personType: {}\n      })}' view=\"twoLines\"></mgt-person>`\n    );\n    expect(person).not.toBeUndefined();\n    const initials = await screen.findByText('H');\n    expect(initials).toBeDefined();\n  });\n\n  it('should render with one initial when only displayName of one word is supplied', async () => {\n    Providers.globalProvider = new MockProvider(true);\n    person = await fixture(\n      `<mgt-person person-details='${JSON.stringify({\n        displayName: 'Frank',\n        mail: 'herbert@dune.net',\n        givenName: null,\n        surname: null,\n        personType: {}\n      })}' view=\"twoLines\"></mgt-person>`\n    );\n    expect(person).not.toBeUndefined();\n    const initials = await screen.findByText('F');\n    expect(initials).toBeDefined();\n  });\n\n  it('should render with two initial when only displayName of more than two words is supplied', async () => {\n    Providers.globalProvider = new MockProvider(true);\n    person = await fixture(\n      `<mgt-person person-details='${JSON.stringify({\n        displayName: 'Frank van Herbert',\n        mail: 'herbert@dune.net',\n        givenName: null,\n        surname: null,\n        personType: {}\n      })}' view=\"twoLines\"></mgt-person>`\n    );\n    expect(person).not.toBeUndefined();\n    const initials = await screen.findByText('FV');\n    expect(initials).toBeDefined();\n  });\n});\n"]}